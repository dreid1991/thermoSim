(function(){function b(d,e,f){if(d===e)return 0!==d||1/d==1/e;if(null==d||null==e)return d===e;d._chain&&(d=d._wrapped);e._chain&&(e=e._wrapped);if(d.isEqual&&v.isFunction(d.isEqual))return d.isEqual(e);if(e.isEqual&&v.isFunction(e.isEqual))return e.isEqual(d);var h=n.call(d);if(h!=n.call(e))return!1;switch(h){case "[object String]":return d==""+e;case "[object Number]":return d!=+d?e!=+e:0==d?1/d==1/e:d==+e;case "[object Date]":case "[object Boolean]":return+d==+e;case "[object RegExp]":return d.source==
e.source&&d.global==e.global&&d.multiline==e.multiline&&d.ignoreCase==e.ignoreCase}if("object"!=typeof d||"object"!=typeof e)return!1;for(var l=f.length;l--;)if(f[l]==d)return!0;f.push(d);var l=0,k=!0;if("[object Array]"==h){if(l=d.length,k=l==e.length)for(;l--&&(k=l in d==l in e&&b(d[l],e[l],f)););}else{if("constructor"in d!="constructor"in e||d.constructor!=e.constructor)return!1;for(var m in d)if(v.has(d,m)&&(l++,!(k=v.has(e,m)&&b(d[m],e[m],f))))break;if(k){for(m in e)if(v.has(e,m)&&!l--)break;
k=!l}}f.pop();return k}var d=this,e=d._,f={},h=Array.prototype,k=Object.prototype,l=h.slice,m=h.unshift,n=k.toString,p=k.hasOwnProperty,r=h.forEach,s=h.map,t=h.reduce,u=h.reduceRight,w=h.filter,x=h.every,y=h.some,z=h.indexOf,F=h.lastIndexOf,k=Array.isArray,C=Object.keys,A=Function.prototype.bind,v=function(b){return new aa(b)};"undefined"!==typeof exports?("undefined"!==typeof module&&module.exports&&(exports=module.exports=v),exports._=v):d._=v;v.VERSION="1.3.3";var B=v.each=v.forEach=function(b,
d,e){if(null!=b)if(r&&b.forEach===r)b.forEach(d,e);else if(b.length===+b.length)for(var h=0,l=b.length;h<l&&!(h in b&&d.call(e,b[h],h,b)===f);h++);else for(h in b)if(v.has(b,h)&&d.call(e,b[h],h,b)===f)break};v.map=v.collect=function(b,d,e){var f=[];if(null==b)return f;if(s&&b.map===s)return b.map(d,e);B(b,function(b,h,l){f[f.length]=d.call(e,b,h,l)});b.length===+b.length&&(f.length=b.length);return f};v.reduce=v.foldl=v.inject=function(b,d,e,f){var h=2<arguments.length;null==b&&(b=[]);if(t&&b.reduce===
t)return f&&(d=v.bind(d,f)),h?b.reduce(d,e):b.reduce(d);B(b,function(b,l,k){h?e=d.call(f,e,b,l,k):(e=b,h=!0)});if(!h)throw new TypeError("Reduce of empty array with no initial value");return e};v.reduceRight=v.foldr=function(b,d,e,f){var h=2<arguments.length;null==b&&(b=[]);if(u&&b.reduceRight===u)return f&&(d=v.bind(d,f)),h?b.reduceRight(d,e):b.reduceRight(d);var l=v.toArray(b).reverse();f&&!h&&(d=v.bind(d,f));return h?v.reduce(l,d,e,f):v.reduce(l,d)};v.find=v.detect=function(b,d,e){var f;T(b,function(b,
h,l){if(d.call(e,b,h,l))return f=b,!0});return f};v.filter=v.select=function(b,d,e){var f=[];if(null==b)return f;if(w&&b.filter===w)return b.filter(d,e);B(b,function(b,h,l){d.call(e,b,h,l)&&(f[f.length]=b)});return f};v.reject=function(b,d,e){var f=[];if(null==b)return f;B(b,function(b,h,l){d.call(e,b,h,l)||(f[f.length]=b)});return f};v.every=v.all=function(b,d,e){var h=!0;if(null==b)return h;if(x&&b.every===x)return b.every(d,e);B(b,function(b,l,k){if(!(h=h&&d.call(e,b,l,k)))return f});return!!h};
var T=v.some=v.any=function(b,d,e){d||(d=v.identity);var h=!1;if(null==b)return h;if(y&&b.some===y)return b.some(d,e);B(b,function(b,l,k){if(h||(h=d.call(e,b,l,k)))return f});return!!h};v.include=v.contains=function(b,d){return null==b?!1:z&&b.indexOf===z?-1!=b.indexOf(d):T(b,function(b){return b===d})};v.invoke=function(b,d){var e=l.call(arguments,2);return v.map(b,function(b){return(v.isFunction(d)?d||b:b[d]).apply(b,e)})};v.pluck=function(b,d){return v.map(b,function(b){return b[d]})};v.max=function(b,
d,e){if(!d&&v.isArray(b)&&b[0]===+b[0])return Math.max.apply(Math,b);if(!d&&v.isEmpty(b))return-Infinity;var f={computed:-Infinity};B(b,function(b,h,l){h=d?d.call(e,b,h,l):b;h>=f.computed&&(f={value:b,computed:h})});return f.value};v.min=function(b,d,e){if(!d&&v.isArray(b)&&b[0]===+b[0])return Math.min.apply(Math,b);if(!d&&v.isEmpty(b))return Infinity;var f={computed:Infinity};B(b,function(b,h,l){h=d?d.call(e,b,h,l):b;h<f.computed&&(f={value:b,computed:h})});return f.value};v.shuffle=function(b){var d=
[],e;B(b,function(b,f){e=Math.floor(Math.random()*(f+1));d[f]=d[e];d[e]=b});return d};v.sortBy=function(b,d,e){var f=v.isFunction(d)?d:function(b){return b[d]};return v.pluck(v.map(b,function(b,d,h){return{value:b,criteria:f.call(e,b,d,h)}}).sort(function(b,d){var e=b.criteria,f=d.criteria;return void 0===e?1:void 0===f?-1:e<f?-1:e>f?1:0}),"value")};v.groupBy=function(b,d){var e={},f=v.isFunction(d)?d:function(b){return b[d]};B(b,function(b,d){var h=f(b,d);(e[h]||(e[h]=[])).push(b)});return e};v.sortedIndex=
function(b,d,e){e||(e=v.identity);for(var f=0,h=b.length;f<h;){var l=f+h>>1;e(b[l])<e(d)?f=l+1:h=l}return f};v.toArray=function(b){return!b?[]:v.isArray(b)||v.isArguments(b)?l.call(b):b.toArray&&v.isFunction(b.toArray)?b.toArray():v.values(b)};v.size=function(b){return v.isArray(b)?b.length:v.keys(b).length};v.first=v.head=v.take=function(b,d,e){return null!=d&&!e?l.call(b,0,d):b[0]};v.initial=function(b,d,e){return l.call(b,0,b.length-(null==d||e?1:d))};v.last=function(b,d,e){return null!=d&&!e?
l.call(b,Math.max(b.length-d,0)):b[b.length-1]};v.rest=v.tail=function(b,d,e){return l.call(b,null==d||e?1:d)};v.compact=function(b){return v.filter(b,function(b){return!!b})};v.flatten=function(b,d){return v.reduce(b,function(b,e){if(v.isArray(e))return b.concat(d?e:v.flatten(e));b[b.length]=e;return b},[])};v.without=function(b){return v.difference(b,l.call(arguments,1))};v.uniq=v.unique=function(b,d,e){e=e?v.map(b,e):b;var f=[];3>b.length&&(d=!0);v.reduce(e,function(e,h,l){if(d?v.last(e)!==h||
!e.length:!v.include(e,h))e.push(h),f.push(b[l]);return e},[]);return f};v.union=function(){return v.uniq(v.flatten(arguments,!0))};v.intersection=v.intersect=function(b){var d=l.call(arguments,1);return v.filter(v.uniq(b),function(b){return v.every(d,function(d){return 0<=v.indexOf(d,b)})})};v.difference=function(b){var d=v.flatten(l.call(arguments,1),!0);return v.filter(b,function(b){return!v.include(d,b)})};v.zip=function(){for(var b=l.call(arguments),d=v.max(v.pluck(b,"length")),e=Array(d),f=
0;f<d;f++)e[f]=v.pluck(b,""+f);return e};v.indexOf=function(b,d,e){if(null==b)return-1;var f;if(e)return e=v.sortedIndex(b,d),b[e]===d?e:-1;if(z&&b.indexOf===z)return b.indexOf(d);e=0;for(f=b.length;e<f;e++)if(e in b&&b[e]===d)return e;return-1};v.lastIndexOf=function(b,d){if(null==b)return-1;if(F&&b.lastIndexOf===F)return b.lastIndexOf(d);for(var e=b.length;e--;)if(e in b&&b[e]===d)return e;return-1};v.range=function(b,d,e){1>=arguments.length&&(d=b||0,b=0);e=arguments[2]||1;for(var f=Math.max(Math.ceil((d-
b)/e),0),h=0,l=Array(f);h<f;)l[h++]=b,b+=e;return l};var E=function(){};v.bind=function(b,d){var e,f;if(b.bind===A&&A)return A.apply(b,l.call(arguments,1));if(!v.isFunction(b))throw new TypeError;f=l.call(arguments,2);return e=function(){if(!(this instanceof e))return b.apply(d,f.concat(l.call(arguments)));E.prototype=b.prototype;var h=new E,k=b.apply(h,f.concat(l.call(arguments)));return Object(k)===k?k:h}};v.bindAll=function(b){var d=l.call(arguments,1);0==d.length&&(d=v.functions(b));B(d,function(d){b[d]=
v.bind(b[d],b)});return b};v.memoize=function(b,d){var e={};d||(d=v.identity);return function(){var f=d.apply(this,arguments);return v.has(e,f)?e[f]:e[f]=b.apply(this,arguments)}};v.delay=function(b,d){var e=l.call(arguments,2);return setTimeout(function(){return b.apply(null,e)},d)};v.defer=function(b){return v.delay.apply(v,[b,1].concat(l.call(arguments,1)))};v.throttle=function(b,d){var e,f,h,l,k,m,n=v.debounce(function(){k=l=!1},d);return function(){e=this;f=arguments;h||(h=setTimeout(function(){h=
null;k&&b.apply(e,f);n()},d));l?k=!0:m=b.apply(e,f);n();l=!0;return m}};v.debounce=function(b,d,e){var f;return function(){var h=this,l=arguments;e&&!f&&b.apply(h,l);clearTimeout(f);f=setTimeout(function(){f=null;e||b.apply(h,l)},d)}};v.once=function(b){var d=!1,e;return function(){if(d)return e;d=!0;return e=b.apply(this,arguments)}};v.wrap=function(b,d){return function(){var e=[b].concat(l.call(arguments,0));return d.apply(this,e)}};v.compose=function(){var b=arguments;return function(){for(var d=
arguments,e=b.length-1;0<=e;e--)d=[b[e].apply(this,d)];return d[0]}};v.after=function(b,d){return 0>=b?d():function(){if(1>--b)return d.apply(this,arguments)}};v.keys=C||function(b){if(b!==Object(b))throw new TypeError("Invalid object");var d=[],e;for(e in b)v.has(b,e)&&(d[d.length]=e);return d};v.values=function(b){return v.map(b,v.identity)};v.functions=v.methods=function(b){var d=[],e;for(e in b)v.isFunction(b[e])&&d.push(e);return d.sort()};v.extend=function(b){B(l.call(arguments,1),function(d){for(var e in d)b[e]=
d[e]});return b};v.pick=function(b){var d={};B(v.flatten(l.call(arguments,1)),function(e){e in b&&(d[e]=b[e])});return d};v.defaults=function(b){B(l.call(arguments,1),function(d){for(var e in d)null==b[e]&&(b[e]=d[e])});return b};v.clone=function(b){return!v.isObject(b)?b:v.isArray(b)?b.slice():v.extend({},b)};v.tap=function(b,d){d(b);return b};v.isEqual=function(d,e){return b(d,e,[])};v.isEmpty=function(b){if(null==b)return!0;if(v.isArray(b)||v.isString(b))return 0===b.length;for(var d in b)if(v.has(b,
d))return!1;return!0};v.isElement=function(b){return!!(b&&1==b.nodeType)};v.isArray=k||function(b){return"[object Array]"==n.call(b)};v.isObject=function(b){return b===Object(b)};v.isArguments=function(b){return"[object Arguments]"==n.call(b)};v.isArguments(arguments)||(v.isArguments=function(b){return!(!b||!v.has(b,"callee"))});v.isFunction=function(b){return"[object Function]"==n.call(b)};v.isString=function(b){return"[object String]"==n.call(b)};v.isNumber=function(b){return"[object Number]"==
n.call(b)};v.isFinite=function(b){return v.isNumber(b)&&isFinite(b)};v.isNaN=function(b){return b!==b};v.isBoolean=function(b){return!0===b||!1===b||"[object Boolean]"==n.call(b)};v.isDate=function(b){return"[object Date]"==n.call(b)};v.isRegExp=function(b){return"[object RegExp]"==n.call(b)};v.isNull=function(b){return null===b};v.isUndefined=function(b){return void 0===b};v.has=function(b,d){return p.call(b,d)};v.noConflict=function(){d._=e;return this};v.identity=function(b){return b};v.times=
function(b,d,e){for(var f=0;f<b;f++)d.call(e,f)};v.escape=function(b){return(""+b).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")};v.result=function(b,d){if(null==b)return null;var e=b[d];return v.isFunction(e)?e.call(b):e};v.mixin=function(b){B(v.functions(b),function(d){ea(d,v[d]=b[d])})};var Q=0;v.uniqueId=function(b){var d=Q++;return b?b+d:d};v.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,
escape:/<%-([\s\S]+?)%>/g};var M=/.^/,L={"\\":"\\","'":"'",r:"\r",n:"\n",t:"\t",u2028:"\u2028",u2029:"\u2029"},K;for(K in L)L[L[K]]=K;var Z=/\\|'|\r|\n|\t|\u2028|\u2029/g,ca=/\\(\\|'|r|n|t|u2028|u2029)/g,ia=function(b){return b.replace(ca,function(b,d){return L[d]})};v.template=function(b,d,e){e=v.defaults(e||{},v.templateSettings);b="__p+='"+b.replace(Z,function(b){return"\\"+L[b]}).replace(e.escape||M,function(b,d){return"'+\n_.escape("+ia(d)+")+\n'"}).replace(e.interpolate||M,function(b,d){return"'+\n("+
ia(d)+")+\n'"}).replace(e.evaluate||M,function(b,d){return"';\n"+ia(d)+"\n;__p+='"})+"';\n";e.variable||(b="with(obj||{}){\n"+b+"}\n");b="var __p='';var print=function(){__p+=Array.prototype.join.call(arguments, '')};\n"+b+"return __p;\n";var f=new Function(e.variable||"obj","_",b);if(d)return f(d,v);d=function(b){return f.call(this,b,v)};d.source="function("+(e.variable||"obj")+"){\n"+b+"}";return d};v.chain=function(b){return v(b).chain()};var aa=function(b){this._wrapped=b};v.prototype=aa.prototype;
var U=function(b,d){return d?v(b).chain():b},ea=function(b,d){aa.prototype[b]=function(){var b=l.call(arguments);m.call(b,this._wrapped);return U(d.apply(v,b),this._chain)}};v.mixin(v);B("pop push reverse shift sort splice unshift".split(" "),function(b){var d=h[b];aa.prototype[b]=function(){var e=this._wrapped;d.apply(e,arguments);var f=e.length;("shift"==b||"splice"==b)&&0===f&&delete e[0];return U(e,this._chain)}});B(["concat","join","slice"],function(b){var d=h[b];aa.prototype[b]=function(){return U(d.apply(this._wrapped,
arguments),this._chain)}});aa.prototype.chain=function(){this._chain=!0;return this};aa.prototype.value=function(){return this._wrapped}}).call(this);(function(b,d){function e(b){var d=b.length,e=q.type(b);return q.isWindow(b)?!1:1===b.nodeType&&d?!0:"array"===e||"function"!==e&&(0===d||"number"==typeof d&&0<d&&d-1 in b)}function f(b){var d=Ta[b]={};return q.each(b.match(na)||[],function(b,e){d[e]=!0}),d}function h(){Object.defineProperty(this.cache={},0,{get:function(){return{}}});this.expando=q.expando+Math.random()}function k(b,e,f){var h;if(f===d&&1===b.nodeType)if(h="data-"+e.replace(pb,"-$1").toLowerCase(),f=b.getAttribute(h),"string"==typeof f){try{f=
"true"===f?!0:"false"===f?!1:"null"===f?null:+f+""===f?+f:qb.test(f)?JSON.parse(f):f}catch(l){}ba.set(b,e,f)}else f=d;return f}function l(){return!0}function m(){return!1}function n(){try{return I.activeElement}catch(b){}}function p(b,d){for(;(b=b[d])&&1!==b.nodeType;);return b}function r(b,d,e){if(q.isFunction(d))return q.grep(b,function(b,f){return!!d.call(b,f,b)!==e});if(d.nodeType)return q.grep(b,function(b){return b===d!==e});if("string"==typeof d){if(rb.test(d))return q.filter(d,b,e);d=q.filter(d,
b)}return q.grep(b,function(b){return 0<=Fa.call(d,b)!==e})}function s(b,d){return q.nodeName(b,"table")&&q.nodeName(1===d.nodeType?d:d.firstChild,"tr")?b.getElementsByTagName("tbody")[0]||b.appendChild(b.ownerDocument.createElement("tbody")):b}function t(b){return b.type=(null!==b.getAttribute("type"))+"/"+b.type,b}function u(b){var d=sb.exec(b.type);return d?b.type=d[1]:b.removeAttribute("type"),b}function w(b,d){for(var e=b.length,f=0;e>f;f++)G.set(b[f],"globalEval",!d||G.get(d[f],"globalEval"))}
function x(b,d){var e,f,h,l,k,m;if(1===d.nodeType){if(G.hasData(b)&&(e=G.access(b),f=G.set(d,e),m=e.events))for(h in delete f.handle,f.events={},m){e=0;for(f=m[h].length;f>e;e++)q.event.add(d,h,m[h][e])}ba.hasData(b)&&(l=ba.access(b),k=q.extend({},l),ba.set(d,k))}}function y(b,e){var f=b.getElementsByTagName?b.getElementsByTagName(e||"*"):b.querySelectorAll?b.querySelectorAll(e||"*"):[];return e===d||e&&q.nodeName(b,e)?q.merge([b],f):f}function z(b,d){if(d in b)return d;for(var e=d.charAt(0).toUpperCase()+
d.slice(1),f=d,h=Ua.length;h--;)if(d=Ua[h]+e,d in b)return d;return f}function F(b,d){return b=d||b,"none"===q.css(b,"display")||!q.contains(b.ownerDocument,b)}function C(b,d){for(var e,f,h,l=[],k=0,m=b.length;m>k;k++)f=b[k],f.style&&(l[k]=G.get(f,"olddisplay"),e=f.style.display,d?(l[k]||"none"!==e||(f.style.display=""),""===f.style.display&&F(f)&&(l[k]=G.access(f,"olddisplay",T(f.nodeName)))):l[k]||(h=F(f),(e&&"none"!==e||!h)&&G.set(f,"olddisplay",h?e:q.css(f,"display"))));for(k=0;m>k;k++)f=b[k],
f.style&&(d&&"none"!==f.style.display&&""!==f.style.display||(f.style.display=d?l[k]||"":"none"));return b}function A(b,d,e){return(b=tb.exec(d))?Math.max(0,b[1]-(e||0))+(b[2]||"px"):d}function v(b,d,e,f,h){d=e===(f?"border":"content")?4:"width"===d?1:0;for(var l=0;4>d;d+=2)"margin"===e&&(l+=q.css(b,e+ra[d],!0,h)),f?("content"===e&&(l-=q.css(b,"padding"+ra[d],!0,h)),"margin"!==e&&(l-=q.css(b,"border"+ra[d]+"Width",!0,h))):(l+=q.css(b,"padding"+ra[d],!0,h),"padding"!==e&&(l+=q.css(b,"border"+ra[d]+
"Width",!0,h)));return l}function B(d,e,f){var h=!0,l="width"===e?d.offsetWidth:d.offsetHeight,k=b.getComputedStyle(d,null),m=q.support.boxSizing&&"border-box"===q.css(d,"boxSizing",!1,k);if(0>=l||null==l){if(l=sa(d,e,k),(0>l||null==l)&&(l=d.style[e]),Ja.test(l))return l;h=m&&(q.support.boxSizingReliable||l===d.style[e]);l=parseFloat(l)||0}return l+v(d,e,f||(m?"border":"content"),h,k)+"px"}function T(b){var d=I,e=Va[b];return e||(e=E(b,d),"none"!==e&&e||(ta=(ta||q("<iframe frameborder='0' width='0' height='0'/>").css("cssText",
"display:block !important")).appendTo(d.documentElement),d=(ta[0].contentWindow||ta[0].contentDocument).document,d.write("<!doctype html><html><body>"),d.close(),e=E(b,d),ta.detach()),Va[b]=e),e}function E(b,d){var e=q(d.createElement(b)).appendTo(d.body),f=q.css(e[0],"display");return e.remove(),f}function Q(b,d,e,f){var h;if(q.isArray(d))q.each(d,function(d,h){e||ub.test(b)?f(b,h):Q(b+"["+("object"==typeof h?d:"")+"]",h,e,f)});else if(e||"object"!==q.type(d))f(b,d);else for(h in d)Q(b+"["+h+"]",
d[h],e,f)}function M(b){return function(d,e){"string"!=typeof d&&(e=d,d="*");var f,h=0,l=d.toLowerCase().match(na)||[];if(q.isFunction(e))for(;f=l[h++];)"+"===f[0]?(f=f.slice(1)||"*",(b[f]=b[f]||[]).unshift(e)):(b[f]=b[f]||[]).push(e)}}function L(b,e,f,h){function l(n){var p;return k[n]=!0,q.each(b[n]||[],function(b,n){var H=n(e,f,h);return"string"!=typeof H||m||k[H]?m?!(p=H):d:(e.dataTypes.unshift(H),l(H),!1)}),p}var k={},m=b===Ka;return l(e.dataTypes[0])||!k["*"]&&l("*")}function K(b,e){var f,h,
l=q.ajaxSettings.flatOptions||{};for(f in e)e[f]!==d&&((l[f]?b:h||(h={}))[f]=e[f]);return h&&q.extend(!0,b,h),b}function Z(){return setTimeout(function(){ua=d}),ua=q.now()}function ca(b,d,e){for(var f,h=(pa[d]||[]).concat(pa["*"]),l=0,k=h.length;k>l;l++)if(f=h[l].call(e,d,b))return f}function ia(b,d,e){var f,h=0,l=Ga.length,k=q.Deferred().always(function(){delete m.elem}),m=function(){if(f)return!1;for(var d=ua||Z(),d=Math.max(0,n.startTime+n.duration-d),e=1-(d/n.duration||0),h=0,l=n.tweens.length;l>
h;h++)n.tweens[h].run(e);return k.notifyWith(b,[n,e,d]),1>e&&l?d:(k.resolveWith(b,[n]),!1)},n=k.promise({elem:b,props:q.extend({},d),opts:q.extend(!0,{specialEasing:{}},e),originalProperties:d,originalOptions:e,startTime:ua||Z(),duration:e.duration,tweens:[],createTween:function(d,e){var f=q.Tween(b,n.opts,d,e,n.opts.specialEasing[d]||n.opts.easing);return n.tweens.push(f),f},stop:function(d){var e=0,h=d?n.tweens.length:0;if(f)return this;for(f=!0;h>e;e++)n.tweens[e].run(1);return d?k.resolveWith(b,
[n,d]):k.rejectWith(b,[n,d]),this}});e=n.props;for(aa(e,n.opts.specialEasing);l>h;h++)if(d=Ga[h].call(n,b,e,n.opts))return d;return q.map(e,ca,n),q.isFunction(n.opts.start)&&n.opts.start.call(b,n),q.fx.timer(q.extend(m,{elem:b,anim:n,queue:n.opts.queue})),n.progress(n.opts.progress).done(n.opts.done,n.opts.complete).fail(n.opts.fail).always(n.opts.always)}function aa(b,d){var e,f,h,l,k;for(e in b)if(f=q.camelCase(e),h=d[f],l=b[e],q.isArray(l)&&(h=l[1],l=b[e]=l[0]),e!==f&&(b[f]=l,delete b[e]),k=q.cssHooks[f],
k&&"expand"in k)for(e in l=k.expand(l),delete b[f],l)e in b||(b[e]=l[e],d[e]=h);else d[f]=h}function U(b,d,e,f,h){return new U.prototype.init(b,d,e,f,h)}function ea(b,d){var e,f={height:b},h=0;for(d=d?1:0;4>h;h+=2-d)e=ra[h],f["margin"+e]=f["padding"+e]=b;return d&&(f.opacity=f.width=b),f}var J,Y,O=typeof d,oa=b.location,I=b.document,ga=I.documentElement,ka=b.jQuery,W=b.$,xa={},Ha=[],Wa=Ha.concat,La=Ha.push,va=Ha.slice,Fa=Ha.indexOf,vb=xa.toString,Na=xa.hasOwnProperty,wb="2.0.3".trim,q=function(b,
d){return new q.fn.init(b,d,J)},wa=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,na=/\S+/g,xb=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,Xa=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,yb=/^-ms-/,zb=/-([\da-z])/gi,Ab=function(b,d){return d.toUpperCase()},ya=function(){I.removeEventListener("DOMContentLoaded",ya,!1);b.removeEventListener("load",ya,!1);q.ready()};q.fn=q.prototype={jquery:"2.0.3",constructor:q,init:function(b,e,f){var h,l;if(!b)return this;if("string"==typeof b){if(h="<"===b.charAt(0)&&">"===b.charAt(b.length-
1)&&3<=b.length?[null,b,null]:xb.exec(b),!h||!h[1]&&e)return!e||e.jquery?(e||f).find(b):this.constructor(e).find(b);if(h[1]){if(e=e instanceof q?e[0]:e,q.merge(this,q.parseHTML(h[1],e&&e.nodeType?e.ownerDocument||e:I,!0)),Xa.test(h[1])&&q.isPlainObject(e))for(h in e)q.isFunction(this[h])?this[h](e[h]):this.attr(h,e[h]);return this}return l=I.getElementById(h[2]),l&&l.parentNode&&(this.length=1,this[0]=l),this.context=I,this.selector=b,this}return b.nodeType?(this.context=this[0]=b,this.length=1,this):
q.isFunction(b)?f.ready(b):(b.selector!==d&&(this.selector=b.selector,this.context=b.context),q.makeArray(b,this))},selector:"",length:0,toArray:function(){return va.call(this)},get:function(b){return null==b?this.toArray():0>b?this[this.length+b]:this[b]},pushStack:function(b){b=q.merge(this.constructor(),b);return b.prevObject=this,b.context=this.context,b},each:function(b,d){return q.each(this,b,d)},ready:function(b){return q.ready.promise().done(b),this},slice:function(){return this.pushStack(va.apply(this,
arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(b){var d=this.length;b=+b+(0>b?d:0);return this.pushStack(0<=b&&d>b?[this[b]]:[])},map:function(b){return this.pushStack(q.map(this,function(d,e){return b.call(d,e,d)}))},end:function(){return this.prevObject||this.constructor(null)},push:La,sort:[].sort,splice:[].splice};q.fn.init.prototype=q.fn;q.extend=q.fn.extend=function(){var b,e,f,h,l,k,m=arguments[0]||{},n=1,p=arguments.length,r=!1;"boolean"==
typeof m&&(r=m,m=arguments[1]||{},n=2);"object"==typeof m||q.isFunction(m)||(m={});for(p===n&&(m=this,--n);p>n;n++)if(null!=(b=arguments[n]))for(e in b)f=m[e],h=b[e],m!==h&&(r&&h&&(q.isPlainObject(h)||(l=q.isArray(h)))?(l?(l=!1,k=f&&q.isArray(f)?f:[]):k=f&&q.isPlainObject(f)?f:{},m[e]=q.extend(r,k,h)):h!==d&&(m[e]=h));return m};q.extend({expando:"jQuery"+("2.0.3"+Math.random()).replace(/\D/g,""),noConflict:function(d){return b.$===q&&(b.$=W),d&&b.jQuery===q&&(b.jQuery=ka),q},isReady:!1,readyWait:1,
holdReady:function(b){b?q.readyWait++:q.ready(!0)},ready:function(b){(!0===b?--q.readyWait:q.isReady)||(q.isReady=!0,!0!==b&&0<--q.readyWait||(Y.resolveWith(I,[q]),q.fn.trigger&&q(I).trigger("ready").off("ready")))},isFunction:function(b){return"function"===q.type(b)},isArray:Array.isArray,isWindow:function(b){return null!=b&&b===b.window},isNumeric:function(b){return!isNaN(parseFloat(b))&&isFinite(b)},type:function(b){return null==b?b+"":"object"==typeof b||"function"==typeof b?xa[vb.call(b)]||"object":
typeof b},isPlainObject:function(b){if("object"!==q.type(b)||b.nodeType||q.isWindow(b))return!1;try{if(b.constructor&&!Na.call(b.constructor.prototype,"isPrototypeOf"))return!1}catch(d){return!1}return!0},isEmptyObject:function(b){for(var d in b)return!1;return!0},error:function(b){throw Error(b);},parseHTML:function(b,d,e){if(!b||"string"!=typeof b)return null;"boolean"==typeof d&&(e=d,d=!1);d=d||I;var f=Xa.exec(b);e=!e&&[];return f?[d.createElement(f[1])]:(f=q.buildFragment([b],d,e),e&&q(e).remove(),
q.merge([],f.childNodes))},parseJSON:JSON.parse,parseXML:function(b){var e,f;if(!b||"string"!=typeof b)return null;try{f=new DOMParser,e=f.parseFromString(b,"text/xml")}catch(h){e=d}return(!e||e.getElementsByTagName("parsererror").length)&&q.error("Invalid XML: "+b),e},noop:function(){},globalEval:function(b){var d,e=eval;(b=q.trim(b))&&(1===b.indexOf("use strict")?(d=I.createElement("script"),d.text=b,I.head.appendChild(d).parentNode.removeChild(d)):e(b))},camelCase:function(b){return b.replace(yb,
"ms-").replace(zb,Ab)},nodeName:function(b,d){return b.nodeName&&b.nodeName.toLowerCase()===d.toLowerCase()},each:function(b,d,f){var h,l=0,k=b.length,m=e(b);if(f)if(m)for(;k>l&&!(h=d.apply(b[l],f),!1===h);l++);else for(l in b){if(h=d.apply(b[l],f),!1===h)break}else if(m)for(;k>l&&!(h=d.call(b[l],l,b[l]),!1===h);l++);else for(l in b)if(h=d.call(b[l],l,b[l]),!1===h)break;return b},trim:function(b){return null==b?"":wb.call(b)},makeArray:function(b,d){var f=d||[];return null!=b&&(e(Object(b))?q.merge(f,
"string"==typeof b?[b]:b):La.call(f,b)),f},inArray:function(b,d,e){return null==d?-1:Fa.call(d,b,e)},merge:function(b,e){var f=e.length,h=b.length,l=0;if("number"==typeof f)for(;f>l;l++)b[h++]=e[l];else for(;e[l]!==d;)b[h++]=e[l++];return b.length=h,b},grep:function(b,d,e){var f,h=[],l=0,k=b.length;for(e=!!e;k>l;l++)f=!!d(b[l],l),e!==f&&h.push(b[l]);return h},map:function(b,d,f){var h,l=0,k=b.length,m=[];if(e(b))for(;k>l;l++)h=d(b[l],l,f),null!=h&&(m[m.length]=h);else for(l in b)h=d(b[l],l,f),null!=
h&&(m[m.length]=h);return Wa.apply([],m)},guid:1,proxy:function(b,e){var f,h,l;return"string"==typeof e&&(f=b[e],e=b,b=f),q.isFunction(b)?(h=va.call(arguments,2),l=function(){return b.apply(e||this,h.concat(va.call(arguments)))},l.guid=b.guid=b.guid||q.guid++,l):d},access:function(b,e,f,h,l,k,m){var n=0,p=b.length,r=null==f;if("object"===q.type(f))for(n in l=!0,f)q.access(b,e,n,f[n],!0,k,m);else if(h!==d&&(l=!0,q.isFunction(h)||(m=!0),r&&(m?(e.call(b,h),e=null):(r=e,e=function(b,d,e){return r.call(q(b),
e)})),e))for(;p>n;n++)e(b[n],f,m?h:h.call(b[n],n,e(b[n],f)));return l?b:r?e.call(b):p?e(b[0],f):k},now:Date.now,swap:function(b,d,e,f){var h,l={};for(h in d)l[h]=b.style[h],b.style[h]=d[h];e=e.apply(b,f||[]);for(h in d)b.style[h]=l[h];return e}});q.ready.promise=function(d){return Y||(Y=q.Deferred(),"complete"===I.readyState?setTimeout(q.ready):(I.addEventListener("DOMContentLoaded",ya,!1),b.addEventListener("load",ya,!1))),Y.promise(d)};q.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),
function(b,d){xa["[object "+d+"]"]=d.toLowerCase()});J=q(I);(function(b,d){function e(b,d,f,h){var l,k,m,n,p;if((d?d.ownerDocument||d:W)!==G&&I(d),d=d||G,f=f||[],!b||"string"!=typeof b)return f;if(1!==(n=d.nodeType)&&9!==n)return[];if(O&&!h){if(l=Ia.exec(b))if(m=l[1])if(9===n){if(k=d.getElementById(m),!k||!k.parentNode)return f;if(k.id===m)return f.push(k),f}else{if(d.ownerDocument&&(k=d.ownerDocument.getElementById(m))&&Ma(d,k)&&k.id===m)return f.push(k),f}else{if(l[2])return za.apply(f,d.getElementsByTagName(b)),
f;if((m=l[3])&&B.getElementsByClassName&&d.getElementsByClassName)return za.apply(f,d.getElementsByClassName(m)),f}if(B.qsa&&(!Z||!Z.test(b))){if(k=l=da,m=d,p=9===n&&b,1===n&&"object"!==d.nodeName.toLowerCase()){n=t(b);(l=d.getAttribute("id"))?k=l.replace(La,"\\$&"):d.setAttribute("id",k);k="[id='"+k+"'] ";for(m=n.length;m--;)n[m]=k+u(n[m]);m=xa.test(b)&&d.parentNode||d;p=n.join(",")}if(p)try{return za.apply(f,m.querySelectorAll(p)),f}catch(H){}finally{l||d.removeAttribute("id")}}}var r;a:{b=b.replace(pa,
"$1");var q,X;k=t(b);if(!h&&1===k.length){if(r=k[0]=k[0].slice(0),2<r.length&&"ID"===(q=r[0]).type&&B.getById&&9===d.nodeType&&O&&E.relative[r[1].type]){if(d=(E.find.ID(q.matches[0].replace(Aa,Ba),d)||[])[0],!d){r=f;break a}b=b.slice(r.shift().value.length)}for(n=wa.needsContext.test(b)?0:r.length;n--&&!(q=r[n],E.relative[l=q.type]);)if((X=E.find[l])&&(h=X(q.matches[0].replace(Aa,Ba),xa.test(r[0].type)&&d.parentNode||d))){if(r.splice(n,1),b=h.length&&u(r),!b){r=(za.apply(f,h),f);break a}break}}r=
(M(b,k)(h,d,!O,f,xa.test(b)),f)}return r}function f(){function b(e,f){return d.push(e+=" ")>E.cacheLength&&delete b[d.shift()],b[e]=f}var d=[];return b}function h(b){return b[da]=!0,b}function l(b){var d=G.createElement("div");try{return!!b(d)}catch(e){return!1}finally{d.parentNode&&d.parentNode.removeChild(d)}}function k(b,d){for(var e=b.split("|"),f=b.length;f--;)E.attrHandle[e[f]]=d}function m(b,d){var e=d&&b,f=e&&1===b.nodeType&&1===d.nodeType&&(~d.sourceIndex||ja)-(~b.sourceIndex||ja);if(f)return f;
if(e)for(;e=e.nextSibling;)if(e===d)return-1;return b?1:-1}function n(b){return function(d){return"input"===d.nodeName.toLowerCase()&&d.type===b}}function p(b){return function(d){var e=d.nodeName.toLowerCase();return("input"===e||"button"===e)&&d.type===b}}function r(b){return h(function(d){return d=+d,h(function(e,f){for(var h,l=b([],e.length,d),k=l.length;k--;)e[h=l[k]]&&(e[h]=!(f[h]=e[h]))})})}function s(){}function t(b,d){var f,h,l,k,m,n,p;if(m=ba[b+" "])return d?0:m.slice(0);m=b;n=[];for(p=E.preFilter;m;){(!f||
(h=Da.exec(m)))&&(h&&(m=m.slice(h[0].length)||m),n.push(l=[]));f=!1;(h=Ea.exec(m))&&(f=h.shift(),l.push({value:f,type:h[0].replace(pa," ")}),m=m.slice(f.length));for(k in E.filter)!(h=wa[k].exec(m))||p[k]&&!(h=p[k](h))||(f=h.shift(),l.push({value:f,type:k,matches:h}),m=m.slice(f.length));if(!f)break}return d?m.length:m?e.error(b):ba(b,n).slice(0)}function u(b){for(var d=0,e=b.length,f="";e>d;d++)f+=b[d].value;return f}function w(b,d,e){var f=d.dir,h=e&&"parentNode"===f,l=Y++;return d.first?function(d,
e,l){for(;d=d[f];)if(1===d.nodeType||h)return b(d,e,l)}:function(d,e,k){var m,n,p,H=ca+" "+l;if(k)for(;d=d[f];){if((1===d.nodeType||h)&&b(d,e,k))return!0}else for(;d=d[f];)if(1===d.nodeType||h)if(p=d[da]||(d[da]={}),(n=p[f])&&n[0]===H){if(!0===(m=n[1])||m===A)return!0===m}else if(n=p[f]=[H],n[1]=b(d,e,k)||A,!0===n[1])return!0}}function y(b){return 1<b.length?function(d,e,f){for(var h=b.length;h--;)if(!b[h](d,e,f))return!1;return!0}:b[0]}function v(b,d,e,f,h){for(var l,k=[],m=0,n=b.length,p=null!=
d;n>m;m++)(l=b[m])&&(!e||e(l,f,h))&&(k.push(l),p&&d.push(m));return k}function x(b,d,f,l,k,m){return l&&!l[da]&&(l=x(l)),k&&!k[da]&&(k=x(k,m)),h(function(h,m,n,p){var H,r,q=[],X=[],s=m.length,ha;if(!(ha=h)){ha=d||"*";for(var t=n.nodeType?[n]:n,u=[],w=0,Oa=t.length;Oa>w;w++)e(ha,t[w],u);ha=u}ha=!b||!h&&d?ha:v(ha,q,b,n,p);t=f?k||(h?b:s||l)?[]:m:ha;if(f&&f(ha,t,n,p),l){H=v(t,X);l(H,[],n,p);for(n=H.length;n--;)(r=H[n])&&(t[X[n]]=!(ha[X[n]]=r))}if(h){if(k||b){if(k){H=[];for(n=t.length;n--;)(r=t[n])&&H.push(ha[n]=
r);k(null,t=[],H,p)}for(n=t.length;n--;)(r=t[n])&&-1<(H=k?Ca.call(h,r):q[n])&&(h[H]=!(m[H]=r))}}else t=v(t===m?t.splice(s,t.length):t),k?k(null,m,t,p):za.apply(m,t)})}function z(b){var d,e,f,h=b.length,l=E.relative[b[0].type];e=l||E.relative[" "];for(var k=l?1:0,m=w(function(b){return b===d},e,!0),n=w(function(b){return-1<Ca.call(d,b)},e,!0),p=[function(b,e,f){return!l&&(f||e!==T)||((d=e).nodeType?m(b,e,f):n(b,e,f))}];h>k;k++)if(e=E.relative[b[k].type])p=[w(y(p),e)];else{if(e=E.filter[b[k].type].apply(null,
b[k].matches),e[da]){for(f=++k;h>f&&!E.relative[b[f].type];f++);return x(1<k&&y(p),1<k&&u(b.slice(0,k-1).concat({value:" "===b[k-2].type?"*":""})).replace(pa,"$1"),e,f>k&&z(b.slice(k,f)),h>f&&z(b=b.slice(f)),h>f&&u(b))}p.push(e)}return y(p)}function F(b,d){var f=0,l=0<d.length,k=0<b.length,m=function(h,m,n,p,H){var r,q,X=[],s=0,t="0",ha=h&&[],u=null!=H,w=T,Oa=h||k&&E.find.TAG("*",H&&m.parentNode||m),y=ca+=null==w?1:Math.random()||0.1;for(u&&(T=m!==G&&m,A=f);null!=(H=Oa[t]);t++){if(k&&H){for(r=0;q=
b[r++];)if(q(H,m,n)){p.push(H);break}u&&(ca=y,A=++f)}l&&((H=!q&&H)&&s--,h&&ha.push(H))}if(s+=t,l&&t!==s){for(r=0;q=d[r++];)q(ha,X,m,n);if(h){if(0<s)for(;t--;)ha[t]||X[t]||(X[t]=ra.call(p));X=v(X)}za.apply(p,X);u&&!h&&0<X.length&&1<s+d.length&&e.uniqueSort(p)}return u&&(ca=y,T=w),ha};return l?h(m):m}var C,B,A,E,K,L,M,T,Q,I,G,J,O,Z,U,aa,Ma,da="sizzle"+-new Date,W=b.document,ca=0,Y=0,ia=f(),ba=f(),ea=f(),ga=!1,ka=function(b,d){return b===d?(ga=!0,0):0},oa=typeof d,ja=-2147483648,na={}.hasOwnProperty,
fa=[],ra=fa.pop,va=fa.push,za=fa.push,qa=fa.slice,Ca=fa.indexOf||function(b){for(var d=0,e=this.length;e>d;d++)if(this[d]===b)return d;return-1},sa="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+".replace("w","w#"),ua="\\[[\\x20\\t\\r\\n\\f]*((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)[\\x20\\t\\r\\n\\f]*(?:([*^$|!~]?=)[\\x20\\t\\r\\n\\f]*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+sa+")|)|)[\\x20\\t\\r\\n\\f]*\\]",ta=":((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+ua.replace(3,
8)+")*)|.*)\\)|)",pa=/^[\x20\t\r\n\f]+|((?:^|[^\\])(?:\\.)*)[\x20\t\r\n\f]+$/g,Da=/^[\x20\t\r\n\f]*,[\x20\t\r\n\f]*/,Ea=/^[\x20\t\r\n\f]*([>+~]|[\x20\t\r\n\f])[\x20\t\r\n\f]*/,xa=/[\x20\t\r\n\f]*[+~]/,Fa=/=[\x20\t\r\n\f]*([^\]'"]*)[\x20\t\r\n\f]*\]/g,Ga=RegExp(ta),Ha=RegExp("^"+sa+"$"),wa={ID:/^#((?:\\.|[\w-]|[^\x00-\xa0])+)/,CLASS:/^\.((?:\\.|[\w-]|[^\x00-\xa0])+)/,TAG:RegExp("^("+"(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+".replace("w","w*")+")"),ATTR:RegExp("^"+ua),PSEUDO:RegExp("^"+ta),CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\([\\x20\\t\\r\\n\\f]*(even|odd|(([+-]|)(\\d*)n|)[\\x20\\t\\r\\n\\f]*(?:([+-]|)[\\x20\\t\\r\\n\\f]*(\\d+)|))[\\x20\\t\\r\\n\\f]*\\)|)",
"i"),bool:RegExp("^(?:checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)$","i"),needsContext:RegExp("^[\\x20\\t\\r\\n\\f]*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\([\\x20\\t\\r\\n\\f]*((?:-\\d)?\\d*)[\\x20\\t\\r\\n\\f]*\\)|)(?=[^-]|$)","i")},ya=/^[^{]+\{\s*\[native \w/,Ia=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Ja=/^(?:input|select|textarea|button)$/i,Ka=/^h\d$/i,La=/'|\\/g,Aa=/\\([\da-f]{1,6}[\x20\t\r\n\f]?|([\x20\t\r\n\f])|.)/ig,
Ba=function(b,d,e){b="0x"+d-65536;return b!==b||e?d:0>b?String.fromCharCode(b+65536):String.fromCharCode(55296|b>>10,56320|1023&b)};try{za.apply(fa=qa.call(W.childNodes),W.childNodes),fa[W.childNodes.length].nodeType}catch(Na){za={apply:fa.length?function(b,d){va.apply(b,qa.call(d))}:function(b,d){for(var e=b.length,f=0;b[e++]=d[f++];);b.length=e-1}}}L=e.isXML=function(b){return(b=b&&(b.ownerDocument||b).documentElement)?"HTML"!==b.nodeName:!1};B=e.support={};I=e.setDocument=function(b){var e=b?b.ownerDocument||
b:W;b=e.defaultView;return e!==G&&9===e.nodeType&&e.documentElement?(G=e,J=e.documentElement,O=!L(e),b&&b.attachEvent&&b!==b.top&&b.attachEvent("onbeforeunload",function(){I()}),B.attributes=l(function(b){return b.className="i",!b.getAttribute("className")}),B.getElementsByTagName=l(function(b){return b.appendChild(e.createComment("")),!b.getElementsByTagName("*").length}),B.getElementsByClassName=l(function(b){return b.innerHTML="<div class='a'></div><div class='a i'></div>",b.firstChild.className=
"i",2===b.getElementsByClassName("i").length}),B.getById=l(function(b){return J.appendChild(b).id=da,!e.getElementsByName||!e.getElementsByName(da).length}),B.getById?(E.find.ID=function(b,d){if(typeof d.getElementById!==oa&&O){var e=d.getElementById(b);return e&&e.parentNode?[e]:[]}},E.filter.ID=function(b){var d=b.replace(Aa,Ba);return function(b){return b.getAttribute("id")===d}}):(delete E.find.ID,E.filter.ID=function(b){var d=b.replace(Aa,Ba);return function(b){return(b=typeof b.getAttributeNode!==
oa&&b.getAttributeNode("id"))&&b.value===d}}),E.find.TAG=B.getElementsByTagName?function(b,e){return typeof e.getElementsByTagName!==oa?e.getElementsByTagName(b):d}:function(b,d){var e,f=[],h=0,l=d.getElementsByTagName(b);if("*"===b){for(;e=l[h++];)1===e.nodeType&&f.push(e);return f}return l},E.find.CLASS=B.getElementsByClassName&&function(b,e){return typeof e.getElementsByClassName!==oa&&O?e.getElementsByClassName(b):d},U=[],Z=[],(B.qsa=ya.test(e.querySelectorAll))&&(l(function(b){b.innerHTML="<select><option selected=''></option></select>";
b.querySelectorAll("[selected]").length||Z.push("\\[[\\x20\\t\\r\\n\\f]*(?:value|checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)");b.querySelectorAll(":checked").length||Z.push(":checked")}),l(function(b){var d=e.createElement("input");d.setAttribute("type","hidden");b.appendChild(d).setAttribute("t","");b.querySelectorAll("[t^='']").length&&Z.push("[*^$]=[\\x20\\t\\r\\n\\f]*(?:''|\"\")");b.querySelectorAll(":enabled").length||
Z.push(":enabled",":disabled");b.querySelectorAll("*,:x");Z.push(",.*:")})),(B.matchesSelector=ya.test(aa=J.webkitMatchesSelector||J.mozMatchesSelector||J.oMatchesSelector||J.msMatchesSelector))&&l(function(b){B.disconnectedMatch=aa.call(b,"div");aa.call(b,"[s!='']:x");U.push("!=",ta)}),Z=Z.length&&RegExp(Z.join("|")),U=U.length&&RegExp(U.join("|")),Ma=ya.test(J.contains)||J.compareDocumentPosition?function(b,d){var e=9===b.nodeType?b.documentElement:b,f=d&&d.parentNode;return b===f||!(!f||1!==f.nodeType||
!(e.contains?e.contains(f):b.compareDocumentPosition&&16&b.compareDocumentPosition(f)))}:function(b,d){if(d)for(;d=d.parentNode;)if(d===b)return!0;return!1},ka=J.compareDocumentPosition?function(b,d){if(b===d)return ga=!0,0;var f=d.compareDocumentPosition&&b.compareDocumentPosition&&b.compareDocumentPosition(d);return f?1&f||!B.sortDetached&&d.compareDocumentPosition(b)===f?b===e||Ma(W,b)?-1:d===e||Ma(W,d)?1:Q?Ca.call(Q,b)-Ca.call(Q,d):0:4&f?-1:1:b.compareDocumentPosition?-1:1}:function(b,d){var f,
h=0;f=b.parentNode;var l=d.parentNode,k=[b],n=[d];if(b===d)return ga=!0,0;if(!f||!l)return b===e?-1:d===e?1:f?-1:l?1:Q?Ca.call(Q,b)-Ca.call(Q,d):0;if(f===l)return m(b,d);for(f=b;f=f.parentNode;)k.unshift(f);for(f=d;f=f.parentNode;)n.unshift(f);for(;k[h]===n[h];)h++;return h?m(k[h],n[h]):k[h]===W?-1:n[h]===W?1:0},e):G};e.matches=function(b,d){return e(b,null,null,d)};e.matchesSelector=function(b,d){if((b.ownerDocument||b)!==G&&I(b),d=d.replace(Fa,"='$1']"),!(!B.matchesSelector||!O||U&&U.test(d)||Z&&
Z.test(d)))try{var f=aa.call(b,d);if(f||B.disconnectedMatch||b.document&&11!==b.document.nodeType)return f}catch(h){}return 0<e(d,G,null,[b]).length};e.contains=function(b,d){return(b.ownerDocument||b)!==G&&I(b),Ma(b,d)};e.attr=function(b,e){(b.ownerDocument||b)!==G&&I(b);var f=E.attrHandle[e.toLowerCase()],f=f&&na.call(E.attrHandle,e.toLowerCase())?f(b,e,!O):d;return f===d?B.attributes||!O?b.getAttribute(e):(f=b.getAttributeNode(e))&&f.specified?f.value:null:f};e.error=function(b){throw Error("Syntax error, unrecognized expression: "+
b);};e.uniqueSort=function(b){var d,e=[],f=0,h=0;if(ga=!B.detectDuplicates,Q=!B.sortStable&&b.slice(0),b.sort(ka),ga){for(;d=b[h++];)d===b[h]&&(f=e.push(h));for(;f--;)b.splice(e[f],1)}return b};K=e.getText=function(b){var d,e="",f=0;if(d=b.nodeType)if(1===d||9===d||11===d){if("string"==typeof b.textContent)return b.textContent;for(b=b.firstChild;b;b=b.nextSibling)e+=K(b)}else{if(3===d||4===d)return b.nodeValue}else for(;d=b[f];f++)e+=K(d);return e};E=e.selectors={cacheLength:50,createPseudo:h,match:wa,
attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(b){return b[1]=b[1].replace(Aa,Ba),b[3]=(b[4]||b[5]||"").replace(Aa,Ba),"~="===b[2]&&(b[3]=" "+b[3]+" "),b.slice(0,4)},CHILD:function(b){return b[1]=b[1].toLowerCase(),"nth"===b[1].slice(0,3)?(b[3]||e.error(b[0]),b[4]=+(b[4]?b[5]+(b[6]||1):2*("even"===b[3]||"odd"===b[3])),b[5]=+(b[7]+b[8]||"odd"===b[3])):b[3]&&e.error(b[0]),
b},PSEUDO:function(b){var e,f=!b[5]&&b[2];return wa.CHILD.test(b[0])?null:(b[3]&&b[4]!==d?b[2]=b[4]:f&&Ga.test(f)&&(e=t(f,!0))&&(e=f.indexOf(")",f.length-e)-f.length)&&(b[0]=b[0].slice(0,e),b[2]=f.slice(0,e)),b.slice(0,3))}},filter:{TAG:function(b){var d=b.replace(Aa,Ba).toLowerCase();return"*"===b?function(){return!0}:function(b){return b.nodeName&&b.nodeName.toLowerCase()===d}},CLASS:function(b){var d=ia[b+" "];return d||(d=RegExp("(^|[\\x20\\t\\r\\n\\f])"+b+"([\\x20\\t\\r\\n\\f]|$)"))&&ia(b,function(b){return d.test("string"==
typeof b.className&&b.className||typeof b.getAttribute!==oa&&b.getAttribute("class")||"")})},ATTR:function(b,d,f){return function(h){h=e.attr(h,b);return null==h?"!="===d:d?(h+="","="===d?h===f:"!="===d?h!==f:"^="===d?f&&0===h.indexOf(f):"*="===d?f&&-1<h.indexOf(f):"$="===d?f&&h.slice(-f.length)===f:"~="===d?-1<(" "+h+" ").indexOf(f):"|="===d?h===f||h.slice(0,f.length+1)===f+"-":!1):!0}},CHILD:function(b,d,e,f,h){var l="nth"!==b.slice(0,3),k="last"!==b.slice(-4),m="of-type"===d;return 1===f&&0===
h?function(b){return!!b.parentNode}:function(d,e,n){var p,H,r,q,X;e=l!==k?"nextSibling":"previousSibling";var s=d.parentNode,la=m&&d.nodeName.toLowerCase();n=!n&&!m;if(s){if(l){for(;e;){for(H=d;H=H[e];)if(m?H.nodeName.toLowerCase()===la:1===H.nodeType)return!1;X=e="only"===b&&!X&&"nextSibling"}return!0}if(X=[k?s.firstChild:s.lastChild],k&&n){n=s[da]||(s[da]={});p=n[b]||[];q=p[0]===ca&&p[1];r=p[0]===ca&&p[2];for(H=q&&s.childNodes[q];H=++q&&H&&H[e]||(r=q=0)||X.pop();)if(1===H.nodeType&&++r&&H===d){n[b]=
[ca,q,r];break}}else if(n&&(p=(d[da]||(d[da]={}))[b])&&p[0]===ca)r=p[1];else for(;(H=++q&&H&&H[e]||(r=q=0)||X.pop())&&(!(m?H.nodeName.toLowerCase()===la:1===H.nodeType)||!++r||!(n&&((H[da]||(H[da]={}))[b]=[ca,r]),H===d)););return r-=h,r===f||0===r%f&&0<=r/f}}},PSEUDO:function(b,d){var f,l=E.pseudos[b]||E.setFilters[b.toLowerCase()]||e.error("unsupported pseudo: "+b);return l[da]?l(d):1<l.length?(f=[b,b,"",d],E.setFilters.hasOwnProperty(b.toLowerCase())?h(function(b,e){for(var f,h=l(b,d),k=h.length;k--;)f=
Ca.call(b,h[k]),b[f]=!(e[f]=h[k])}):function(b){return l(b,0,f)}):l}},pseudos:{not:h(function(b){var d=[],e=[],f=M(b.replace(pa,"$1"));return f[da]?h(function(b,d,e,h){var l;e=f(b,null,h,[]);for(h=b.length;h--;)(l=e[h])&&(b[h]=!(d[h]=l))}):function(b,h,l){return d[0]=b,f(d,null,l,e),!e.pop()}}),has:h(function(b){return function(d){return 0<e(b,d).length}}),contains:h(function(b){return function(d){return-1<(d.textContent||d.innerText||K(d)).indexOf(b)}}),lang:h(function(b){return Ha.test(b||"")||
e.error("unsupported lang: "+b),b=b.replace(Aa,Ba).toLowerCase(),function(d){var e;do if(e=O?d.lang:d.getAttribute("xml:lang")||d.getAttribute("lang"))return e=e.toLowerCase(),e===b||0===e.indexOf(b+"-");while((d=d.parentNode)&&1===d.nodeType);return!1}}),target:function(d){var e=b.location&&b.location.hash;return e&&e.slice(1)===d.id},root:function(b){return b===J},focus:function(b){return b===G.activeElement&&(!G.hasFocus||G.hasFocus())&&!(!b.type&&!b.href&&!~b.tabIndex)},enabled:function(b){return!1===
b.disabled},disabled:function(b){return!0===b.disabled},checked:function(b){var d=b.nodeName.toLowerCase();return"input"===d&&!!b.checked||"option"===d&&!!b.selected},selected:function(b){return b.parentNode&&b.parentNode.selectedIndex,!0===b.selected},empty:function(b){for(b=b.firstChild;b;b=b.nextSibling)if("@"<b.nodeName||3===b.nodeType||4===b.nodeType)return!1;return!0},parent:function(b){return!E.pseudos.empty(b)},header:function(b){return Ka.test(b.nodeName)},input:function(b){return Ja.test(b.nodeName)},
button:function(b){var d=b.nodeName.toLowerCase();return"input"===d&&"button"===b.type||"button"===d},text:function(b){var d;return"input"===b.nodeName.toLowerCase()&&"text"===b.type&&(null==(d=b.getAttribute("type"))||d.toLowerCase()===b.type)},first:r(function(){return[0]}),last:r(function(b,d){return[d-1]}),eq:r(function(b,d,e){return[0>e?e+d:e]}),even:r(function(b,d){for(var e=0;d>e;e+=2)b.push(e);return b}),odd:r(function(b,d){for(var e=1;d>e;e+=2)b.push(e);return b}),lt:r(function(b,d,e){for(d=
0>e?e+d:e;0<=--d;)b.push(d);return b}),gt:r(function(b,d,e){for(e=0>e?e+d:e;d>++e;)b.push(e);return b})}};E.pseudos.nth=E.pseudos.eq;for(C in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})E.pseudos[C]=n(C);for(C in{submit:!0,reset:!0})E.pseudos[C]=p(C);s.prototype=E.filters=E.pseudos;E.setFilters=new s;M=e.compile=function(b,d){var e,f=[],h=[],l=ea[b+" "];if(!l){d||(d=t(b));for(e=d.length;e--;)l=z(d[e]),l[da]?f.push(l):h.push(l);l=ea(b,F(h,f))}return l};B.sortStable=da.split("").sort(ka).join("")===
da;B.detectDuplicates=ga;I();B.sortDetached=l(function(b){return 1&b.compareDocumentPosition(G.createElement("div"))});l(function(b){return b.innerHTML="<a href='#'></a>","#"===b.firstChild.getAttribute("href")})||k("type|href|height|width",function(b,e,f){return f?d:b.getAttribute(e,"type"===e.toLowerCase()?1:2)});B.attributes&&l(function(b){return b.innerHTML="<input/>",b.firstChild.setAttribute("value",""),""===b.firstChild.getAttribute("value")})||k("value",function(b,e,f){return f||"input"!==
b.nodeName.toLowerCase()?d:b.defaultValue});l(function(b){return null==b.getAttribute("disabled")})||k("checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",function(b,e,f){var h;return f?d:(h=b.getAttributeNode(e))&&h.specified?h.value:!0===b[e]?e.toLowerCase():null});q.find=e;q.expr=e.selectors;q.expr[":"]=q.expr.pseudos;q.unique=e.uniqueSort;q.text=e.getText;q.isXMLDoc=e.isXML;q.contains=e.contains})(b);var Ta={};q.Callbacks=
function(b){b="string"==typeof b?Ta[b]||f(b):q.extend({},b);var e,h,l,k,m,n,p=[],r=!b.once&&[],s=function(d){e=b.memory&&d;h=!0;n=k||0;k=0;m=p.length;for(l=!0;p&&m>n;n++)if(!1===p[n].apply(d[0],d[1])&&b.stopOnFalse){e=!1;break}l=!1;p&&(r?r.length&&s(r.shift()):e?p=[]:t.disable())},t={add:function(){if(p){var d=p.length;(function Bb(d){q.each(d,function(d,e){var f=q.type(e);"function"===f?b.unique&&t.has(e)||p.push(e):e&&e.length&&"string"!==f&&Bb(e)})})(arguments);l?m=p.length:e&&(k=d,s(e))}return this},
remove:function(){return p&&q.each(arguments,function(b,d){for(var e;-1<(e=q.inArray(d,p,e));)p.splice(e,1),l&&(m>=e&&m--,n>=e&&n--)}),this},has:function(b){return b?-1<q.inArray(b,p):!(!p||!p.length)},empty:function(){return p=[],m=0,this},disable:function(){return p=r=e=d,this},disabled:function(){return!p},lock:function(){return r=d,e||t.disable(),this},locked:function(){return!r},fireWith:function(b,d){return!p||h&&!r||(d=d||[],d=[b,d.slice?d.slice():d],l?r.push(d):s(d)),this},fire:function(){return t.fireWith(this,
arguments),this},fired:function(){return!!h}};return t};q.extend({Deferred:function(b){var d=[["resolve","done",q.Callbacks("once memory"),"resolved"],["reject","fail",q.Callbacks("once memory"),"rejected"],["notify","progress",q.Callbacks("memory")]],e="pending",f={state:function(){return e},always:function(){return h.done(arguments).fail(arguments),this},then:function(){var b=arguments;return q.Deferred(function(e){q.each(d,function(d,l){var k=l[0],m=q.isFunction(b[d])&&b[d];h[l[1]](function(){var b=
m&&m.apply(this,arguments);b&&q.isFunction(b.promise)?b.promise().done(e.resolve).fail(e.reject).progress(e.notify):e[k+"With"](this===f?e.promise():this,m?[b]:arguments)})});b=null}).promise()},promise:function(b){return null!=b?q.extend(b,f):f}},h={};return f.pipe=f.then,q.each(d,function(b,l){var k=l[2],m=l[3];f[l[1]]=k.add;m&&k.add(function(){e=m},d[1^b][2].disable,d[2][2].lock);h[l[0]]=function(){return h[l[0]+"With"](this===h?f:this,arguments),this};h[l[0]+"With"]=k.fireWith}),f.promise(h),
b&&b.call(h,h),h},when:function(b){var d=0,e=va.call(arguments),f=e.length,h=1!==f||b&&q.isFunction(b.promise)?f:0,l=1===h?b:q.Deferred(),k=function(b,d,e){return function(f){d[b]=this;e[b]=1<arguments.length?va.call(arguments):f;e===m?l.notifyWith(d,e):--h||l.resolveWith(d,e)}},m,n,p;if(1<f){m=Array(f);n=Array(f);for(p=Array(f);f>d;d++)e[d]&&q.isFunction(e[d].promise)?e[d].promise().done(k(d,p,e)).fail(l.reject).progress(k(d,n,m)):--h}return h||l.resolveWith(p,e),l.promise()}});q.support=function(d){var e=
I.createElement("input"),f=I.createDocumentFragment(),h=I.createElement("div"),l=I.createElement("select"),k=l.appendChild(I.createElement("option"));return e.type?(e.type="checkbox",d.checkOn=""!==e.value,d.optSelected=k.selected,d.reliableMarginRight=!0,d.boxSizingReliable=!0,d.pixelPosition=!1,e.checked=!0,d.noCloneChecked=e.cloneNode(!0).checked,l.disabled=!0,d.optDisabled=!k.disabled,e=I.createElement("input"),e.value="t",e.type="radio",d.radioValue="t"===e.value,e.setAttribute("checked","t"),
e.setAttribute("name","t"),f.appendChild(e),d.checkClone=f.cloneNode(!0).cloneNode(!0).lastChild.checked,d.focusinBubbles="onfocusin"in b,h.style.backgroundClip="content-box",h.cloneNode(!0).style.backgroundClip="",d.clearCloneStyle="content-box"===h.style.backgroundClip,q(function(){var e,f,l=I.getElementsByTagName("body")[0];l&&(e=I.createElement("div"),e.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",l.appendChild(e).appendChild(h),h.innerHTML="",
h.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%",q.swap(l,null!=l.style.zoom?{zoom:1}:{},function(){d.boxSizing=4===h.offsetWidth}),b.getComputedStyle&&(d.pixelPosition="1%"!==(b.getComputedStyle(h,null)||{}).top,d.boxSizingReliable="4px"===(b.getComputedStyle(h,null)||{width:"4px"}).width,f=h.appendChild(I.createElement("div")),f.style.cssText=h.style.cssText="padding:0;margin:0;border:0;display:block;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box",
f.style.marginRight=f.style.width="0",h.style.width="1px",d.reliableMarginRight=!parseFloat((b.getComputedStyle(f,null)||{}).marginRight)),l.removeChild(e))}),d):d}({});var ba,G,qb=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,pb=/([A-Z])/g;h.uid=1;h.accepts=function(b){return b.nodeType?1===b.nodeType||9===b.nodeType:!0};h.prototype={key:function(b){if(!h.accepts(b))return 0;var d={},e=b[this.expando];if(!e){e=h.uid++;try{d[this.expando]={value:e},Object.defineProperties(b,d)}catch(f){d[this.expando]=e,q.extend(b,
d)}}return this.cache[e]||(this.cache[e]={}),e},set:function(b,d,e){var f;b=this.key(b);var h=this.cache[b];if("string"==typeof d)h[d]=e;else if(q.isEmptyObject(h))q.extend(this.cache[b],d);else for(f in d)h[f]=d[f];return h},get:function(b,e){var f=this.cache[this.key(b)];return e===d?f:f[e]},access:function(b,e,f){var h;return e===d||e&&"string"==typeof e&&f===d?(h=this.get(b,e),h!==d?h:this.get(b,q.camelCase(e))):(this.set(b,e,f),f!==d?f:e)},remove:function(b,e){var f,h,l=this.key(b),k=this.cache[l];
if(e===d)this.cache[l]={};else{q.isArray(e)?h=e.concat(e.map(q.camelCase)):(f=q.camelCase(e),e in k?h=[e,f]:(h=f,h=h in k?[h]:h.match(na)||[]));for(f=h.length;f--;)delete k[h[f]]}},hasData:function(b){return!q.isEmptyObject(this.cache[b[this.expando]]||{})},discard:function(b){b[this.expando]&&delete this.cache[b[this.expando]]}};ba=new h;G=new h;q.extend({acceptData:h.accepts,hasData:function(b){return ba.hasData(b)||G.hasData(b)},data:function(b,d,e){return ba.access(b,d,e)},removeData:function(b,
d){ba.remove(b,d)},_data:function(b,d,e){return G.access(b,d,e)},_removeData:function(b,d){G.remove(b,d)}});q.fn.extend({data:function(b,e){var f,h,l=this[0],m=0,n=null;if(b===d){if(this.length&&(n=ba.get(l),1===l.nodeType&&!G.get(l,"hasDataAttrs"))){for(f=l.attributes;f.length>m;m++)h=f[m].name,0===h.indexOf("data-")&&(h=q.camelCase(h.slice(5)),k(l,h,n[h]));G.set(l,"hasDataAttrs",!0)}return n}return"object"==typeof b?this.each(function(){ba.set(this,b)}):q.access(this,function(e){var f,h=q.camelCase(b);
if(l&&e===d){if((f=ba.get(l,b),f!==d)||(f=ba.get(l,h),f!==d)||(f=k(l,h,d),f!==d))return f}else this.each(function(){var f=ba.get(this,h);ba.set(this,h,e);-1!==b.indexOf("-")&&f!==d&&ba.set(this,b,e)})},null,e,1<arguments.length,null,!0)},removeData:function(b){return this.each(function(){ba.remove(this,b)})}});q.extend({queue:function(b,e,f){var h;return b?(e=(e||"fx")+"queue",h=G.get(b,e),f&&(!h||q.isArray(f)?h=G.access(b,e,q.makeArray(f)):h.push(f)),h||[]):d},dequeue:function(b,d){d=d||"fx";var e=
q.queue(b,d),f=e.length,h=e.shift(),l=q._queueHooks(b,d),k=function(){q.dequeue(b,d)};"inprogress"===h&&(h=e.shift(),f--);h&&("fx"===d&&e.unshift("inprogress"),delete l.stop,h.call(b,k,l));!f&&l&&l.empty.fire()},_queueHooks:function(b,d){var e=d+"queueHooks";return G.get(b,e)||G.access(b,e,{empty:q.Callbacks("once memory").add(function(){G.remove(b,[d+"queue",e])})})}});q.fn.extend({queue:function(b,e){var f=2;return"string"!=typeof b&&(e=b,b="fx",f--),f>arguments.length?q.queue(this[0],b):e===d?
this:this.each(function(){var d=q.queue(this,b,e);q._queueHooks(this,b);"fx"===b&&"inprogress"!==d[0]&&q.dequeue(this,b)})},dequeue:function(b){return this.each(function(){q.dequeue(this,b)})},delay:function(b,d){return b=q.fx?q.fx.speeds[b]||b:b,d=d||"fx",this.queue(d,function(d,e){var f=setTimeout(d,b);e.stop=function(){clearTimeout(f)}})},clearQueue:function(b){return this.queue(b||"fx",[])},promise:function(b,e){var f,h=1,l=q.Deferred(),k=this,m=this.length,n=function(){--h||l.resolveWith(k,[k])};
"string"!=typeof b&&(e=b,b=d);for(b=b||"fx";m--;)(f=G.get(k[m],b+"queueHooks"))&&f.empty&&(h++,f.empty.add(n));return n(),l.promise(e)}});var Ya,Pa=/[\t\r\n\f]/g,Cb=/\r/g,Db=/^(?:input|select|textarea|button)$/i;q.fn.extend({attr:function(b,d){return q.access(this,q.attr,b,d,1<arguments.length)},removeAttr:function(b){return this.each(function(){q.removeAttr(this,b)})},prop:function(b,d){return q.access(this,q.prop,b,d,1<arguments.length)},removeProp:function(b){return this.each(function(){delete this[q.propFix[b]||
b]})},addClass:function(b){var d,e,f,h,l,k=0,m=this.length;d="string"==typeof b&&b;if(q.isFunction(b))return this.each(function(d){q(this).addClass(b.call(this,d,this.className))});if(d)for(d=(b||"").match(na)||[];m>k;k++)if(e=this[k],f=1===e.nodeType&&(e.className?(" "+e.className+" ").replace(Pa," "):" ")){for(l=0;h=d[l++];)0>f.indexOf(" "+h+" ")&&(f+=h+" ");e.className=q.trim(f)}return this},removeClass:function(b){var d,e,f,h,l,k=0,m=this.length;d=0===arguments.length||"string"==typeof b&&b;if(q.isFunction(b))return this.each(function(d){q(this).removeClass(b.call(this,
d,this.className))});if(d)for(d=(b||"").match(na)||[];m>k;k++)if(e=this[k],f=1===e.nodeType&&(e.className?(" "+e.className+" ").replace(Pa," "):"")){for(l=0;h=d[l++];)for(;0<=f.indexOf(" "+h+" ");)f=f.replace(" "+h+" "," ");e.className=b?q.trim(f):""}return this},toggleClass:function(b,d){var e=typeof b;return"boolean"==typeof d&&"string"===e?d?this.addClass(b):this.removeClass(b):q.isFunction(b)?this.each(function(e){q(this).toggleClass(b.call(this,e,this.className,d),d)}):this.each(function(){if("string"===
e)for(var d,f=0,h=q(this),l=b.match(na)||[];d=l[f++];)h.hasClass(d)?h.removeClass(d):h.addClass(d);else(e===O||"boolean"===e)&&(this.className&&G.set(this,"__className__",this.className),this.className=this.className||!1===b?"":G.get(this,"__className__")||"")})},hasClass:function(b){b=" "+b+" ";for(var d=0,e=this.length;e>d;d++)if(1===this[d].nodeType&&0<=(" "+this[d].className+" ").replace(Pa," ").indexOf(b))return!0;return!1},val:function(b){var e,f,h,l=this[0];if(arguments.length)return h=q.isFunction(b),
this.each(function(f){var l;1===this.nodeType&&(l=h?b.call(this,f,q(this).val()):b,null==l?l="":"number"==typeof l?l+="":q.isArray(l)&&(l=q.map(l,function(b){return null==b?"":b+""})),e=q.valHooks[this.type]||q.valHooks[this.nodeName.toLowerCase()],e&&"set"in e&&e.set(this,l,"value")!==d||(this.value=l))});if(l)return e=q.valHooks[l.type]||q.valHooks[l.nodeName.toLowerCase()],e&&"get"in e&&(f=e.get(l,"value"))!==d?f:(f=l.value,"string"==typeof f?f.replace(Cb,""):null==f?"":f)}});q.extend({valHooks:{option:{get:function(b){var d=
b.attributes.value;return!d||d.specified?b.value:b.text}},select:{get:function(b){for(var d,e=b.options,f=b.selectedIndex,h="select-one"===b.type||0>f,l=h?null:[],k=h?f+1:e.length,m=0>f?k:h?f:0;k>m;m++)if(d=e[m],!(!d.selected&&m!==f||(q.support.optDisabled?d.disabled:null!==d.getAttribute("disabled"))||d.parentNode.disabled&&q.nodeName(d.parentNode,"optgroup"))){if(b=q(d).val(),h)return b;l.push(b)}return l},set:function(b,d){for(var e,f,h=b.options,l=q.makeArray(d),k=h.length;k--;)f=h[k],(f.selected=
0<=q.inArray(q(f).val(),l))&&(e=!0);return e||(b.selectedIndex=-1),l}}},attr:function(b,e,f){var h,l,k=b.nodeType;if(b&&3!==k&&8!==k&&2!==k)return typeof b.getAttribute===O?q.prop(b,e,f):(1===k&&q.isXMLDoc(b)||(e=e.toLowerCase(),h=q.attrHooks[e]||(q.expr.match.bool.test(e)?Ya:void 0)),f===d?h&&"get"in h&&null!==(l=h.get(b,e))?l:(l=q.find.attr(b,e),null==l?d:l):null!==f?h&&"set"in h&&(l=h.set(b,f,e))!==d?l:(b.setAttribute(e,f+""),f):(q.removeAttr(b,e),d))},removeAttr:function(b,d){var e,f,h=0,l=d&&
d.match(na);if(l&&1===b.nodeType)for(;e=l[h++];)f=q.propFix[e]||e,q.expr.match.bool.test(e)&&(b[f]=!1),b.removeAttribute(e)},attrHooks:{type:{set:function(b,d){if(!q.support.radioValue&&"radio"===d&&q.nodeName(b,"input")){var e=b.value;return b.setAttribute("type",d),e&&(b.value=e),d}}}},propFix:{"for":"htmlFor","class":"className"},prop:function(b,e,f){var h,l,k,m=b.nodeType;if(b&&3!==m&&8!==m&&2!==m)return k=1!==m||!q.isXMLDoc(b),k&&(e=q.propFix[e]||e,l=q.propHooks[e]),f!==d?l&&"set"in l&&(h=l.set(b,
f,e))!==d?h:b[e]=f:l&&"get"in l&&null!==(h=l.get(b,e))?h:b[e]},propHooks:{tabIndex:{get:function(b){return b.hasAttribute("tabindex")||Db.test(b.nodeName)||b.href?b.tabIndex:-1}}}});Ya={set:function(b,d,e){return!1===d?q.removeAttr(b,e):b.setAttribute(e,e),e}};q.each(q.expr.match.bool.source.match(/\w+/g),function(b,e){var f=q.expr.attrHandle[e]||q.find.attr;q.expr.attrHandle[e]=function(b,e,h){var l=q.expr.attrHandle[e];b=h?d:(q.expr.attrHandle[e]=d)!=f(b,e,h)?e.toLowerCase():null;return q.expr.attrHandle[e]=
l,b}});q.support.optSelected||(q.propHooks.selected={get:function(b){b=b.parentNode;return b&&b.parentNode&&b.parentNode.selectedIndex,null}});q.each("tabIndex readOnly maxLength cellSpacing cellPadding rowSpan colSpan useMap frameBorder contentEditable".split(" "),function(){q.propFix[this.toLowerCase()]=this});q.each(["radio","checkbox"],function(){q.valHooks[this]={set:function(b,e){return q.isArray(e)?b.checked=0<=q.inArray(q(b).val(),e):d}};q.support.checkOn||(q.valHooks[this].get=function(b){return null===
b.getAttribute("value")?"on":b.value})});var Eb=/^key/,Fb=/^(?:mouse|contextmenu)|click/,Za=/^(?:focusinfocus|focusoutblur)$/,$a=/^([^.]*)(?:\.(.+)|)$/;q.event={global:{},add:function(b,e,f,h,l){var k,m,n,p,r,s,t,u,w,y;if(r=G.get(b)){f.handler&&(k=f,f=k.handler,l=k.selector);f.guid||(f.guid=q.guid++);(p=r.events)||(p=r.events={});(m=r.handle)||(m=r.handle=function(b){return typeof q===O||b&&q.event.triggered===b.type?d:q.event.dispatch.apply(m.elem,arguments)},m.elem=b);e=(e||"").match(na)||[""];
for(r=e.length;r--;)n=$a.exec(e[r])||[],w=y=n[1],n=(n[2]||"").split(".").sort(),w&&(t=q.event.special[w]||{},w=(l?t.delegateType:t.bindType)||w,t=q.event.special[w]||{},s=q.extend({type:w,origType:y,data:h,handler:f,guid:f.guid,selector:l,needsContext:l&&q.expr.match.needsContext.test(l),namespace:n.join(".")},k),(u=p[w])||(u=p[w]=[],u.delegateCount=0,t.setup&&!1!==t.setup.call(b,h,n,m)||b.addEventListener&&b.addEventListener(w,m,!1)),t.add&&(t.add.call(b,s),s.handler.guid||(s.handler.guid=f.guid)),
l?u.splice(u.delegateCount++,0,s):u.push(s),q.event.global[w]=!0);b=null}},remove:function(b,d,e,f,h){var l,k,m,n,p,r,s,t,u,w,y,v=G.hasData(b)&&G.get(b);if(v&&(n=v.events)){d=(d||"").match(na)||[""];for(p=d.length;p--;)if(m=$a.exec(d[p])||[],u=y=m[1],w=(m[2]||"").split(".").sort(),u){s=q.event.special[u]||{};u=(f?s.delegateType:s.bindType)||u;t=n[u]||[];m=m[2]&&RegExp("(^|\\.)"+w.join("\\.(?:.*\\.|)")+"(\\.|$)");for(k=l=t.length;l--;)r=t[l],!h&&y!==r.origType||e&&e.guid!==r.guid||m&&!m.test(r.namespace)||
f&&f!==r.selector&&("**"!==f||!r.selector)||(t.splice(l,1),r.selector&&t.delegateCount--,s.remove&&s.remove.call(b,r));k&&!t.length&&(s.teardown&&!1!==s.teardown.call(b,w,v.handle)||q.removeEvent(b,u,v.handle),delete n[u])}else for(u in n)q.event.remove(b,u+d[p],e,f,!0);q.isEmptyObject(n)&&(delete v.handle,G.remove(b,"events"))}},trigger:function(e,f,h,l){var k,m,n,p,r,s,t,u=[h||I],w=Na.call(e,"type")?e.type:e;k=Na.call(e,"namespace")?e.namespace.split("."):[];if(m=n=h=h||I,3!==h.nodeType&&8!==h.nodeType&&
!Za.test(w+q.event.triggered)&&(0<=w.indexOf(".")&&(k=w.split("."),w=k.shift(),k.sort()),r=0>w.indexOf(":")&&"on"+w,e=e[q.expando]?e:new q.Event(w,"object"==typeof e&&e),e.isTrigger=l?2:3,e.namespace=k.join("."),e.namespace_re=e.namespace?RegExp("(^|\\.)"+k.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=d,e.target||(e.target=h),f=null==f?[e]:q.makeArray(f,[e]),t=q.event.special[w]||{},l||!t.trigger||!1!==t.trigger.apply(h,f))){if(!l&&!t.noBubble&&!q.isWindow(h)){p=t.delegateType||w;for(Za.test(p+
w)||(m=m.parentNode);m;m=m.parentNode)u.push(m),n=m;n===(h.ownerDocument||I)&&u.push(n.defaultView||n.parentWindow||b)}for(k=0;(m=u[k++])&&!e.isPropagationStopped();)e.type=1<k?p:t.bindType||w,(s=(G.get(m,"events")||{})[e.type]&&G.get(m,"handle"))&&s.apply(m,f),(s=r&&m[r])&&q.acceptData(m)&&s.apply&&!1===s.apply(m,f)&&e.preventDefault();return e.type=w,l||e.isDefaultPrevented()||t._default&&!1!==t._default.apply(u.pop(),f)||!q.acceptData(h)||r&&q.isFunction(h[w])&&!q.isWindow(h)&&(n=h[r],n&&(h[r]=
null),q.event.triggered=w,h[w](),q.event.triggered=d,n&&(h[r]=n)),e.result}},dispatch:function(b){b=q.event.fix(b);var e,f,h,l,k,m=[],n=va.call(arguments);e=(G.get(this,"events")||{})[b.type]||[];var p=q.event.special[b.type]||{};if(n[0]=b,b.delegateTarget=this,!p.preDispatch||!1!==p.preDispatch.call(this,b)){m=q.event.handlers.call(this,b,e);for(e=0;(l=m[e++])&&!b.isPropagationStopped();){b.currentTarget=l.elem;for(f=0;(k=l.handlers[f++])&&!b.isImmediatePropagationStopped();)(!b.namespace_re||b.namespace_re.test(k.namespace))&&
(b.handleObj=k,b.data=k.data,h=((q.event.special[k.origType]||{}).handle||k.handler).apply(l.elem,n),h!==d&&!1===(b.result=h)&&(b.preventDefault(),b.stopPropagation()))}return p.postDispatch&&p.postDispatch.call(this,b),b.result}},handlers:function(b,e){var f,h,l,k,m=[],n=e.delegateCount,p=b.target;if(n&&p.nodeType&&(!b.button||"click"!==b.type))for(;p!==this;p=p.parentNode||this)if(!0!==p.disabled||"click"!==b.type){h=[];for(f=0;n>f;f++)k=e[f],l=k.selector+" ",h[l]===d&&(h[l]=k.needsContext?0<=q(l,
this).index(p):q.find(l,this,null,[p]).length),h[l]&&h.push(k);h.length&&m.push({elem:p,handlers:h})}return e.length>n&&m.push({elem:this,handlers:e.slice(n)}),m},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:["char","charCode","key","keyCode"],filter:function(b,d){return null==b.which&&(b.which=null!=d.charCode?d.charCode:d.keyCode),b}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),
filter:function(b,e){var f,h,l,k=e.button;return null==b.pageX&&null!=e.clientX&&(f=b.target.ownerDocument||I,h=f.documentElement,l=f.body,b.pageX=e.clientX+(h&&h.scrollLeft||l&&l.scrollLeft||0)-(h&&h.clientLeft||l&&l.clientLeft||0),b.pageY=e.clientY+(h&&h.scrollTop||l&&l.scrollTop||0)-(h&&h.clientTop||l&&l.clientTop||0)),b.which||k===d||(b.which=1&k?1:2&k?3:4&k?2:0),b}},fix:function(b){if(b[q.expando])return b;var d,e,f;d=b.type;var h=b,l=this.fixHooks[d];l||(this.fixHooks[d]=l=Fb.test(d)?this.mouseHooks:
Eb.test(d)?this.keyHooks:{});f=l.props?this.props.concat(l.props):this.props;b=new q.Event(h);for(d=f.length;d--;)e=f[d],b[e]=h[e];return b.target||(b.target=I),3===b.target.nodeType&&(b.target=b.target.parentNode),l.filter?l.filter(b,h):b},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==n()&&this.focus?(this.focus(),!1):d},delegateType:"focusin"},blur:{trigger:function(){return this===n()&&this.blur?(this.blur(),!1):d},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===
this.type&&this.click&&q.nodeName(this,"input")?(this.click(),!1):d},_default:function(b){return q.nodeName(b.target,"a")}},beforeunload:{postDispatch:function(b){b.result!==d&&(b.originalEvent.returnValue=b.result)}}},simulate:function(b,d,e,f){b=q.extend(new q.Event,e,{type:b,isSimulated:!0,originalEvent:{}});f?q.event.trigger(b,null,d):q.event.dispatch.call(d,b);b.isDefaultPrevented()&&e.preventDefault()}};q.removeEvent=function(b,d,e){b.removeEventListener&&b.removeEventListener(d,e,!1)};q.Event=
function(b,e){return this instanceof q.Event?(b&&b.type?(this.originalEvent=b,this.type=b.type,this.isDefaultPrevented=b.defaultPrevented||b.getPreventDefault&&b.getPreventDefault()?l:m):this.type=b,e&&q.extend(this,e),this.timeStamp=b&&b.timeStamp||q.now(),this[q.expando]=!0,d):new q.Event(b,e)};q.Event.prototype={isDefaultPrevented:m,isPropagationStopped:m,isImmediatePropagationStopped:m,preventDefault:function(){var b=this.originalEvent;this.isDefaultPrevented=l;b&&b.preventDefault&&b.preventDefault()},
stopPropagation:function(){var b=this.originalEvent;this.isPropagationStopped=l;b&&b.stopPropagation&&b.stopPropagation()},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=l;this.stopPropagation()}};q.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(b,d){q.event.special[b]={delegateType:d,bindType:d,handle:function(b){var e,f=b.relatedTarget,h=b.handleObj;return(!f||f!==this&&!q.contains(this,f))&&(b.type=h.origType,e=h.handler.apply(this,arguments),b.type=d),e}}});
q.support.focusinBubbles||q.each({focus:"focusin",blur:"focusout"},function(b,d){var e=0,f=function(b){q.event.simulate(d,b.target,q.event.fix(b),!0)};q.event.special[d]={setup:function(){0===e++&&I.addEventListener(b,f,!0)},teardown:function(){0===--e&&I.removeEventListener(b,f,!0)}}});q.fn.extend({on:function(b,e,f,h,l){var k,n;if("object"==typeof b){"string"!=typeof e&&(f=f||e,e=d);for(n in b)this.on(n,e,f,b[n],l);return this}if(null==f&&null==h?(h=e,f=e=d):null==h&&("string"==typeof e?(h=f,f=
d):(h=f,f=e,e=d)),!1===h)h=m;else if(!h)return this;return 1===l&&(k=h,h=function(b){return q().off(b),k.apply(this,arguments)},h.guid=k.guid||(k.guid=q.guid++)),this.each(function(){q.event.add(this,b,h,f,e)})},one:function(b,d,e,f){return this.on(b,d,e,f,1)},off:function(b,e,f){var h,l;if(b&&b.preventDefault&&b.handleObj)return h=b.handleObj,q(b.delegateTarget).off(h.namespace?h.origType+"."+h.namespace:h.origType,h.selector,h.handler),this;if("object"==typeof b){for(l in b)this.off(l,e,b[l]);return this}return(!1===
e||"function"==typeof e)&&(f=e,e=d),!1===f&&(f=m),this.each(function(){q.event.remove(this,b,f,e)})},trigger:function(b,d){return this.each(function(){q.event.trigger(b,d,this)})},triggerHandler:function(b,e){var f=this[0];return f?q.event.trigger(b,e,f,!0):d}});var rb=/^.[^:#\[\.,]*$/,Gb=/^(?:parents|prev(?:Until|All))/,ab=q.expr.match.needsContext,Hb={children:!0,contents:!0,next:!0,prev:!0};q.fn.extend({find:function(b){var d,e=[],f=this,h=f.length;if("string"!=typeof b)return this.pushStack(q(b).filter(function(){for(d=
0;h>d;d++)if(q.contains(f[d],this))return!0}));for(d=0;h>d;d++)q.find(b,f[d],e);return e=this.pushStack(1<h?q.unique(e):e),e.selector=this.selector?this.selector+" "+b:b,e},has:function(b){var d=q(b,this),e=d.length;return this.filter(function(){for(var b=0;e>b;b++)if(q.contains(this,d[b]))return!0})},not:function(b){return this.pushStack(r(this,b||[],!0))},filter:function(b){return this.pushStack(r(this,b||[],!1))},is:function(b){return!!r(this,"string"==typeof b&&ab.test(b)?q(b):b||[],!1).length},
closest:function(b,d){for(var e,f=0,h=this.length,l=[],k=ab.test(b)||"string"!=typeof b?q(b,d||this.context):0;h>f;f++)for(e=this[f];e&&e!==d;e=e.parentNode)if(11>e.nodeType&&(k?-1<k.index(e):1===e.nodeType&&q.find.matchesSelector(e,b))){l.push(e);break}return this.pushStack(1<l.length?q.unique(l):l)},index:function(b){return b?"string"==typeof b?Fa.call(q(b),this[0]):Fa.call(this,b.jquery?b[0]:b):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(b,d){var e="string"==typeof b?
q(b,d):q.makeArray(b&&b.nodeType?[b]:b),e=q.merge(this.get(),e);return this.pushStack(q.unique(e))},addBack:function(b){return this.add(null==b?this.prevObject:this.prevObject.filter(b))}});q.each({parent:function(b){return(b=b.parentNode)&&11!==b.nodeType?b:null},parents:function(b){return q.dir(b,"parentNode")},parentsUntil:function(b,d,e){return q.dir(b,"parentNode",e)},next:function(b){return p(b,"nextSibling")},prev:function(b){return p(b,"previousSibling")},nextAll:function(b){return q.dir(b,
"nextSibling")},prevAll:function(b){return q.dir(b,"previousSibling")},nextUntil:function(b,d,e){return q.dir(b,"nextSibling",e)},prevUntil:function(b,d,e){return q.dir(b,"previousSibling",e)},siblings:function(b){return q.sibling((b.parentNode||{}).firstChild,b)},children:function(b){return q.sibling(b.firstChild)},contents:function(b){return b.contentDocument||q.merge([],b.childNodes)}},function(b,d){q.fn[b]=function(e,f){var h=q.map(this,d,e);return"Until"!==b.slice(-5)&&(f=e),f&&"string"==typeof f&&
(h=q.filter(f,h)),1<this.length&&(Hb[b]||q.unique(h),Gb.test(b)&&h.reverse()),this.pushStack(h)}});q.extend({filter:function(b,d,e){var f=d[0];return e&&(b=":not("+b+")"),1===d.length&&1===f.nodeType?q.find.matchesSelector(f,b)?[f]:[]:q.find.matches(b,q.grep(d,function(b){return 1===b.nodeType}))},dir:function(b,e,f){for(var h=[],l=f!==d;(b=b[e])&&9!==b.nodeType;)if(1===b.nodeType){if(l&&q(b).is(f))break;h.push(b)}return h},sibling:function(b,d){for(var e=[];b;b=b.nextSibling)1===b.nodeType&&b!==
d&&e.push(b);return e}});var bb=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,cb=/<([\w:]+)/,Ib=/<|&#?\w+;/,Jb=/<(?:script|style|link)/i,db=/^(?:checkbox|radio)$/i,Kb=/checked\s*(?:[^=]|=\s*.checked.)/i,eb=/^$|\/(?:java|ecma)script/i,sb=/^true\/(.*)/,Lb=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,ja={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],
td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};ja.optgroup=ja.option;ja.tbody=ja.tfoot=ja.colgroup=ja.caption=ja.thead;ja.th=ja.td;q.fn.extend({text:function(b){return q.access(this,function(b){return b===d?q.text(this):this.empty().append((this[0]&&this[0].ownerDocument||I).createTextNode(b))},null,b,arguments.length)},append:function(){return this.domManip(arguments,function(b){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&s(this,b).appendChild(b)})},prepend:function(){return this.domManip(arguments,
function(b){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var d=s(this,b);d.insertBefore(b,d.firstChild)}})},before:function(){return this.domManip(arguments,function(b){this.parentNode&&this.parentNode.insertBefore(b,this)})},after:function(){return this.domManip(arguments,function(b){this.parentNode&&this.parentNode.insertBefore(b,this.nextSibling)})},remove:function(b,d){for(var e,f=b?q.filter(b,this):this,h=0;null!=(e=f[h]);h++)d||1!==e.nodeType||q.cleanData(y(e)),e.parentNode&&
(d&&q.contains(e.ownerDocument,e)&&w(y(e,"script")),e.parentNode.removeChild(e));return this},empty:function(){for(var b,d=0;null!=(b=this[d]);d++)1===b.nodeType&&(q.cleanData(y(b,!1)),b.textContent="");return this},clone:function(b,d){return b=null==b?!1:b,d=null==d?b:d,this.map(function(){return q.clone(this,b,d)})},html:function(b){return q.access(this,function(b){var e=this[0]||{},f=0,h=this.length;if(b===d&&1===e.nodeType)return e.innerHTML;if("string"==typeof b&&!Jb.test(b)&&!ja[(cb.exec(b)||
["",""])[1].toLowerCase()]){b=b.replace(bb,"<$1></$2>");try{for(;h>f;f++)e=this[f]||{},1===e.nodeType&&(q.cleanData(y(e,!1)),e.innerHTML=b);e=0}catch(l){}}e&&this.empty().append(b)},null,b,arguments.length)},replaceWith:function(){var b=q.map(this,function(b){return[b.nextSibling,b.parentNode]}),d=0;return this.domManip(arguments,function(e){var f=b[d++],h=b[d++];h&&(f&&f.parentNode!==h&&(f=this.nextSibling),q(this).remove(),h.insertBefore(e,f))},!0),d?this:this.remove()},detach:function(b){return this.remove(b,
!0)},domManip:function(b,d,e){b=Wa.apply([],b);var f,h,l,k,m=0,n=this.length,p=this,r=n-1,s=b[0],w=q.isFunction(s);if(w||!(1>=n||"string"!=typeof s||q.support.checkClone)&&Kb.test(s))return this.each(function(f){var h=p.eq(f);w&&(b[0]=s.call(this,f,h.html()));h.domManip(b,d,e)});if(n&&(f=q.buildFragment(b,this[0].ownerDocument,!1,!e&&this),h=f.firstChild,1===f.childNodes.length&&(f=h),h)){h=q.map(y(f,"script"),t);for(l=h.length;n>m;m++)k=f,m!==r&&(k=q.clone(k,!0,!0),l&&q.merge(h,y(k,"script"))),d.call(this[m],
k,m);if(l){f=h[h.length-1].ownerDocument;q.map(h,u);for(m=0;l>m;m++)k=h[m],eb.test(k.type||"")&&!G.access(k,"globalEval")&&q.contains(f,k)&&(k.src?q._evalUrl(k.src):q.globalEval(k.textContent.replace(Lb,"")))}}return this}});q.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(b,d){q.fn[b]=function(b){for(var e=[],f=q(b),h=f.length-1,l=0;h>=l;l++)b=l===h?this:this.clone(!0),q(f[l])[d](b),La.apply(e,b.get());return this.pushStack(e)}});
q.extend({clone:function(b,d,e){var f,h,l,k,m=b.cloneNode(!0),n=q.contains(b.ownerDocument,b);if(!q.support.noCloneChecked&&!(1!==b.nodeType&&11!==b.nodeType||q.isXMLDoc(b))){k=y(m);l=y(b);f=0;for(h=l.length;h>f;f++){var p=l[f],r=k[f],s=r.nodeName.toLowerCase();"input"===s&&db.test(p.type)?r.checked=p.checked:("input"===s||"textarea"===s)&&(r.defaultValue=p.defaultValue)}}if(d)if(e){l=l||y(b);k=k||y(m);f=0;for(h=l.length;h>f;f++)x(l[f],k[f])}else x(b,m);return k=y(m,"script"),0<k.length&&w(k,!n&&
y(b,"script")),m},buildFragment:function(b,d,e,f){for(var h,l,k,m,n=0,p=b.length,r=d.createDocumentFragment(),s=[];p>n;n++)if(h=b[n],h||0===h)if("object"===q.type(h))q.merge(s,h.nodeType?[h]:h);else if(Ib.test(h)){l=l||r.appendChild(d.createElement("div"));k=(cb.exec(h)||["",""])[1].toLowerCase();k=ja[k]||ja._default;l.innerHTML=k[1]+h.replace(bb,"<$1></$2>")+k[2];for(k=k[0];k--;)l=l.lastChild;q.merge(s,l.childNodes);l=r.firstChild;l.textContent=""}else s.push(d.createTextNode(h));r.textContent="";
for(n=0;h=s[n++];)if((!f||-1===q.inArray(h,f))&&(m=q.contains(h.ownerDocument,h),l=y(r.appendChild(h),"script"),m&&w(l),e))for(k=0;h=l[k++];)eb.test(h.type||"")&&e.push(h);return r},cleanData:function(b){for(var e,f,l,k,m,n,p=q.event.special,r=0;(f=b[r])!==d;r++){if(h.accepts(f)&&(m=f[G.expando],m&&(e=G.cache[m]))){if(l=Object.keys(e.events||{}),l.length)for(n=0;(k=l[n])!==d;n++)p[k]?q.event.remove(f,k):q.removeEvent(f,k,e.handle);G.cache[m]&&delete G.cache[m]}delete ba.cache[f[ba.expando]]}},_evalUrl:function(b){return q.ajax({url:b,
type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})}});q.fn.extend({wrapAll:function(b){var d;return q.isFunction(b)?this.each(function(d){q(this).wrapAll(b.call(this,d))}):(this[0]&&(d=q(b,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&d.insertBefore(this[0]),d.map(function(){for(var b=this;b.firstElementChild;)b=b.firstElementChild;return b}).append(this)),this)},wrapInner:function(b){return q.isFunction(b)?this.each(function(d){q(this).wrapInner(b.call(this,d))}):this.each(function(){var d=
q(this),e=d.contents();e.length?e.wrapAll(b):d.append(b)})},wrap:function(b){var d=q.isFunction(b);return this.each(function(e){q(this).wrapAll(d?b.call(this,e):b)})},unwrap:function(){return this.parent().each(function(){q.nodeName(this,"body")||q(this).replaceWith(this.childNodes)}).end()}});var sa,ta,Mb=/^(none|table(?!-c[ea]).+)/,fb=/^margin/,tb=RegExp("^("+wa+")(.*)$","i"),Ja=RegExp("^("+wa+")(?!px)[a-z%]+$","i"),Nb=RegExp("^([+-])=("+wa+")","i"),Va={BODY:"block"},Ob={position:"absolute",visibility:"hidden",
display:"block"},gb={letterSpacing:0,fontWeight:400},ra=["Top","Right","Bottom","Left"],Ua=["Webkit","O","Moz","ms"];q.fn.extend({css:function(e,f){return q.access(this,function(e,f,h){var l,k={},m=0;if(q.isArray(f)){h=b.getComputedStyle(e,null);for(l=f.length;l>m;m++)k[f[m]]=q.css(e,f[m],!1,h);return k}return h!==d?q.style(e,f,h):q.css(e,f)},e,f,1<arguments.length)},show:function(){return C(this,!0)},hide:function(){return C(this)},toggle:function(b){return"boolean"==typeof b?b?this.show():this.hide():
this.each(function(){F(this)?q(this).show():q(this).hide()})}});q.extend({cssHooks:{opacity:{get:function(b,d){if(d){var e=sa(b,"opacity");return""===e?"1":e}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(b,e,f,h){if(b&&3!==b.nodeType&&8!==b.nodeType&&b.style){var l,k,m,n=q.camelCase(e),p=b.style;return e=q.cssProps[n]||(q.cssProps[n]=z(p,n)),m=q.cssHooks[e]||q.cssHooks[n],
f===d?m&&"get"in m&&(l=m.get(b,!1,h))!==d?l:p[e]:(k=typeof f,"string"===k&&(l=Nb.exec(f))&&(f=(l[1]+1)*l[2]+parseFloat(q.css(b,e)),k="number"),null==f||"number"===k&&isNaN(f)||("number"!==k||q.cssNumber[n]||(f+="px"),q.support.clearCloneStyle||""!==f||0!==e.indexOf("background")||(p[e]="inherit"),m&&"set"in m&&(f=m.set(b,f,h))===d||(p[e]=f)),d)}},css:function(b,e,f,h){var l,k,m,n=q.camelCase(e);return e=q.cssProps[n]||(q.cssProps[n]=z(b.style,n)),m=q.cssHooks[e]||q.cssHooks[n],m&&"get"in m&&(l=m.get(b,
!0,f)),l===d&&(l=sa(b,e,h)),"normal"===l&&e in gb&&(l=gb[e]),""===f||f?(k=parseFloat(l),!0===f||q.isNumeric(k)?k||0:l):l}});sa=function(e,f,h){var l,k,m,n=(h=h||b.getComputedStyle(e,null))?h.getPropertyValue(f)||h[f]:d,p=e.style;return h&&(""!==n||q.contains(e.ownerDocument,e)||(n=q.style(e,f)),Ja.test(n)&&fb.test(f)&&(l=p.width,k=p.minWidth,m=p.maxWidth,p.minWidth=p.maxWidth=p.width=n,n=h.width,p.width=l,p.minWidth=k,p.maxWidth=m)),n};q.each(["height","width"],function(e,f){q.cssHooks[f]={get:function(b,
e,h){return e?0===b.offsetWidth&&Mb.test(q.css(b,"display"))?q.swap(b,Ob,function(){return B(b,f,h)}):B(b,f,h):d},set:function(d,e,h){var l=h&&b.getComputedStyle(d,null);return A(d,e,h?v(d,f,h,q.support.boxSizing&&"border-box"===q.css(d,"boxSizing",!1,l),l):0)}}});q(function(){q.support.reliableMarginRight||(q.cssHooks.marginRight={get:function(b,e){return e?q.swap(b,{display:"inline-block"},sa,[b,"marginRight"]):d}});!q.support.pixelPosition&&q.fn.position&&q.each(["top","left"],function(b,e){q.cssHooks[e]=
{get:function(b,f){return f?(f=sa(b,e),Ja.test(f)?q(b).position()[e]+"px":f):d}}})});q.expr&&q.expr.filters&&(q.expr.filters.hidden=function(b){return 0>=b.offsetWidth&&0>=b.offsetHeight},q.expr.filters.visible=function(b){return!q.expr.filters.hidden(b)});q.each({margin:"",padding:"",border:"Width"},function(b,d){q.cssHooks[b+d]={expand:function(e){var f=0,h={};for(e="string"==typeof e?e.split(" "):[e];4>f;f++)h[b+ra[f]+d]=e[f]||e[f-2]||e[0];return h}};fb.test(b)||(q.cssHooks[b+d].set=A)});var Pb=
/%20/g,ub=/\[\]$/,hb=/\r?\n/g,Qb=/^(?:submit|button|image|reset|file)$/i,Rb=/^(?:input|select|textarea|keygen)/i;q.fn.extend({serialize:function(){return q.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var b=q.prop(this,"elements");return b?q.makeArray(b):this}).filter(function(){var b=this.type;return this.name&&!q(this).is(":disabled")&&Rb.test(this.nodeName)&&!Qb.test(b)&&(this.checked||!db.test(b))}).map(function(b,d){var e=q(this).val();return null==e?null:
q.isArray(e)?q.map(e,function(b){return{name:d.name,value:b.replace(hb,"\r\n")}}):{name:d.name,value:e.replace(hb,"\r\n")}}).get()}});q.param=function(b,e){var f,h=[],l=function(b,d){d=q.isFunction(d)?d():null==d?"":d;h[h.length]=encodeURIComponent(b)+"="+encodeURIComponent(d)};if(e===d&&(e=q.ajaxSettings&&q.ajaxSettings.traditional),q.isArray(b)||b.jquery&&!q.isPlainObject(b))q.each(b,function(){l(this.name,this.value)});else for(f in b)Q(f,b[f],e,l);return h.join("&").replace(Pb,"+")};q.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),
function(b,d){q.fn[d]=function(b,e){return 0<arguments.length?this.on(d,null,b,e):this.trigger(d)}});q.fn.extend({hover:function(b,d){return this.mouseenter(b).mouseleave(d||b)},bind:function(b,d,e){return this.on(b,null,d,e)},unbind:function(b,d){return this.off(b,null,d)},delegate:function(b,d,e,f){return this.on(d,b,e,f)},undelegate:function(b,d,e){return 1===arguments.length?this.off(b,"**"):this.off(d,b||"**",e)}});var qa,fa,Qa=q.now(),Ra=/\?/,Sb=/#.*$/,ib=/([?&])_=[^&]*/,Tb=/^(.*?):[ \t]*([^\r\n]*)$/gm,
Ub=/^(?:GET|HEAD)$/,Vb=/^\/\//,jb=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,kb=q.fn.load,lb={},Ka={},mb="*/".concat("*");try{fa=oa.href}catch($b){fa=I.createElement("a"),fa.href="",fa=fa.href}qa=jb.exec(fa.toLowerCase())||[];q.fn.load=function(b,e,f){if("string"!=typeof b&&kb)return kb.apply(this,arguments);var h,l,k,m=this,n=b.indexOf(" ");return 0<=n&&(h=b.slice(n),b=b.slice(0,n)),q.isFunction(e)?(f=e,e=d):e&&"object"==typeof e&&(l="POST"),0<m.length&&q.ajax({url:b,type:l,dataType:"html",data:e}).done(function(b){k=
arguments;m.html(h?q("<div>").append(q.parseHTML(b)).find(h):b)}).complete(f&&function(b,d){m.each(f,k||[b.responseText,d,b])}),this};q.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(b,d){q.fn[d]=function(b){return this.on(d,b)}});q.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:fa,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(qa[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",
accepts:{"*":mb,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":q.parseJSON,"text xml":q.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(b,d){return d?K(K(b,q.ajaxSettings),d):K(q.ajaxSettings,b)},ajaxPrefilter:M(lb),ajaxTransport:M(Ka),ajax:function(b,
e){function f(b,e,m,p){var s,H,z,F,B=e;if(2!==C){C=2;n&&clearTimeout(n);h=d;k=p||"";A.readyState=0<b?4:0;p=200<=b&&300>b||304===b;if(m){z=t;for(var X=A,E,la,K,L,M=z.contents,Q=z.dataTypes;"*"===Q[0];)Q.shift(),E===d&&(E=z.mimeType||X.getResponseHeader("Content-Type"));if(E)for(la in M)if(M[la]&&M[la].test(E)){Q.unshift(la);break}if(Q[0]in m)K=Q[0];else{for(la in m){if(!Q[0]||z.converters[la+" "+Q[0]]){K=la;break}L||(L=la)}K=K||L}z=K?(K!==Q[0]&&Q.unshift(K),m[K]):d}var T;a:{m=t;E=z;la=A;K=p;var ma,
G,I;z={};X=m.dataTypes.slice();if(X[1])for(ma in m.converters)z[ma.toLowerCase()]=m.converters[ma];for(L=X.shift();L;)if(m.responseFields[L]&&(la[m.responseFields[L]]=E),!I&&K&&m.dataFilter&&(E=m.dataFilter(E,m.dataType)),I=L,L=X.shift())if("*"===L)L=I;else if("*"!==I&&I!==L){if(ma=z[I+" "+L]||z["* "+L],!ma)for(T in z)if(G=T.split(" "),G[1]===L&&(ma=z[I+" "+G[0]]||z["* "+G[0]])){!0===ma?ma=z[T]:!0!==z[T]&&(L=G[0],X.unshift(G[1]));break}if(!0!==ma)if(ma&&m["throws"])E=ma(E);else try{E=ma(E)}catch(J){T=
{state:"parsererror",error:ma?J:"No conversion from "+I+" to "+L};break a}}T={state:"success",data:E}}z=T;p?(t.ifModified&&(F=A.getResponseHeader("Last-Modified"),F&&(q.lastModified[l]=F),F=A.getResponseHeader("etag"),F&&(q.etag[l]=F)),204===b||"HEAD"===t.type?B="nocontent":304===b?B="notmodified":(B=z.state,s=z.data,H=z.error,p=!H)):(H=B,(b||!B)&&(B="error",0>b&&(b=0)));A.status=b;A.statusText=(e||B)+"";p?y.resolveWith(u,[s,B,A]):y.rejectWith(u,[A,B,H]);A.statusCode(x);x=d;r&&w.trigger(p?"ajaxSuccess":
"ajaxError",[A,t,p?s:H]);v.fireWith(u,[A,B]);r&&(w.trigger("ajaxComplete",[A,t]),--q.active||q.event.trigger("ajaxStop"))}}"object"==typeof b&&(e=b,b=d);e=e||{};var h,l,k,m,n,p,r,s,t=q.ajaxSetup({},e),u=t.context||t,w=t.context&&(u.nodeType||u.jquery)?q(u):q.event,y=q.Deferred(),v=q.Callbacks("once memory"),x=t.statusCode||{},z={},F={},C=0,B="canceled",A={readyState:0,getResponseHeader:function(b){var d;if(2===C){if(!m)for(m={};d=Tb.exec(k);)m[d[1].toLowerCase()]=d[2];d=m[b.toLowerCase()]}return null==
d?null:d},getAllResponseHeaders:function(){return 2===C?k:null},setRequestHeader:function(b,d){var e=b.toLowerCase();return C||(b=F[e]=F[e]||b,z[b]=d),this},overrideMimeType:function(b){return C||(t.mimeType=b),this},statusCode:function(b){var d;if(b)if(2>C)for(d in b)x[d]=[x[d],b[d]];else A.always(b[A.status]);return this},abort:function(b){b=b||B;return h&&h.abort(b),f(0,b),this}};if(y.promise(A).complete=v.add,A.success=A.done,A.error=A.fail,t.url=((b||t.url||fa)+"").replace(Sb,"").replace(Vb,
qa[1]+"//"),t.type=e.method||e.type||t.method||t.type,t.dataTypes=q.trim(t.dataType||"*").toLowerCase().match(na)||[""],null==t.crossDomain&&(p=jb.exec(t.url.toLowerCase()),t.crossDomain=!(!p||p[1]===qa[1]&&p[2]===qa[2]&&(p[3]||("http:"===p[1]?"80":"443"))===(qa[3]||("http:"===qa[1]?"80":"443")))),t.data&&t.processData&&"string"!=typeof t.data&&(t.data=q.param(t.data,t.traditional)),L(lb,t,e,A),2===C)return A;(r=t.global)&&0===q.active++&&q.event.trigger("ajaxStart");t.type=t.type.toUpperCase();t.hasContent=
!Ub.test(t.type);l=t.url;t.hasContent||(t.data&&(l=t.url+=(Ra.test(l)?"&":"?")+t.data,delete t.data),!1===t.cache&&(t.url=ib.test(l)?l.replace(ib,"$1_="+Qa++):l+(Ra.test(l)?"&":"?")+"_="+Qa++));t.ifModified&&(q.lastModified[l]&&A.setRequestHeader("If-Modified-Since",q.lastModified[l]),q.etag[l]&&A.setRequestHeader("If-None-Match",q.etag[l]));(t.data&&t.hasContent&&!1!==t.contentType||e.contentType)&&A.setRequestHeader("Content-Type",t.contentType);A.setRequestHeader("Accept",t.dataTypes[0]&&t.accepts[t.dataTypes[0]]?
t.accepts[t.dataTypes[0]]+("*"!==t.dataTypes[0]?", "+mb+"; q=0.01":""):t.accepts["*"]);for(s in t.headers)A.setRequestHeader(s,t.headers[s]);if(t.beforeSend&&(!1===t.beforeSend.call(u,A,t)||2===C))return A.abort();B="abort";for(s in{success:1,error:1,complete:1})A[s](t[s]);if(h=L(Ka,t,e,A)){A.readyState=1;r&&w.trigger("ajaxSend",[A,t]);t.async&&0<t.timeout&&(n=setTimeout(function(){A.abort("timeout")},t.timeout));try{C=1,h.send(z,f)}catch(E){if(!(2>C))throw E;f(-1,E)}}else f(-1,"No Transport");return A},
getJSON:function(b,d,e){return q.get(b,d,e,"json")},getScript:function(b,e){return q.get(b,d,e,"script")}});q.each(["get","post"],function(b,e){q[e]=function(b,f,h,l){return q.isFunction(f)&&(l=l||h,h=f,f=d),q.ajax({url:b,type:e,dataType:l,data:f,success:h})}});q.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(b){return q.globalEval(b),b}}});q.ajaxPrefilter("script",
function(b){b.cache===d&&(b.cache=!1);b.crossDomain&&(b.type="GET")});q.ajaxTransport("script",function(b){if(b.crossDomain){var d,e;return{send:function(f,h){d=q("<script>").prop({async:!0,charset:b.scriptCharset,src:b.url}).on("load error",e=function(b){d.remove();e=null;b&&h("error"===b.type?404:200,b.type)});I.head.appendChild(d[0])},abort:function(){e&&e()}}}});var nb=[],Sa=/(=)\?(?=&|$)|\?\?/;q.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var b=nb.pop()||q.expando+"_"+Qa++;return this[b]=
!0,b}});q.ajaxPrefilter("json jsonp",function(e,f,h){var l,k,m,n=!1!==e.jsonp&&(Sa.test(e.url)?"url":"string"==typeof e.data&&!(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&Sa.test(e.data)&&"data");return n||"jsonp"===e.dataTypes[0]?(l=e.jsonpCallback=q.isFunction(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,n?e[n]=e[n].replace(Sa,"$1"+l):!1!==e.jsonp&&(e.url+=(Ra.test(e.url)?"&":"?")+e.jsonp+"="+l),e.converters["script json"]=function(){return m||q.error(l+" was not called"),
m[0]},e.dataTypes[0]="json",k=b[l],b[l]=function(){m=arguments},h.always(function(){b[l]=k;e[l]&&(e.jsonpCallback=f.jsonpCallback,nb.push(l));m&&q.isFunction(k)&&k(m[0]);m=k=d}),"script"):d});q.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(b){}};var Da=q.ajaxSettings.xhr(),Wb={0:200,1223:204},Xb=0,Ea={};b.ActiveXObject&&q(b).on("unload",function(){for(var b in Ea)Ea[b]();Ea=d});q.support.cors=!!Da&&"withCredentials"in Da;q.support.ajax=Da=!!Da;q.ajaxTransport(function(b){var e;return q.support.cors||
Da&&!b.crossDomain?{send:function(f,h){var l,k,m=b.xhr();if(m.open(b.type,b.url,b.async,b.username,b.password),b.xhrFields)for(l in b.xhrFields)m[l]=b.xhrFields[l];b.mimeType&&m.overrideMimeType&&m.overrideMimeType(b.mimeType);b.crossDomain||f["X-Requested-With"]||(f["X-Requested-With"]="XMLHttpRequest");for(l in f)m.setRequestHeader(l,f[l]);e=function(b){return function(){e&&(delete Ea[k],e=m.onload=m.onerror=null,"abort"===b?m.abort():"error"===b?h(m.status||404,m.statusText):h(Wb[m.status]||m.status,
m.statusText,"string"==typeof m.responseText?{text:m.responseText}:d,m.getAllResponseHeaders()))}};m.onload=e();m.onerror=e("error");e=Ea[k=Xb++]=e("abort");m.send(b.hasContent&&b.data||null)},abort:function(){e&&e()}}:d});var ua,Ia,Yb=/^(?:toggle|show|hide)$/,ob=RegExp("^(?:([+-])=|)("+wa+")([a-z%]*)$","i"),Zb=/queueHooks$/,Ga=[function(b,e,f){var h,l,k,m,n,p=this,r={},s=b.style,t=b.nodeType&&F(b),u=G.get(b,"fxshow");f.queue||(m=q._queueHooks(b,"fx"),null==m.unqueued&&(m.unqueued=0,n=m.empty.fire,
m.empty.fire=function(){m.unqueued||n()}),m.unqueued++,p.always(function(){p.always(function(){m.unqueued--;q.queue(b,"fx").length||m.empty.fire()})}));1===b.nodeType&&("height"in e||"width"in e)&&(f.overflow=[s.overflow,s.overflowX,s.overflowY],"inline"===q.css(b,"display")&&"none"===q.css(b,"float")&&(s.display="inline-block"));f.overflow&&(s.overflow="hidden",p.always(function(){s.overflow=f.overflow[0];s.overflowX=f.overflow[1];s.overflowY=f.overflow[2]}));for(h in e)if(l=e[h],Yb.exec(l)){if(delete e[h],
k=k||"toggle"===l,l===(t?"hide":"show")){if("show"!==l||!u||u[h]===d)continue;t=!0}r[h]=u&&u[h]||q.style(b,h)}if(!q.isEmptyObject(r))for(h in u?"hidden"in u&&(t=u.hidden):u=G.access(b,"fxshow",{}),k&&(u.hidden=!t),t?q(b).show():p.done(function(){q(b).hide()}),p.done(function(){var d;G.remove(b,"fxshow");for(d in r)q.style(b,d,r[d])}),r)e=ca(t?u[h]:0,h,p),h in u||(u[h]=e.start,t&&(e.end=e.start,e.start="width"===h||"height"===h?1:0))}],pa={"*":[function(b,d){var e=this.createTween(b,d),f=e.cur(),h=
ob.exec(d),l=h&&h[3]||(q.cssNumber[b]?"":"px"),k=(q.cssNumber[b]||"px"!==l&&+f)&&ob.exec(q.css(e.elem,b)),m=1,n=20;if(k&&k[3]!==l){l=l||k[3];h=h||[];k=+f||1;do m=m||".5",k/=m,q.style(e.elem,b,k+l);while(m!==(m=e.cur()/f)&&1!==m&&--n)}return h&&(k=e.start=+k||+f||0,e.unit=l,e.end=h[1]?k+(h[1]+1)*h[2]:+h[2]),e}]};q.Animation=q.extend(ia,{tweener:function(b,d){q.isFunction(b)?(d=b,b=["*"]):b=b.split(" ");for(var e,f=0,h=b.length;h>f;f++)e=b[f],pa[e]=pa[e]||[],pa[e].unshift(d)},prefilter:function(b,d){d?
Ga.unshift(b):Ga.push(b)}});q.Tween=U;U.prototype={constructor:U,init:function(b,d,e,f,h,l){this.elem=b;this.prop=e;this.easing=h||"swing";this.options=d;this.start=this.now=this.cur();this.end=f;this.unit=l||(q.cssNumber[e]?"":"px")},cur:function(){var b=U.propHooks[this.prop];return b&&b.get?b.get(this):U.propHooks._default.get(this)},run:function(b){var d,e=U.propHooks[this.prop];return this.pos=d=this.options.duration?q.easing[this.easing](b,this.options.duration*b,0,1,this.options.duration):
b,this.now=(this.end-this.start)*d+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),e&&e.set?e.set(this):U.propHooks._default.set(this),this}};U.prototype.init.prototype=U.prototype;U.propHooks={_default:{get:function(b){var d;return null==b.elem[b.prop]||b.elem.style&&null!=b.elem.style[b.prop]?(d=q.css(b.elem,b.prop,""),d&&"auto"!==d?d:0):b.elem[b.prop]},set:function(b){q.fx.step[b.prop]?q.fx.step[b.prop](b):b.elem.style&&(null!=b.elem.style[q.cssProps[b.prop]]||q.cssHooks[b.prop])?
q.style(b.elem,b.prop,b.now+b.unit):b.elem[b.prop]=b.now}}};U.propHooks.scrollTop=U.propHooks.scrollLeft={set:function(b){b.elem.nodeType&&b.elem.parentNode&&(b.elem[b.prop]=b.now)}};q.each(["toggle","show","hide"],function(b,d){var e=q.fn[d];q.fn[d]=function(b,f,h){return null==b||"boolean"==typeof b?e.apply(this,arguments):this.animate(ea(d,!0),b,f,h)}});q.fn.extend({fadeTo:function(b,d,e,f){return this.filter(F).css("opacity",0).show().end().animate({opacity:d},b,e,f)},animate:function(b,d,e,f){var h=
q.isEmptyObject(b),l=q.speed(d,e,f);d=function(){var d=ia(this,q.extend({},b),l);(h||G.get(this,"finish"))&&d.stop(!0)};return d.finish=d,h||!1===l.queue?this.each(d):this.queue(l.queue,d)},stop:function(b,e,f){var h=function(b){var d=b.stop;delete b.stop;d(f)};return"string"!=typeof b&&(f=e,e=b,b=d),e&&!1!==b&&this.queue(b||"fx",[]),this.each(function(){var d=!0,e=null!=b&&b+"queueHooks",l=q.timers,k=G.get(this);if(e)k[e]&&k[e].stop&&h(k[e]);else for(e in k)k[e]&&k[e].stop&&Zb.test(e)&&h(k[e]);for(e=
l.length;e--;)l[e].elem!==this||null!=b&&l[e].queue!==b||(l[e].anim.stop(f),d=!1,l.splice(e,1));(d||!f)&&q.dequeue(this,b)})},finish:function(b){return!1!==b&&(b=b||"fx"),this.each(function(){var d,e=G.get(this),f=e[b+"queue"];d=e[b+"queueHooks"];var h=q.timers,l=f?f.length:0;e.finish=!0;q.queue(this,b,[]);d&&d.stop&&d.stop.call(this,!0);for(d=h.length;d--;)h[d].elem===this&&h[d].queue===b&&(h[d].anim.stop(!0),h.splice(d,1));for(d=0;l>d;d++)f[d]&&f[d].finish&&f[d].finish.call(this);delete e.finish})}});
q.each({slideDown:ea("show"),slideUp:ea("hide"),slideToggle:ea("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(b,d){q.fn[b]=function(b,e,f){return this.animate(d,b,e,f)}});q.speed=function(b,d,e){var f=b&&"object"==typeof b?q.extend({},b):{complete:e||!e&&d||q.isFunction(b)&&b,duration:b,easing:e&&d||d&&!q.isFunction(d)&&d};return f.duration=q.fx.off?0:"number"==typeof f.duration?f.duration:f.duration in q.fx.speeds?q.fx.speeds[f.duration]:q.fx.speeds._default,
(null==f.queue||!0===f.queue)&&(f.queue="fx"),f.old=f.complete,f.complete=function(){q.isFunction(f.old)&&f.old.call(this);f.queue&&q.dequeue(this,f.queue)},f};q.easing={linear:function(b){return b},swing:function(b){return 0.5-Math.cos(b*Math.PI)/2}};q.timers=[];q.fx=U.prototype.init;q.fx.tick=function(){var b,e=q.timers,f=0;for(ua=q.now();e.length>f;f++)b=e[f],b()||e[f]!==b||e.splice(f--,1);e.length||q.fx.stop();ua=d};q.fx.timer=function(b){b()&&q.timers.push(b)&&q.fx.start()};q.fx.interval=13;
q.fx.start=function(){Ia||(Ia=setInterval(q.fx.tick,q.fx.interval))};q.fx.stop=function(){clearInterval(Ia);Ia=null};q.fx.speeds={slow:600,fast:200,_default:400};q.fx.step={};q.expr&&q.expr.filters&&(q.expr.filters.animated=function(b){return q.grep(q.timers,function(d){return b===d.elem}).length});q.fn.offset=function(b){if(arguments.length)return b===d?this:this.each(function(d){q.offset.setOffset(this,b,d)});var e,f,h=this[0],l={top:0,left:0},k=h&&h.ownerDocument;if(k)return e=k.documentElement,
q.contains(e,h)?(typeof h.getBoundingClientRect!==O&&(l=h.getBoundingClientRect()),f=q.isWindow(k)?k:9===k.nodeType&&k.defaultView,{top:l.top+f.pageYOffset-e.clientTop,left:l.left+f.pageXOffset-e.clientLeft}):l};q.offset={setOffset:function(b,d,e){var f,h,l,k,m,n,p=q.css(b,"position"),r=q(b),s={};"static"===p&&(b.style.position="relative");m=r.offset();l=q.css(b,"top");n=q.css(b,"left");("absolute"===p||"fixed"===p)&&-1<(l+n).indexOf("auto")?(f=r.position(),k=f.top,h=f.left):(k=parseFloat(l)||0,h=
parseFloat(n)||0);q.isFunction(d)&&(d=d.call(b,e,m));null!=d.top&&(s.top=d.top-m.top+k);null!=d.left&&(s.left=d.left-m.left+h);"using"in d?d.using.call(b,s):r.css(s)}};q.fn.extend({position:function(){if(this[0]){var b,d,e=this[0],f={top:0,left:0};return"fixed"===q.css(e,"position")?d=e.getBoundingClientRect():(b=this.offsetParent(),d=this.offset(),q.nodeName(b[0],"html")||(f=b.offset()),f.top+=q.css(b[0],"borderTopWidth",!0),f.left+=q.css(b[0],"borderLeftWidth",!0)),{top:d.top-f.top-q.css(e,"marginTop",
!0),left:d.left-f.left-q.css(e,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var b=this.offsetParent||ga;b&&!q.nodeName(b,"html")&&"static"===q.css(b,"position");)b=b.offsetParent;return b||ga})}});q.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,f){var h="pageYOffset"===f;q.fn[e]=function(l){return q.access(this,function(e,l,k){var m=q.isWindow(e)?e:9===e.nodeType&&e.defaultView;return k===d?m?m[f]:e[l]:(m?m.scrollTo(h?b.pageXOffset:k,h?k:b.pageYOffset):
e[l]=k,d)},e,l,arguments.length,null)}});q.each({Height:"height",Width:"width"},function(b,e){q.each({padding:"inner"+b,content:e,"":"outer"+b},function(f,h){q.fn[h]=function(h,l){var k=arguments.length&&(f||"boolean"!=typeof h),m=f||(!0===h||!0===l?"margin":"border");return q.access(this,function(e,f,h){var l;return q.isWindow(e)?e.document.documentElement["client"+b]:9===e.nodeType?(l=e.documentElement,Math.max(e.body["scroll"+b],l["scroll"+b],e.body["offset"+b],l["offset"+b],l["client"+b])):h===
d?q.css(e,f,m):q.style(e,f,h,m)},e,k?h:d,k,null)}})});q.fn.size=function(){return this.length};q.fn.andSelf=q.fn.addBack;"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=q:"function"==typeof define&&define.amd&&define("jquery",[],function(){return q});"object"==typeof b&&"object"==typeof b.document&&(b.jQuery=b.$=q)})(window);(function(b,d){function e(d,e){var h,k,r,s=d.nodeName.toLowerCase();return"area"===s?(h=d.parentNode,k=h.name,d.href&&k&&"map"===h.nodeName.toLowerCase()?(r=b("img[usemap=#"+k+"]")[0],!!r&&f(r)):!1):(/input|select|textarea|button|object/.test(s)?!d.disabled:"a"===s?d.href||e:e)&&f(d)}function f(d){return b.expr.filters.visible(d)&&!b(d).parents().addBack().filter(function(){return"hidden"===b.css(this,"visibility")}).length}var h=0,k=/^ui-id-\d+$/;b.ui=b.ui||{};b.extend(b.ui,{version:"1.10.3",keyCode:{BACKSPACE:8,
COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}});b.fn.extend({focus:function(d){return function(e,f){return"number"==typeof e?this.each(function(){var d=this;setTimeout(function(){b(d).focus();f&&f.call(d)},e)}):d.apply(this,arguments)}}(b.fn.focus),scrollParent:function(){var d;return d=b.ui.ie&&/(static|relative)/.test(this.css("position"))||
/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(b.css(this,"position"))&&/(auto|scroll)/.test(b.css(this,"overflow")+b.css(this,"overflow-y")+b.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(b.css(this,"overflow")+b.css(this,"overflow-y")+b.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!d.length?b(document):d},zIndex:function(e){if(e!==d)return this.css("zIndex",e);if(this.length){var f,
h;for(e=b(this[0]);e.length&&e[0]!==document;){if(f=e.css("position"),("absolute"===f||"relative"===f||"fixed"===f)&&(h=parseInt(e.css("zIndex"),10),!isNaN(h)&&0!==h))return h;e=e.parent()}}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++h)})},removeUniqueId:function(){return this.each(function(){k.test(this.id)&&b(this).removeAttr("id")})}});b.extend(b.expr[":"],{data:b.expr.createPseudo?b.expr.createPseudo(function(d){return function(e){return!!b.data(e,d)}}):
function(d,e,f){return!!b.data(d,f[3])},focusable:function(d){return e(d,!isNaN(b.attr(d,"tabindex")))},tabbable:function(d){var f=b.attr(d,"tabindex"),h=isNaN(f);return(h||0<=f)&&e(d,!h)}});b("<a>").outerWidth(1).jquery||b.each(["Width","Height"],function(e,f){function h(d,e,f,l){return b.each(k,function(){e-=parseFloat(b.css(d,"padding"+this))||0;f&&(e-=parseFloat(b.css(d,"border"+this+"Width"))||0);l&&(e-=parseFloat(b.css(d,"margin"+this))||0)}),e}var k="Width"===f?["Left","Right"]:["Top","Bottom"],
r=f.toLowerCase(),s={innerWidth:b.fn.innerWidth,innerHeight:b.fn.innerHeight,outerWidth:b.fn.outerWidth,outerHeight:b.fn.outerHeight};b.fn["inner"+f]=function(e){return e===d?s["inner"+f].call(this):this.each(function(){b(this).css(r,h(this,e)+"px")})};b.fn["outer"+f]=function(d,e){return"number"!=typeof d?s["outer"+f].call(this,d):this.each(function(){b(this).css(r,h(this,d,!0,e)+"px")})}});b.fn.addBack||(b.fn.addBack=function(b){return this.add(null==b?this.prevObject:this.prevObject.filter(b))});
b("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(b.fn.removeData=function(d){return function(e){return arguments.length?d.call(this,b.camelCase(e)):d.call(this)}}(b.fn.removeData));b.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase());b.support.selectstart="onselectstart"in document.createElement("div");b.fn.extend({disableSelection:function(){return this.bind((b.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(b){b.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}});
b.extend(b.ui,{plugin:{add:function(d,e,f){var h;d=b.ui[d].prototype;for(h in f)d.plugins[h]=d.plugins[h]||[],d.plugins[h].push([e,f[h]])},call:function(b,d,e){var f=b.plugins[d];if(f&&b.element[0].parentNode&&11!==b.element[0].parentNode.nodeType)for(d=0;f.length>d;d++)b.options[f[d][0]]&&f[d][1].apply(b.element,e)}},hasScroll:function(d,e){if("hidden"===b(d).css("overflow"))return!1;var f=e&&"left"===e?"scrollLeft":"scrollTop";return 0<d[f]?!0:(d[f]=1,d[f]=0,!1)}})})(jQuery);
(function(b,d){var e=0,f=Array.prototype.slice,h=b.cleanData;b.cleanData=function(d){for(var e,f=0;null!=(e=d[f]);f++)try{b(e).triggerHandler("remove")}catch(n){}h(d)};b.widget=function(e,f,h){var n,p,r,s,t={},u=e.split(".")[0];e=e.split(".")[1];n=u+"-"+e;h||(h=f,f=b.Widget);b.expr[":"][n.toLowerCase()]=function(d){return!!b.data(d,n)};b[u]=b[u]||{};p=b[u][e];r=b[u][e]=function(b,e){return this._createWidget?(arguments.length&&this._createWidget(b,e),d):new r(b,e)};b.extend(r,p,{version:h.version,
_proto:b.extend({},h),_childConstructors:[]});s=new f;s.options=b.widget.extend({},s.options);b.each(h,function(e,h){return b.isFunction(h)?(t[e]=function(){var b=function(){return f.prototype[e].apply(this,arguments)},d=function(b){return f.prototype[e].apply(this,b)};return function(){var e,f=this._super,l=this._superApply;return this._super=b,this._superApply=d,e=h.apply(this,arguments),this._super=f,this._superApply=l,e}}(),d):(t[e]=h,d)});r.prototype=b.widget.extend(s,{widgetEventPrefix:p?s.widgetEventPrefix:
e},t,{constructor:r,namespace:u,widgetName:e,widgetFullName:n});p?(b.each(p._childConstructors,function(d,e){var f=e.prototype;b.widget(f.namespace+"."+f.widgetName,r,e._proto)}),delete p._childConstructors):f._childConstructors.push(r);b.widget.bridge(e,r)};b.widget.extend=function(e){for(var h,m,n=f.call(arguments,1),p=0,r=n.length;r>p;p++)for(h in n[p])m=n[p][h],n[p].hasOwnProperty(h)&&m!==d&&(e[h]=b.isPlainObject(m)?b.isPlainObject(e[h])?b.widget.extend({},e[h],m):b.widget.extend({},m):m);return e};
b.widget.bridge=function(e,h){var m=h.prototype.widgetFullName||e;b.fn[e]=function(n){var p="string"==typeof n,r=f.call(arguments,1),s=this;return n=!p&&r.length?b.widget.extend.apply(null,[n].concat(r)):n,p?this.each(function(){var f,h=b.data(this,m);return h?b.isFunction(h[n])&&"_"!==n.charAt(0)?(f=h[n].apply(h,r),f!==h&&f!==d?(s=f&&f.jquery?s.pushStack(f.get()):f,!1):d):b.error("no such method '"+n+"' for "+e+" widget instance"):b.error("cannot call methods on "+e+" prior to initialization; attempted to call method '"+
n+"'")}):this.each(function(){var d=b.data(this,m);d?d.option(n||{})._init():b.data(this,m,new h(n,this))}),s}};b.Widget=function(){};b.Widget._childConstructors=[];b.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(d,f){f=b(f||this.defaultElement||this)[0];this.element=b(f);this.uuid=e++;this.eventNamespace="."+this.widgetName+this.uuid;this.options=b.widget.extend({},this.options,this._getCreateOptions(),d);
this.bindings=b();this.hoverable=b();this.focusable=b();f!==this&&(b.data(f,this.widgetFullName,this),this._on(!0,this.element,{remove:function(b){b.target===f&&this.destroy()}}),this.document=b(f.style?f.ownerDocument:f.document||f),this.window=b(this.document[0].defaultView||this.document[0].parentWindow));this._create();this._trigger("create",null,this._getCreateEventData());this._init()},_getCreateOptions:b.noop,_getCreateEventData:b.noop,_create:b.noop,_init:b.noop,destroy:function(){this._destroy();
this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(b.camelCase(this.widgetFullName));this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled");this.bindings.unbind(this.eventNamespace);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus")},_destroy:b.noop,widget:function(){return this.element},option:function(e,f){var h,n,p,r=e;
if(0===arguments.length)return b.widget.extend({},this.options);if("string"==typeof e)if(r={},h=e.split("."),e=h.shift(),h.length){n=r[e]=b.widget.extend({},this.options[e]);for(p=0;h.length-1>p;p++)n[h[p]]=n[h[p]]||{},n=n[h[p]];if(e=h.pop(),f===d)return n[e]===d?null:n[e];n[e]=f}else{if(f===d)return this.options[e]===d?null:this.options[e];r[e]=f}return this._setOptions(r),this},_setOptions:function(b){for(var d in b)this._setOption(d,b[d]);return this},_setOption:function(b,d){return this.options[b]=
d,"disabled"===b&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!d).attr("aria-disabled",d),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(e,f,h){var n,p=this;"boolean"!=typeof e&&(h=f,f=e,e=!1);h?(f=n=b(f),this.bindings=this.bindings.add(f)):(h=f,f=this.element,n=this.widget());b.each(h,function(h,
m){function t(){return e||!0!==p.options.disabled&&!b(this).hasClass("ui-state-disabled")?("string"==typeof m?p[m]:m).apply(p,arguments):d}"string"!=typeof m&&(t.guid=m.guid=m.guid||t.guid||b.guid++);var u=h.match(/^(\w+)\s*(.*)$/),w=u[1]+p.eventNamespace;(u=u[2])?n.delegate(u,w,t):f.bind(w,t)})},_off:function(b,d){d=(d||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace;b.unbind(d).undelegate(d)},_delay:function(b,d){var e=this;return setTimeout(function(){return("string"==typeof b?
e[b]:b).apply(e,arguments)},d||0)},_hoverable:function(d){this.hoverable=this.hoverable.add(d);this._on(d,{mouseenter:function(d){b(d.currentTarget).addClass("ui-state-hover")},mouseleave:function(d){b(d.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(d){this.focusable=this.focusable.add(d);this._on(d,{focusin:function(d){b(d.currentTarget).addClass("ui-state-focus")},focusout:function(d){b(d.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(d,e,f){var h,p=this.options[d];
if(f=f||{},e=b.Event(e),e.type=(d===this.widgetEventPrefix?d:this.widgetEventPrefix+d).toLowerCase(),e.target=this.element[0],d=e.originalEvent)for(h in d)h in e||(e[h]=d[h]);return this.element.trigger(e,f),!(b.isFunction(p)&&!1===p.apply(this.element[0],[e].concat(f))||e.isDefaultPrevented())}};b.each({show:"fadeIn",hide:"fadeOut"},function(d,e){b.Widget.prototype["_"+d]=function(f,h,p){"string"==typeof h&&(h={effect:h});var r,s=h?!0===h||"number"==typeof h?e:h.effect||e:d;h=h||{};"number"==typeof h&&
(h={duration:h});r=!b.isEmptyObject(h);h.complete=p;h.delay&&f.delay(h.delay);r&&b.effects&&b.effects.effect[s]?f[d](h):s!==d&&f[s]?f[s](h.duration,h.easing,p):f.queue(function(e){b(this)[d]();p&&p.call(f[0]);e()})}})})(jQuery);
(function(b){var d=!1;b(document).mouseup(function(){d=!1});b.widget("ui.mouse",{version:"1.10.3",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var d=this;this.element.bind("mousedown."+this.widgetName,function(b){return d._mouseDown(b)}).bind("click."+this.widgetName,function(f){return!0===b.data(f.target,d.widgetName+".preventClickEvent")?(b.removeData(f.target,d.widgetName+".preventClickEvent"),f.stopImmediatePropagation(),!1):void 0});this.started=
!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName);this._mouseMoveDelegate&&b(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(e){if(!d){this._mouseStarted&&this._mouseUp(e);this._mouseDownEvent=e;var f=this,h=1===e.which,k="string"==typeof this.options.cancel&&e.target.nodeName?b(e.target).closest(this.options.cancel).length:!1;return h&&!k&&this._mouseCapture(e)?(this.mouseDelayMet=
!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){f.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=!1!==this._mouseStart(e),!this._mouseStarted)?(e.preventDefault(),!0):(!0===b.data(e.target,this.widgetName+".preventClickEvent")&&b.removeData(e.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(b){return f._mouseMove(b)},this._mouseUpDelegate=function(b){return f._mouseUp(b)},
b(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),e.preventDefault(),d=!0,!0)):!0}},_mouseMove:function(d){return b.ui.ie&&(!document.documentMode||9>document.documentMode)&&!d.button?this._mouseUp(d):this._mouseStarted?(this._mouseDrag(d),d.preventDefault()):(this._mouseDistanceMet(d)&&this._mouseDelayMet(d)&&(this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,d),this._mouseStarted?this._mouseDrag(d):this._mouseUp(d)),
!this._mouseStarted)},_mouseUp:function(d){return b(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,d.target===this._mouseDownEvent.target&&b.data(d.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(d)),!1},_mouseDistanceMet:function(b){return Math.max(Math.abs(this._mouseDownEvent.pageX-b.pageX),Math.abs(this._mouseDownEvent.pageY-b.pageY))>=this.options.distance},
_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})})(jQuery);
(function(b,d){function e(b,d,e){return[parseFloat(b[0])*(t.test(b[0])?d/100:1),parseFloat(b[1])*(t.test(b[1])?e/100:1)]}function f(d){var e=d[0];return 9===e.nodeType?{width:d.width(),height:d.height(),offset:{top:0,left:0}}:b.isWindow(e)?{width:d.width(),height:d.height(),offset:{top:d.scrollTop(),left:d.scrollLeft()}}:e.preventDefault?{width:0,height:0,offset:{top:e.pageY,left:e.pageX}}:{width:d.outerWidth(),height:d.outerHeight(),offset:d.offset()}}b.ui=b.ui||{};var h,k=Math.max,l=Math.abs,m=
Math.round,n=/left|center|right/,p=/top|center|bottom/,r=/[\+\-]\d+(\.[\d]+)?%?/,s=/^\w+/,t=/%$/,u=b.fn.position;b.position={scrollbarWidth:function(){if(h!==d)return h;var e,f,l=b("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),k=l.children()[0];return b("body").append(l),e=k.offsetWidth,l.css("overflow","scroll"),f=k.offsetWidth,e===f&&(f=l[0].clientWidth),l.remove(),h=e-f},getScrollInfo:function(d){var e=d.isWindow?"":d.element.css("overflow-x"),
f=d.isWindow?"":d.element.css("overflow-y"),e="scroll"===e||"auto"===e&&d.width<d.element[0].scrollWidth;return{width:"scroll"===f||"auto"===f&&d.height<d.element[0].scrollHeight?b.position.scrollbarWidth():0,height:e?b.position.scrollbarWidth():0}},getWithinInfo:function(d){d=b(d||window);var e=b.isWindow(d[0]);return{element:d,isWindow:e,offset:d.offset()||{left:0,top:0},scrollLeft:d.scrollLeft(),scrollTop:d.scrollTop(),width:e?d.width():d.outerWidth(),height:e?d.height():d.outerHeight()}}};b.fn.position=
function(d){if(!d||!d.of)return u.apply(this,arguments);d=b.extend({},d);var h,t,z,F,C,A,v=b(d.of),B=b.position.getWithinInfo(d.within),T=b.position.getScrollInfo(B),E=(d.collision||"flip").split(" "),Q={};return A=f(v),v[0].preventDefault&&(d.at="left top"),t=A.width,z=A.height,F=A.offset,C=b.extend({},F),b.each(["my","at"],function(){var b,e,f=(d[this]||"").split(" ");1===f.length&&(f=n.test(f[0])?f.concat(["center"]):p.test(f[0])?["center"].concat(f):["center","center"]);f[0]=n.test(f[0])?f[0]:
"center";f[1]=p.test(f[1])?f[1]:"center";b=r.exec(f[0]);e=r.exec(f[1]);Q[this]=[b?b[0]:0,e?e[0]:0];d[this]=[s.exec(f[0])[0],s.exec(f[1])[0]]}),1===E.length&&(E[1]=E[0]),"right"===d.at[0]?C.left+=t:"center"===d.at[0]&&(C.left+=t/2),"bottom"===d.at[1]?C.top+=z:"center"===d.at[1]&&(C.top+=z/2),h=e(Q.at,t,z),C.left+=h[0],C.top+=h[1],this.each(function(){var f,n,p=b(this),r=p.outerWidth(),s=p.outerHeight(),u=parseInt(b.css(this,"marginLeft"),10)||0,A=parseInt(b.css(this,"marginTop"),10)||0,U=r+u+(parseInt(b.css(this,
"marginRight"),10)||0)+T.width,ea=s+A+(parseInt(b.css(this,"marginBottom"),10)||0)+T.height,J=b.extend({},C),Y=e(Q.my,p.outerWidth(),p.outerHeight());"right"===d.my[0]?J.left-=r:"center"===d.my[0]&&(J.left-=r/2);"bottom"===d.my[1]?J.top-=s:"center"===d.my[1]&&(J.top-=s/2);J.left+=Y[0];J.top+=Y[1];b.support.offsetFractions||(J.left=m(J.left),J.top=m(J.top));f={marginLeft:u,marginTop:A};b.each(["left","top"],function(e,l){b.ui.position[E[e]]&&b.ui.position[E[e]][l](J,{targetWidth:t,targetHeight:z,elemWidth:r,
elemHeight:s,collisionPosition:f,collisionWidth:U,collisionHeight:ea,offset:[h[0]+Y[0],h[1]+Y[1]],my:d.my,at:d.at,within:B,elem:p})});d.using&&(n=function(b){var e=F.left-J.left,f=e+t-r,h=F.top-J.top,m=h+z-s,n={target:{element:v,left:F.left,top:F.top,width:t,height:z},element:{element:p,left:J.left,top:J.top,width:r,height:s},horizontal:0>f?"left":0<e?"right":"center",vertical:0>m?"top":0<h?"bottom":"middle"};r>t&&t>l(e+f)&&(n.horizontal="center");s>z&&z>l(h+m)&&(n.vertical="middle");n.important=
k(l(e),l(f))>k(l(h),l(m))?"horizontal":"vertical";d.using.call(this,b,n)});p.offset(b.extend(J,{using:n}))})};b.ui.position={fit:{left:function(b,d){var e,f=d.within,h=f.isWindow?f.scrollLeft:f.offset.left,f=f.width,l=b.left-d.collisionPosition.marginLeft,m=h-l,n=l+d.collisionWidth-f-h;d.collisionWidth>f?0<m&&0>=n?(e=b.left+m+d.collisionWidth-f-h,b.left+=m-e):b.left=0<n&&0>=m?h:m>n?h+f-d.collisionWidth:h:0<m?b.left+=m:0<n?b.left-=n:b.left=k(b.left-l,b.left)},top:function(b,d){var e,f=d.within,f=f.isWindow?
f.scrollTop:f.offset.top,h=d.within.height,l=b.top-d.collisionPosition.marginTop,m=f-l,n=l+d.collisionHeight-h-f;d.collisionHeight>h?0<m&&0>=n?(e=b.top+m+d.collisionHeight-h-f,b.top+=m-e):b.top=0<n&&0>=m?f:m>n?f+h-d.collisionHeight:f:0<m?b.top+=m:0<n?b.top-=n:b.top=k(b.top-l,b.top)}},flip:{left:function(b,d){var e,f,h=d.within,k=h.offset.left+h.scrollLeft,m=h.width,h=h.isWindow?h.scrollLeft:h.offset.left,n=b.left-d.collisionPosition.marginLeft,p=n-h,n=n+d.collisionWidth-m-h,r="left"===d.my[0]?-d.elemWidth:
"right"===d.my[0]?d.elemWidth:0,s="left"===d.at[0]?d.targetWidth:"right"===d.at[0]?-d.targetWidth:0,t=-2*d.offset[0];0>p?(e=b.left+r+s+t+d.collisionWidth-m-k,(0>e||l(p)>e)&&(b.left+=r+s+t)):0<n&&(f=b.left-d.collisionPosition.marginLeft+r+s+t-h,(0<f||n>l(f))&&(b.left+=r+s+t))},top:function(b,d){var e,f,h=d.within,k=h.offset.top+h.scrollTop,m=h.height,h=h.isWindow?h.scrollTop:h.offset.top,n=b.top-d.collisionPosition.marginTop,p=n-h,n=n+d.collisionHeight-m-h,r="top"===d.my[1]?-d.elemHeight:"bottom"===
d.my[1]?d.elemHeight:0,s="top"===d.at[1]?d.targetHeight:"bottom"===d.at[1]?-d.targetHeight:0,t=-2*d.offset[1];0>p?(f=b.top+r+s+t+d.collisionHeight-m-k,b.top+r+s+t>p&&(0>f||l(p)>f)&&(b.top+=r+s+t)):0<n&&(e=b.top-d.collisionPosition.marginTop+r+s+t-h,b.top+r+s+t>n&&(0<e||n>l(e))&&(b.top+=r+s+t))}},flipfit:{left:function(){b.ui.position.flip.left.apply(this,arguments);b.ui.position.fit.left.apply(this,arguments)},top:function(){b.ui.position.flip.top.apply(this,arguments);b.ui.position.fit.top.apply(this,
arguments)}}};(function(){var d,e,f,h,l=document.getElementsByTagName("body")[0];f=document.createElement("div");d=document.createElement(l?"div":"body");e={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"};l&&b.extend(e,{position:"absolute",left:"-1000px",top:"-1000px"});for(h in e)d.style[h]=e[h];d.appendChild(f);e=l||document.documentElement;e.insertBefore(d,e.firstChild);f.style.cssText="position: absolute; left: 10.7432222px;";f=b(f).offset().left;b.support.offsetFractions=
10<f&&11>f;d.innerHTML="";e.removeChild(d)})()})(jQuery);
(function(b){b.widget("ui.draggable",b.ui.mouse,{version:"1.10.3",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"!==this.options.helper||
/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative");this.options.addClasses&&this.element.addClass("ui-draggable");this.options.disabled&&this.element.addClass("ui-draggable-disabled");this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled");this._mouseDestroy()},_mouseCapture:function(d){var e=this.options;return this.helper||e.disabled||0<b(d.target).closest(".ui-resizable-handle").length?
!1:(this.handle=this._getHandle(d),this.handle?(b(!0===e.iframeFix?"iframe":e.iframeFix).each(function(){b("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1E3}).css(b(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(d){var e=this.options;return this.helper=this._createHelper(d),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),
b.ui.ddmanager&&(b.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offsetParent=this.helper.offsetParent(),this.offsetParentCssPosition=this.offsetParent.css("position"),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},this.offset.scroll=!1,b.extend(this.offset,{click:{left:d.pageX-this.offset.left,top:d.pageY-this.offset.top},
parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(d),this.originalPageX=d.pageX,this.originalPageY=d.pageY,e.cursorAt&&this._adjustOffsetFromHelper(e.cursorAt),this._setContainment(),!1===this._trigger("start",d)?(this._clear(),!1):(this._cacheHelperProportions(),b.ui.ddmanager&&!e.dropBehaviour&&b.ui.ddmanager.prepareOffsets(this,d),this._mouseDrag(d,!0),b.ui.ddmanager&&b.ui.ddmanager.dragStart(this,d),!0)},_mouseDrag:function(d,
e){if("fixed"===this.offsetParentCssPosition&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(d),this.positionAbs=this._convertPositionTo("absolute"),!e){var f=this._uiHash();if(!1===this._trigger("drag",d,f))return this._mouseUp({}),!1;this.position=f.position}return this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),b.ui.ddmanager&&
b.ui.ddmanager.drag(this,d),!1},_mouseStop:function(d){var e=this,f=!1;return b.ui.ddmanager&&!this.options.dropBehaviour&&(f=b.ui.ddmanager.drop(this,d)),this.dropped&&(f=this.dropped,this.dropped=!1),"original"!==this.options.helper||b.contains(this.element[0].ownerDocument,this.element[0])?("invalid"===this.options.revert&&!f||"valid"===this.options.revert&&f||!0===this.options.revert||b.isFunction(this.options.revert)&&this.options.revert.call(this.element,f)?b(this.helper).animate(this.originalPosition,
parseInt(this.options.revertDuration,10),function(){!1!==e._trigger("stop",d)&&e._clear()}):!1!==this._trigger("stop",d)&&this._clear(),!1):!1},_mouseUp:function(d){return b("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),b.ui.ddmanager&&b.ui.ddmanager.dragStop(this,d),b.ui.mouse.prototype._mouseUp.call(this,d)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(d){return this.options.handle?
!!b(d.target).closest(this.element.find(this.options.handle)).length:!0},_createHelper:function(d){var e=this.options;d=b.isFunction(e.helper)?b(e.helper.apply(this.element[0],[d])):"clone"===e.helper?this.element.clone().removeAttr("id"):this.element;return d.parents("body").length||d.appendTo("parent"===e.appendTo?this.element[0].parentNode:e.appendTo),d[0]===this.element[0]||/(fixed|absolute)/.test(d.css("position"))||d.css("position","absolute"),d},_adjustOffsetFromHelper:function(d){"string"==
typeof d&&(d=d.split(" "));b.isArray(d)&&(d={left:+d[0],top:+d[1]||0});"left"in d&&(this.offset.click.left=d.left+this.margins.left);"right"in d&&(this.offset.click.left=this.helperProportions.width-d.right+this.margins.left);"top"in d&&(this.offset.click.top=d.top+this.margins.top);"bottom"in d&&(this.offset.click.top=this.helperProportions.height-d.bottom+this.margins.top)},_getParentOffset:function(){var d=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&
b.contains(this.scrollParent[0],this.offsetParent[0])&&(d.left+=this.scrollParent.scrollLeft(),d.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&b.ui.ie)&&(d={top:0,left:0}),{top:d.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:d.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var b=this.element.position();
return{top:b.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:b.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions=
{width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var d,e,f,h=this.options;return h.containment?"window"===h.containment?(this.containment=[b(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,b(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,b(window).scrollLeft()+b(window).width()-this.helperProportions.width-this.margins.left,b(window).scrollTop()+(b(window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-
this.margins.top],void 0):"document"===h.containment?(this.containment=[0,0,b(document).width()-this.helperProportions.width-this.margins.left,(b(document).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top],void 0):h.containment.constructor===Array?(this.containment=h.containment,void 0):("parent"===h.containment&&(h.containment=this.helper[0].parentNode),e=b(h.containment),f=e[0],f&&(d="hidden"!==e.css("overflow"),this.containment=[(parseInt(e.css("borderLeftWidth"),
10)||0)+(parseInt(e.css("paddingLeft"),10)||0),(parseInt(e.css("borderTopWidth"),10)||0)+(parseInt(e.css("paddingTop"),10)||0),(d?Math.max(f.scrollWidth,f.offsetWidth):f.offsetWidth)-(parseInt(e.css("borderRightWidth"),10)||0)-(parseInt(e.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(d?Math.max(f.scrollHeight,f.offsetHeight):f.offsetHeight)-(parseInt(e.css("borderBottomWidth"),10)||0)-(parseInt(e.css("paddingBottom"),10)||0)-this.helperProportions.height-
this.margins.top-this.margins.bottom],this.relative_container=e),void 0):(this.containment=null,void 0)},_convertPositionTo:function(d,e){e||(e=this.position);var f="absolute"===d?1:-1,h="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&b.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent;return this.offset.scroll||(this.offset.scroll={top:h.scrollTop(),left:h.scrollLeft()}),{top:e.top+this.offset.relative.top*f+this.offset.parent.top*f-("fixed"===
this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top)*f,left:e.left+this.offset.relative.left*f+this.offset.parent.left*f-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)*f}},_generatePosition:function(d){var e,f,h,k,l=this.options,m="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&b.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,n=d.pageX,p=d.pageY;return this.offset.scroll||(this.offset.scroll=
{top:m.scrollTop(),left:m.scrollLeft()}),this.originalPosition&&(this.containment&&(this.relative_container?(f=this.relative_container.offset(),e=[this.containment[0]+f.left,this.containment[1]+f.top,this.containment[2]+f.left,this.containment[3]+f.top]):e=this.containment,d.pageX-this.offset.click.left<e[0]&&(n=e[0]+this.offset.click.left),d.pageY-this.offset.click.top<e[1]&&(p=e[1]+this.offset.click.top),d.pageX-this.offset.click.left>e[2]&&(n=e[2]+this.offset.click.left),d.pageY-this.offset.click.top>
e[3]&&(p=e[3]+this.offset.click.top)),l.grid&&(h=l.grid[1]?this.originalPageY+Math.round((p-this.originalPageY)/l.grid[1])*l.grid[1]:this.originalPageY,p=e?h-this.offset.click.top>=e[1]||h-this.offset.click.top>e[3]?h:h-this.offset.click.top>=e[1]?h-l.grid[1]:h+l.grid[1]:h,k=l.grid[0]?this.originalPageX+Math.round((n-this.originalPageX)/l.grid[0])*l.grid[0]:this.originalPageX,n=e?k-this.offset.click.left>=e[0]||k-this.offset.click.left>e[2]?k:k-this.offset.click.left>=e[0]?k-l.grid[0]:k+l.grid[0]:
k)),{top:p-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top),left:n-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging");this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove();this.helper=null;this.cancelHelperRemoval=
!1},_trigger:function(d,e,f){return f=f||this._uiHash(),b.ui.plugin.call(this,d,[e,f]),"drag"===d&&(this.positionAbs=this._convertPositionTo("absolute")),b.Widget.prototype._trigger.call(this,d,e,f)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}});b.ui.plugin.add("draggable","connectToSortable",{start:function(d,e){var f=b(this).data("ui-draggable"),h=f.options,k=b.extend({},e,{item:f.element});f.sortables=
[];b(h.connectToSortable).each(function(){var e=b.data(this,"ui-sortable");e&&!e.options.disabled&&(f.sortables.push({instance:e,shouldRevert:e.options.revert}),e.refreshPositions(),e._trigger("activate",d,k))})},stop:function(d,e){var f=b(this).data("ui-draggable"),h=b.extend({},e,{item:f.element});b.each(f.sortables,function(){this.instance.isOver?(this.instance.isOver=0,f.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=this.shouldRevert),
this.instance._mouseStop(d),this.instance.options.helper=this.instance.options._helper,"original"===f.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",d,h))})},drag:function(d,e){var f=b(this).data("ui-draggable"),h=this;b.each(f.sortables,function(){var k=!1,l=this;this.instance.positionAbs=f.positionAbs;this.instance.helperProportions=f.helperProportions;this.instance.offset.click=f.offset.click;this.instance._intersectsWith(this.instance.containerCache)&&
(k=!0,b.each(f.sortables,function(){return this.instance.positionAbs=f.positionAbs,this.instance.helperProportions=f.helperProportions,this.instance.offset.click=f.offset.click,this!==l&&this.instance._intersectsWith(this.instance.containerCache)&&b.contains(l.instance.element[0],this.instance.element[0])&&(k=!1),k}));k?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=b(h).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item",!0),this.instance.options._helper=
this.instance.options.helper,this.instance.options.helper=function(){return e.helper[0]},d.target=this.instance.currentItem[0],this.instance._mouseCapture(d,!0),this.instance._mouseStart(d,!0,!0),this.instance.offset.click.top=f.offset.click.top,this.instance.offset.click.left=f.offset.click.left,this.instance.offset.parent.left-=f.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=f.offset.parent.top-this.instance.offset.parent.top,f._trigger("toSortable",d),f.dropped=
this.instance.element,f.currentItem=f.element,this.instance.fromOutside=f),this.instance.currentItem&&this.instance._mouseDrag(d)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",d,this.instance._uiHash(this.instance)),this.instance._mouseStop(d,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),
f._trigger("fromSortable",d),f.dropped=!1)})}});b.ui.plugin.add("draggable","cursor",{start:function(){var d=b("body"),e=b(this).data("ui-draggable").options;d.css("cursor")&&(e._cursor=d.css("cursor"));d.css("cursor",e.cursor)},stop:function(){var d=b(this).data("ui-draggable").options;d._cursor&&b("body").css("cursor",d._cursor)}});b.ui.plugin.add("draggable","opacity",{start:function(d,e){var f=b(e.helper),h=b(this).data("ui-draggable").options;f.css("opacity")&&(h._opacity=f.css("opacity"));f.css("opacity",
h.opacity)},stop:function(d,e){var f=b(this).data("ui-draggable").options;f._opacity&&b(e.helper).css("opacity",f._opacity)}});b.ui.plugin.add("draggable","scroll",{start:function(){var d=b(this).data("ui-draggable");d.scrollParent[0]!==document&&"HTML"!==d.scrollParent[0].tagName&&(d.overflowOffset=d.scrollParent.offset())},drag:function(d){var e=b(this).data("ui-draggable"),f=e.options,h=!1;e.scrollParent[0]!==document&&"HTML"!==e.scrollParent[0].tagName?(f.axis&&"x"===f.axis||(e.overflowOffset.top+
e.scrollParent[0].offsetHeight-d.pageY<f.scrollSensitivity?e.scrollParent[0].scrollTop=h=e.scrollParent[0].scrollTop+f.scrollSpeed:d.pageY-e.overflowOffset.top<f.scrollSensitivity&&(e.scrollParent[0].scrollTop=h=e.scrollParent[0].scrollTop-f.scrollSpeed)),f.axis&&"y"===f.axis||(e.overflowOffset.left+e.scrollParent[0].offsetWidth-d.pageX<f.scrollSensitivity?e.scrollParent[0].scrollLeft=h=e.scrollParent[0].scrollLeft+f.scrollSpeed:d.pageX-e.overflowOffset.left<f.scrollSensitivity&&(e.scrollParent[0].scrollLeft=
h=e.scrollParent[0].scrollLeft-f.scrollSpeed))):(f.axis&&"x"===f.axis||(d.pageY-b(document).scrollTop()<f.scrollSensitivity?h=b(document).scrollTop(b(document).scrollTop()-f.scrollSpeed):b(window).height()-(d.pageY-b(document).scrollTop())<f.scrollSensitivity&&(h=b(document).scrollTop(b(document).scrollTop()+f.scrollSpeed))),f.axis&&"y"===f.axis||(d.pageX-b(document).scrollLeft()<f.scrollSensitivity?h=b(document).scrollLeft(b(document).scrollLeft()-f.scrollSpeed):b(window).width()-(d.pageX-b(document).scrollLeft())<
f.scrollSensitivity&&(h=b(document).scrollLeft(b(document).scrollLeft()+f.scrollSpeed))));!1!==h&&b.ui.ddmanager&&!f.dropBehaviour&&b.ui.ddmanager.prepareOffsets(e,d)}});b.ui.plugin.add("draggable","snap",{start:function(){var d=b(this).data("ui-draggable"),e=d.options;d.snapElements=[];b(e.snap.constructor!==String?e.snap.items||":data(ui-draggable)":e.snap).each(function(){var e=b(this),h=e.offset();this!==d.element[0]&&d.snapElements.push({item:this,width:e.outerWidth(),height:e.outerHeight(),
top:h.top,left:h.left})})},drag:function(d,e){var f,h,k,l,m,n,p,r,s,t,u=b(this).data("ui-draggable"),w=u.options,x=w.snapTolerance,y=e.offset.left,z=y+u.helperProportions.width,F=e.offset.top,C=F+u.helperProportions.height;for(s=u.snapElements.length-1;0<=s;s--)m=u.snapElements[s].left,n=m+u.snapElements[s].width,p=u.snapElements[s].top,r=p+u.snapElements[s].height,m-x>z||y>n+x||p-x>C||F>r+x||!b.contains(u.snapElements[s].item.ownerDocument,u.snapElements[s].item)?(u.snapElements[s].snapping&&u.options.snap.release&&
u.options.snap.release.call(u.element,d,b.extend(u._uiHash(),{snapItem:u.snapElements[s].item})),u.snapElements[s].snapping=!1):("inner"!==w.snapMode&&(f=x>=Math.abs(p-C),h=x>=Math.abs(r-F),k=x>=Math.abs(m-z),l=x>=Math.abs(n-y),f&&(e.position.top=u._convertPositionTo("relative",{top:p-u.helperProportions.height,left:0}).top-u.margins.top),h&&(e.position.top=u._convertPositionTo("relative",{top:r,left:0}).top-u.margins.top),k&&(e.position.left=u._convertPositionTo("relative",{top:0,left:m-u.helperProportions.width}).left-
u.margins.left),l&&(e.position.left=u._convertPositionTo("relative",{top:0,left:n}).left-u.margins.left)),t=f||h||k||l,"outer"!==w.snapMode&&(f=x>=Math.abs(p-F),h=x>=Math.abs(r-C),k=x>=Math.abs(m-y),l=x>=Math.abs(n-z),f&&(e.position.top=u._convertPositionTo("relative",{top:p,left:0}).top-u.margins.top),h&&(e.position.top=u._convertPositionTo("relative",{top:r-u.helperProportions.height,left:0}).top-u.margins.top),k&&(e.position.left=u._convertPositionTo("relative",{top:0,left:m}).left-u.margins.left),
l&&(e.position.left=u._convertPositionTo("relative",{top:0,left:n-u.helperProportions.width}).left-u.margins.left)),!u.snapElements[s].snapping&&(f||h||k||l||t)&&u.options.snap.snap&&u.options.snap.snap.call(u.element,d,b.extend(u._uiHash(),{snapItem:u.snapElements[s].item})),u.snapElements[s].snapping=f||h||k||l||t)}});b.ui.plugin.add("draggable","stack",{start:function(){var d,e=this.data("ui-draggable").options,e=b.makeArray(b(e.stack)).sort(function(d,e){return(parseInt(b(d).css("zIndex"),10)||
0)-(parseInt(b(e).css("zIndex"),10)||0)});e.length&&(d=parseInt(b(e[0]).css("zIndex"),10)||0,b(e).each(function(e){b(this).css("zIndex",d+e)}),this.css("zIndex",d+e.length))}});b.ui.plugin.add("draggable","zIndex",{start:function(d,e){var f=b(e.helper),h=b(this).data("ui-draggable").options;f.css("zIndex")&&(h._zIndex=f.css("zIndex"));f.css("zIndex",h.zIndex)},stop:function(d,e){var f=b(this).data("ui-draggable").options;f._zIndex&&b(e.helper).css("zIndex",f._zIndex)}})})(jQuery);
(function(b){b.widget("ui.droppable",{version:"1.10.3",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var d=this.options,e=d.accept;this.isover=!1;this.isout=!0;this.accept=b.isFunction(e)?e:function(b){return b.is(e)};this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight};b.ui.ddmanager.droppables[d.scope]=
b.ui.ddmanager.droppables[d.scope]||[];b.ui.ddmanager.droppables[d.scope].push(this);d.addClasses&&this.element.addClass("ui-droppable")},_destroy:function(){for(var d=0,e=b.ui.ddmanager.droppables[this.options.scope];e.length>d;d++)e[d]===this&&e.splice(d,1);this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(d,e){"accept"===d&&(this.accept=b.isFunction(e)?e:function(b){return b.is(e)});b.Widget.prototype._setOption.apply(this,arguments)},_activate:function(d){var e=
b.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass);e&&this._trigger("activate",d,this.ui(e))},_deactivate:function(d){var e=b.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass);e&&this._trigger("deactivate",d,this.ui(e))},_over:function(d){var e=b.ui.ddmanager.current;e&&(e.currentItem||e.element)[0]!==this.element[0]&&this.accept.call(this.element[0],e.currentItem||e.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),
this._trigger("over",d,this.ui(e)))},_out:function(d){var e=b.ui.ddmanager.current;e&&(e.currentItem||e.element)[0]!==this.element[0]&&this.accept.call(this.element[0],e.currentItem||e.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",d,this.ui(e)))},_drop:function(d,e){var f=e||b.ui.ddmanager.current,h=!1;return f&&(f.currentItem||f.element)[0]!==this.element[0]?(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var d=
b.data(this,"ui-droppable");return d.options.greedy&&!d.options.disabled&&d.options.scope===f.options.scope&&d.accept.call(d.element[0],f.currentItem||f.element)&&b.ui.intersect(f,b.extend(d,{offset:d.element.offset()}),d.options.tolerance)?(h=!0,!1):void 0}),h?!1:this.accept.call(this.element[0],f.currentItem||f.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",d,this.ui(f)),
this.element):!1):!1},ui:function(b){return{draggable:b.currentItem||b.element,helper:b.helper,position:b.position,offset:b.positionAbs}}});b.ui.intersect=function(b,e,f){if(!e.offset)return!1;var h,k,l=(b.positionAbs||b.position.absolute).left,m=l+b.helperProportions.width,n=(b.positionAbs||b.position.absolute).top,p=n+b.helperProportions.height,r=e.offset.left,s=r+e.proportions.width,t=e.offset.top,u=t+e.proportions.height;switch(f){case "fit":return l>=r&&s>=m&&n>=t&&u>=p;case "intersect":return l+
b.helperProportions.width/2>r&&s>m-b.helperProportions.width/2&&n+b.helperProportions.height/2>t&&u>p-b.helperProportions.height/2;case "pointer":return h=(b.positionAbs||b.position.absolute).left+(b.clickOffset||b.offset.click).left,k=(b.positionAbs||b.position.absolute).top+(b.clickOffset||b.offset.click).top,k>t&&t+e.proportions.height>k&&h>r&&r+e.proportions.width>h;case "touch":return(n>=t&&u>=n||p>=t&&u>=p||t>n&&p>u)&&(l>=r&&s>=l||m>=r&&s>=m||r>l&&m>s);default:return!1}};b.ui.ddmanager={current:null,
droppables:{"default":[]},prepareOffsets:function(d,e){var f,h,k=b.ui.ddmanager.droppables[d.options.scope]||[],l=e?e.type:null,m=(d.currentItem||d.element).find(":data(ui-droppable)").addBack();f=0;a:for(;k.length>f;f++)if(!(k[f].options.disabled||d&&!k[f].accept.call(k[f].element[0],d.currentItem||d.element))){for(h=0;m.length>h;h++)if(m[h]===k[f].element[0]){k[f].proportions.height=0;continue a}k[f].visible="none"!==k[f].element.css("display");k[f].visible&&("mousedown"===l&&k[f]._activate.call(k[f],
e),k[f].offset=k[f].element.offset(),k[f].proportions={width:k[f].element[0].offsetWidth,height:k[f].element[0].offsetHeight})}},drop:function(d,e){var f=!1;return b.each((b.ui.ddmanager.droppables[d.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&b.ui.intersect(d,this,this.options.tolerance)&&(f=this._drop.call(this,e)||f),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],d.currentItem||d.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,
e)))}),f},dragStart:function(d,e){d.element.parentsUntil("body").bind("scroll.droppable",function(){d.options.refreshPositions||b.ui.ddmanager.prepareOffsets(d,e)})},drag:function(d,e){d.options.refreshPositions&&b.ui.ddmanager.prepareOffsets(d,e);b.each(b.ui.ddmanager.droppables[d.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var f,h,k,l=b.ui.intersect(d,this,this.options.tolerance);(l=!l&&this.isover?"isout":l&&!this.isover?"isover":null)&&(this.options.greedy&&
(h=this.options.scope,k=this.element.parents(":data(ui-droppable)").filter(function(){return b.data(this,"ui-droppable").options.scope===h}),k.length&&(f=b.data(k[0],"ui-droppable"),f.greedyChild="isover"===l)),f&&"isover"===l&&(f.isover=!1,f.isout=!0,f._out.call(f,e)),this[l]=!0,this["isout"===l?"isover":"isout"]=!1,this["isover"===l?"_over":"_out"].call(this,e),f&&"isout"===l&&(f.isout=!1,f.isover=!0,f._over.call(f,e)))}})},dragStop:function(d,e){d.element.parentsUntil("body").unbind("scroll.droppable");
d.options.refreshPositions||b.ui.ddmanager.prepareOffsets(d,e)}}})(jQuery);
(function(b){function d(b){return parseInt(b,10)||0}function e(b){return!isNaN(parseInt(b,10))}b.widget("ui.resizable",b.ui.mouse,{version:"1.10.3",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_create:function(){var d,e,k,l,m,n=this,p=this.options;if(this.element.addClass("ui-resizable"),
b.extend(this,{_aspectRatio:!!p.aspectRatio,aspectRatio:p.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:p.helper||p.ghost||p.animate?p.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(this.element.wrap(b("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),
left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.data("ui-resizable")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),
this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=p.handles||(b(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),
this.handles.constructor===String){"all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw");d=this.handles.split(",");this.handles={};for(e=0;d.length>e;e++)k=b.trim(d[e]),m="ui-resizable-"+k,l=b("<div class='ui-resizable-handle "+m+"'></div>"),l.css({zIndex:p.zIndex}),"se"===k&&l.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[k]=".ui-resizable-"+k,this.element.append(l)}this._renderAxis=function(d){var e,f,h,l;d=d||this.element;for(e in this.handles)this.handles[e].constructor===
String&&(this.handles[e]=b(this.handles[e],this.element).show()),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)&&(f=b(this.handles[e],this.element),l=/sw|ne|nw|se|n|s/.test(e)?f.outerHeight():f.outerWidth(),h=["padding",/ne|nw|n/.test(e)?"Top":/se|sw|s/.test(e)?"Bottom":/^e$/.test(e)?"Right":"Left"].join(""),d.css(h,l),this._proportionallyResize()),b(this.handles[e]).length};this._renderAxis(this.element);this._handles=b(".ui-resizable-handle",this.element).disableSelection();
this._handles.mouseover(function(){n.resizing||(this.className&&(l=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),n.axis=l&&l[1]?l[1]:"se")});p.autoHide&&(this._handles.hide(),b(this.element).addClass("ui-resizable-autohide").mouseenter(function(){p.disabled||(b(this).removeClass("ui-resizable-autohide"),n._handles.show())}).mouseleave(function(){p.disabled||n.resizing||(b(this).addClass("ui-resizable-autohide"),n._handles.hide())}));this._mouseInit()},_destroy:function(){this._mouseDestroy();
var d,e=function(d){b(d).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(e(this.element),d=this.element,this.originalElement.css({position:d.css("position"),width:d.outerWidth(),height:d.outerHeight(),top:d.css("top"),left:d.css("left")}).insertAfter(d),d.remove()),this.originalElement.css("resize",this.originalResizeStyle),e(this.originalElement),
this},_mouseCapture:function(d){var e,k,l=!1;for(e in this.handles)k=b(this.handles[e])[0],(k===d.target||b.contains(k,d.target))&&(l=!0);return!this.options.disabled&&l},_mouseStart:function(e){var h,k,l,m=this.options,n=this.element.position(),p=this.element;return this.resizing=!0,/absolute/.test(p.css("position"))?p.css({position:"absolute",top:p.css("top"),left:p.css("left")}):p.is(".ui-draggable")&&p.css({position:"absolute",top:n.top,left:n.left}),this._renderProxy(),h=d(this.helper.css("left")),
k=d(this.helper.css("top")),m.containment&&(h+=b(m.containment).scrollLeft()||0,k+=b(m.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:h,top:k},this.size=this._helper?{width:p.outerWidth(),height:p.outerHeight()}:{width:p.width(),height:p.height()},this.originalSize=this._helper?{width:p.outerWidth(),height:p.outerHeight()}:{width:p.width(),height:p.height()},this.originalPosition={left:h,top:k},this.sizeDiff={width:p.outerWidth()-p.width(),height:p.outerHeight()-
p.height()},this.originalMousePosition={left:e.pageX,top:e.pageY},this.aspectRatio="number"==typeof m.aspectRatio?m.aspectRatio:this.originalSize.width/this.originalSize.height||1,l=b(".ui-resizable-"+this.axis).css("cursor"),b("body").css("cursor","auto"===l?this.axis+"-resize":l),p.addClass("ui-resizable-resizing"),this._propagate("start",e),!0},_mouseDrag:function(d){var e,k=this.helper,l={},m=this.originalMousePosition,n=this.position.top,p=this.position.left,r=this.size.width,s=this.size.height,
t=d.pageX-m.left||0,m=d.pageY-m.top||0,u=this._change[this.axis];return u?(e=u.apply(this,[d,t,m]),this._updateVirtualBoundaries(d.shiftKey),(this._aspectRatio||d.shiftKey)&&(e=this._updateRatio(e,d)),e=this._respectSize(e,d),this._updateCache(e),this._propagate("resize",d),this.position.top!==n&&(l.top=this.position.top+"px"),this.position.left!==p&&(l.left=this.position.left+"px"),this.size.width!==r&&(l.width=this.size.width+"px"),this.size.height!==s&&(l.height=this.size.height+"px"),k.css(l),
!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),b.isEmptyObject(l)||this._trigger("resize",d,this.ui()),!1):!1},_mouseStop:function(d){this.resizing=!1;var e,k,l,m,n,p,r,s=this.options;return this._helper&&(e=this._proportionallyResizeElements,k=e.length&&/textarea/i.test(e[0].nodeName),l=k&&b.ui.hasScroll(e[0],"left")?0:this.sizeDiff.height,m=k?0:this.sizeDiff.width,n={width:this.helper.width()-m,height:this.helper.height()-l},p=parseInt(this.element.css("left"),
10)+(this.position.left-this.originalPosition.left)||null,r=parseInt(this.element.css("top"),10)+(this.position.top-this.originalPosition.top)||null,s.animate||this.element.css(b.extend(n,{top:r,left:p})),this.helper.height(this.size.height),this.helper.width(this.size.width),this._helper&&!s.animate&&this._proportionallyResize()),b("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",d),this._helper&&this.helper.remove(),!1},_updateVirtualBoundaries:function(b){var d,
k,l,m,n;n=this.options;n={minWidth:e(n.minWidth)?n.minWidth:0,maxWidth:e(n.maxWidth)?n.maxWidth:1/0,minHeight:e(n.minHeight)?n.minHeight:0,maxHeight:e(n.maxHeight)?n.maxHeight:1/0};(this._aspectRatio||b)&&(d=n.minHeight*this.aspectRatio,l=n.minWidth/this.aspectRatio,k=n.maxHeight*this.aspectRatio,m=n.maxWidth/this.aspectRatio,d>n.minWidth&&(n.minWidth=d),l>n.minHeight&&(n.minHeight=l),n.maxWidth>k&&(n.maxWidth=k),n.maxHeight>m&&(n.maxHeight=m));this._vBoundaries=n},_updateCache:function(b){this.offset=
this.helper.offset();e(b.left)&&(this.position.left=b.left);e(b.top)&&(this.position.top=b.top);e(b.height)&&(this.size.height=b.height);e(b.width)&&(this.size.width=b.width)},_updateRatio:function(b){var d=this.position,k=this.size,l=this.axis;return e(b.height)?b.width=b.height*this.aspectRatio:e(b.width)&&(b.height=b.width/this.aspectRatio),"sw"===l&&(b.left=d.left+(k.width-b.width),b.top=null),"nw"===l&&(b.top=d.top+(k.height-b.height),b.left=d.left+(k.width-b.width)),b},_respectSize:function(b){var d=
this._vBoundaries,k=this.axis,l=e(b.width)&&d.maxWidth&&d.maxWidth<b.width,m=e(b.height)&&d.maxHeight&&d.maxHeight<b.height,n=e(b.width)&&d.minWidth&&d.minWidth>b.width,p=e(b.height)&&d.minHeight&&d.minHeight>b.height,r=this.originalPosition.left+this.originalSize.width,s=this.position.top+this.size.height,t=/sw|nw|w/.test(k),k=/nw|ne|n/.test(k);return n&&(b.width=d.minWidth),p&&(b.height=d.minHeight),l&&(b.width=d.maxWidth),m&&(b.height=d.maxHeight),n&&t&&(b.left=r-d.minWidth),l&&t&&(b.left=r-d.maxWidth),
p&&k&&(b.top=s-d.minHeight),m&&k&&(b.top=s-d.maxHeight),b.width||b.height||b.left||!b.top?b.width||b.height||b.top||!b.left||(b.left=null):b.top=null,b},_proportionallyResize:function(){if(this._proportionallyResizeElements.length){var b,d,e,l,m,n=this.helper||this.element;for(b=0;this._proportionallyResizeElements.length>b;b++){if(m=this._proportionallyResizeElements[b],!this.borderDif){this.borderDif=[];e=[m.css("borderTopWidth"),m.css("borderRightWidth"),m.css("borderBottomWidth"),m.css("borderLeftWidth")];
l=[m.css("paddingTop"),m.css("paddingRight"),m.css("paddingBottom"),m.css("paddingLeft")];for(d=0;e.length>d;d++)this.borderDif[d]=(parseInt(e[d],10)||0)+(parseInt(l[d],10)||0)}m.css({height:n.height()-this.borderDif[0]-this.borderDif[2]||0,width:n.width()-this.borderDif[1]-this.borderDif[3]||0})}}},_renderProxy:function(){var d=this.options;this.elementOffset=this.element.offset();this._helper?(this.helper=this.helper||b("<div style='overflow:hidden;'></div>"),this.helper.addClass(this._helper).css({width:this.element.outerWidth()-
1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++d.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(b,d){return{width:this.originalSize.width+d}},w:function(b,d){return{left:this.originalPosition.left+d,width:this.originalSize.width-d}},n:function(b,d,e){return{top:this.originalPosition.top+e,height:this.originalSize.height-e}},s:function(b,d,e){return{height:this.originalSize.height+
e}},se:function(d,e,k){return b.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[d,e,k]))},sw:function(d,e,k){return b.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[d,e,k]))},ne:function(d,e,k){return b.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[d,e,k]))},nw:function(d,e,k){return b.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[d,e,k]))}},_propagate:function(d,e){b.ui.plugin.call(this,d,[e,this.ui()]);
"resize"!==d&&this._trigger(d,e,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}});b.ui.plugin.add("resizable","animate",{stop:function(d){var e=b(this).data("ui-resizable"),k=e.options,l=e._proportionallyResizeElements,m=l.length&&/textarea/i.test(l[0].nodeName),n=m&&b.ui.hasScroll(l[0],"left")?0:e.sizeDiff.height,m=
{width:e.size.width-(m?0:e.sizeDiff.width),height:e.size.height-n},n=parseInt(e.element.css("left"),10)+(e.position.left-e.originalPosition.left)||null,p=parseInt(e.element.css("top"),10)+(e.position.top-e.originalPosition.top)||null;e.element.animate(b.extend(m,p&&n?{top:p,left:n}:{}),{duration:k.animateDuration,easing:k.animateEasing,step:function(){var k={width:parseInt(e.element.css("width"),10),height:parseInt(e.element.css("height"),10),top:parseInt(e.element.css("top"),10),left:parseInt(e.element.css("left"),
10)};l&&l.length&&b(l[0]).css({width:k.width,height:k.height});e._updateCache(k);e._propagate("resize",d)}})}});b.ui.plugin.add("resizable","containment",{start:function(){var e,h,k,l,m,n,p,r=b(this).data("ui-resizable"),s=r.element,t=r.options.containment;(s=t instanceof b?t.get(0):/parent/.test(t)?s.parent().get(0):t)&&(r.containerElement=b(s),/document/.test(t)||t===document?(r.containerOffset={left:0,top:0},r.containerPosition={left:0,top:0},r.parentData={element:b(document),left:0,top:0,width:b(document).width(),
height:b(document).height()||document.body.parentNode.scrollHeight}):(e=b(s),h=[],b(["Top","Right","Left","Bottom"]).each(function(b,l){h[b]=d(e.css("padding"+l))}),r.containerOffset=e.offset(),r.containerPosition=e.position(),r.containerSize={height:e.innerHeight()-h[3],width:e.innerWidth()-h[1]},k=r.containerOffset,l=r.containerSize.height,m=r.containerSize.width,n=b.ui.hasScroll(s,"left")?s.scrollWidth:m,p=b.ui.hasScroll(s)?s.scrollHeight:l,r.parentData={element:s,left:k.left,top:k.top,width:n,
height:p}))},resize:function(d){var e,k,l,m,n=b(this).data("ui-resizable");e=n.options;k=n.containerOffset;l=n.position;d=n._aspectRatio||d.shiftKey;m={top:0,left:0};var p=n.containerElement;p[0]!==document&&/static/.test(p.css("position"))&&(m=k);l.left<(n._helper?k.left:0)&&(n.size.width+=n._helper?n.position.left-k.left:n.position.left-m.left,d&&(n.size.height=n.size.width/n.aspectRatio),n.position.left=e.helper?k.left:0);l.top<(n._helper?k.top:0)&&(n.size.height+=n._helper?n.position.top-k.top:
n.position.top,d&&(n.size.width=n.size.height*n.aspectRatio),n.position.top=n._helper?k.top:0);n.offset.left=n.parentData.left+n.position.left;n.offset.top=n.parentData.top+n.position.top;e=Math.abs(n.offset.left-m.left+n.sizeDiff.width);k=Math.abs((n._helper?n.offset.top-m.top:n.offset.top-k.top)+n.sizeDiff.height);l=n.containerElement.get(0)===n.element.parent().get(0);m=/relative|absolute/.test(n.containerElement.css("position"));l&&m&&(e-=n.parentData.left);e+n.size.width>=n.parentData.width&&
(n.size.width=n.parentData.width-e,d&&(n.size.height=n.size.width/n.aspectRatio));k+n.size.height>=n.parentData.height&&(n.size.height=n.parentData.height-k,d&&(n.size.width=n.size.height*n.aspectRatio))},stop:function(){var d=b(this).data("ui-resizable"),e=d.options,k=d.containerOffset,l=d.containerPosition,m=d.containerElement,n=b(d.helper),p=n.offset(),r=n.outerWidth()-d.sizeDiff.width,n=n.outerHeight()-d.sizeDiff.height;d._helper&&!e.animate&&/relative/.test(m.css("position"))&&b(this).css({left:p.left-
l.left-k.left,width:r,height:n});d._helper&&!e.animate&&/static/.test(m.css("position"))&&b(this).css({left:p.left-l.left-k.left,width:r,height:n})}});b.ui.plugin.add("resizable","alsoResize",{start:function(){var d=b(this).data("ui-resizable").options,e=function(d){b(d).each(function(){var d=b(this);d.data("ui-resizable-alsoresize",{width:parseInt(d.width(),10),height:parseInt(d.height(),10),left:parseInt(d.css("left"),10),top:parseInt(d.css("top"),10)})})};"object"!=typeof d.alsoResize||d.alsoResize.parentNode?
e(d.alsoResize):d.alsoResize.length?(d.alsoResize=d.alsoResize[0],e(d.alsoResize)):b.each(d.alsoResize,function(b){e(b)})},resize:function(d,e){var k=b(this).data("ui-resizable"),l=k.options,m=k.originalSize,n=k.originalPosition,p={height:k.size.height-m.height||0,width:k.size.width-m.width||0,top:k.position.top-n.top||0,left:k.position.left-n.left||0},r=function(d,f){b(d).each(function(){var d=b(this),l=b(this).data("ui-resizable-alsoresize"),k={},m=f&&f.length?f:d.parents(e.originalElement[0]).length?
["width","height"]:["width","height","top","left"];b.each(m,function(b,d){var e=(l[d]||0)+(p[d]||0);e&&0<=e&&(k[d]=e||null)});d.css(k)})};"object"!=typeof l.alsoResize||l.alsoResize.nodeType?r(l.alsoResize):b.each(l.alsoResize,function(b,d){r(b,d)})},stop:function(){b(this).removeData("resizable-alsoresize")}});b.ui.plugin.add("resizable","ghost",{start:function(){var d=b(this).data("ui-resizable"),e=d.options,k=d.size;d.ghost=d.originalElement.clone();d.ghost.css({opacity:0.25,display:"block",position:"relative",
height:k.height,width:k.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof e.ghost?e.ghost:"");d.ghost.appendTo(d.helper)},resize:function(){var d=b(this).data("ui-resizable");d.ghost&&d.ghost.css({position:"relative",height:d.size.height,width:d.size.width})},stop:function(){var d=b(this).data("ui-resizable");d.ghost&&d.helper&&d.helper.get(0).removeChild(d.ghost.get(0))}});b.ui.plugin.add("resizable","grid",{resize:function(){var d=b(this).data("ui-resizable"),
e=d.options,k=d.size,l=d.originalSize,m=d.originalPosition,n=d.axis,p="number"==typeof e.grid?[e.grid,e.grid]:e.grid,r=p[0]||1,s=p[1]||1,t=Math.round((k.width-l.width)/r)*r,k=Math.round((k.height-l.height)/s)*s,u=l.width+t,l=l.height+k,w=e.maxWidth&&u>e.maxWidth,x=e.maxHeight&&l>e.maxHeight,y=e.minWidth&&e.minWidth>u,z=e.minHeight&&e.minHeight>l;e.grid=p;y&&(u+=r);z&&(l+=s);w&&(u-=r);x&&(l-=s);/^(se|s|e)$/.test(n)?(d.size.width=u,d.size.height=l):/^(ne)$/.test(n)?(d.size.width=u,d.size.height=l,d.position.top=
m.top-k):/^(sw)$/.test(n)?(d.size.width=u,d.size.height=l,d.position.left=m.left-t):(d.size.width=u,d.size.height=l,d.position.top=m.top-k,d.position.left=m.left-t)}})})(jQuery);
(function(b){b.widget("ui.selectable",b.ui.mouse,{version:"1.10.3",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var d,e=this;this.element.addClass("ui-selectable");this.dragged=!1;this.refresh=function(){d=b(e.options.filter,e.element[0]);d.addClass("ui-selectee");d.each(function(){var d=b(this),e=d.offset();b.data(this,"selectable-item",{element:this,$element:d,
left:e.left,top:e.top,right:e.left+d.outerWidth(),bottom:e.top+d.outerHeight(),startselected:!1,selected:d.hasClass("ui-selected"),selecting:d.hasClass("ui-selecting"),unselecting:d.hasClass("ui-unselecting")})})};this.refresh();this.selectees=d.addClass("ui-selectee");this._mouseInit();this.helper=b("<div class='ui-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item");this.element.removeClass("ui-selectable ui-selectable-disabled");
this._mouseDestroy()},_mouseStart:function(d){var e=this,f=this.options;this.opos=[d.pageX,d.pageY];this.options.disabled||(this.selectees=b(f.filter,this.element[0]),this._trigger("start",d),b(f.appendTo).append(this.helper),this.helper.css({left:d.pageX,top:d.pageY,width:0,height:0}),f.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var f=b.data(this,"selectable-item");f.startselected=!0;d.metaKey||d.ctrlKey||(f.$element.removeClass("ui-selected"),f.selected=!1,
f.$element.addClass("ui-unselecting"),f.unselecting=!0,e._trigger("unselecting",d,{unselecting:f.element}))}),b(d.target).parents().addBack().each(function(){var f,k=b.data(this,"selectable-item");return k?(f=!d.metaKey&&!d.ctrlKey||!k.$element.hasClass("ui-selected"),k.$element.removeClass(f?"ui-unselecting":"ui-selected").addClass(f?"ui-selecting":"ui-unselecting"),k.unselecting=!f,k.selecting=f,k.selected=f,f?e._trigger("selecting",d,{selecting:k.element}):e._trigger("unselecting",d,{unselecting:k.element}),
!1):void 0}))},_mouseDrag:function(d){if(this.dragged=!0,!this.options.disabled){var e,f=this,h=this.options,k=this.opos[0],l=this.opos[1],m=d.pageX,n=d.pageY;return k>m&&(e=m,m=k,k=e),l>n&&(e=n,n=l,l=e),this.helper.css({left:k,top:l,width:m-k,height:n-l}),this.selectees.each(function(){var e=b.data(this,"selectable-item");e&&e.element!==f.element[0]&&(e.selecting&&((d.metaKey||d.ctrlKey)&&e.startselected?(e.$element.removeClass("ui-selecting"),e.selecting=!1,e.$element.addClass("ui-selected"),e.selected=
!0):(e.$element.removeClass("ui-selecting"),e.selecting=!1,e.startselected&&(e.$element.addClass("ui-unselecting"),e.unselecting=!0),f._trigger("unselecting",d,{unselecting:e.element}))),e.selected&&(d.metaKey||d.ctrlKey||e.startselected||(e.$element.removeClass("ui-selected"),e.selected=!1,e.$element.addClass("ui-unselecting"),e.unselecting=!0,f._trigger("unselecting",d,{unselecting:e.element}))))}),!1}},_mouseStop:function(d){var e=this;return this.dragged=!1,b(".ui-unselecting",this.element[0]).each(function(){var f=
b.data(this,"selectable-item");f.$element.removeClass("ui-unselecting");f.unselecting=!1;f.startselected=!1;e._trigger("unselected",d,{unselected:f.element})}),b(".ui-selecting",this.element[0]).each(function(){var f=b.data(this,"selectable-item");f.$element.removeClass("ui-selecting").addClass("ui-selected");f.selecting=!1;f.selected=!0;f.startselected=!0;e._trigger("selected",d,{selected:f.element})}),this._trigger("stop",d),this.helper.remove(),!1}})})(jQuery);
(function(b){function d(b){return/left|right/.test(b.css("float"))||/inline|table-cell/.test(b.css("display"))}b.widget("ui.sortable",b.ui.mouse,{version:"1.10.3",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",
zIndex:1E3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_create:function(){var b=this.options;this.containerCache={};this.element.addClass("ui-sortable");this.refresh();this.floating=this.items.length?"x"===b.axis||d(this.items[0].item):!1;this.offset=this.element.offset();this._mouseInit();this.ready=!0},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled");this._mouseDestroy();
for(var b=this.items.length-1;0<=b;b--)this.items[b].item.removeData(this.widgetName+"-item");return this},_setOption:function(d,f){"disabled"===d?(this.options[d]=f,this.widget().toggleClass("ui-sortable-disabled",!!f)):b.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(d,f){var h=null,k=!1,l=this;return this.reverting?!1:this.options.disabled||"static"===this.options.type?!1:(this._refreshItems(d),b(d.target).parents().each(function(){return b.data(this,l.widgetName+"-item")===
l?(h=b(this),!1):void 0}),b.data(d.target,l.widgetName+"-item")===l&&(h=b(d.target)),h?!this.options.handle||f||(b(this.options.handle,h).find("*").addBack().each(function(){this===d.target&&(k=!0)}),k)?(this.currentItem=h,this._removeCurrentsFromItems(),!0):!1:!1)},_mouseStart:function(d,f,h){var k;f=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(d),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),
this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},b.extend(this.offset,{click:{left:d.pageX-this.offset.left,top:d.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(d),this.originalPageX=d.pageX,this.originalPageY=d.pageY,f.cursorAt&&this._adjustOffsetFromHelper(f.cursorAt),
this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),f.containment&&this._setContainment(),f.cursor&&"auto"!==f.cursor&&(k=this.document.find("body"),this.storedCursor=k.css("cursor"),k.css("cursor",f.cursor),this.storedStylesheet=b("<style>*{ cursor: "+f.cursor+" !important; }</style>").appendTo(k)),f.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),
this.helper.css("opacity",f.opacity)),f.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",f.zIndex)),this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",d,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!h)for(h=this.containers.length-1;0<=h;h--)this.containers[h]._trigger("activate",d,this._uiHash(this));return b.ui.ddmanager&&
(b.ui.ddmanager.current=this),b.ui.ddmanager&&!f.dropBehaviour&&b.ui.ddmanager.prepareOffsets(this,d),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(d),!0},_mouseDrag:function(d){var f,h,k,l;f=this.options;var m=!1;this.position=this._generatePosition(d);this.positionAbs=this._convertPositionTo("absolute");this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs);this.options.scroll&&(this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+
this.scrollParent[0].offsetHeight-d.pageY<f.scrollSensitivity?this.scrollParent[0].scrollTop=m=this.scrollParent[0].scrollTop+f.scrollSpeed:d.pageY-this.overflowOffset.top<f.scrollSensitivity&&(this.scrollParent[0].scrollTop=m=this.scrollParent[0].scrollTop-f.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-d.pageX<f.scrollSensitivity?this.scrollParent[0].scrollLeft=m=this.scrollParent[0].scrollLeft+f.scrollSpeed:d.pageX-this.overflowOffset.left<f.scrollSensitivity&&(this.scrollParent[0].scrollLeft=
m=this.scrollParent[0].scrollLeft-f.scrollSpeed)):(d.pageY-b(document).scrollTop()<f.scrollSensitivity?m=b(document).scrollTop(b(document).scrollTop()-f.scrollSpeed):b(window).height()-(d.pageY-b(document).scrollTop())<f.scrollSensitivity&&(m=b(document).scrollTop(b(document).scrollTop()+f.scrollSpeed)),d.pageX-b(document).scrollLeft()<f.scrollSensitivity?m=b(document).scrollLeft(b(document).scrollLeft()-f.scrollSpeed):b(window).width()-(d.pageX-b(document).scrollLeft())<f.scrollSensitivity&&(m=b(document).scrollLeft(b(document).scrollLeft()+
f.scrollSpeed))),!1!==m&&b.ui.ddmanager&&!f.dropBehaviour&&b.ui.ddmanager.prepareOffsets(this,d));this.positionAbs=this._convertPositionTo("absolute");this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px");this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px");for(f=this.items.length-1;0<=f;f--)if(h=this.items[f],k=h.item[0],l=this._intersectsWithPointer(h),l&&h.instance===this.currentContainer&&k!==this.currentItem[0]&&
this.placeholder[1===l?"next":"prev"]()[0]!==k&&!b.contains(this.placeholder[0],k)&&("semi-dynamic"===this.options.type?!b.contains(this.element[0],k):!0)){if(this.direction=1===l?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(h))break;this._rearrange(d,h);this._trigger("change",d,this._uiHash());break}return this._contactContainers(d),b.ui.ddmanager&&b.ui.ddmanager.drag(this,d),this._trigger("sort",d,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(d,
f){if(d){if(b.ui.ddmanager&&!this.options.dropBehaviour&&b.ui.ddmanager.drop(this,d),this.options.revert){var h=this,k=this.placeholder.offset(),l=this.options.axis,m={};l&&"x"!==l||(m.left=k.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft));l&&"y"!==l||(m.top=k.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop));this.reverting=!0;b(this.helper).animate(m,parseInt(this.options.revert,
10)||500,function(){h._clear(d)})}else this._clear(d,f);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null});"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var d=this.containers.length-1;0<=d;d--)this.containers[d]._trigger("deactivate",null,this._uiHash(this)),this.containers[d].containerCache.over&&(this.containers[d]._trigger("out",null,this._uiHash(this)),this.containers[d].containerCache.over=
0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),b.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?b(this.domPosition.prev).after(this.currentItem):b(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(d){var f=this._getItemsAsjQuery(d&&d.connected),h=[];return d=
d||{},b(f).each(function(){var f=(b(d.item||this).attr(d.attribute||"id")||"").match(d.expression||/(.+)[\-=_](.+)/);f&&h.push((d.key||f[1]+"[]")+"="+(d.key&&d.expression?f[1]:f[2]))}),!h.length&&d.key&&h.push(d.key+"="),h.join("&")},toArray:function(d){var f=this._getItemsAsjQuery(d&&d.connected),h=[];return d=d||{},f.each(function(){h.push(b(d.item||this).attr(d.attribute||"id")||"")}),h},_intersectsWith:function(b){var d=this.positionAbs.left,h=d+this.helperProportions.width,k=this.positionAbs.top,
l=k+this.helperProportions.height,m=b.left,n=m+b.width,p=b.top,r=p+b.height,s=this.offset.click.top,t=this.offset.click.left,t="y"===this.options.axis||d+t>m&&n>d+t,s=("x"===this.options.axis||k+s>p&&r>k+s)&&t;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>b[this.floating?"width":"height"]?s:d+this.helperProportions.width/2>m&&n>h-this.helperProportions.width/2&&k+this.helperProportions.height/
2>p&&r>l-this.helperProportions.height/2},_intersectsWithPointer:function(b){var d="y"===this.options.axis||this.positionAbs.left+this.offset.click.left>b.left&&b.left+b.width>this.positionAbs.left+this.offset.click.left;b=("x"===this.options.axis||this.positionAbs.top+this.offset.click.top>b.top&&b.top+b.height>this.positionAbs.top+this.offset.click.top)&&d;var d=this._getDragVerticalDirection(),h=this._getDragHorizontalDirection();return b?this.floating?h&&"right"===h||"down"===d?2:1:d&&("down"===
d?2:1):!1},_intersectsWithSides:function(b){var d=this.positionAbs.top+this.offset.click.top>b.top+b.height/2&&b.top+b.height/2+b.height>this.positionAbs.top+this.offset.click.top;b=this.positionAbs.left+this.offset.click.left>b.left+b.width/2&&b.left+b.width/2+b.width>this.positionAbs.left+this.offset.click.left;var h=this._getDragVerticalDirection(),k=this._getDragHorizontalDirection();return this.floating&&k?"right"===k&&b||"left"===k&&!b:h&&("down"===h&&d||"up"===h&&!d)},_getDragVerticalDirection:function(){var b=
this.positionAbs.top-this.lastPositionAbs.top;return 0!==b&&(0<b?"down":"up")},_getDragHorizontalDirection:function(){var b=this.positionAbs.left-this.lastPositionAbs.left;return 0!==b&&(0<b?"right":"left")},refresh:function(b){return this._refreshItems(b),this.refreshPositions(),this},_connectWith:function(){var b=this.options;return b.connectWith.constructor===String?[b.connectWith]:b.connectWith},_getItemsAsjQuery:function(d){var f,h,k,l=[],m=[],n=this._connectWith();if(n&&d)for(d=n.length-1;0<=
d;d--){h=b(n[d]);for(f=h.length-1;0<=f;f--)(k=b.data(h[f],this.widgetFullName))&&k!==this&&!k.options.disabled&&m.push([b.isFunction(k.options.items)?k.options.items.call(k.element):b(k.options.items,k.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),k])}m.push([b.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):b(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);
for(d=m.length-1;0<=d;d--)m[d][0].each(function(){l.push(this)});return b(l)},_removeCurrentsFromItems:function(){var d=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=b.grep(this.items,function(b){for(var h=0;d.length>h;h++)if(d[h]===b.item[0])return!1;return!0})},_refreshItems:function(d){this.items=[];this.containers=[this];var f,h,k,l,m,n=this.items,p=[[b.isFunction(this.options.items)?this.options.items.call(this.element[0],d,{item:this.currentItem}):b(this.options.items,
this.element),this]];if((m=this._connectWith())&&this.ready)for(f=m.length-1;0<=f;f--){k=b(m[f]);for(h=k.length-1;0<=h;h--)(l=b.data(k[h],this.widgetFullName))&&l!==this&&!l.options.disabled&&(p.push([b.isFunction(l.options.items)?l.options.items.call(l.element[0],d,{item:this.currentItem}):b(l.options.items,l.element),l]),this.containers.push(l))}for(f=p.length-1;0<=f;f--){d=p[f][1];k=p[f][0];h=0;for(m=k.length;m>h;h++)l=b(k[h]),l.data(this.widgetName+"-item",d),n.push({item:l,instance:d,width:0,
height:0,left:0,top:0})}},refreshPositions:function(d){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var f,h,k,l;for(f=this.items.length-1;0<=f;f--)h=this.items[f],h.instance!==this.currentContainer&&this.currentContainer&&h.item[0]!==this.currentItem[0]||(k=this.options.toleranceElement?b(this.options.toleranceElement,h.item):h.item,d||(h.width=k.outerWidth(),h.height=k.outerHeight()),l=k.offset(),h.left=l.left,h.top=l.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);
else for(f=this.containers.length-1;0<=f;f--)l=this.containers[f].element.offset(),this.containers[f].containerCache.left=l.left,this.containers[f].containerCache.top=l.top,this.containers[f].containerCache.width=this.containers[f].element.outerWidth(),this.containers[f].containerCache.height=this.containers[f].element.outerHeight();return this},_createPlaceholder:function(d){d=d||this;var f,h=d.options;h.placeholder&&h.placeholder.constructor!==String||(f=h.placeholder,h.placeholder={element:function(){var h=
d.currentItem[0].nodeName.toLowerCase(),l=b("<"+h+">",d.document[0]).addClass(f||d.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return"tr"===h?d.currentItem.children().each(function(){b("<td>&#160;</td>",d.document[0]).attr("colspan",b(this).attr("colspan")||1).appendTo(l)}):"img"===h&&l.attr("src",d.currentItem.attr("src")),f||l.css("visibility","hidden"),l},update:function(b,l){(!f||h.forcePlaceholderSize)&&(l.height()||l.height(d.currentItem.innerHeight()-
parseInt(d.currentItem.css("paddingTop")||0,10)-parseInt(d.currentItem.css("paddingBottom")||0,10)),l.width()||l.width(d.currentItem.innerWidth()-parseInt(d.currentItem.css("paddingLeft")||0,10)-parseInt(d.currentItem.css("paddingRight")||0,10)))}});d.placeholder=b(h.placeholder.element.call(d.element,d.currentItem));d.currentItem.after(d.placeholder);h.placeholder.update(d,d.placeholder)},_contactContainers:function(e){var f,h,k,l,m,n,p,r,s,t=h=null;for(f=this.containers.length-1;0<=f;f--)if(!b.contains(this.currentItem[0],
this.containers[f].element[0]))if(this._intersectsWith(this.containers[f].containerCache)){if(!h||!b.contains(this.containers[f].element[0],h.element[0]))h=this.containers[f],t=f}else this.containers[f].containerCache.over&&(this.containers[f]._trigger("out",e,this._uiHash(this)),this.containers[f].containerCache.over=0);if(h)if(1===this.containers.length)this.containers[t].containerCache.over||(this.containers[t]._trigger("over",e,this._uiHash(this)),this.containers[t].containerCache.over=1);else{f=
1E4;k=null;l=(s=h.floating||d(this.currentItem))?"left":"top";m=s?"width":"height";n=this.positionAbs[l]+this.offset.click[l];for(h=this.items.length-1;0<=h;h--)b.contains(this.containers[t].element[0],this.items[h].item[0])&&this.items[h].item[0]!==this.currentItem[0]&&(!s||this.positionAbs.top+this.offset.click.top>this.items[h].top&&this.items[h].top+this.items[h].height>this.positionAbs.top+this.offset.click.top)&&(p=this.items[h].item.offset()[l],r=!1,Math.abs(p-n)>Math.abs(p+this.items[h][m]-
n)&&(r=!0,p+=this.items[h][m]),f>Math.abs(p-n)&&(f=Math.abs(p-n),k=this.items[h],this.direction=r?"up":"down"));if((k||this.options.dropOnEmpty)&&this.currentContainer!==this.containers[t])k?this._rearrange(e,k,null,!0):this._rearrange(e,null,this.containers[t].element,!0),this._trigger("change",e,this._uiHash()),this.containers[t]._trigger("change",e,this._uiHash(this)),this.currentContainer=this.containers[t],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[t]._trigger("over",
e,this._uiHash(this)),this.containers[t].containerCache.over=1}},_createHelper:function(d){var f=this.options;d=b.isFunction(f.helper)?b(f.helper.apply(this.element[0],[d,this.currentItem])):"clone"===f.helper?this.currentItem.clone():this.currentItem;return d.parents("body").length||b("parent"!==f.appendTo?f.appendTo:this.currentItem[0].parentNode)[0].appendChild(d[0]),d[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),
top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!d[0].style.width||f.forceHelperSize)&&d.width(this.currentItem.width()),(!d[0].style.height||f.forceHelperSize)&&d.height(this.currentItem.height()),d},_adjustOffsetFromHelper:function(d){"string"==typeof d&&(d=d.split(" "));b.isArray(d)&&(d={left:+d[0],top:+d[1]||0});"left"in d&&(this.offset.click.left=d.left+this.margins.left);"right"in d&&(this.offset.click.left=this.helperProportions.width-d.right+this.margins.left);"top"in
d&&(this.offset.click.top=d.top+this.margins.top);"bottom"in d&&(this.offset.click.top=this.helperProportions.height-d.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var d=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&b.contains(this.scrollParent[0],this.offsetParent[0])&&(d.left+=this.scrollParent.scrollLeft(),d.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&
"html"===this.offsetParent[0].tagName.toLowerCase()&&b.ui.ie)&&(d={top:0,left:0}),{top:d.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:d.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var b=this.currentItem.position();return{top:b.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:b.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,
left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var d,f,h,k=this.options;"parent"===k.containment&&(k.containment=this.helper[0].parentNode);("document"===k.containment||"window"===k.containment)&&(this.containment=[0-this.offset.relative.left-
this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,b("document"===k.containment?document:window).width()-this.helperProportions.width-this.margins.left,(b("document"===k.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]);/^(document|window|parent)$/.test(k.containment)||(d=b(k.containment)[0],f=b(k.containment).offset(),h="hidden"!==b(d).css("overflow"),this.containment=[f.left+(parseInt(b(d).css("borderLeftWidth"),
10)||0)+(parseInt(b(d).css("paddingLeft"),10)||0)-this.margins.left,f.top+(parseInt(b(d).css("borderTopWidth"),10)||0)+(parseInt(b(d).css("paddingTop"),10)||0)-this.margins.top,f.left+(h?Math.max(d.scrollWidth,d.offsetWidth):d.offsetWidth)-(parseInt(b(d).css("borderLeftWidth"),10)||0)-(parseInt(b(d).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,f.top+(h?Math.max(d.scrollHeight,d.offsetHeight):d.offsetHeight)-(parseInt(b(d).css("borderTopWidth"),10)||0)-(parseInt(b(d).css("paddingBottom"),
10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(d,f){f||(f=this.position);var h="absolute"===d?1:-1,k="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&b.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,l=/(html|body)/i.test(k[0].tagName);return{top:f.top+this.offset.relative.top*h+this.offset.parent.top*h-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():l?0:k.scrollTop())*h,left:f.left+this.offset.relative.left*
h+this.offset.parent.left*h-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():l?0:k.scrollLeft())*h}},_generatePosition:function(d){var f,h,k=this.options,l=d.pageX,m=d.pageY,n="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&b.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,p=/(html|body)/i.test(n[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==document&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=
this._getRelativeOffset()),this.originalPosition&&(this.containment&&(d.pageX-this.offset.click.left<this.containment[0]&&(l=this.containment[0]+this.offset.click.left),d.pageY-this.offset.click.top<this.containment[1]&&(m=this.containment[1]+this.offset.click.top),d.pageX-this.offset.click.left>this.containment[2]&&(l=this.containment[2]+this.offset.click.left),d.pageY-this.offset.click.top>this.containment[3]&&(m=this.containment[3]+this.offset.click.top)),k.grid&&(f=this.originalPageY+Math.round((m-
this.originalPageY)/k.grid[1])*k.grid[1],m=this.containment?f-this.offset.click.top>=this.containment[1]&&f-this.offset.click.top<=this.containment[3]?f:f-this.offset.click.top>=this.containment[1]?f-k.grid[1]:f+k.grid[1]:f,h=this.originalPageX+Math.round((l-this.originalPageX)/k.grid[0])*k.grid[0],l=this.containment?h-this.offset.click.left>=this.containment[0]&&h-this.offset.click.left<=this.containment[2]?h:h-this.offset.click.left>=this.containment[0]?h-k.grid[0]:h+k.grid[0]:h)),{top:m-this.offset.click.top-
this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():p?0:n.scrollTop()),left:l-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():p?0:n.scrollLeft())}},_rearrange:function(b,d,h,k){h?h[0].appendChild(this.placeholder[0]):d.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?d.item[0]:d.item[0].nextSibling);var l=this.counter=this.counter?++this.counter:
1;this._delay(function(){l===this.counter&&this.refreshPositions(!k)})},_clear:function(b,d){this.reverting=!1;var h,k=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(h in this._storedCSS)("auto"===this._storedCSS[h]||"static"===this._storedCSS[h])&&(this._storedCSS[h]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();this.fromOutside&&
!d&&k.push(function(b){this._trigger("receive",b,this._uiHash(this.fromOutside))});!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||d||k.push(function(b){this._trigger("update",b,this._uiHash())});this!==this.currentContainer&&(d||(k.push(function(b){this._trigger("remove",b,this._uiHash())}),k.push(function(b){return function(d){b._trigger("receive",d,this._uiHash(this))}}.call(this,this.currentContainer)),
k.push(function(b){return function(d){b._trigger("update",d,this._uiHash(this))}}.call(this,this.currentContainer))));for(h=this.containers.length-1;0<=h;h--)d||k.push(function(b){return function(d){b._trigger("deactivate",d,this._uiHash(this))}}.call(this,this.containers[h])),this.containers[h].containerCache.over&&(k.push(function(b){return function(d){b._trigger("out",d,this._uiHash(this))}}.call(this,this.containers[h])),this.containers[h].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",
this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,this.cancelHelperRemoval){if(!d){this._trigger("beforeStop",b,this._uiHash());for(h=0;k.length>h;h++)k[h].call(this,b);this._trigger("stop",b,this._uiHash())}return this.fromOutside=!1,!1}if(d||this._trigger("beforeStop",b,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),
this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null,!d){for(h=0;k.length>h;h++)k[h].call(this,b);this._trigger("stop",b,this._uiHash())}return this.fromOutside=!1,!0},_trigger:function(){!1===b.Widget.prototype._trigger.apply(this,arguments)&&this.cancel()},_uiHash:function(d){var f=d||this;return{helper:f.helper,placeholder:f.placeholder||b([]),position:f.position,originalPosition:f.originalPosition,offset:f.positionAbs,item:f.currentItem,sender:d?d.element:null}}})})(jQuery);
(function(b){var d=0,e={},f={};e.height=e.paddingTop=e.paddingBottom=e.borderTopWidth=e.borderBottomWidth="hide";f.height=f.paddingTop=f.paddingBottom=f.borderTopWidth=f.borderBottomWidth="show";b.widget("ui.accordion",{version:"1.10.3",options:{active:0,animate:{},collapsible:!1,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},_create:function(){var d=this.options;
this.prevShow=this.prevHide=b();this.element.addClass("ui-accordion ui-widget ui-helper-reset").attr("role","tablist");d.collapsible||!1!==d.active&&null!=d.active||(d.active=0);this._processPanels();0>d.active&&(d.active+=this.headers.length);this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:this.active.length?this.active.next():b(),content:this.active.length?this.active.next():b()}},_createIcons:function(){var d=this.options.icons;d&&(b("<span>").addClass("ui-accordion-header-icon ui-icon "+
d.header).prependTo(this.headers),this.active.children(".ui-accordion-header-icon").removeClass(d.header).addClass(d.activeHeader),this.headers.addClass("ui-accordion-icons"))},_destroyIcons:function(){this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove()},_destroy:function(){var b;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role");this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-helper-reset ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").each(function(){/^ui-accordion/.test(this.id)&&
this.removeAttribute("id")});this._destroyIcons();b=this.headers.next().css("display","").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled").each(function(){/^ui-accordion/.test(this.id)&&this.removeAttribute("id")});"content"!==this.options.heightStyle&&b.css("height","")},_setOption:function(b,d){return"active"===
b?(this._activate(d),void 0):("event"===b&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(d)),this._super(b,d),"collapsible"!==b||d||!1!==this.options.active||this._activate(0),"icons"===b&&(this._destroyIcons(),d&&this._createIcons()),"disabled"===b&&this.headers.add(this.headers.next()).toggleClass("ui-state-disabled",!!d),void 0)},_keydown:function(d){if(!d.altKey&&!d.ctrlKey){var e=b.ui.keyCode,f=this.headers.length,m=this.headers.index(d.target),n=!1;switch(d.keyCode){case e.RIGHT:case e.DOWN:n=
this.headers[(m+1)%f];break;case e.LEFT:case e.UP:n=this.headers[(m-1+f)%f];break;case e.SPACE:case e.ENTER:this._eventHandler(d);break;case e.HOME:n=this.headers[0];break;case e.END:n=this.headers[f-1]}n&&(b(d.target).attr("tabIndex",-1),b(n).attr("tabIndex",0),n.focus(),d.preventDefault())}},_panelKeyDown:function(d){d.keyCode===b.ui.keyCode.UP&&d.ctrlKey&&b(d.currentTarget).prev().focus()},refresh:function(){var d=this.options;this._processPanels();!1===d.active&&!0===d.collapsible||!this.headers.length?
(d.active=!1,this.active=b()):!1===d.active?this._activate(0):this.active.length&&!b.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(".ui-state-disabled").length?(d.active=!1,this.active=b()):this._activate(Math.max(0,d.active-1)):d.active=this.headers.index(this.active);this._destroyIcons();this._refresh()},_processPanels:function(){this.headers=this.element.find(this.options.header).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all");this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").filter(":not(.ui-accordion-content-active)").hide()},
_refresh:function(){var e,f=this.options,l=f.heightStyle,m=this.element.parent(),n=this.accordionId="ui-accordion-"+(this.element.attr("id")||++d);this.active=this._findActive(f.active).addClass("ui-accordion-header-active ui-state-active ui-corner-top").removeClass("ui-corner-all");this.active.next().addClass("ui-accordion-content-active").show();this.headers.attr("role","tab").each(function(d){var e=b(this),f=e.attr("id"),h=e.next(),l=h.attr("id");f||(f=n+"-header-"+d,e.attr("id",f));l||(l=n+"-panel-"+
d,h.attr("id",l));e.attr("aria-controls",l);h.attr("aria-labelledby",f)}).next().attr("role","tabpanel");this.headers.not(this.active).attr({"aria-selected":"false",tabIndex:-1}).next().attr({"aria-expanded":"false","aria-hidden":"true"}).hide();this.active.length?this.active.attr({"aria-selected":"true",tabIndex:0}).next().attr({"aria-expanded":"true","aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0);this._createIcons();this._setupEvents(f.event);"fill"===l?(e=m.height(),this.element.siblings(":visible").each(function(){var d=
b(this),f=d.css("position");"absolute"!==f&&"fixed"!==f&&(e-=d.outerHeight(!0))}),this.headers.each(function(){e-=b(this).outerHeight(!0)}),this.headers.next().each(function(){b(this).height(Math.max(0,e-b(this).innerHeight()+b(this).height()))}).css("overflow","auto")):"auto"===l&&(e=0,this.headers.next().each(function(){e=Math.max(e,b(this).css("height","").height())}).height(e))},_activate:function(d){d=this._findActive(d)[0];d!==this.active[0]&&(d=d||this.active[0],this._eventHandler({target:d,
currentTarget:d,preventDefault:b.noop}))},_findActive:function(d){return"number"==typeof d?this.headers.eq(d):b()},_setupEvents:function(d){var e={keydown:"_keydown"};d&&b.each(d.split(" "),function(b,d){e[d]="_eventHandler"});this._off(this.headers.add(this.headers.next()));this._on(this.headers,e);this._on(this.headers.next(),{keydown:"_panelKeyDown"});this._hoverable(this.headers);this._focusable(this.headers)},_eventHandler:function(d){var e=this.options,f=this.active,m=b(d.currentTarget),n=m[0]===
f[0],p=n&&e.collapsible,r=p?b():m.next(),s=f.next(),r={oldHeader:f,oldPanel:s,newHeader:p?b():m,newPanel:r};d.preventDefault();n&&!e.collapsible||!1===this._trigger("beforeActivate",d,r)||(e.active=p?!1:this.headers.index(m),this.active=n?b():m,this._toggle(r),f.removeClass("ui-accordion-header-active ui-state-active"),e.icons&&f.children(".ui-accordion-header-icon").removeClass(e.icons.activeHeader).addClass(e.icons.header),n||(m.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top"),
e.icons&&m.children(".ui-accordion-header-icon").removeClass(e.icons.header).addClass(e.icons.activeHeader),m.next().addClass("ui-accordion-content-active")))},_toggle:function(d){var e=d.newPanel,f=this.prevShow.length?this.prevShow:d.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0);this.prevShow=e;this.prevHide=f;this.options.animate?this._animate(e,f,d):(f.hide(),e.show(),this._toggleComplete(d));f.attr({"aria-expanded":"false","aria-hidden":"true"});f.prev().attr("aria-selected","false");
e.length&&f.length?f.prev().attr("tabIndex",-1):e.length&&this.headers.filter(function(){return 0===b(this).attr("tabIndex")}).attr("tabIndex",-1);e.attr({"aria-expanded":"true","aria-hidden":"false"}).prev().attr({"aria-selected":"true",tabIndex:0})},_animate:function(b,d,l){var m,n,p,r=this,s=0,t=b.length&&(!d.length||b.index()<d.index()),u=this.options.animate||{},t=t&&u.down||u,w=function(){r._toggleComplete(l)};return"number"==typeof t&&(p=t),"string"==typeof t&&(n=t),n=n||t.easing||u.easing,
p=p||t.duration||u.duration,d.length?b.length?(m=b.show().outerHeight(),d.animate(e,{duration:p,easing:n,step:function(b,d){d.now=Math.round(b)}}),b.hide().animate(f,{duration:p,easing:n,complete:w,step:function(b,e){e.now=Math.round(b);"height"!==e.prop?s+=e.now:"content"!==r.options.heightStyle&&(e.now=Math.round(m-d.outerHeight()-s),s=0)}}),void 0):d.animate(e,p,n,w):b.animate(f,p,n,w)},_toggleComplete:function(b){var d=b.oldPanel;d.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all");
d.length&&(d.parent()[0].className=d.parent()[0].className);this._trigger("activate",null,b)}})})(jQuery);
(function(b){var d=0;b.widget("ui.autocomplete",{version:"1.10.3",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},pending:0,_create:function(){var d,f,h,k=this.element[0].nodeName.toLowerCase(),l="textarea"===k,k="input"===k;this.isMultiLine=l?!0:k?!1:this.element.prop("isContentEditable");this.valueMethod=this.element[l||
k?"val":"text"];this.isNewMenu=!0;this.element.addClass("ui-autocomplete-input").attr("autocomplete","off");this._on(this.element,{keydown:function(l){if(this.element.prop("readOnly"))return d=!0,h=!0,f=!0,void 0;f=h=d=!1;var k=b.ui.keyCode;switch(l.keyCode){case k.PAGE_UP:d=!0;this._move("previousPage",l);break;case k.PAGE_DOWN:d=!0;this._move("nextPage",l);break;case k.UP:d=!0;this._keyEvent("previous",l);break;case k.DOWN:d=!0;this._keyEvent("next",l);break;case k.ENTER:case k.NUMPAD_ENTER:this.menu.active&&
(d=!0,l.preventDefault(),this.menu.select(l));break;case k.TAB:this.menu.active&&this.menu.select(l);break;case k.ESCAPE:this.menu.element.is(":visible")&&(this._value(this.term),this.close(l),l.preventDefault());break;default:f=!0,this._searchTimeout(l)}},keypress:function(h){if(d)return d=!1,(!this.isMultiLine||this.menu.element.is(":visible"))&&h.preventDefault(),void 0;if(!f){var l=b.ui.keyCode;switch(h.keyCode){case l.PAGE_UP:this._move("previousPage",h);break;case l.PAGE_DOWN:this._move("nextPage",
h);break;case l.UP:this._keyEvent("previous",h);break;case l.DOWN:this._keyEvent("next",h)}}},input:function(b){return h?(h=!1,b.preventDefault(),void 0):(this._searchTimeout(b),void 0)},focus:function(){this.selectedItem=null;this.previous=this._value()},blur:function(b){return this.cancelBlur?(delete this.cancelBlur,void 0):(clearTimeout(this.searching),this.close(b),this._change(b),void 0)}});this._initSource();this.menu=b("<ul>").addClass("ui-autocomplete ui-front").appendTo(this._appendTo()).menu({role:null}).hide().data("ui-menu");
this._on(this.menu.element,{mousedown:function(d){d.preventDefault();this.cancelBlur=!0;this._delay(function(){delete this.cancelBlur});var e=this.menu.element[0];b(d.target).closest(".ui-menu-item").length||this._delay(function(){var d=this;this.document.one("mousedown",function(f){f.target===d.element[0]||f.target===e||b.contains(e,f.target)||d.close()})})},menufocus:function(d,e){if(this.isNewMenu&&(this.isNewMenu=!1,d.originalEvent&&/^mouse/.test(d.originalEvent.type)))return this.menu.blur(),
this.document.one("mousemove",function(){b(d.target).trigger(d.originalEvent)}),void 0;var f=e.item.data("ui-autocomplete-item");!1!==this._trigger("focus",d,{item:f})?d.originalEvent&&/^key/.test(d.originalEvent.type)&&this._value(f.value):this.liveRegion.text(f.value)},menuselect:function(b,d){var e=d.item.data("ui-autocomplete-item"),f=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=f,this._delay(function(){this.previous=f;this.selectedItem=e}));
!1!==this._trigger("select",b,{item:e})&&this._value(e.value);this.term=this._value();this.close(b);this.selectedItem=e}});this.liveRegion=b("<span>",{role:"status","aria-live":"polite"}).addClass("ui-helper-hidden-accessible").insertBefore(this.element);this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching);this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete");this.menu.element.remove();this.liveRegion.remove()},
_setOption:function(b,d){this._super(b,d);"source"===b&&this._initSource();"appendTo"===b&&this.menu.element.appendTo(this._appendTo());"disabled"===b&&d&&this.xhr&&this.xhr.abort()},_appendTo:function(){var d=this.options.appendTo;return d&&(d=d.jquery||d.nodeType?b(d):this.document.find(d).eq(0)),d||(d=this.element.closest(".ui-front")),d.length||(d=this.document[0].body),d},_initSource:function(){var d,f,h=this;b.isArray(this.options.source)?(d=this.options.source,this.source=function(f,h){h(b.ui.autocomplete.filter(d,
f.term))}):"string"==typeof this.options.source?(f=this.options.source,this.source=function(d,e){h.xhr&&h.xhr.abort();h.xhr=b.ajax({url:f,data:d,dataType:"json",success:function(b){e(b)},error:function(){e([])}})}):this.source=this.options.source},_searchTimeout:function(b){clearTimeout(this.searching);this.searching=this._delay(function(){this.term!==this._value()&&(this.selectedItem=null,this.search(null,b))},this.options.delay)},search:function(b,d){return b=null!=b?b:this._value(),this.term=this._value(),
b.length<this.options.minLength?this.close(d):!1!==this._trigger("search",d)?this._search(b):void 0},_search:function(b){this.pending++;this.element.addClass("ui-autocomplete-loading");this.cancelSearch=!1;this.source({term:b},this._response())},_response:function(){var b=this,f=++d;return function(h){f===d&&b.__response(h);b.pending--;b.pending||b.element.removeClass("ui-autocomplete-loading")}},__response:function(b){b&&(b=this._normalize(b));this._trigger("response",null,{content:b});!this.options.disabled&&
b&&b.length&&!this.cancelSearch?(this._suggest(b),this._trigger("open")):this._close()},close:function(b){this.cancelSearch=!0;this._close(b)},_close:function(b){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",b))},_change:function(b){this.previous!==this._value()&&this._trigger("change",b,{item:this.selectedItem})},_normalize:function(d){return d.length&&d[0].label&&d[0].value?d:b.map(d,function(d){return"string"==typeof d?{label:d,
value:d}:b.extend({label:d.label||d.value,value:d.value||d.label},d)})},_suggest:function(d){var f=this.menu.element.empty();this._renderMenu(f,d);this.isNewMenu=!0;this.menu.refresh();f.show();this._resizeMenu();f.position(b.extend({of:this.element},this.options.position));this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var b=this.menu.element;b.outerWidth(Math.max(b.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(d,f){var h=this;b.each(f,function(b,f){h._renderItemData(d,
f)})},_renderItemData:function(b,d){return this._renderItem(b,d).data("ui-autocomplete-item",d)},_renderItem:function(d,f){return b("<li>").append(b("<a>").text(f.label)).appendTo(d)},_move:function(b,d){return this.menu.element.is(":visible")?this.menu.isFirstItem()&&/^previous/.test(b)||this.menu.isLastItem()&&/^next/.test(b)?(this._value(this.term),this.menu.blur(),void 0):(this.menu[b](d),void 0):(this.search(null,d),void 0)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,
arguments)},_keyEvent:function(b,d){(!this.isMultiLine||this.menu.element.is(":visible"))&&(this._move(b,d),d.preventDefault())}});b.extend(b.ui.autocomplete,{escapeRegex:function(b){return b.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(d,f){var h=RegExp(b.ui.autocomplete.escapeRegex(f),"i");return b.grep(d,function(b){return h.test(b.label||b.value||b)})}});b.widget("ui.autocomplete",b.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(b){return b+
(1<b?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(b){var d;this._superApply(arguments);this.options.disabled||this.cancelSearch||(d=b&&b.length?this.options.messages.results(b.length):this.options.messages.noResults,this.liveRegion.text(d))}})})(jQuery);
(function(b){var d,e,f,h,k=function(){var d=b(this);setTimeout(function(){d.find(":ui-button").button("refresh")},1)},l=function(d){var e=d.name,f=d.form,h=b([]);return e&&(e=e.replace(/'/g,"\\'"),h=f?b(f).find("[name='"+e+"']"):b("[name='"+e+"']",d.ownerDocument).filter(function(){return!this.form})),h};b.widget("ui.button",{version:"1.10.3",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+
this.eventNamespace).bind("reset"+this.eventNamespace,k);"boolean"!=typeof this.options.disabled?this.options.disabled=!!this.element.prop("disabled"):this.element.prop("disabled",this.options.disabled);this._determineButtonType();this.hasTitle=!!this.buttonElement.attr("title");var m=this,n=this.options,p="checkbox"===this.type||"radio"===this.type,r=p?"":"ui-state-active";null===n.label&&(n.label="input"===this.type?this.buttonElement.val():this.buttonElement.html());this._hoverable(this.buttonElement);
this.buttonElement.addClass("ui-button ui-widget ui-state-default ui-corner-all").attr("role","button").bind("mouseenter"+this.eventNamespace,function(){n.disabled||this===d&&b(this).addClass("ui-state-active")}).bind("mouseleave"+this.eventNamespace,function(){n.disabled||b(this).removeClass(r)}).bind("click"+this.eventNamespace,function(b){n.disabled&&(b.preventDefault(),b.stopImmediatePropagation())});this.element.bind("focus"+this.eventNamespace,function(){m.buttonElement.addClass("ui-state-focus")}).bind("blur"+
this.eventNamespace,function(){m.buttonElement.removeClass("ui-state-focus")});p&&(this.element.bind("change"+this.eventNamespace,function(){h||m.refresh()}),this.buttonElement.bind("mousedown"+this.eventNamespace,function(b){n.disabled||(h=!1,e=b.pageX,f=b.pageY)}).bind("mouseup"+this.eventNamespace,function(b){n.disabled||(e!==b.pageX||f!==b.pageY)&&(h=!0)}));"checkbox"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){return n.disabled||h?!1:void 0}):"radio"===this.type?
this.buttonElement.bind("click"+this.eventNamespace,function(){if(n.disabled||h)return!1;b(this).addClass("ui-state-active");m.buttonElement.attr("aria-pressed","true");var d=m.element[0];l(d).not(d).map(function(){return b(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown"+this.eventNamespace,function(){return n.disabled?!1:(b(this).addClass("ui-state-active"),d=this,m.document.one("mouseup",function(){d=null}),void 0)}).bind("mouseup"+
this.eventNamespace,function(){return n.disabled?!1:(b(this).removeClass("ui-state-active"),void 0)}).bind("keydown"+this.eventNamespace,function(d){return n.disabled?!1:((d.keyCode===b.ui.keyCode.SPACE||d.keyCode===b.ui.keyCode.ENTER)&&b(this).addClass("ui-state-active"),void 0)}).bind("keyup"+this.eventNamespace+" blur"+this.eventNamespace,function(){b(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(d){d.keyCode===b.ui.keyCode.SPACE&&b(this).click()}));
this._setOption("disabled",n.disabled);this._resetButton()},_determineButtonType:function(){var b,d,e;this.type=this.element.is("[type=checkbox]")?"checkbox":this.element.is("[type=radio]")?"radio":this.element.is("input")?"input":"button";"checkbox"===this.type||"radio"===this.type?(b=this.element.parents().last(),d="label[for='"+this.element.attr("id")+"']",this.buttonElement=b.find(d),this.buttonElement.length||(b=b.length?b.siblings():this.element.siblings(),this.buttonElement=b.filter(d),this.buttonElement.length||
(this.buttonElement=b.find(d))),this.element.addClass("ui-helper-hidden-accessible"),e=this.element.is(":checked"),e&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.prop("aria-pressed",e)):this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible");this.buttonElement.removeClass("ui-button ui-widget ui-state-default ui-corner-all ui-state-hover ui-state-active  ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only").removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html());
this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(b,d){return this._super(b,d),"disabled"===b?(d?this.element.prop("disabled",!0):this.element.prop("disabled",!1),void 0):(this._resetButton(),void 0)},refresh:function(){var d=this.element.is("input, button")?this.element.is(":disabled"):this.element.hasClass("ui-button-disabled");d!==this.options.disabled&&this._setOption("disabled",d);"radio"===this.type?l(this.element[0]).each(function(){b(this).is(":checked")?b(this).button("widget").addClass("ui-state-active").attr("aria-pressed",
"true"):b(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}):"checkbox"===this.type&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if("input"===this.type)return this.options.label&&this.element.val(this.options.label),void 0;var d=this.buttonElement.removeClass("ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only"),
e=b("<span></span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(d.empty()).text(),f=this.options.icons,h=f.primary&&f.secondary,l=[];f.primary||f.secondary?(this.options.text&&l.push("ui-button-text-icon"+(h?"s":f.primary?"-primary":"-secondary")),f.primary&&d.prepend("<span class='ui-button-icon-primary ui-icon "+f.primary+"'></span>"),f.secondary&&d.append("<span class='ui-button-icon-secondary ui-icon "+f.secondary+"'></span>"),this.options.text||(l.push(h?"ui-button-icons-only":
"ui-button-icon-only"),this.hasTitle||d.attr("title",b.trim(e)))):l.push("ui-button-text-only");d.addClass(l.join(" "))}});b.widget("ui.buttonset",{version:"1.10.3",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(ui-button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(b,d){"disabled"===b&&this.buttons.button("option",b,d);this._super(b,d)},refresh:function(){var d=
"rtl"===this.element.css("direction");this.buttons=this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function(){return b(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(d?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(d?"ui-corner-left":"ui-corner-right").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset");this.buttons.map(function(){return b(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}})})(jQuery);
(function(b,d){function e(){this._curInst=null;this._keyEvent=!1;this._disabledInputs=[];this._inDialog=this._datepickerShowing=!1;this._mainDivId="ui-datepicker-div";this._inlineClass="ui-datepicker-inline";this._appendClass="ui-datepicker-append";this._triggerClass="ui-datepicker-trigger";this._dialogClass="ui-datepicker-dialog";this._disableClass="ui-datepicker-disabled";this._unselectableClass="ui-datepicker-unselectable";this._currentClass="ui-datepicker-current-day";this._dayOverClass="ui-datepicker-days-cell-over";
this.regional=[];this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:"January February March April May June July August September October November December".split(" "),monthNamesShort:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),dayNames:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),dayNamesShort:"Sun Mon Tue Wed Thu Fri Sat".split(" "),dayNamesMin:"Su Mo Tu We Th Fr Sa".split(" "),weekHeader:"Wk",dateFormat:"mm/dd/yy",
firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""};this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,
onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1};b.extend(this._defaults,this.regional[""]);this.dpDiv=f(b("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function f(d){return d.delegate("button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a","mouseout",function(){b(this).removeClass("ui-state-hover");
-1!==this.className.indexOf("ui-datepicker-prev")&&b(this).removeClass("ui-datepicker-prev-hover");-1!==this.className.indexOf("ui-datepicker-next")&&b(this).removeClass("ui-datepicker-next-hover")}).delegate("button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a","mouseover",function(){b.datepicker._isDisabledDatepicker(k.inline?d.parent()[0]:k.input[0])||(b(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),b(this).addClass("ui-state-hover"),
-1!==this.className.indexOf("ui-datepicker-prev")&&b(this).addClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&b(this).addClass("ui-datepicker-next-hover"))})}function h(d,e){b.extend(d,e);for(var f in e)null==e[f]&&(d[f]=e[f]);return d}b.extend(b.ui,{datepicker:{version:"1.10.3"}});var k;b.extend(e.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(b){return h(this._defaults,b||{}),this},_attachDatepicker:function(d,
e){var f,h,k;f=d.nodeName.toLowerCase();h="div"===f||"span"===f;d.id||(this.uuid+=1,d.id="dp"+this.uuid);k=this._newInst(b(d),h);k.settings=b.extend({},e||{});"input"===f?this._connectDatepicker(d,k):h&&this._inlineDatepicker(d,k)},_newInst:function(d,e){return{id:d[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1"),input:d,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:e,dpDiv:e?f(b("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):
this.dpDiv}},_connectDatepicker:function(d,e){var f=b(d);e.append=b([]);e.trigger=b([]);f.hasClass(this.markerClassName)||(this._attachments(f,e),f.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp),this._autoSize(e),b.data(d,"datepicker",e),e.settings.disabled&&this._disableDatepicker(d))},_attachments:function(d,e){var f,h,k;f=this._get(e,"appendText");var s=this._get(e,"isRTL");e.append&&e.append.remove();f&&(e.append=b("<span class='"+this._appendClass+
"'>"+f+"</span>"),d[s?"before":"after"](e.append));d.unbind("focus",this._showDatepicker);e.trigger&&e.trigger.remove();f=this._get(e,"showOn");("focus"===f||"both"===f)&&d.focus(this._showDatepicker);("button"===f||"both"===f)&&(h=this._get(e,"buttonText"),k=this._get(e,"buttonImage"),e.trigger=b(this._get(e,"buttonImageOnly")?b("<img/>").addClass(this._triggerClass).attr({src:k,alt:h,title:h}):b("<button type='button'></button>").addClass(this._triggerClass).html(k?b("<img/>").attr({src:k,alt:h,
title:h}):h)),d[s?"before":"after"](e.trigger),e.trigger.click(function(){return b.datepicker._datepickerShowing&&b.datepicker._lastInput===d[0]?b.datepicker._hideDatepicker():b.datepicker._datepickerShowing&&b.datepicker._lastInput!==d[0]?(b.datepicker._hideDatepicker(),b.datepicker._showDatepicker(d[0])):b.datepicker._showDatepicker(d[0]),!1}))},_autoSize:function(b){if(this._get(b,"autoSize")&&!b.inline){var d,e,f,h,k=new Date(2009,11,20),t=this._get(b,"dateFormat");t.match(/[DM]/)&&(d=function(b){for(h=
f=e=0;b.length>h;h++)b[h].length>e&&(e=b[h].length,f=h);return f},k.setMonth(d(this._get(b,t.match(/MM/)?"monthNames":"monthNamesShort"))),k.setDate(d(this._get(b,t.match(/DD/)?"dayNames":"dayNamesShort"))+20-k.getDay()));b.input.attr("size",this._formatDate(b,k).length)}},_inlineDatepicker:function(d,e){var f=b(d);f.hasClass(this.markerClassName)||(f.addClass(this.markerClassName).append(e.dpDiv),b.data(d,"datepicker",e),this._setDate(e,this._getDefaultDate(e),!0),this._updateDatepicker(e),this._updateAlternate(e),
e.settings.disabled&&this._disableDatepicker(d),e.dpDiv.css("display","block"))},_dialogDatepicker:function(d,e,f,k,r){var s,t,u,w,x;d=this._dialogInst;return d||(this.uuid+=1,s="dp"+this.uuid,this._dialogInput=b("<input type='text' id='"+s+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.keydown(this._doKeyDown),b("body").append(this._dialogInput),d=this._dialogInst=this._newInst(this._dialogInput,!1),d.settings={},b.data(this._dialogInput[0],"datepicker",d)),h(d.settings,
k||{}),e=e&&e.constructor===Date?this._formatDate(d,e):e,this._dialogInput.val(e),this._pos=r?r.length?r:[r.pageX,r.pageY]:null,this._pos||(t=document.documentElement.clientWidth,u=document.documentElement.clientHeight,w=document.documentElement.scrollLeft||document.body.scrollLeft,x=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[t/2-100+w,u/2-150+x]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),d.settings.onSelect=f,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),
this._showDatepicker(this._dialogInput[0]),b.blockUI&&b.blockUI(this.dpDiv),b.data(this._dialogInput[0],"datepicker",d),this},_destroyDatepicker:function(d){var e,f=b(d),h=b.data(d,"datepicker");f.hasClass(this.markerClassName)&&(e=d.nodeName.toLowerCase(),b.removeData(d,"datepicker"),"input"===e?(h.append.remove(),h.trigger.remove(),f.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):
("div"===e||"span"===e)&&f.removeClass(this.markerClassName).empty())},_enableDatepicker:function(d){var e,f,h=b(d),k=b.data(d,"datepicker");h.hasClass(this.markerClassName)&&(e=d.nodeName.toLowerCase(),"input"===e?(d.disabled=!1,k.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})):("div"===e||"span"===e)&&(f=h.children("."+this._inlineClass),f.children().removeClass("ui-state-disabled"),f.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",
!1)),this._disabledInputs=b.map(this._disabledInputs,function(b){return b===d?null:b}))},_disableDatepicker:function(d){var e,f,h=b(d),k=b.data(d,"datepicker");h.hasClass(this.markerClassName)&&(e=d.nodeName.toLowerCase(),"input"===e?(d.disabled=!0,k.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})):("div"===e||"span"===e)&&(f=h.children("."+this._inlineClass),f.children().addClass("ui-state-disabled"),f.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",
!0)),this._disabledInputs=b.map(this._disabledInputs,function(b){return b===d?null:b}),this._disabledInputs[this._disabledInputs.length]=d)},_isDisabledDatepicker:function(b){if(!b)return!1;for(var d=0;this._disabledInputs.length>d;d++)if(this._disabledInputs[d]===b)return!0;return!1},_getInst:function(d){try{return b.data(d,"datepicker")}catch(e){throw"Missing instance data for this datepicker";}},_optionDatepicker:function(e,f,k){var p,r,s,t,u=this._getInst(e);return 2===arguments.length&&"string"==
typeof f?"defaults"===f?b.extend({},b.datepicker._defaults):u?"all"===f?b.extend({},u.settings):this._get(u,f):null:(p=f||{},"string"==typeof f&&(p={},p[f]=k),u&&(this._curInst===u&&this._hideDatepicker(),r=this._getDateDatepicker(e,!0),s=this._getMinMaxDate(u,"min"),t=this._getMinMaxDate(u,"max"),h(u.settings,p),null!==s&&p.dateFormat!==d&&p.minDate===d&&(u.settings.minDate=this._formatDate(u,s)),null!==t&&p.dateFormat!==d&&p.maxDate===d&&(u.settings.maxDate=this._formatDate(u,t)),"disabled"in p&&
(p.disabled?this._disableDatepicker(e):this._enableDatepicker(e)),this._attachments(b(e),u),this._autoSize(u),this._setDate(u,r),this._updateAlternate(u),this._updateDatepicker(u)),d)},_changeDatepicker:function(b,d,e){this._optionDatepicker(b,d,e)},_refreshDatepicker:function(b){(b=this._getInst(b))&&this._updateDatepicker(b)},_setDateDatepicker:function(b,d){var e=this._getInst(b);e&&(this._setDate(e,d),this._updateDatepicker(e),this._updateAlternate(e))},_getDateDatepicker:function(b,d){var e=
this._getInst(b);return e&&!e.inline&&this._setDateFromField(e,d),e?this._getDate(e):null},_doKeyDown:function(d){var e,f,h,k=b.datepicker._getInst(d.target),s=!0,t=k.dpDiv.is(".ui-datepicker-rtl");if(k._keyEvent=!0,b.datepicker._datepickerShowing)switch(d.keyCode){case 9:b.datepicker._hideDatepicker();s=!1;break;case 13:return h=b("td."+b.datepicker._dayOverClass+":not(."+b.datepicker._currentClass+")",k.dpDiv),h[0]&&b.datepicker._selectDay(d.target,k.selectedMonth,k.selectedYear,h[0]),e=b.datepicker._get(k,
"onSelect"),e?(f=b.datepicker._formatDate(k),e.apply(k.input?k.input[0]:null,[f,k])):b.datepicker._hideDatepicker(),!1;case 27:b.datepicker._hideDatepicker();break;case 33:b.datepicker._adjustDate(d.target,d.ctrlKey?-b.datepicker._get(k,"stepBigMonths"):-b.datepicker._get(k,"stepMonths"),"M");break;case 34:b.datepicker._adjustDate(d.target,d.ctrlKey?+b.datepicker._get(k,"stepBigMonths"):+b.datepicker._get(k,"stepMonths"),"M");break;case 35:(d.ctrlKey||d.metaKey)&&b.datepicker._clearDate(d.target);
s=d.ctrlKey||d.metaKey;break;case 36:(d.ctrlKey||d.metaKey)&&b.datepicker._gotoToday(d.target);s=d.ctrlKey||d.metaKey;break;case 37:(d.ctrlKey||d.metaKey)&&b.datepicker._adjustDate(d.target,t?1:-1,"D");s=d.ctrlKey||d.metaKey;d.originalEvent.altKey&&b.datepicker._adjustDate(d.target,d.ctrlKey?-b.datepicker._get(k,"stepBigMonths"):-b.datepicker._get(k,"stepMonths"),"M");break;case 38:(d.ctrlKey||d.metaKey)&&b.datepicker._adjustDate(d.target,-7,"D");s=d.ctrlKey||d.metaKey;break;case 39:(d.ctrlKey||d.metaKey)&&
b.datepicker._adjustDate(d.target,t?-1:1,"D");s=d.ctrlKey||d.metaKey;d.originalEvent.altKey&&b.datepicker._adjustDate(d.target,d.ctrlKey?+b.datepicker._get(k,"stepBigMonths"):+b.datepicker._get(k,"stepMonths"),"M");break;case 40:(d.ctrlKey||d.metaKey)&&b.datepicker._adjustDate(d.target,7,"D");s=d.ctrlKey||d.metaKey;break;default:s=!1}else 36===d.keyCode&&d.ctrlKey?b.datepicker._showDatepicker(this):s=!1;s&&(d.preventDefault(),d.stopPropagation())},_doKeyPress:function(e){var f,h,k=b.datepicker._getInst(e.target);
return b.datepicker._get(k,"constrainInput")?(f=b.datepicker._possibleChars(b.datepicker._get(k,"dateFormat")),h=String.fromCharCode(null==e.charCode?e.keyCode:e.charCode),e.ctrlKey||e.metaKey||" ">h||!f||-1<f.indexOf(h)):d},_doKeyUp:function(d){var e;d=b.datepicker._getInst(d.target);if(d.input.val()!==d.lastVal)try{(e=b.datepicker.parseDate(b.datepicker._get(d,"dateFormat"),d.input?d.input.val():null,b.datepicker._getFormatConfig(d)))&&(b.datepicker._setDateFromField(d),b.datepicker._updateAlternate(d),
b.datepicker._updateDatepicker(d))}catch(f){}return!0},_showDatepicker:function(d){if(d=d.target||d,"input"!==d.nodeName.toLowerCase()&&(d=b("input",d.parentNode)[0]),!b.datepicker._isDisabledDatepicker(d)&&b.datepicker._lastInput!==d){var e,f,k,r,s,t;e=b.datepicker._getInst(d);b.datepicker._curInst&&b.datepicker._curInst!==e&&(b.datepicker._curInst.dpDiv.stop(!0,!0),e&&b.datepicker._datepickerShowing&&b.datepicker._hideDatepicker(b.datepicker._curInst.input[0]));f=(f=b.datepicker._get(e,"beforeShow"))?
f.apply(d,[d,e]):{};!1!==f&&(h(e.settings,f),e.lastVal=null,b.datepicker._lastInput=d,b.datepicker._setDateFromField(e),b.datepicker._inDialog&&(d.value=""),b.datepicker._pos||(b.datepicker._pos=b.datepicker._findPos(d),b.datepicker._pos[1]+=d.offsetHeight),k=!1,b(d).parents().each(function(){return k|="fixed"===b(this).css("position"),!k}),r={left:b.datepicker._pos[0],top:b.datepicker._pos[1]},b.datepicker._pos=null,e.dpDiv.empty(),e.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),
b.datepicker._updateDatepicker(e),r=b.datepicker._checkOffset(e,r,k),e.dpDiv.css({position:b.datepicker._inDialog&&b.blockUI?"static":k?"fixed":"absolute",display:"none",left:r.left+"px",top:r.top+"px"}),e.inline||(s=b.datepicker._get(e,"showAnim"),t=b.datepicker._get(e,"duration"),e.dpDiv.zIndex(b(d).zIndex()+1),b.datepicker._datepickerShowing=!0,b.effects&&b.effects.effect[s]?e.dpDiv.show(s,b.datepicker._get(e,"showOptions"),t):e.dpDiv[s||"show"](s?t:null),b.datepicker._shouldFocusInput(e)&&e.input.focus(),
b.datepicker._curInst=e))}},_updateDatepicker:function(d){this.maxRows=4;k=d;d.dpDiv.empty().append(this._generateHTML(d));this._attachHandlers(d);d.dpDiv.find("."+this._dayOverClass+" a").mouseover();var e,f=this._getNumberOfMonths(d),h=f[1];d.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width("");1<h&&d.dpDiv.addClass("ui-datepicker-multi-"+h).css("width",17*h+"em");d.dpDiv[(1!==f[0]||1!==f[1]?"add":"remove")+"Class"]("ui-datepicker-multi");d.dpDiv[(this._get(d,
"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl");d===b.datepicker._curInst&&b.datepicker._datepickerShowing&&b.datepicker._shouldFocusInput(d)&&d.input.focus();d.yearshtml&&(e=d.yearshtml,setTimeout(function(){e===d.yearshtml&&d.yearshtml&&d.dpDiv.find("select.ui-datepicker-year:first").replaceWith(d.yearshtml);e=d.yearshtml=null},0))},_shouldFocusInput:function(b){return b.input&&b.input.is(":visible")&&!b.input.is(":disabled")&&!b.input.is(":focus")},_checkOffset:function(d,e,f){var h=d.dpDiv.outerWidth(),
k=d.dpDiv.outerHeight(),s=d.input?d.input.outerWidth():0,t=d.input?d.input.outerHeight():0,u=document.documentElement.clientWidth+(f?0:b(document).scrollLeft()),w=document.documentElement.clientHeight+(f?0:b(document).scrollTop());return e.left-=this._get(d,"isRTL")?h-s:0,e.left-=f&&e.left===d.input.offset().left?b(document).scrollLeft():0,e.top-=f&&e.top===d.input.offset().top+t?b(document).scrollTop():0,e.left-=Math.min(e.left,e.left+h>u&&u>h?Math.abs(e.left+h-u):0),e.top-=Math.min(e.top,e.top+
k>w&&w>k?Math.abs(k+t):0),e},_findPos:function(d){for(var e,f=this._getInst(d),f=this._get(f,"isRTL");d&&("hidden"===d.type||1!==d.nodeType||b.expr.filters.hidden(d));)d=d[f?"previousSibling":"nextSibling"];return e=b(d).offset(),[e.left,e.top]},_hideDatepicker:function(d){var e,f,h,k,s=this._curInst;!s||d&&s!==b.data(d,"datepicker")||this._datepickerShowing&&(e=this._get(s,"showAnim"),f=this._get(s,"duration"),h=function(){b.datepicker._tidyDialog(s)},b.effects&&(b.effects.effect[e]||b.effects[e])?
s.dpDiv.hide(e,b.datepicker._get(s,"showOptions"),f,h):s.dpDiv["slideDown"===e?"slideUp":"fadeIn"===e?"fadeOut":"hide"](e?f:null,h),e||h(),this._datepickerShowing=!1,k=this._get(s,"onClose"),k&&k.apply(s.input?s.input[0]:null,[s.input?s.input.val():"",s]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),b.blockUI&&(b.unblockUI(),b("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(b){b.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},
_checkExternalClick:function(d){if(b.datepicker._curInst){d=b(d.target);var e=b.datepicker._getInst(d[0]);(d[0].id!==b.datepicker._mainDivId&&0===d.parents("#"+b.datepicker._mainDivId).length&&!d.hasClass(b.datepicker.markerClassName)&&!d.closest("."+b.datepicker._triggerClass).length&&b.datepicker._datepickerShowing&&(!b.datepicker._inDialog||!b.blockUI)||d.hasClass(b.datepicker.markerClassName)&&b.datepicker._curInst!==e)&&b.datepicker._hideDatepicker()}},_adjustDate:function(d,e,f){d=b(d);var h=
this._getInst(d[0]);this._isDisabledDatepicker(d[0])||(this._adjustInstDate(h,e+("M"===f?this._get(h,"showCurrentAtPos"):0),f),this._updateDatepicker(h))},_gotoToday:function(d){var e;d=b(d);var f=this._getInst(d[0]);this._get(f,"gotoCurrent")&&f.currentDay?(f.selectedDay=f.currentDay,f.drawMonth=f.selectedMonth=f.currentMonth,f.drawYear=f.selectedYear=f.currentYear):(e=new Date,f.selectedDay=e.getDate(),f.drawMonth=f.selectedMonth=e.getMonth(),f.drawYear=f.selectedYear=e.getFullYear());this._notifyChange(f);
this._adjustDate(d)},_selectMonthYear:function(d,e,f){d=b(d);var h=this._getInst(d[0]);h["selected"+("M"===f?"Month":"Year")]=h["draw"+("M"===f?"Month":"Year")]=parseInt(e.options[e.selectedIndex].value,10);this._notifyChange(h);this._adjustDate(d)},_selectDay:function(d,e,f,h){var k,s=b(d);b(h).hasClass(this._unselectableClass)||this._isDisabledDatepicker(s[0])||(k=this._getInst(s[0]),k.selectedDay=k.currentDay=b("a",h).html(),k.selectedMonth=k.currentMonth=e,k.selectedYear=k.currentYear=f,this._selectDate(d,
this._formatDate(k,k.currentDay,k.currentMonth,k.currentYear)))},_clearDate:function(d){d=b(d);this._selectDate(d,"")},_selectDate:function(d,e){var f;f=b(d);var h=this._getInst(f[0]);e=null!=e?e:this._formatDate(h);h.input&&h.input.val(e);this._updateAlternate(h);(f=this._get(h,"onSelect"))?f.apply(h.input?h.input[0]:null,[e,h]):h.input&&h.input.trigger("change");h.inline?this._updateDatepicker(h):(this._hideDatepicker(),this._lastInput=h.input[0],"object"!=typeof h.input[0]&&h.input.focus(),this._lastInput=
null)},_updateAlternate:function(d){var e,f,h,k=this._get(d,"altField");k&&(e=this._get(d,"altFormat")||this._get(d,"dateFormat"),f=this._getDate(d),h=this.formatDate(e,f,this._getFormatConfig(d)),b(k).each(function(){b(this).val(h)}))},noWeekends:function(b){b=b.getDay();return[0<b&&6>b,""]},iso8601Week:function(b){var d;b=new Date(b.getTime());return b.setDate(b.getDate()+4-(b.getDay()||7)),d=b.getTime(),b.setMonth(0),b.setDate(1),Math.floor(Math.round((d-b)/864E5)/7)+1},parseDate:function(e,f,
h){if(null==e||null==f)throw"Invalid arguments";if(f="object"==typeof f?""+f:f+"",""===f)return null;var k,r,s,t,u=0,w=(h?h.shortYearCutoff:null)||this._defaults.shortYearCutoff,w="string"!=typeof w?w:(new Date).getFullYear()%100+parseInt(w,10),x=(h?h.dayNamesShort:null)||this._defaults.dayNamesShort,y=(h?h.dayNames:null)||this._defaults.dayNames,z=(h?h.monthNamesShort:null)||this._defaults.monthNamesShort;h=(h?h.monthNames:null)||this._defaults.monthNames;var F=-1,C=-1,A=-1,v=-1,B=!1,T=function(b){b=
e.length>k+1&&e.charAt(k+1)===b;return b&&k++,b},E=function(b){var d=T(b);b=RegExp("^\\d{1,"+("@"===b?14:"!"===b?20:"y"===b&&d?4:"o"===b?3:2)+"}");b=f.substring(u).match(b);if(!b)throw"Missing number at position "+u;return u+=b[0].length,parseInt(b[0],10)},Q=function(e,h,k){var l=-1;e=b.map(T(e)?k:h,function(b,d){return[[d,b]]}).sort(function(b,d){return-(b[1].length-d[1].length)});if(b.each(e,function(b,e){var h=e[1];return f.substr(u,h.length).toLowerCase()===h.toLowerCase()?(l=e[0],u+=h.length,
!1):d}),-1!==l)return l+1;throw"Unknown name at position "+u;},M=function(){if(f.charAt(u)!==e.charAt(k))throw"Unexpected literal at position "+u;u++};for(k=0;e.length>k;k++)if(B)"'"!==e.charAt(k)||T("'")?M():B=!1;else switch(e.charAt(k)){case "d":A=E("d");break;case "D":Q("D",x,y);break;case "o":v=E("o");break;case "m":C=E("m");break;case "M":C=Q("M",z,h);break;case "y":F=E("y");break;case "@":t=new Date(E("@"));F=t.getFullYear();C=t.getMonth()+1;A=t.getDate();break;case "!":t=new Date((E("!")-this._ticksTo1970)/
1E4);F=t.getFullYear();C=t.getMonth()+1;A=t.getDate();break;case "'":T("'")?M():B=!0;break;default:M()}if(f.length>u&&(s=f.substr(u),!/^\s+/.test(s)))throw"Extra/unparsed characters found in date: "+s;if(-1===F?F=(new Date).getFullYear():100>F&&(F+=(new Date).getFullYear()-(new Date).getFullYear()%100+(w>=F?0:-100)),-1<v){C=1;for(A=v;!(r=this._getDaysInMonth(F,C-1),r>=A);)C++,A-=r}if(t=this._daylightSavingAdjust(new Date(F,C-1,A)),t.getFullYear()!==F||t.getMonth()+1!==C||t.getDate()!==A)throw"Invalid date";
return t},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:864E9*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925)),formatDate:function(b,d,e){if(!d)return"";var f,h=(e?e.dayNamesShort:null)||this._defaults.dayNamesShort,k=(e?e.dayNames:null)||this._defaults.dayNames,t=(e?e.monthNamesShort:null)||this._defaults.monthNamesShort;
e=(e?e.monthNames:null)||this._defaults.monthNames;var u=function(d){d=b.length>f+1&&b.charAt(f+1)===d;return d&&f++,d},w=function(b,d,e){d=""+d;if(u(b))for(;e>d.length;)d="0"+d;return d},x=function(b,d,e,f){return u(b)?f[d]:e[d]},y="",z=!1;if(d)for(f=0;b.length>f;f++)if(z)"'"!==b.charAt(f)||u("'")?y+=b.charAt(f):z=!1;else switch(b.charAt(f)){case "d":y+=w("d",d.getDate(),2);break;case "D":y+=x("D",d.getDay(),h,k);break;case "o":y+=w("o",Math.round(((new Date(d.getFullYear(),d.getMonth(),d.getDate())).getTime()-
(new Date(d.getFullYear(),0,0)).getTime())/864E5),3);break;case "m":y+=w("m",d.getMonth()+1,2);break;case "M":y+=x("M",d.getMonth(),t,e);break;case "y":y+=u("y")?d.getFullYear():(10>d.getYear()%100?"0":"")+d.getYear()%100;break;case "@":y+=d.getTime();break;case "!":y+=1E4*d.getTime()+this._ticksTo1970;break;case "'":u("'")?y+="'":z=!0;break;default:y+=b.charAt(f)}return y},_possibleChars:function(b){var d,e="",f=!1,h=function(e){e=b.length>d+1&&b.charAt(d+1)===e;return e&&d++,e};for(d=0;b.length>
d;d++)if(f)"'"!==b.charAt(d)||h("'")?e+=b.charAt(d):f=!1;else switch(b.charAt(d)){case "d":case "m":case "y":case "@":e+="0123456789";break;case "D":case "M":return null;case "'":h("'")?e+="'":f=!0;break;default:e+=b.charAt(d)}return e},_get:function(b,e){return b.settings[e]!==d?b.settings[e]:this._defaults[e]},_setDateFromField:function(b,d){if(b.input.val()!==b.lastVal){var e=this._get(b,"dateFormat"),f=b.lastVal=b.input?b.input.val():null,h=this._getDefaultDate(b),k=h,t=this._getFormatConfig(b);
try{k=this.parseDate(e,f,t)||h}catch(u){f=d?"":f}b.selectedDay=k.getDate();b.drawMonth=b.selectedMonth=k.getMonth();b.drawYear=b.selectedYear=k.getFullYear();b.currentDay=f?k.getDate():0;b.currentMonth=f?k.getMonth():0;b.currentYear=f?k.getFullYear():0;this._adjustInstDate(b)}},_getDefaultDate:function(b){return this._restrictMinMax(b,this._determineDate(b,this._get(b,"defaultDate"),new Date))},_determineDate:function(d,e,f){var h=function(b){var d=new Date;return d.setDate(d.getDate()+b),d},k=function(e){try{return b.datepicker.parseDate(b.datepicker._get(d,
"dateFormat"),e,b.datepicker._getFormatConfig(d))}catch(f){}for(var h=(e.toLowerCase().match(/^c/)?b.datepicker._getDate(d):null)||new Date,k=h.getFullYear(),m=h.getMonth(),h=h.getDate(),n=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,p=n.exec(e);p;){switch(p[2]||"d"){case "d":case "D":h+=parseInt(p[1],10);break;case "w":case "W":h+=7*parseInt(p[1],10);break;case "m":case "M":m+=parseInt(p[1],10);h=Math.min(h,b.datepicker._getDaysInMonth(k,m));break;case "y":case "Y":k+=parseInt(p[1],10),h=Math.min(h,b.datepicker._getDaysInMonth(k,
m))}p=n.exec(e)}return new Date(k,m,h)};e=null==e||""===e?f:"string"==typeof e?k(e):"number"==typeof e?isNaN(e)?f:h(e):new Date(e.getTime());return e=e&&"Invalid Date"==""+e?f:e,e&&(e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0)),this._daylightSavingAdjust(e)},_daylightSavingAdjust:function(b){return b?(b.setHours(12<b.getHours()?b.getHours()+2:0),b):null},_setDate:function(b,d,e){var f=!d,h=b.selectedMonth,k=b.selectedYear;d=this._restrictMinMax(b,this._determineDate(b,d,new Date));
b.selectedDay=b.currentDay=d.getDate();b.drawMonth=b.selectedMonth=b.currentMonth=d.getMonth();b.drawYear=b.selectedYear=b.currentYear=d.getFullYear();h===b.selectedMonth&&k===b.selectedYear||e||this._notifyChange(b);this._adjustInstDate(b);b.input&&b.input.val(f?"":this._formatDate(b))},_getDate:function(b){return!b.currentYear||b.input&&""===b.input.val()?null:this._daylightSavingAdjust(new Date(b.currentYear,b.currentMonth,b.currentDay))},_attachHandlers:function(d){var e=this._get(d,"stepMonths"),
f="#"+d.id.replace(/\\\\/g,"\\");d.dpDiv.find("[data-handler]").map(function(){b(this).bind(this.getAttribute("data-event"),{prev:function(){b.datepicker._adjustDate(f,-e,"M")},next:function(){b.datepicker._adjustDate(f,+e,"M")},hide:function(){b.datepicker._hideDatepicker()},today:function(){b.datepicker._gotoToday(f)},selectDay:function(){return b.datepicker._selectDay(f,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return b.datepicker._selectMonthYear(f,
this,"M"),!1},selectYear:function(){return b.datepicker._selectMonthYear(f,this,"Y"),!1}}[this.getAttribute("data-handler")])})},_generateHTML:function(b){var d,e,f,h,k,t,u,w,x,y,z,F,C,A,v,B,T,E,Q,M,L,K,Z,ca,ia,aa,U,ea=new Date,ea=this._daylightSavingAdjust(new Date(ea.getFullYear(),ea.getMonth(),ea.getDate())),J=this._get(b,"isRTL");t=this._get(b,"showButtonPanel");f=this._get(b,"hideIfNoPrevNext");k=this._get(b,"navigationAsDateFormat");var Y=this._getNumberOfMonths(b),O=this._get(b,"showCurrentAtPos");
h=this._get(b,"stepMonths");var oa=1!==Y[0]||1!==Y[1],I=this._daylightSavingAdjust(b.currentDay?new Date(b.currentYear,b.currentMonth,b.currentDay):new Date(9999,9,9)),ga=this._getMinMaxDate(b,"min"),ka=this._getMinMaxDate(b,"max"),O=b.drawMonth-O,W=b.drawYear;if(0>O&&(O+=12,W--),ka){d=this._daylightSavingAdjust(new Date(ka.getFullYear(),ka.getMonth()-Y[0]*Y[1]+1,ka.getDate()));for(d=ga&&ga>d?ga:d;this._daylightSavingAdjust(new Date(W,O,1))>d;)O--,0>O&&(O=11,W--)}b.drawMonth=O;b.drawYear=W;d=this._get(b,
"prevText");d=k?this.formatDate(d,this._daylightSavingAdjust(new Date(W,O-h,1)),this._getFormatConfig(b)):d;d=this._canAdjustMonth(b,-1,W,O)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+d+"'><span class='ui-icon ui-icon-circle-triangle-"+(J?"e":"w")+"'>"+d+"</span></a>":f?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+d+"'><span class='ui-icon ui-icon-circle-triangle-"+(J?"e":"w")+"'>"+d+"</span></a>";e=this._get(b,"nextText");
e=k?this.formatDate(e,this._daylightSavingAdjust(new Date(W,O+h,1)),this._getFormatConfig(b)):e;f=this._canAdjustMonth(b,1,W,O)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+e+"'><span class='ui-icon ui-icon-circle-triangle-"+(J?"w":"e")+"'>"+e+"</span></a>":f?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+e+"'><span class='ui-icon ui-icon-circle-triangle-"+(J?"w":"e")+"'>"+e+"</span></a>";h=this._get(b,"currentText");e=this._get(b,
"gotoCurrent")&&b.currentDay?I:ea;h=k?this.formatDate(h,e,this._getFormatConfig(b)):h;k=b.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(b,"closeText")+"</button>";t=t?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(J?k:"")+(this._isInRange(b,e)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+
h+"</button>":"")+(J?"":k)+"</div>":"";k=parseInt(this._get(b,"firstDay"),10);k=isNaN(k)?0:k;h=this._get(b,"showWeek");e=this._get(b,"dayNames");u=this._get(b,"dayNamesMin");w=this._get(b,"monthNames");x=this._get(b,"monthNamesShort");y=this._get(b,"beforeShowDay");z=this._get(b,"showOtherMonths");F=this._get(b,"selectOtherMonths");C=this._getDefaultDate(b);A="";for(B=0;Y[0]>B;B++){T="";this.maxRows=4;for(E=0;Y[1]>E;E++){if(Q=this._daylightSavingAdjust(new Date(W,O,b.selectedDay)),v=" ui-corner-all",
M="",oa){if(M+="<div class='ui-datepicker-group",1<Y[1])switch(E){case 0:M+=" ui-datepicker-group-first";v=" ui-corner-"+(J?"right":"left");break;case Y[1]-1:M+=" ui-datepicker-group-last";v=" ui-corner-"+(J?"left":"right");break;default:M+=" ui-datepicker-group-middle",v=""}M+="'>"}M+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+v+"'>"+(/all|left/.test(v)&&0===B?J?f:d:"")+(/all|right/.test(v)&&0===B?J?d:f:"")+this._generateMonthYearHeader(b,O,W,ga,ka,0<B||0<E,w,x)+"</div><table class='ui-datepicker-calendar'><thead><tr>";
L=h?"<th class='ui-datepicker-week-col'>"+this._get(b,"weekHeader")+"</th>":"";for(v=0;7>v;v++)K=(v+k)%7,L+="<th"+(5<=(v+k+6)%7?" class='ui-datepicker-week-end'":"")+"><span title='"+e[K]+"'>"+u[K]+"</span></th>";M+=L+"</tr></thead><tbody>";L=this._getDaysInMonth(W,O);W===b.selectedYear&&O===b.selectedMonth&&(b.selectedDay=Math.min(b.selectedDay,L));v=(this._getFirstDayOfMonth(W,O)-k+7)%7;L=Math.ceil((v+L)/7);this.maxRows=L=oa?this.maxRows>L?this.maxRows:L:L;K=this._daylightSavingAdjust(new Date(W,
O,1-v));for(Z=0;L>Z;Z++){M+="<tr>";ca=h?"<td class='ui-datepicker-week-col'>"+this._get(b,"calculateWeek")(K)+"</td>":"";for(v=0;7>v;v++)ia=y?y.apply(b.input?b.input[0]:null,[K]):[!0,""],U=(aa=K.getMonth()!==O)&&!F||!ia[0]||ga&&ga>K||ka&&K>ka,ca+="<td class='"+(5<=(v+k+6)%7?" ui-datepicker-week-end":"")+(aa?" ui-datepicker-other-month":"")+(K.getTime()===Q.getTime()&&O===b.selectedMonth&&b._keyEvent||C.getTime()===K.getTime()&&C.getTime()===Q.getTime()?" "+this._dayOverClass:"")+(U?" "+this._unselectableClass+
" ui-state-disabled":"")+(aa&&!z?"":" "+ia[1]+(K.getTime()===I.getTime()?" "+this._currentClass:"")+(K.getTime()===ea.getTime()?" ui-datepicker-today":""))+"'"+(aa&&!z||!ia[2]?"":" title='"+ia[2].replace(/'/g,"&#39;")+"'")+(U?"":" data-handler='selectDay' data-event='click' data-month='"+K.getMonth()+"' data-year='"+K.getFullYear()+"'")+">"+(aa&&!z?"&#xa0;":U?"<span class='ui-state-default'>"+K.getDate()+"</span>":"<a class='ui-state-default"+(K.getTime()===ea.getTime()?" ui-state-highlight":"")+
(K.getTime()===I.getTime()?" ui-state-active":"")+(aa?" ui-priority-secondary":"")+"' href='#'>"+K.getDate()+"</a>")+"</td>",K.setDate(K.getDate()+1),K=this._daylightSavingAdjust(K);M+=ca+"</tr>"}O++;11<O&&(O=0,W++);M+="</tbody></table>"+(oa?"</div>"+(0<Y[0]&&E===Y[1]-1?"<div class='ui-datepicker-row-break'></div>":""):"");T+=M}A+=T}return A+=t,b._keyEvent=!1,A},_generateMonthYearHeader:function(b,d,e,f,h,k,t,u){var w,x,y,z=this._get(b,"changeMonth"),F=this._get(b,"changeYear"),C=this._get(b,"showMonthAfterYear"),
A="<div class='ui-datepicker-title'>",v="";if(k||!z)v+="<span class='ui-datepicker-month'>"+t[d]+"</span>";else{t=f&&f.getFullYear()===e;w=h&&h.getFullYear()===e;v+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>";for(x=0;12>x;x++)(!t||x>=f.getMonth())&&(!w||h.getMonth()>=x)&&(v+="<option value='"+x+"'"+(x===d?" selected='selected'":"")+">"+u[x]+"</option>");v+="</select>"}if(C||(A+=v+(!k&&z&&F?"":"&#xa0;")),!b.yearshtml)if(b.yearshtml="",k||!F)A+="<span class='ui-datepicker-year'>"+
e+"</span>";else{u=this._get(b,"yearRange").split(":");y=(new Date).getFullYear();t=function(b){b=b.match(/c[+\-].*/)?e+parseInt(b.substring(1),10):b.match(/[+\-].*/)?y+parseInt(b,10):parseInt(b,10);return isNaN(b)?y:b};d=t(u[0]);u=Math.max(d,t(u[1]||""));d=f?Math.max(d,f.getFullYear()):d;u=h?Math.min(u,h.getFullYear()):u;for(b.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";u>=d;d++)b.yearshtml+="<option value='"+d+"'"+(d===e?" selected='selected'":
"")+">"+d+"</option>";b.yearshtml+="</select>";A+=b.yearshtml;b.yearshtml=null}return A+=this._get(b,"yearSuffix"),C&&(A+=(!k&&z&&F?"":"&#xa0;")+v),A+="</div>"},_adjustInstDate:function(b,d,e){var f=b.drawYear+("Y"===e?d:0),h=b.drawMonth+("M"===e?d:0);d=Math.min(b.selectedDay,this._getDaysInMonth(f,h))+("D"===e?d:0);f=this._restrictMinMax(b,this._daylightSavingAdjust(new Date(f,h,d)));b.selectedDay=f.getDate();b.drawMonth=b.selectedMonth=f.getMonth();b.drawYear=b.selectedYear=f.getFullYear();("M"===
e||"Y"===e)&&this._notifyChange(b)},_restrictMinMax:function(b,d){var e=this._getMinMaxDate(b,"min"),f=this._getMinMaxDate(b,"max"),e=e&&e>d?e:d;return f&&e>f?f:e},_notifyChange:function(b){var d=this._get(b,"onChangeMonthYear");d&&d.apply(b.input?b.input[0]:null,[b.selectedYear,b.selectedMonth+1,b])},_getNumberOfMonths:function(b){b=this._get(b,"numberOfMonths");return null==b?[1,1]:"number"==typeof b?[1,b]:b},_getMinMaxDate:function(b,d){return this._determineDate(b,this._get(b,d+"Date"),null)},
_getDaysInMonth:function(b,d){return 32-this._daylightSavingAdjust(new Date(b,d,32)).getDate()},_getFirstDayOfMonth:function(b,d){return(new Date(b,d,1)).getDay()},_canAdjustMonth:function(b,d,e,f){var h=this._getNumberOfMonths(b);e=this._daylightSavingAdjust(new Date(e,f+(0>d?d:h[0]*h[1]),1));return 0>d&&e.setDate(this._getDaysInMonth(e.getFullYear(),e.getMonth())),this._isInRange(b,e)},_isInRange:function(b,d){var e,f,h=this._getMinMaxDate(b,"min"),k=this._getMinMaxDate(b,"max"),t=null,u=null,w=
this._get(b,"yearRange");return w&&(e=w.split(":"),f=(new Date).getFullYear(),t=parseInt(e[0],10),u=parseInt(e[1],10),e[0].match(/[+\-].*/)&&(t+=f),e[1].match(/[+\-].*/)&&(u+=f)),(!h||d.getTime()>=h.getTime())&&(!k||d.getTime()<=k.getTime())&&(!t||d.getFullYear()>=t)&&(!u||u>=d.getFullYear())},_getFormatConfig:function(b){var d=this._get(b,"shortYearCutoff");return d="string"!=typeof d?d:(new Date).getFullYear()%100+parseInt(d,10),{shortYearCutoff:d,dayNamesShort:this._get(b,"dayNamesShort"),dayNames:this._get(b,
"dayNames"),monthNamesShort:this._get(b,"monthNamesShort"),monthNames:this._get(b,"monthNames")}},_formatDate:function(b,d,e,f){d||(b.currentDay=b.selectedDay,b.currentMonth=b.selectedMonth,b.currentYear=b.selectedYear);d=d?"object"==typeof d?d:this._daylightSavingAdjust(new Date(f,e,d)):this._daylightSavingAdjust(new Date(b.currentYear,b.currentMonth,b.currentDay));return this.formatDate(this._get(b,"dateFormat"),d,this._getFormatConfig(b))}});b.fn.datepicker=function(d){if(!this.length)return this;
b.datepicker.initialized||(b(document).mousedown(b.datepicker._checkExternalClick),b.datepicker.initialized=!0);0===b("#"+b.datepicker._mainDivId).length&&b("body").append(b.datepicker.dpDiv);var e=Array.prototype.slice.call(arguments,1);return"string"!=typeof d||"isDisabled"!==d&&"getDate"!==d&&"widget"!==d?"option"===d&&2===arguments.length&&"string"==typeof arguments[1]?b.datepicker["_"+d+"Datepicker"].apply(b.datepicker,[this[0]].concat(e)):this.each(function(){"string"==typeof d?b.datepicker["_"+
d+"Datepicker"].apply(b.datepicker,[this].concat(e)):b.datepicker._attachDatepicker(this,d)}):b.datepicker["_"+d+"Datepicker"].apply(b.datepicker,[this[0]].concat(e))};b.datepicker=new e;b.datepicker.initialized=!1;b.datepicker.uuid=(new Date).getTime();b.datepicker.version="1.10.3"})(jQuery);
(function(b){var d={buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},e={maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0};b.widget("ui.dialog",{version:"1.10.3",options:{appendTo:"body",autoOpen:!0,buttons:[],closeOnEscape:!0,closeText:"close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(d){var e=b(this).css(d).offset().top;
0>e&&b(this).css("top",d.top-e)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height};this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)};
this.originalTitle=this.element.attr("title");this.options.title=this.options.title||this.originalTitle;this._createWrapper();this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(this.uiDialog);this._createTitlebar();this._createButtonPane();this.options.draggable&&b.fn.draggable&&this._makeDraggable();this.options.resizable&&b.fn.resizable&&this._makeResizable();this._isOpen=!1},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var d=
this.options.appendTo;return d&&(d.jquery||d.nodeType)?b(d):this.document.find(d||"body").eq(0)},_destroy:function(){var b,d=this.originalPosition;this._destroyOverlay();this.element.removeUniqueId().removeClass("ui-dialog-content ui-widget-content").css(this.originalCss).detach();this.uiDialog.stop(!0,!0).remove();this.originalTitle&&this.element.attr("title",this.originalTitle);b=d.parent.children().eq(d.index);b.length&&b[0]!==this.element[0]?b.before(this.element):d.parent.append(this.element)},
widget:function(){return this.uiDialog},disable:b.noop,enable:b.noop,close:function(d){var e=this;this._isOpen&&!1!==this._trigger("beforeClose",d)&&(this._isOpen=!1,this._destroyOverlay(),this.opener.filter(":focusable").focus().length||b(this.document[0].activeElement).blur(),this._hide(this.uiDialog,this.options.hide,function(){e._trigger("close",d)}))},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(b,d){var e=!!this.uiDialog.nextAll(":visible").insertBefore(this.uiDialog).length;
return e&&!d&&this._trigger("focus",b),e},open:function(){var d=this;return this._isOpen?(this._moveToTop()&&this._focusTabbable(),void 0):(this._isOpen=!0,this.opener=b(this.document[0].activeElement),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this._show(this.uiDialog,this.options.show,function(){d._focusTabbable();d._trigger("focus")}),this._trigger("open"),void 0)},_focusTabbable:function(){var b=this.element.find("[autofocus]");b.length||(b=this.element.find(":tabbable"));
b.length||(b=this.uiDialogButtonPane.find(":tabbable"));b.length||(b=this.uiDialogTitlebarClose.filter(":tabbable"));b.length||(b=this.uiDialog);b.eq(0).focus()},_keepFocus:function(d){function e(){var d=this.document[0].activeElement;this.uiDialog[0]===d||b.contains(this.uiDialog[0],d)||this._focusTabbable()}d.preventDefault();e.call(this);this._delay(e)},_createWrapper:function(){this.uiDialog=b("<div>").addClass("ui-dialog ui-widget ui-widget-content ui-corner-all ui-front "+this.options.dialogClass).hide().attr({tabIndex:-1,
role:"dialog"}).appendTo(this._appendTo());this._on(this.uiDialog,{keydown:function(d){if(this.options.closeOnEscape&&!d.isDefaultPrevented()&&d.keyCode&&d.keyCode===b.ui.keyCode.ESCAPE)return d.preventDefault(),this.close(d),void 0;if(d.keyCode===b.ui.keyCode.TAB){var e=this.uiDialog.find(":tabbable"),k=e.filter(":first"),e=e.filter(":last");d.target!==e[0]&&d.target!==this.uiDialog[0]||d.shiftKey?d.target!==k[0]&&d.target!==this.uiDialog[0]||!d.shiftKey||(e.focus(1),d.preventDefault()):(k.focus(1),
d.preventDefault())}},mousedown:function(b){this._moveToTop(b)&&this._focusTabbable()}});this.element.find("[aria-describedby]").length||this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){var d;this.uiDialogTitlebar=b("<div>").addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(this.uiDialog);this._on(this.uiDialogTitlebar,{mousedown:function(d){b(d.target).closest(".ui-dialog-titlebar-close")||this.uiDialog.focus()}});
this.uiDialogTitlebarClose=b("<button></button>").button({label:this.options.closeText,icons:{primary:"ui-icon-closethick"},text:!1}).addClass("ui-dialog-titlebar-close").appendTo(this.uiDialogTitlebar);this._on(this.uiDialogTitlebarClose,{click:function(b){b.preventDefault();this.close(b)}});d=b("<span>").uniqueId().addClass("ui-dialog-title").prependTo(this.uiDialogTitlebar);this._title(d);this.uiDialog.attr({"aria-labelledby":d.attr("id")})},_title:function(b){this.options.title||b.html("&#160;");
b.text(this.options.title)},_createButtonPane:function(){this.uiDialogButtonPane=b("<div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix");this.uiButtonSet=b("<div>").addClass("ui-dialog-buttonset").appendTo(this.uiDialogButtonPane);this._createButtons()},_createButtons:function(){var d=this,e=this.options.buttons;return this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),b.isEmptyObject(e)||b.isArray(e)&&!e.length?(this.uiDialog.removeClass("ui-dialog-buttons"),void 0):
(b.each(e,function(e,h){var m,n;h=b.isFunction(h)?{click:h,text:e}:h;h=b.extend({type:"button"},h);m=h.click;h.click=function(){m.apply(d.element[0],arguments)};n={icons:h.icons,text:h.showText};delete h.icons;delete h.showText;b("<button></button>",h).button(n).appendTo(d.uiButtonSet)}),this.uiDialog.addClass("ui-dialog-buttons"),this.uiDialogButtonPane.appendTo(this.uiDialog),void 0)},_makeDraggable:function(){function d(b){return{position:b.position,offset:b.offset}}var e=this,k=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",
handle:".ui-dialog-titlebar",containment:"document",start:function(k,m){b(this).addClass("ui-dialog-dragging");e._blockFrames();e._trigger("dragStart",k,d(m))},drag:function(b,k){e._trigger("drag",b,d(k))},stop:function(l,m){k.position=[m.position.left-e.document.scrollLeft(),m.position.top-e.document.scrollTop()];b(this).removeClass("ui-dialog-dragging");e._unblockFrames();e._trigger("dragStop",l,d(m))}})},_makeResizable:function(){function d(b){return{originalPosition:b.originalPosition,originalSize:b.originalSize,
position:b.position,size:b.size}}var e=this,k=this.options,l=k.resizable,m=this.uiDialog.css("position"),l="string"==typeof l?l:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:k.maxWidth,maxHeight:k.maxHeight,minWidth:k.minWidth,minHeight:this._minHeight(),handles:l,start:function(k,l){b(this).addClass("ui-dialog-resizing");e._blockFrames();e._trigger("resizeStart",k,d(l))},resize:function(b,k){e._trigger("resize",
b,d(k))},stop:function(l,m){k.height=b(this).height();k.width=b(this).width();b(this).removeClass("ui-dialog-resizing");e._unblockFrames();e._trigger("resizeStop",l,d(m))}}).css("position",m)},_minHeight:function(){var b=this.options;return"auto"===b.height?b.minHeight:Math.min(b.minHeight,b.height)},_position:function(){var b=this.uiDialog.is(":visible");b||this.uiDialog.show();this.uiDialog.position(this.options.position);b||this.uiDialog.hide()},_setOptions:function(f){var h=this,k=!1,l={};b.each(f,
function(b,f){h._setOption(b,f);b in d&&(k=!0);b in e&&(l[b]=f)});k&&(this._size(),this._position());this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option",l)},_setOption:function(b,d){var e,l,m=this.uiDialog;"dialogClass"===b&&m.removeClass(this.options.dialogClass).addClass(d);"disabled"!==b&&(this._super(b,d),"appendTo"===b&&this.uiDialog.appendTo(this._appendTo()),"buttons"===b&&this._createButtons(),"closeText"===b&&this.uiDialogTitlebarClose.button({label:""+d}),"draggable"===
b&&(e=m.is(":data(ui-draggable)"),e&&!d&&m.draggable("destroy"),!e&&d&&this._makeDraggable()),"position"===b&&this._position(),"resizable"===b&&(l=m.is(":data(ui-resizable)"),l&&!d&&m.resizable("destroy"),l&&"string"==typeof d&&m.resizable("option","handles",d),l||!1===d||this._makeResizable()),"title"===b&&this._title(this.uiDialogTitlebar.find(".ui-dialog-title")))},_size:function(){var b,d,e,l=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0});l.minWidth>
l.width&&(l.width=l.minWidth);b=this.uiDialog.css({height:"auto",width:l.width}).outerHeight();d=Math.max(0,l.minHeight-b);e="number"==typeof l.maxHeight?Math.max(0,l.maxHeight-b):"none";"auto"===l.height?this.element.css({minHeight:d,maxHeight:e,height:"auto"}):this.element.height(Math.max(0,l.height-b));this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var d=
b(this);return b("<div>").css({position:"absolute",width:d.outerWidth(),height:d.outerHeight()}).appendTo(d.parent()).offset(d.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_allowInteraction:function(d){return b(d.target).closest(".ui-dialog").length?!0:!!b(d.target).closest(".ui-datepicker").length},_createOverlay:function(){if(this.options.modal){var d=this,e=this.widgetFullName;b.ui.dialog.overlayInstances||this._delay(function(){b.ui.dialog.overlayInstances&&
this.document.bind("focusin.dialog",function(k){d._allowInteraction(k)||(k.preventDefault(),b(".ui-dialog:visible:last .ui-dialog-content").data(e)._focusTabbable())})});this.overlay=b("<div>").addClass("ui-widget-overlay ui-front").appendTo(this._appendTo());this._on(this.overlay,{mousedown:"_keepFocus"});b.ui.dialog.overlayInstances++}},_destroyOverlay:function(){this.options.modal&&this.overlay&&(b.ui.dialog.overlayInstances--,b.ui.dialog.overlayInstances||this.document.unbind("focusin.dialog"),
this.overlay.remove(),this.overlay=null)}});b.ui.dialog.overlayInstances=0;!1!==b.uiBackCompat&&b.widget("ui.dialog",b.ui.dialog,{_position:function(){var d,e=this.options.position,k=[],l=[0,0];e?(("string"==typeof e||"object"==typeof e&&"0"in e)&&(k=e.split?e.split(" "):[e[0],e[1]],1===k.length&&(k[1]=k[0]),b.each(["left","top"],function(b,d){+k[b]===k[b]&&(l[b]=k[b],k[b]=d)}),e={my:k[0]+(0>l[0]?l[0]:"+"+l[0])+" "+k[1]+(0>l[1]?l[1]:"+"+l[1]),at:k.join(" ")}),e=b.extend({},b.ui.dialog.prototype.options.position,
e)):e=b.ui.dialog.prototype.options.position;(d=this.uiDialog.is(":visible"))||this.uiDialog.show();this.uiDialog.position(e);d||this.uiDialog.hide()}})})(jQuery);
(function(b){b.widget("ui.menu",{version:"1.10.3",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element;this.mouseHandled=!1;this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content ui-corner-all").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}).bind("click"+
this.eventNamespace,b.proxy(function(b){this.options.disabled&&b.preventDefault()},this));this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true");this._on({"mousedown .ui-menu-item > a":function(b){b.preventDefault()},"click .ui-state-disabled > a":function(b){b.preventDefault()},"click .ui-menu-item:has(a)":function(d){var e=b(d.target).closest(".ui-menu-item");!this.mouseHandled&&e.not(".ui-state-disabled").length&&(this.mouseHandled=!0,this.select(d),e.has(".ui-menu").length?
this.expand(d):this.element.is(":focus")||(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(d){var e=b(d.currentTarget);e.siblings().children(".ui-state-active").removeClass("ui-state-active");this.focus(d,e)},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(b,e){var f=this.active||this.element.children(".ui-menu-item").eq(0);e||this.focus(b,f)},blur:function(d){this._delay(function(){b.contains(this.element[0],
this.document[0].activeElement)||this.collapseAll(d)})},keydown:"_keydown"});this.refresh();this._on(this.document,{click:function(d){b(d.target).closest(".ui-menu").length||this.collapseAll(d);this.mouseHandled=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-corner-all ui-menu-icons").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show();
this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").children("a").removeUniqueId().removeClass("ui-corner-all ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var d=b(this);d.data("ui-menu-submenu-carat")&&d.remove()});this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(d){function e(b){return b.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,
"\\$&")}var f,h,k,l,m=!0;switch(d.keyCode){case b.ui.keyCode.PAGE_UP:this.previousPage(d);break;case b.ui.keyCode.PAGE_DOWN:this.nextPage(d);break;case b.ui.keyCode.HOME:this._move("first","first",d);break;case b.ui.keyCode.END:this._move("last","last",d);break;case b.ui.keyCode.UP:this.previous(d);break;case b.ui.keyCode.DOWN:this.next(d);break;case b.ui.keyCode.LEFT:this.collapse(d);break;case b.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(d);break;case b.ui.keyCode.ENTER:case b.ui.keyCode.SPACE:this._activate(d);
break;case b.ui.keyCode.ESCAPE:this.collapse(d);break;default:m=!1,f=this.previousFilter||"",h=String.fromCharCode(d.keyCode),k=!1,clearTimeout(this.filterTimer),h===f?k=!0:h=f+h,l=RegExp("^"+e(h),"i"),f=this.activeMenu.children(".ui-menu-item").filter(function(){return l.test(b(this).children("a").text())}),f=k&&-1!==f.index(this.active.next())?this.active.nextAll(".ui-menu-item"):f,f.length||(h=String.fromCharCode(d.keyCode),l=RegExp("^"+e(h),"i"),f=this.activeMenu.children(".ui-menu-item").filter(function(){return l.test(b(this).children("a").text())})),
f.length?(this.focus(d,f),1<f.length?(this.previousFilter=h,this.filterTimer=this._delay(function(){delete this.previousFilter},1E3)):delete this.previousFilter):delete this.previousFilter}m&&d.preventDefault()},_activate:function(b){this.active.is(".ui-state-disabled")||(this.active.children("a[aria-haspopup='true']").length?this.expand(b):this.select(b))},refresh:function(){var d,e=this.options.icons.submenu;d=this.element.find(this.options.menus);d.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-corner-all").hide().attr({role:this.options.role,
"aria-hidden":"true","aria-expanded":"false"}).each(function(){var d=b(this),h=d.prev("a"),k=b("<span>").addClass("ui-menu-icon ui-icon "+e).data("ui-menu-submenu-carat",!0);h.attr("aria-haspopup","true").prepend(k);d.attr("aria-labelledby",h.attr("id"))});d=d.add(this.element);d.children(":not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","presentation").children("a").uniqueId().addClass("ui-corner-all").attr({tabIndex:-1,role:this._itemRole()});d.children(":not(.ui-menu-item)").each(function(){var d=
b(this);/[^\-\u2014\u2013\s]/.test(d.text())||d.addClass("ui-widget-content ui-menu-divider")});d.children(".ui-state-disabled").attr("aria-disabled","true");this.active&&!b.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(b,e){"icons"===b&&this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(e.submenu);this._super(b,e)},focus:function(b,e){var f;this.blur(b,b&&
"focus"===b.type);this._scrollIntoView(e);this.active=e.first();f=this.active.children("a").addClass("ui-state-focus");this.options.role&&this.element.attr("aria-activedescendant",f.attr("id"));this.active.parent().closest(".ui-menu-item").children("a:first").addClass("ui-state-active");b&&"keydown"===b.type?this._close():this.timer=this._delay(function(){this._close()},this.delay);f=e.children(".ui-menu");f.length&&/^mouse/.test(b.type)&&this._startOpening(f);this.activeMenu=e.parent();this._trigger("focus",
b,{item:e})},_scrollIntoView:function(d){var e,f,h,k,l,m;this._hasScroll()&&(e=parseFloat(b.css(this.activeMenu[0],"borderTopWidth"))||0,f=parseFloat(b.css(this.activeMenu[0],"paddingTop"))||0,h=d.offset().top-this.activeMenu.offset().top-e-f,k=this.activeMenu.scrollTop(),l=this.activeMenu.height(),m=d.height(),0>h?this.activeMenu.scrollTop(k+h):h+m>l&&this.activeMenu.scrollTop(k+h-l+m))},blur:function(b,e){e||clearTimeout(this.timer);this.active&&(this.active.children("a").removeClass("ui-state-focus"),
this.active=null,this._trigger("blur",b,{item:this.active}))},_startOpening:function(b){clearTimeout(this.timer);"true"===b.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close();this._open(b)},this.delay))},_open:function(d){var e=b.extend({of:this.active},this.options.position);clearTimeout(this.timer);this.element.find(".ui-menu").not(d.parents(".ui-menu")).hide().attr("aria-hidden","true");d.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(e)},collapseAll:function(d,
e){clearTimeout(this.timer);this.timer=this._delay(function(){var f=e?this.element:b(d&&d.target).closest(this.element.find(".ui-menu"));f.length||(f=this.element);this._close(f);this.blur(d);this.activeMenu=f},this.delay)},_close:function(b){b||(b=this.active?this.active.parent():this.element);b.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find("a.ui-state-active").removeClass("ui-state-active")},collapse:function(b){var e=this.active&&this.active.parent().closest(".ui-menu-item",
this.element);e&&e.length&&(this._close(),this.focus(b,e))},expand:function(b){var e=this.active&&this.active.children(".ui-menu ").children(".ui-menu-item").first();e&&e.length&&(this._open(e.parent()),this._delay(function(){this.focus(b,e)}))},next:function(b){this._move("next","first",b)},previous:function(b){this._move("prev","last",b)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},
_move:function(b,e,f){var h;this.active&&(h="first"===b||"last"===b?this.active["first"===b?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[b+"All"](".ui-menu-item").eq(0));h&&h.length&&this.active||(h=this.activeMenu.children(".ui-menu-item")[e]());this.focus(f,h)},nextPage:function(d){var e,f,h;return this.active?(this.isLastItem()||(this._hasScroll()?(f=this.active.offset().top,h=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return e=b(this),0>e.offset().top-
f-h}),this.focus(d,e)):this.focus(d,this.activeMenu.children(".ui-menu-item")[this.active?"last":"first"]())),void 0):(this.next(d),void 0)},previousPage:function(d){var e,f,h;return this.active?(this.isFirstItem()||(this._hasScroll()?(f=this.active.offset().top,h=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return e=b(this),0<e.offset().top-f+h}),this.focus(d,e)):this.focus(d,this.activeMenu.children(".ui-menu-item").first())),void 0):(this.next(d),void 0)},_hasScroll:function(){return this.element.outerHeight()<
this.element.prop("scrollHeight")},select:function(d){this.active=this.active||b(d.target).closest(".ui-menu-item");var e={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(d,!0);this._trigger("select",d,e)}})})(jQuery);
(function(b,d){b.widget("ui.progressbar",{version:"1.10.3",options:{max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue();this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min});this.valueDiv=b("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element);this._refreshValue()},_destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow");
this.valueDiv.remove()},value:function(b){return b===d?this.options.value:(this.options.value=this._constrainedValue(b),this._refreshValue(),d)},_constrainedValue:function(b){return b===d&&(b=this.options.value),this.indeterminate=!1===b,"number"!=typeof b&&(b=0),this.indeterminate?!1:Math.min(this.options.max,Math.max(this.min,b))},_setOptions:function(b){var d=b.value;delete b.value;this._super(b);this.options.value=this._constrainedValue(d);this._refreshValue()},_setOption:function(b,d){"max"===
b&&(d=Math.max(this.min,d));this._super(b,d)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var d=this.options.value,f=this._percentage();this.valueDiv.toggle(this.indeterminate||d>this.min).toggleClass("ui-corner-right",d===this.options.max).width(f.toFixed(0)+"%");this.element.toggleClass("ui-progressbar-indeterminate",this.indeterminate);this.indeterminate?(this.element.removeAttr("aria-valuenow"),this.overlayDiv||
(this.overlayDiv=b("<div class='ui-progressbar-overlay'></div>").appendTo(this.valueDiv))):(this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":d}),this.overlayDiv&&(this.overlayDiv.remove(),this.overlayDiv=null));this.oldValue!==d&&(this.oldValue=d,this._trigger("change"));d===this.options.max&&this._trigger("complete")}})})(jQuery);
(function(b){b.widget("ui.slider",b.ui.mouse,{version:"1.10.3",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},_create:function(){this._mouseSliding=this._keySliding=!1;this._animateOff=!0;this._handleIndex=null;this._detectOrientation();this._mouseInit();this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all");this._refresh();
this._setOption("disabled",this.options.disabled);this._animateOff=!1},_refresh:function(){this._createRange();this._createHandles();this._setupEvents();this._refreshValue()},_createHandles:function(){var d,e;d=this.options;var f=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),h=[];e=d.values&&d.values.length||1;f.length>e&&(f.slice(e).remove(),f=f.slice(0,e));for(d=f.length;e>d;d++)h.push("<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>");
this.handles=f.add(b(h.join("")).appendTo(this.element));this.handle=this.handles.eq(0);this.handles.each(function(d){b(this).data("ui-slider-handle-index",d)})},_createRange:function(){var d=this.options,e="";d.range?(!0===d.range&&(d.values?d.values.length&&2!==d.values.length?d.values=[d.values[0],d.values[0]]:b.isArray(d.values)&&(d.values=d.values.slice(0)):d.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",
bottom:""}):(this.range=b("<div></div>").appendTo(this.element),e="ui-slider-range ui-widget-header ui-corner-all"),this.range.addClass(e+("min"===d.range||"max"===d.range?" ui-slider-range-"+d.range:""))):this.range=b([])},_setupEvents:function(){var b=this.handles.add(this.range).filter("a");this._off(b);this._on(b,this._handleEvents);this._hoverable(b);this._focusable(b)},_destroy:function(){this.handles.remove();this.range.remove();this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all");
this._mouseDestroy()},_mouseCapture:function(d){var e,f,h,k,l,m,n,p,r=this,s=this.options;return s.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),e={x:d.pageX,y:d.pageY},f=this._normValueFromMouse(e),h=this._valueMax()-this._valueMin()+1,this.handles.each(function(d){var e=Math.abs(f-r.values(d));(h>e||h===e&&(d===r._lastChangedValue||r.values(d)===s.min))&&(h=e,k=b(this),l=d)}),m=this._start(d,l),!1===m?!1:
(this._mouseSliding=!0,this._handleIndex=l,k.addClass("ui-state-active").focus(),n=k.offset(),p=!b(d.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=p?{left:0,top:0}:{left:d.pageX-n.left-k.width()/2,top:d.pageY-n.top-k.height()/2-(parseInt(k.css("borderTopWidth"),10)||0)-(parseInt(k.css("borderBottomWidth"),10)||0)+(parseInt(k.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(d,l,f),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(b){var e=
this._normValueFromMouse({x:b.pageX,y:b.pageY});return this._slide(b,this._handleIndex,e),!1},_mouseStop:function(b){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(b,this._handleIndex),this._change(b,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(b){var e,f,h,k,l;return"horizontal"===
this.orientation?(e=this.elementSize.width,f=b.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(e=this.elementSize.height,f=b.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),h=f/e,1<h&&(h=1),0>h&&(h=0),"vertical"===this.orientation&&(h=1-h),k=this._valueMax()-this._valueMin(),l=this._valueMin()+h*k,this._trimAlignValue(l)},_start:function(b,e){var f={handle:this.handles[e],value:this.value()};return this.options.values&&this.options.values.length&&(f.value=
this.values(e),f.values=this.values()),this._trigger("start",b,f)},_slide:function(b,e,f){var h,k,l;this.options.values&&this.options.values.length?(h=this.values(e?0:1),2===this.options.values.length&&!0===this.options.range&&(0===e&&f>h||1===e&&h>f)&&(f=h),f!==this.values(e)&&(k=this.values(),k[e]=f,l=this._trigger("slide",b,{handle:this.handles[e],value:f,values:k}),this.values(e?0:1),!1!==l&&this.values(e,f,!0))):f!==this.value()&&(l=this._trigger("slide",b,{handle:this.handles[e],value:f}),!1!==
l&&this.value(f))},_stop:function(b,e){var f={handle:this.handles[e],value:this.value()};this.options.values&&this.options.values.length&&(f.value=this.values(e),f.values=this.values());this._trigger("stop",b,f)},_change:function(b,e){if(!this._keySliding&&!this._mouseSliding){var f={handle:this.handles[e],value:this.value()};this.options.values&&this.options.values.length&&(f.value=this.values(e),f.values=this.values());this._lastChangedValue=e;this._trigger("change",b,f)}},value:function(b){return arguments.length?
(this.options.value=this._trimAlignValue(b),this._refreshValue(),this._change(null,0),void 0):this._value()},values:function(d,e){var f,h,k;if(1<arguments.length)return this.options.values[d]=this._trimAlignValue(e),this._refreshValue(),this._change(null,d),void 0;if(!arguments.length)return this._values();if(!b.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(d):this.value();f=this.options.values;h=arguments[0];for(k=0;f.length>k;k+=1)f[k]=this._trimAlignValue(h[k]),
this._change(null,k);this._refreshValue()},_setOption:function(d,e){var f,h=0;switch("range"===d&&!0===this.options.range&&("min"===e?(this.options.value=this._values(0),this.options.values=null):"max"===e&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),b.isArray(this.options.values)&&(h=this.options.values.length),b.Widget.prototype._setOption.apply(this,arguments),d){case "orientation":this._detectOrientation();this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+
this.orientation);this._refreshValue();break;case "value":this._animateOff=!0;this._refreshValue();this._change(null,0);this._animateOff=!1;break;case "values":this._animateOff=!0;this._refreshValue();for(f=0;h>f;f+=1)this._change(null,f);this._animateOff=!1;break;case "min":case "max":this._animateOff=!0;this._refreshValue();this._animateOff=!1;break;case "range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_value:function(){return this._trimAlignValue(this.options.value)},_values:function(b){var e,
f;if(arguments.length)return e=this.options.values[b],this._trimAlignValue(e);if(this.options.values&&this.options.values.length){e=this.options.values.slice();for(f=0;e.length>f;f+=1)e[f]=this._trimAlignValue(e[f]);return e}return[]},_trimAlignValue:function(b){if(this._valueMin()>=b)return this._valueMin();if(b>=this._valueMax())return this._valueMax();var e=0<this.options.step?this.options.step:1,f=(b-this._valueMin())%e;b-=f;return 2*Math.abs(f)>=e&&(b+=0<f?e:-e),parseFloat(b.toFixed(5))},_valueMin:function(){return this.options.min},
_valueMax:function(){return this.options.max},_refreshValue:function(){var d,e,f,h,k,l=this.options.range,m=this.options,n=this,p=this._animateOff?!1:m.animate,r={};this.options.values&&this.options.values.length?this.handles.each(function(f){e=100*((n.values(f)-n._valueMin())/(n._valueMax()-n._valueMin()));r["horizontal"===n.orientation?"left":"bottom"]=e+"%";b(this).stop(1,1)[p?"animate":"css"](r,m.animate);!0===n.options.range&&("horizontal"===n.orientation?(0===f&&n.range.stop(1,1)[p?"animate":
"css"]({left:e+"%"},m.animate),1===f&&n.range[p?"animate":"css"]({width:e-d+"%"},{queue:!1,duration:m.animate})):(0===f&&n.range.stop(1,1)[p?"animate":"css"]({bottom:e+"%"},m.animate),1===f&&n.range[p?"animate":"css"]({height:e-d+"%"},{queue:!1,duration:m.animate})));d=e}):(f=this.value(),h=this._valueMin(),k=this._valueMax(),e=k!==h?100*((f-h)/(k-h)):0,r["horizontal"===this.orientation?"left":"bottom"]=e+"%",this.handle.stop(1,1)[p?"animate":"css"](r,m.animate),"min"===l&&"horizontal"===this.orientation&&
this.range.stop(1,1)[p?"animate":"css"]({width:e+"%"},m.animate),"max"===l&&"horizontal"===this.orientation&&this.range[p?"animate":"css"]({width:100-e+"%"},{queue:!1,duration:m.animate}),"min"===l&&"vertical"===this.orientation&&this.range.stop(1,1)[p?"animate":"css"]({height:e+"%"},m.animate),"max"===l&&"vertical"===this.orientation&&this.range[p?"animate":"css"]({height:100-e+"%"},{queue:!1,duration:m.animate}))},_handleEvents:{keydown:function(d){var e,f,h,k=b(d.target).data("ui-slider-handle-index");
switch(d.keyCode){case b.ui.keyCode.HOME:case b.ui.keyCode.END:case b.ui.keyCode.PAGE_UP:case b.ui.keyCode.PAGE_DOWN:case b.ui.keyCode.UP:case b.ui.keyCode.RIGHT:case b.ui.keyCode.DOWN:case b.ui.keyCode.LEFT:if(d.preventDefault(),!this._keySliding&&(this._keySliding=!0,b(d.target).addClass("ui-state-active"),e=this._start(d,k),!1===e))return}switch(h=this.options.step,e=f=this.options.values&&this.options.values.length?this.values(k):this.value(),d.keyCode){case b.ui.keyCode.HOME:f=this._valueMin();
break;case b.ui.keyCode.END:f=this._valueMax();break;case b.ui.keyCode.PAGE_UP:f=this._trimAlignValue(e+(this._valueMax()-this._valueMin())/5);break;case b.ui.keyCode.PAGE_DOWN:f=this._trimAlignValue(e-(this._valueMax()-this._valueMin())/5);break;case b.ui.keyCode.UP:case b.ui.keyCode.RIGHT:if(e===this._valueMax())return;f=this._trimAlignValue(e+h);break;case b.ui.keyCode.DOWN:case b.ui.keyCode.LEFT:if(e===this._valueMin())return;f=this._trimAlignValue(e-h)}this._slide(d,k,f)},click:function(b){b.preventDefault()},
keyup:function(d){var e=b(d.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(d,e),this._change(d,e),b(d.target).removeClass("ui-state-active"))}}})})(jQuery);
(function(b){function d(b){return function(){var d=this.element.val();b.apply(this,arguments);this._refresh();d!==this.element.val()&&this._trigger("change")}}b.widget("ui.spinner",{version:"1.10.3",defaultElement:"<input>",widgetEventPrefix:"spin",options:{culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max);
this._setOption("min",this.options.min);this._setOption("step",this.options.step);this._value(this.element.val(),!0);this._draw();this._on(this._events);this._refresh();this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var d={},f=this.element;return b.each(["min","max","step"],function(b,k){var l=f.attr(k);void 0!==l&&l.length&&(d[k]=l)}),d},_events:{keydown:function(b){this._start(b)&&this._keydown(b)&&b.preventDefault()},keyup:"_stop",
focus:function(){this.previous=this.element.val()},blur:function(b){return this.cancelBlur?(delete this.cancelBlur,void 0):(this._stop(),this._refresh(),this.previous!==this.element.val()&&this._trigger("change",b),void 0)},mousewheel:function(b,d){if(d){if(!this.spinning&&!this._start(b))return!1;this._spin((0<d?1:-1)*this.options.step,b);clearTimeout(this.mousewheelTimer);this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(b)},100);b.preventDefault()}},"mousedown .ui-spinner-button":function(d){function f(){this.element[0]===
this.document[0].activeElement||(this.element.focus(),this.previous=h,this._delay(function(){this.previous=h}))}var h;h=this.element[0]===this.document[0].activeElement?this.previous:this.element.val();d.preventDefault();f.call(this);this.cancelBlur=!0;this._delay(function(){delete this.cancelBlur;f.call(this)});!1!==this._start(d)&&this._repeat(null,b(d.currentTarget).hasClass("ui-spinner-up")?1:-1,d)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(d){return b(d.currentTarget).hasClass("ui-state-active")?
!1===this._start(d)?!1:(this._repeat(null,b(d.currentTarget).hasClass("ui-spinner-up")?1:-1,d),void 0):void 0},"mouseleave .ui-spinner-button":"_stop"},_draw:function(){var b=this.uiSpinner=this.element.addClass("ui-spinner-input").attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());this.element.attr("role","spinbutton");this.buttons=b.find(".ui-spinner-button").attr("tabIndex",-1).button().removeClass("ui-corner-all");this.buttons.height()>Math.ceil(0.5*b.height())&&
0<b.height()&&b.height(b.height());this.options.disabled&&this.disable()},_keydown:function(d){var f=this.options,h=b.ui.keyCode;switch(d.keyCode){case h.UP:return this._repeat(null,1,d),!0;case h.DOWN:return this._repeat(null,-1,d),!0;case h.PAGE_UP:return this._repeat(null,f.page,d),!0;case h.PAGE_DOWN:return this._repeat(null,-f.page,d),!0}return!1},_uiSpinnerHtml:function(){return"<span class='ui-spinner ui-widget ui-widget-content ui-corner-all'></span>"},_buttonHtml:function(){return"<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon "+
this.options.icons.up+"'>&#9650;</span></a><a class='ui-spinner-button ui-spinner-down ui-corner-br'><span class='ui-icon "+this.options.icons.down+"'>&#9660;</span></a>"},_start:function(b){return this.spinning||!1!==this._trigger("start",b)?(this.counter||(this.counter=1),this.spinning=!0,!0):!1},_repeat:function(b,d,h){b=b||500;clearTimeout(this.timer);this.timer=this._delay(function(){this._repeat(40,d,h)},b);this._spin(d*this.options.step,h)},_spin:function(b,d){var h=this.value()||0;this.counter||
(this.counter=1);h=this._adjustValue(h+b*this._increment(this.counter));this.spinning&&!1===this._trigger("spin",d,{value:h})||(this._value(h),this.counter++)},_increment:function(d){var f=this.options.incremental;return f?b.isFunction(f)?f(d):Math.floor(d*d*d/5E4-d*d/500+17*d/200+1):1},_precision:function(){var b=this._precisionOf(this.options.step);return null!==this.options.min&&(b=Math.max(b,this._precisionOf(this.options.min))),b},_precisionOf:function(b){b=""+b;var d=b.indexOf(".");return-1===
d?0:b.length-d-1},_adjustValue:function(b){var d,h,k=this.options;return d=null!==k.min?k.min:0,h=b-d,h=Math.round(h/k.step)*k.step,b=d+h,b=parseFloat(b.toFixed(this._precision())),null!==k.max&&b>k.max?k.max:null!==k.min&&k.min>b?k.min:b},_stop:function(b){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",b))},_setOption:function(b,d){if("culture"===b||"numberFormat"===b){var h=this._parse(this.element.val());return this.options[b]=
d,this.element.val(this._format(h)),void 0}("max"===b||"min"===b||"step"===b)&&"string"==typeof d&&(d=this._parse(d));"icons"===b&&(this.buttons.first().find(".ui-icon").removeClass(this.options.icons.up).addClass(d.up),this.buttons.last().find(".ui-icon").removeClass(this.options.icons.down).addClass(d.down));this._super(b,d);"disabled"===b&&(d?(this.element.prop("disabled",!0),this.buttons.button("disable")):(this.element.prop("disabled",!1),this.buttons.button("enable")))},_setOptions:d(function(b){this._super(b);
this._value(this.element.val())}),_parse:function(b){return"string"==typeof b&&""!==b&&(b=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(b,10,this.options.culture):+b),""===b||isNaN(b)?null:b},_format:function(b){return""===b?"":window.Globalize&&this.options.numberFormat?Globalize.format(b,this.options.numberFormat,this.options.culture):b},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},
_value:function(b,d){var h;""!==b&&(h=this._parse(b),null!==h&&(d||(h=this._adjustValue(h)),b=this._format(h)));this.element.val(b);this._refresh()},_destroy:function(){this.element.removeClass("ui-spinner-input").prop("disabled",!1).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow");this.uiSpinner.replaceWith(this.element)},stepUp:d(function(b){this._stepUp(b)}),_stepUp:function(b){this._start()&&(this._spin((b||1)*this.options.step),
this._stop())},stepDown:d(function(b){this._stepDown(b)}),_stepDown:function(b){this._start()&&(this._spin((b||1)*-this.options.step),this._stop())},pageUp:d(function(b){this._stepUp((b||1)*this.options.page)}),pageDown:d(function(b){this._stepDown((b||1)*this.options.page)}),value:function(b){return arguments.length?(d(this._value).call(this,b),void 0):this._parse(this.element.val())},widget:function(){return this.uiSpinner}})})(jQuery);
(function(b,d){function e(b){return 1<b.hash.length&&decodeURIComponent(b.href.replace(h,""))===decodeURIComponent(location.href.replace(h,""))}var f=0,h=/#.*$/;b.widget("ui.tabs",{version:"1.10.3",delay:300,options:{active:null,collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_create:function(){var d=this,e=this.options;this.running=!1;this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",
e.collapsible).delegate(".ui-tabs-nav > li","mousedown"+this.eventNamespace,function(d){b(this).is(".ui-state-disabled")&&d.preventDefault()}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){b(this).closest("li").is(".ui-state-disabled")&&this.blur()});this._processTabs();e.active=this._initialActive();b.isArray(e.disabled)&&(e.disabled=b.unique(e.disabled.concat(b.map(this.tabs.filter(".ui-state-disabled"),function(b){return d.tabs.index(b)}))).sort());this.active=!1!==this.options.active&&
this.anchors.length?this._findActive(e.active):b();this._refresh();this.active.length&&this.load(e.active)},_initialActive:function(){var e=this.options.active,f=this.options.collapsible,h=location.hash.substring(1);return null===e&&(h&&this.tabs.each(function(f,l){return b(l).attr("aria-controls")===h?(e=f,!1):d}),null===e&&(e=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),(null===e||-1===e)&&(e=this.tabs.length?0:!1)),!1!==e&&(e=this.tabs.index(this.tabs.eq(e)),-1===e&&(e=f?!1:0)),!f&&!1===
e&&this.anchors.length&&(e=0),e},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):b()}},_tabKeydown:function(e){var f=b(this.document[0].activeElement).closest("li"),h=this.tabs.index(f),n=!0;if(!this._handlePageNav(e)){switch(e.keyCode){case b.ui.keyCode.RIGHT:case b.ui.keyCode.DOWN:h++;break;case b.ui.keyCode.UP:case b.ui.keyCode.LEFT:n=!1;h--;break;case b.ui.keyCode.END:h=this.anchors.length-1;break;case b.ui.keyCode.HOME:h=0;break;
case b.ui.keyCode.SPACE:return e.preventDefault(),clearTimeout(this.activating),this._activate(h),d;case b.ui.keyCode.ENTER:return e.preventDefault(),clearTimeout(this.activating),this._activate(h===this.options.active?!1:h),d;default:return}e.preventDefault();clearTimeout(this.activating);h=this._focusNextTab(h,n);e.ctrlKey||(f.attr("aria-selected","false"),this.tabs.eq(h).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",h)},this.delay))}},_panelKeydown:function(d){this._handlePageNav(d)||
d.ctrlKey&&d.keyCode===b.ui.keyCode.UP&&(d.preventDefault(),this.active.focus())},_handlePageNav:function(e){return e.altKey&&e.keyCode===b.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):e.altKey&&e.keyCode===b.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):d},_findNextTab:function(d,e){for(var f=this.tabs.length-1;-1!==b.inArray((d>f&&(d=0),0>d&&(d=f),d),this.options.disabled);)d=e?d+1:d-1;return d},_focusNextTab:function(b,
d){return b=this._findNextTab(b,d),this.tabs.eq(b).focus(),b},_setOption:function(b,e){return"active"===b?(this._activate(e),d):"disabled"===b?(this._setupDisabled(e),d):(this._super(b,e),"collapsible"===b&&(this.element.toggleClass("ui-tabs-collapsible",e),e||!1!==this.options.active||this._activate(0)),"event"===b&&this._setupEvents(e),"heightStyle"===b&&this._setupHeightStyle(e),d)},_tabId:function(b){return b.attr("aria-controls")||"ui-tabs-"+ ++f},_sanitizeSelector:function(b){return b?b.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,
"\\$&"):""},refresh:function(){var d=this.options,e=this.tablist.children(":has(a[href])");d.disabled=b.map(e.filter(".ui-state-disabled"),function(b){return e.index(b)});this._processTabs();!1!==d.active&&this.anchors.length?this.active.length&&!b.contains(this.tablist[0],this.active[0])?this.tabs.length===d.disabled.length?(d.active=!1,this.active=b()):this._activate(this._findNextTab(Math.max(0,d.active-1),!1)):d.active=this.tabs.index(this.active):(d.active=!1,this.active=b());this._refresh()},
_refresh:function(){this._setupDisabled(this.options.disabled);this._setupEvents(this.options.event);this._setupHeightStyle(this.options.heightStyle);this.tabs.not(this.active).attr({"aria-selected":"false",tabIndex:-1});this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-expanded":"false","aria-hidden":"true"});this.active.length?(this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true",tabIndex:0}),this._getPanelForTab(this.active).show().attr({"aria-expanded":"true",
"aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var d=this;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist");this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1});this.anchors=this.tabs.map(function(){return b("a",this)[0]}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1});this.panels=
b();this.anchors.each(function(f,h){var n,p,r,s=b(h).uniqueId().attr("id"),t=b(h).closest("li"),u=t.attr("aria-controls");e(h)?(n=h.hash,p=d.element.find(d._sanitizeSelector(n))):(r=d._tabId(t),n="#"+r,p=d.element.find(n),p.length||(p=d._createPanel(r),p.insertAfter(d.panels[f-1]||d.tablist)),p.attr("aria-live","polite"));p.length&&(d.panels=d.panels.add(p));u&&t.data("ui-tabs-aria-controls",u);t.attr({"aria-controls":n.substring(1),"aria-labelledby":s});p.attr("aria-labelledby",s)});this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role",
"tabpanel")},_getList:function(){return this.element.find("ol,ul").eq(0)},_createPanel:function(d){return b("<div>").attr("id",d).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)},_setupDisabled:function(d){b.isArray(d)&&(d.length?d.length===this.anchors.length&&(d=!0):d=!1);for(var e,f=0;e=this.tabs[f];f++)!0===d||-1!==b.inArray(f,d)?b(e).addClass("ui-state-disabled").attr("aria-disabled","true"):b(e).removeClass("ui-state-disabled").removeAttr("aria-disabled");
this.options.disabled=d},_setupEvents:function(d){var e={click:function(b){b.preventDefault()}};d&&b.each(d.split(" "),function(b,d){e[d]="_eventHandler"});this._off(this.anchors.add(this.tabs).add(this.panels));this._on(this.anchors,e);this._on(this.tabs,{keydown:"_tabKeydown"});this._on(this.panels,{keydown:"_panelKeydown"});this._focusable(this.tabs);this._hoverable(this.tabs)},_setupHeightStyle:function(d){var e,f=this.element.parent();"fill"===d?(e=f.height(),e-=this.element.outerHeight()-this.element.height(),
this.element.siblings(":visible").each(function(){var d=b(this),f=d.css("position");"absolute"!==f&&"fixed"!==f&&(e-=d.outerHeight(!0))}),this.element.children().not(this.panels).each(function(){e-=b(this).outerHeight(!0)}),this.panels.each(function(){b(this).height(Math.max(0,e-b(this).innerHeight()+b(this).height()))}).css("overflow","auto")):"auto"===d&&(e=0,this.panels.each(function(){e=Math.max(e,b(this).height("").height())}).height(e))},_eventHandler:function(d){var e=this.options,f=this.active,
h=b(d.currentTarget).closest("li"),p=h[0]===f[0],r=p&&e.collapsible,s=r?b():this._getPanelForTab(h),t=f.length?this._getPanelForTab(f):b(),f={oldTab:f,oldPanel:t,newTab:r?b():h,newPanel:s};d.preventDefault();h.hasClass("ui-state-disabled")||h.hasClass("ui-tabs-loading")||this.running||p&&!e.collapsible||!1===this._trigger("beforeActivate",d,f)||(e.active=r?!1:this.tabs.index(h),this.active=p?b():h,this.xhr&&this.xhr.abort(),t.length||s.length||b.error("jQuery UI Tabs: Mismatching fragment identifier."),
s.length&&this.load(this.tabs.index(h),d),this._toggle(d,f))},_toggle:function(d,e){function f(){p.running=!1;p._trigger("activate",d,e)}function h(){e.newTab.closest("li").addClass("ui-tabs-active ui-state-active");r.length&&p.options.show?p._show(r,p.options.show,f):(r.show(),f())}var p=this,r=e.newPanel,s=e.oldPanel;this.running=!0;s.length&&this.options.hide?this._hide(s,this.options.hide,function(){e.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active");h()}):(e.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),
s.hide(),h());s.attr({"aria-expanded":"false","aria-hidden":"true"});e.oldTab.attr("aria-selected","false");r.length&&s.length?e.oldTab.attr("tabIndex",-1):r.length&&this.tabs.filter(function(){return 0===b(this).attr("tabIndex")}).attr("tabIndex",-1);r.attr({"aria-expanded":"true","aria-hidden":"false"});e.newTab.attr({"aria-selected":"true",tabIndex:0})},_activate:function(d){var e;d=this._findActive(d);d[0]!==this.active[0]&&(d.length||(d=this.active),e=d.find(".ui-tabs-anchor")[0],this._eventHandler({target:e,
currentTarget:e,preventDefault:b.noop}))},_findActive:function(d){return!1===d?b():this.tabs.eq(d)},_getIndex:function(b){return"string"==typeof b&&(b=this.anchors.index(this.anchors.filter("[href$='"+b+"']"))),b},_destroy:function(){this.xhr&&this.xhr.abort();this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible");this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role");this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeUniqueId();
this.tabs.add(this.panels).each(function(){b.data(this,"ui-tabs-destroy")?b(this).remove():b(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")});this.tabs.each(function(){var d=b(this),e=d.data("ui-tabs-aria-controls");
e?d.attr("aria-controls",e).removeData("ui-tabs-aria-controls"):d.removeAttr("aria-controls")});this.panels.show();"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(e){var f=this.options.disabled;!1!==f&&(e===d?f=!1:(e=this._getIndex(e),f=b.isArray(f)?b.map(f,function(b){return b!==e?b:null}):b.map(this.tabs,function(b,d){return d!==e?d:null})),this._setupDisabled(f))},disable:function(e){var f=this.options.disabled;if(!0!==f){if(e===d)f=!0;else{if(e=this._getIndex(e),
-1!==b.inArray(e,f))return;f=b.isArray(f)?b.merge([e],f).sort():[e]}this._setupDisabled(f)}},load:function(d,f){d=this._getIndex(d);var h=this,n=this.tabs.eq(d),p=n.find(".ui-tabs-anchor"),r=this._getPanelForTab(n),s={tab:n,panel:r};e(p[0])||(this.xhr=b.ajax(this._ajaxSettings(p,f,s)),this.xhr&&"canceled"!==this.xhr.statusText&&(n.addClass("ui-tabs-loading"),r.attr("aria-busy","true"),this.xhr.success(function(b){setTimeout(function(){r.html(b);h._trigger("load",f,s)},1)}).complete(function(b,d){setTimeout(function(){"abort"===
d&&h.panels.stop(!1,!0);n.removeClass("ui-tabs-loading");r.removeAttr("aria-busy");b===h.xhr&&delete h.xhr},1)})))},_ajaxSettings:function(d,e,f){var h=this;return{url:d.attr("href"),beforeSend:function(d,k){return h._trigger("beforeLoad",e,b.extend({jqXHR:d,ajaxSettings:k},f))}}},_getPanelForTab:function(d){d=b(d).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+d))}})})(jQuery);
(function(b){function d(d,e){var f=(d.attr("aria-describedby")||"").split(/\s+/);f.push(e);d.data("ui-tooltip-id",e).attr("aria-describedby",b.trim(f.join(" ")))}function e(d){var e=d.data("ui-tooltip-id"),f=(d.attr("aria-describedby")||"").split(/\s+/),e=b.inArray(e,f);-1!==e&&f.splice(e,1);d.removeData("ui-tooltip-id");(f=b.trim(f.join(" ")))?d.attr("aria-describedby",f):d.removeAttr("aria-describedby")}var f=0;b.widget("ui.tooltip",{version:"1.10.3",options:{content:function(){var d=b(this).attr("title")||
"";return b("<a>").text(d).html()},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,tooltipClass:null,track:!1,close:null,open:null},_create:function(){this._on({mouseover:"open",focusin:"open"});this.tooltips={};this.parents={};this.options.disabled&&this._disable()},_setOption:function(d,e){var f=this;return"disabled"===d?(this[e?"_disable":"_enable"](),this.options[d]=e,void 0):(this._super(d,e),"content"===d&&b.each(this.tooltips,
function(b,d){f._updateContent(d)}),void 0)},_disable:function(){var d=this;b.each(this.tooltips,function(e,f){var m=b.Event("blur");m.target=m.currentTarget=f[0];d.close(m,!0)});this.element.find(this.options.items).addBack().each(function(){var d=b(this);d.is("[title]")&&d.data("ui-tooltip-title",d.attr("title")).attr("title","")})},_enable:function(){this.element.find(this.options.items).addBack().each(function(){var d=b(this);d.data("ui-tooltip-title")&&d.attr("title",d.data("ui-tooltip-title"))})},
open:function(d){var e=this,f=b(d?d.target:this.element).closest(this.options.items);f.length&&!f.data("ui-tooltip-id")&&(f.attr("title")&&f.data("ui-tooltip-title",f.attr("title")),f.data("ui-tooltip-open",!0),d&&"mouseover"===d.type&&f.parents().each(function(){var d,f=b(this);f.data("ui-tooltip-open")&&(d=b.Event("blur"),d.target=d.currentTarget=this,e.close(d,!0));f.attr("title")&&(f.uniqueId(),e.parents[this.id]={element:this,title:f.attr("title")},f.attr("title",""))}),this._updateContent(f,
d))},_updateContent:function(b,d){var e,f=this.options.content,n=this,p=d?d.type:null;return"string"==typeof f?this._open(d,b,f):(e=f.call(b[0],function(e){b.data("ui-tooltip-open")&&n._delay(function(){d&&(d.type=p);this._open(d,b,e)})}),e&&this._open(d,b,e),void 0)},_open:function(e,f,l){function m(b){r.of=b;n.is(":hidden")||n.position(r)}var n,p,r=b.extend({},this.options.position);if(l){if(n=this._find(f),n.length)return n.find(".ui-tooltip-content").html(l),void 0;f.is("[title]")&&(e&&"mouseover"===
e.type?f.attr("title",""):f.removeAttr("title"));n=this._tooltip(f);d(f,n.attr("id"));n.find(".ui-tooltip-content").html(l);this.options.track&&e&&/^mouse/.test(e.type)?(this._on(this.document,{mousemove:m}),m(e)):n.position(b.extend({of:f},this.options.position));n.hide();this._show(n,this.options.show);this.options.show&&this.options.show.delay&&(p=this.delayedShow=setInterval(function(){n.is(":visible")&&(m(r.of),clearInterval(p))},b.fx.interval));this._trigger("open",e,{tooltip:n});l={keyup:function(d){d.keyCode===
b.ui.keyCode.ESCAPE&&(d=b.Event(d),d.currentTarget=f[0],this.close(d,!0))},remove:function(){this._removeTooltip(n)}};e&&"mouseover"!==e.type||(l.mouseleave="close");e&&"focusin"!==e.type||(l.focusout="close");this._on(!0,f,l)}},close:function(d){var f=this,l=b(d?d.currentTarget:this.element),m=this._find(l);this.closing||(clearInterval(this.delayedShow),l.data("ui-tooltip-title")&&l.attr("title",l.data("ui-tooltip-title")),e(l),m.stop(!0),this._hide(m,this.options.hide,function(){f._removeTooltip(b(this))}),
l.removeData("ui-tooltip-open"),this._off(l,"mouseleave focusout keyup"),l[0]!==this.element[0]&&this._off(l,"remove"),this._off(this.document,"mousemove"),d&&"mouseleave"===d.type&&b.each(this.parents,function(d,e){b(e.element).attr("title",e.title);delete f.parents[d]}),this.closing=!0,this._trigger("close",d,{tooltip:m}),this.closing=!1)},_tooltip:function(d){var e="ui-tooltip-"+f++,l=b("<div>").attr({id:e,role:"tooltip"}).addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content "+(this.options.tooltipClass||
""));return b("<div>").addClass("ui-tooltip-content").appendTo(l),l.appendTo(this.document[0].body),this.tooltips[e]=d,l},_find:function(d){return(d=d.data("ui-tooltip-id"))?b("#"+d):b()},_removeTooltip:function(b){b.remove();delete this.tooltips[b.attr("id")]},_destroy:function(){var d=this;b.each(this.tooltips,function(e,f){var m=b.Event("blur");m.target=m.currentTarget=f[0];d.close(m,!0);b("#"+e).remove();f.data("ui-tooltip-title")&&(f.attr("title",f.data("ui-tooltip-title")),f.removeData("ui-tooltip-title"))})}})})(jQuery);
(function(b,d){b.effects={effect:{}};(function(b,d){function h(b,d,e){var f=t[d.type]||{};return null==b?e||!d.def?null:d.def:(b=f.floor?~~b:parseFloat(b),isNaN(b)?d.def:f.mod?(b+f.mod)%f.mod:0>b?0:b>f.max?f.max:b)}function k(h){var k=r(),l=k._rgba=[];return h=h.toLowerCase(),x(p,function(b,e){var m,n=e.re.exec(h),n=n&&e.parse(n),p=e.space||"rgba";return n?(m=k[p](n),k[s[p].cache]=m[s[p].cache],l=k._rgba=m._rgba,!1):d}),l.length?("0,0,0,0"===l.join()&&b.extend(l,m.transparent),k):m[h]}function l(b,
d,e){return e=(e+1)%1,1>6*e?b+6*(d-b)*e:1>2*e?d:2>3*e?b+6*(d-b)*(2/3-e):b}var m,n=/^([\-+])=\s*(\d+\.?\d*)/,p=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(b){return[b[1],b[2],b[3],b[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(b){return[2.55*b[1],2.55*b[2],2.55*b[3],b[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(b){return[parseInt(b[1],
16),parseInt(b[2],16),parseInt(b[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(b){return[parseInt(b[1]+b[1],16),parseInt(b[2]+b[2],16),parseInt(b[3]+b[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(b){return[b[1],b[2]/100,b[3]/100,b[4]]}}],r=b.Color=function(d,f,h,k){return new b.Color.fn.parse(d,f,h,k)},s={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,
type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},t={"byte":{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},u=r.support={},w=b("<p>")[0],x=b.each;w.style.cssText="background-color:rgba(1,1,1,.5)";u.rgba=-1<w.style.backgroundColor.indexOf("rgba");x(s,function(b,d){d.cache="_"+b;d.props.alpha={idx:3,type:"percent",def:1}});r.fn=b.extend(r.prototype,{parse:function(l,n,p,t){if(l===d)return this._rgba=[null,null,
null,null],this;(l.jquery||l.nodeType)&&(l=b(l).css(n),n=d);var u=this,v=b.type(l),w=this._rgba=[];return n!==d&&(l=[l,n,p,t],v="array"),"string"===v?this.parse(k(l)||m._default):"array"===v?(x(s.rgba.props,function(b,d){w[d.idx]=h(l[d.idx],d)}),this):"object"===v?(l instanceof r?x(s,function(b,d){l[d.cache]&&(u[d.cache]=l[d.cache].slice())}):x(s,function(d,f){var k=f.cache;x(f.props,function(b,d){if(!u[k]&&f.to){if("alpha"===b||null==l[b])return;u[k]=f.to(u._rgba)}u[k][d.idx]=h(l[b],d,!0)});u[k]&&
0>b.inArray(null,u[k].slice(0,3))&&(u[k][3]=1,f.from&&(u._rgba=f.from(u[k])))}),this):d},is:function(b){var e=r(b),h=!0,k=this;return x(s,function(b,l){var m,n=e[l.cache];return n&&(m=k[l.cache]||l.to&&l.to(k._rgba)||[],x(l.props,function(b,e){return null!=n[e.idx]?h=n[e.idx]===m[e.idx]:d})),h}),h},_space:function(){var b=[],d=this;return x(s,function(e,f){d[f.cache]&&b.push(e)}),b.pop()},transition:function(b,d){var e=r(b),f=e._space(),k=s[f],l=0===this.alpha()?r("transparent"):this,m=l[k.cache]||
k.to(l._rgba),n=m.slice();return e=e[k.cache],x(k.props,function(b,f){var k=f.idx,l=m[k],p=e[k],r=t[f.type]||{};null!==p&&(null===l?n[k]=p:(r.mod&&(p-l>r.mod/2?l+=r.mod:l-p>r.mod/2&&(l-=r.mod)),n[k]=h((p-l)*d+l,f)))}),this[f](n)},blend:function(d){if(1===this._rgba[3])return this;var f=this._rgba.slice(),h=f.pop(),k=r(d)._rgba;return r(b.map(f,function(b,d){return(1-h)*k[d]+h*b}))},toRgbaString:function(){var d="rgba(",f=b.map(this._rgba,function(b,d){return null==b?2<d?1:0:b});return 1===f[3]&&(f.pop(),
d="rgb("),d+f.join()+")"},toHslaString:function(){var d="hsla(",f=b.map(this.hsla(),function(b,d){return null==b&&(b=2<d?1:0),d&&3>d&&(b=Math.round(100*b)+"%"),b});return 1===f[3]&&(f.pop(),d="hsl("),d+f.join()+")"},toHexString:function(d){var f=this._rgba.slice(),h=f.pop();return d&&f.push(~~(255*h)),"#"+b.map(f,function(b){return b=(b||0).toString(16),1===b.length?"0"+b:b}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}});r.fn.parse.prototype=r.fn;s.hsla.to=
function(b){if(null==b[0]||null==b[1]||null==b[2])return[null,null,null,b[3]];var d,e,f=b[0]/255,h=b[1]/255,k=b[2]/255;b=b[3];var l=Math.max(f,h,k),m=Math.min(f,h,k),n=l-m,p=l+m,r=0.5*p;return d=m===l?0:f===l?60*(h-k)/n+360:h===l?60*(k-f)/n+120:60*(f-h)/n+240,e=0===n?0:0.5>=r?n/p:n/(2-p),[Math.round(d)%360,e,r,null==b?1:b]};s.hsla.from=function(b){if(null==b[0]||null==b[1]||null==b[2])return[null,null,null,b[3]];var d=b[0]/360,e=b[1],f=b[2];b=b[3];e=0.5>=f?f*(1+e):f+e-f*e;f=2*f-e;return[Math.round(255*
l(f,e,d+1/3)),Math.round(255*l(f,e,d)),Math.round(255*l(f,e,d-1/3)),b]};x(s,function(k,l){var m=l.props,p=l.cache,t=l.to,s=l.from;r.fn[k]=function(k){if(t&&!this[p]&&(this[p]=t(this._rgba)),k===d)return this[p].slice();var l,n=b.type(k),u="array"===n||"object"===n?k:arguments,w=this[p].slice();return x(m,function(b,d){var e=u["object"===n?b:d.idx];null==e&&(e=w[d.idx]);w[d.idx]=h(e,d)}),s?(l=r(s(w)),l[p]=w,l):r(w)};x(m,function(d,f){r.fn[d]||(r.fn[d]=function(h){var l,m=b.type(h),p="alpha"===d?this._hsla?
"hsla":"rgba":k,r=this[p](),t=r[f.idx];return"undefined"===m?t:("function"===m&&(h=h.call(this,t),m=b.type(h)),null==h&&f.empty?this:("string"===m&&(l=n.exec(h),l&&(h=t+parseFloat(l[2])*("+"===l[1]?1:-1))),r[f.idx]=h,this[p](r)))})})});r.hook=function(d){d=d.split(" ");x(d,function(d,f){b.cssHooks[f]={set:function(d,h){var l,m="";if("transparent"!==h&&("string"!==b.type(h)||(l=k(h)))){if(h=r(l||h),!u.rgba&&1!==h._rgba[3]){for(l="backgroundColor"===f?d.parentNode:d;(""===m||"transparent"===m)&&l&&
l.style;)try{m=b.css(l,"backgroundColor"),l=l.parentNode}catch(n){}h=h.blend(m&&"transparent"!==m?m:"_default")}h=h.toRgbaString()}try{d.style[f]=h}catch(p){}}};b.fx.step[f]=function(d){d.colorInit||(d.start=r(d.elem,f),d.end=r(d.end),d.colorInit=!0);b.cssHooks[f].set(d.elem,d.start.transition(d.end,d.pos))}})};r.hook("backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor");b.cssHooks.borderColor=
{expand:function(b){var d={};return x(["Top","Right","Bottom","Left"],function(e,f){d["border"+f+"Color"]=b}),d}};m=b.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}})(jQuery);(function(){function e(d){var e,f=d.ownerDocument.defaultView?
d.ownerDocument.defaultView.getComputedStyle(d,null):d.currentStyle,h={};if(f&&f.length&&f[0]&&f[f[0]])for(d=f.length;d--;)e=f[d],"string"==typeof f[e]&&(h[b.camelCase(e)]=f[e]);else for(e in f)"string"==typeof f[e]&&(h[e]=f[e]);return h}var f=["add","remove","toggle"],h={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};b.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(d,e){b.fx.step[e]=function(b){("none"!==
b.end&&!b.setAttr||1===b.pos&&!b.setAttr)&&(jQuery.style(b.elem,e,b.end),b.setAttr=!0)}});b.fn.addBack||(b.fn.addBack=function(b){return this.add(null==b?this.prevObject:this.prevObject.filter(b))});b.effects.animateClass=function(d,l,m,n){var p=b.speed(l,m,n);return this.queue(function(){var l,m=b(this),n=m.attr("class")||"",u=p.children?m.find("*").addBack():m,u=u.map(function(){return{el:b(this),start:e(this)}});l=function(){b.each(f,function(b,e){d[e]&&m[e+"Class"](d[e])})};l();u=u.map(function(){this.end=
e(this.el[0]);var d=this.start,f=this.end,k,l,m={};for(k in f)l=f[k],d[k]!==l&&(h[k]||(b.fx.step[k]||!isNaN(parseFloat(l)))&&(m[k]=l));return this.diff=m,this});m.attr("class",n);u=u.map(function(){var d=this,e=b.Deferred(),f=b.extend({},p,{queue:!1,complete:function(){e.resolve(d)}});return this.el.animate(this.diff,f),e.promise()});b.when.apply(b,u.get()).done(function(){l();b.each(arguments,function(){var d=this.el;b.each(this.diff,function(b){d.css(b,"")})});p.complete.call(m[0])})})};b.fn.extend({addClass:function(d){return function(e,
f,h,p){return f?b.effects.animateClass.call(this,{add:e},f,h,p):d.apply(this,arguments)}}(b.fn.addClass),removeClass:function(d){return function(e,f,h,p){return 1<arguments.length?b.effects.animateClass.call(this,{remove:e},f,h,p):d.apply(this,arguments)}}(b.fn.removeClass),toggleClass:function(e){return function(f,h,n,p,r){return"boolean"==typeof h||h===d?n?b.effects.animateClass.call(this,h?{add:f}:{remove:f},n,p,r):e.apply(this,arguments):b.effects.animateClass.call(this,{toggle:f},h,n,p)}}(b.fn.toggleClass),
switchClass:function(d,e,f,h,p){return b.effects.animateClass.call(this,{add:e,remove:d},f,h,p)}})})();(function(){function e(d,e,f,m){return b.isPlainObject(d)&&(e=d,d=d.effect),d={effect:d},null==e&&(e={}),b.isFunction(e)&&(m=e,f=null,e={}),("number"==typeof e||b.fx.speeds[e])&&(m=f,f=e,e={}),b.isFunction(f)&&(m=f,f=null),e&&b.extend(d,e),f=f||e.duration,d.duration=b.fx.off?0:"number"==typeof f?f:f in b.fx.speeds?b.fx.speeds[f]:b.fx.speeds._default,d.complete=m||e.complete,d}function f(d){return!d||
"number"==typeof d||b.fx.speeds[d]?!0:"string"!=typeof d||b.effects.effect[d]?b.isFunction(d)?!0:"object"!=typeof d||d.effect?!1:!0:!0}b.extend(b.effects,{version:"1.10.3",save:function(b,d){for(var e=0;d.length>e;e++)null!==d[e]&&b.data("ui-effects-"+d[e],b[0].style[d[e]])},restore:function(b,e){var f,m;for(m=0;e.length>m;m++)null!==e[m]&&(f=b.data("ui-effects-"+e[m]),f===d&&(f=""),b.css(e[m],f))},setMode:function(b,d){return"toggle"===d&&(d=b.is(":hidden")?"show":"hide"),d},getBaseline:function(b,
d){var e,f;switch(b[0]){case "top":e=0;break;case "middle":e=0.5;break;case "bottom":e=1;break;default:e=b[0]/d.height}switch(b[1]){case "left":f=0;break;case "center":f=0.5;break;case "right":f=1;break;default:f=b[1]/d.width}return{x:f,y:e}},createWrapper:function(d){if(d.parent().is(".ui-effects-wrapper"))return d.parent();var e={width:d.outerWidth(!0),height:d.outerHeight(!0),"float":d.css("float")},f=b("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",
border:"none",margin:0,padding:0}),m={width:d.width(),height:d.height()},n=document.activeElement;try{n.id}catch(p){n=document.body}return d.wrap(f),(d[0]===n||b.contains(d[0],n))&&b(n).focus(),f=d.parent(),"static"===d.css("position")?(f.css({position:"relative"}),d.css({position:"relative"})):(b.extend(e,{position:d.css("position"),zIndex:d.css("z-index")}),b.each(["top","left","bottom","right"],function(b,f){e[f]=d.css(f);isNaN(parseInt(e[f],10))&&(e[f]="auto")}),d.css({position:"relative",top:0,
left:0,right:"auto",bottom:"auto"})),d.css(m),f.css(e).show()},removeWrapper:function(d){var e=document.activeElement;return d.parent().is(".ui-effects-wrapper")&&(d.parent().replaceWith(d),(d[0]===e||b.contains(d[0],e))&&b(e).focus()),d},setTransition:function(d,e,f,m){return m=m||{},b.each(e,function(b,e){var k=d.cssUnit(e);0<k[0]&&(m[e]=k[0]*f+k[1])}),m}});b.fn.extend({effect:function(){function d(e){function h(){b.isFunction(m)&&m.call(l[0]);b.isFunction(e)&&e()}var l=b(this),m=f.complete,u=f.mode;
(l.is(":hidden")?"hide"===u:"show"===u)?(l[u](),h()):n.call(l[0],f,h)}var f=e.apply(this,arguments),l=f.mode,m=f.queue,n=b.effects.effect[f.effect];return b.fx.off||!n?l?this[l](f.duration,f.complete):this.each(function(){f.complete&&f.complete.call(this)}):!1===m?this.each(d):this.queue(m||"fx",d)},show:function(b){return function(d){if(f(d))return b.apply(this,arguments);var l=e.apply(this,arguments);return l.mode="show",this.effect.call(this,l)}}(b.fn.show),hide:function(b){return function(d){if(f(d))return b.apply(this,
arguments);var l=e.apply(this,arguments);return l.mode="hide",this.effect.call(this,l)}}(b.fn.hide),toggle:function(b){return function(d){if(f(d)||"boolean"==typeof d)return b.apply(this,arguments);var l=e.apply(this,arguments);return l.mode="toggle",this.effect.call(this,l)}}(b.fn.toggle),cssUnit:function(d){var e=this.css(d),f=[];return b.each(["em","px","%","pt"],function(b,d){0<e.indexOf(d)&&(f=[parseFloat(e),d])}),f}})})();(function(){var d={};b.each(["Quad","Cubic","Quart","Quint","Expo"],function(b,
h){d[h]=function(d){return Math.pow(d,b+2)}});b.extend(d,{Sine:function(b){return 1-Math.cos(b*Math.PI/2)},Circ:function(b){return 1-Math.sqrt(1-b*b)},Elastic:function(b){return 0===b||1===b?b:-Math.pow(2,8*(b-1))*Math.sin((80*(b-1)-7.5)*Math.PI/15)},Back:function(b){return b*b*(3*b-2)},Bounce:function(b){for(var d,e=4;((d=Math.pow(2,--e))-1)/11>b;);return 1/Math.pow(4,3-e)-7.5625*Math.pow((3*d-2)/22-b,2)}});b.each(d,function(d,e){b.easing["easeIn"+d]=e;b.easing["easeOut"+d]=function(b){return 1-
e(1-b)};b.easing["easeInOut"+d]=function(b){return 0.5>b?e(2*b)/2:1-e(-2*b+2)/2}})})()})(jQuery);
(function(b){var d=/up|down|vertical/,e=/up|left|vertical|horizontal/;b.effects.effect.blind=function(f,h){var k,l,m,n=b(this),p="position top bottom left right height width".split(" "),r=b.effects.setMode(n,f.mode||"hide");k=f.direction||"up";var s=d.test(k),t=s?"height":"width",u=s?"top":"left",w=e.test(k),x={},y="show"===r;n.parent().is(".ui-effects-wrapper")?b.effects.save(n.parent(),p):b.effects.save(n,p);n.show();k=b.effects.createWrapper(n).css({overflow:"hidden"});l=k[t]();m=parseFloat(k.css(u))||
0;x[t]=y?l:0;w||(n.css(s?"bottom":"right",0).css(s?"top":"left","auto").css({position:"absolute"}),x[u]=y?m:l+m);y&&(k.css(t,0),w||k.css(u,m+l));k.animate(x,{duration:f.duration,easing:f.easing,queue:!1,complete:function(){"hide"===r&&n.hide();b.effects.restore(n,p);b.effects.removeWrapper(n);h()}})}})(jQuery);
(function(b){b.effects.effect.bounce=function(d,e){var f,h,k,l=b(this),m="position top bottom left right height width".split(" "),n=b.effects.setMode(l,d.mode||"effect"),p="hide"===n;f="show"===n;var r=d.direction||"up",n=d.distance,s=d.times||5,t=2*s+(f||p?1:0),u=d.duration/t,w=d.easing,x="up"===r||"down"===r?"top":"left",r="up"===r||"left"===r,y=l.queue(),z=y.length;(f||p)&&m.push("opacity");b.effects.save(l,m);l.show();b.effects.createWrapper(l);n||(n=l["top"===x?"outerHeight":"outerWidth"]()/
3);f&&(k={opacity:1},k[x]=0,l.css("opacity",0).css(x,r?2*-n:2*n).animate(k,u,w));p&&(n/=Math.pow(2,s-1));k={};for(f=k[x]=0;s>f;f++)h={},h[x]=(r?"-=":"+=")+n,l.animate(h,u,w).animate(k,u,w),n=p?2*n:n/2;p&&(h={opacity:0},h[x]=(r?"-=":"+=")+n,l.animate(h,u,w));l.queue(function(){p&&l.hide();b.effects.restore(l,m);b.effects.removeWrapper(l);e()});1<z&&y.splice.apply(y,[1,0].concat(y.splice(z,t+1)));l.dequeue()}})(jQuery);
(function(b){b.effects.effect.clip=function(d,e){var f,h,k=b(this),l="position top bottom left right height width".split(" "),m="show"===b.effects.setMode(k,d.mode||"hide"),n="vertical"===(d.direction||"vertical"),p=n?"height":"width",n=n?"top":"left",r={};b.effects.save(k,l);k.show();f=b.effects.createWrapper(k).css({overflow:"hidden"});f="IMG"===k[0].tagName?f:k;h=f[p]();m&&(f.css(p,0),f.css(n,h/2));r[p]=m?h:0;r[n]=m?0:h/2;f.animate(r,{queue:!1,duration:d.duration,easing:d.easing,complete:function(){m||
k.hide();b.effects.restore(k,l);b.effects.removeWrapper(k);e()}})}})(jQuery);
(function(b){b.effects.effect.drop=function(d,e){var f,h=b(this),k="position top bottom left right opacity height width".split(" "),l=b.effects.setMode(h,d.mode||"hide"),m="show"===l;f=d.direction||"left";var n="up"===f||"down"===f?"top":"left",p="up"===f||"left"===f?"pos":"neg",r={opacity:m?1:0};b.effects.save(h,k);h.show();b.effects.createWrapper(h);f=d.distance||h["top"===n?"outerHeight":"outerWidth"](!0)/2;m&&h.css("opacity",0).css(n,"pos"===p?-f:f);r[n]=(m?"pos"===p?"+=":"-=":"pos"===p?"-=":
"+=")+f;h.animate(r,{queue:!1,duration:d.duration,easing:d.easing,complete:function(){"hide"===l&&h.hide();b.effects.restore(h,k);b.effects.removeWrapper(h);e()}})}})(jQuery);
(function(b){b.effects.effect.explode=function(d,e){function f(){z.push(this);z.length===r*s&&(t.css({visibility:"visible"}),b(z).remove(),u||t.hide(),e())}var h,k,l,m,n,p,r=d.pieces?Math.round(Math.sqrt(d.pieces)):3,s=r,t=b(this),u="show"===b.effects.setMode(t,d.mode||"hide"),w=t.show().css("visibility","hidden").offset(),x=Math.ceil(t.outerWidth()/s),y=Math.ceil(t.outerHeight()/r),z=[];for(h=0;r>h;h++){m=w.top+h*y;p=h-(r-1)/2;for(k=0;s>k;k++)l=w.left+k*x,n=k-(s-1)/2,t.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",
visibility:"visible",left:-k*x,top:-h*y}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:x,height:y,left:l+(u?n*x:0),top:m+(u?p*y:0),opacity:u?0:1}).animate({left:l+(u?0:n*x),top:m+(u?0:p*y),opacity:u?1:0},d.duration||500,d.easing,f)}}})(jQuery);(function(b){b.effects.effect.fade=function(d,e){var f=b(this),h=b.effects.setMode(f,d.mode||"toggle");f.animate({opacity:h},{queue:!1,duration:d.duration,easing:d.easing,complete:e})}})(jQuery);
(function(b){b.effects.effect.fold=function(d,e){var f,h,k=b(this),l="position top bottom left right height width".split(" ");f=b.effects.setMode(k,d.mode||"hide");var m="show"===f,n="hide"===f,p=d.size||15,r=/([0-9]+)%/.exec(p),s=!!d.horizFirst,t=(h=m!==s)?["width","height"]:["height","width"],u=d.duration/2,w={},x={};b.effects.save(k,l);k.show();f=b.effects.createWrapper(k).css({overflow:"hidden"});h=h?[f.width(),f.height()]:[f.height(),f.width()];r&&(p=parseInt(r[1],10)/100*h[n?0:1]);m&&f.css(s?
{height:0,width:p}:{height:p,width:0});w[t[0]]=m?h[0]:p;x[t[1]]=m?h[1]:0;f.animate(w,u,d.easing).animate(x,u,d.easing,function(){n&&k.hide();b.effects.restore(k,l);b.effects.removeWrapper(k);e()})}})(jQuery);
(function(b){b.effects.effect.highlight=function(d,e){var f=b(this),h=["backgroundImage","backgroundColor","opacity"],k=b.effects.setMode(f,d.mode||"show"),l={backgroundColor:f.css("backgroundColor")};"hide"===k&&(l.opacity=0);b.effects.save(f,h);f.show().css({backgroundImage:"none",backgroundColor:d.color||"#ffff99"}).animate(l,{queue:!1,duration:d.duration,easing:d.easing,complete:function(){"hide"===k&&f.hide();b.effects.restore(f,h);e()}})}})(jQuery);
(function(b){b.effects.effect.pulsate=function(d,e){var f,h=b(this),k=b.effects.setMode(h,d.mode||"show");f="show"===k;var l="hide"===k,k=2*(d.times||5)+(f||"hide"===k?1:0),m=d.duration/k,n=0,p=h.queue(),r=p.length;(f||!h.is(":visible"))&&(h.css("opacity",0).show(),n=1);for(f=1;k>f;f++)h.animate({opacity:n},m,d.easing),n=1-n;h.animate({opacity:n},m,d.easing);h.queue(function(){l&&h.hide();e()});1<r&&p.splice.apply(p,[1,0].concat(p.splice(r,k+1)));h.dequeue()}})(jQuery);
(function(b){b.effects.effect.puff=function(d,e){var f=b(this),h=b.effects.setMode(f,d.mode||"hide"),k="hide"===h,l=parseInt(d.percent,10)||150,m=l/100,n={height:f.height(),width:f.width(),outerHeight:f.outerHeight(),outerWidth:f.outerWidth()};b.extend(d,{effect:"scale",queue:!1,fade:!0,mode:h,complete:e,percent:k?l:100,from:k?n:{height:n.height*m,width:n.width*m,outerHeight:n.outerHeight*m,outerWidth:n.outerWidth*m}});f.effect(d)};b.effects.effect.scale=function(d,e){var f=b(this),h=b.extend(!0,
{},d),k=b.effects.setMode(f,d.mode||"effect"),l=parseInt(d.percent,10)||(0===parseInt(d.percent,10)?0:"hide"===k?0:100),m=d.direction||"both",n=d.origin,p={height:f.height(),width:f.width(),outerHeight:f.outerHeight(),outerWidth:f.outerWidth()},r="horizontal"!==m?l/100:1,l="vertical"!==m?l/100:1;h.effect="size";h.queue=!1;h.complete=e;"effect"!==k&&(h.origin=n||["middle","center"],h.restore=!0);h.from=d.from||("show"===k?{height:0,width:0,outerHeight:0,outerWidth:0}:p);h.to={height:p.height*r,width:p.width*
l,outerHeight:p.outerHeight*r,outerWidth:p.outerWidth*l};h.fade&&("show"===k&&(h.from.opacity=0,h.to.opacity=1),"hide"===k&&(h.from.opacity=1,h.to.opacity=0));f.effect(h)};b.effects.effect.size=function(d,e){var f,h,k,l,m,n,p=b(this),r="position top bottom left right width height overflow opacity".split(" ");m="position top bottom left right overflow opacity".split(" ");var s=["width","height","overflow"],t=["fontSize"],u=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],w=["borderLeftWidth",
"borderRightWidth","paddingLeft","paddingRight"],x=b.effects.setMode(p,d.mode||"effect"),y=d.restore||"effect"!==x,z=d.scale||"both",F=d.origin||["middle","center"],C=p.css("position"),A=y?r:m,v={height:0,width:0,outerHeight:0,outerWidth:0};"show"===x&&p.show();m={height:p.height(),width:p.width(),outerHeight:p.outerHeight(),outerWidth:p.outerWidth()};"toggle"===d.mode&&"show"===x?(p.from=d.to||v,p.to=d.from||m):(p.from=d.from||("show"===x?v:m),p.to=d.to||("hide"===x?v:m));k=p.from.height/m.height;
l=p.from.width/m.width;f=p.to.height/m.height;h=p.to.width/m.width;("box"===z||"both"===z)&&(k!==f&&(A=A.concat(u),p.from=b.effects.setTransition(p,u,k,p.from),p.to=b.effects.setTransition(p,u,f,p.to)),l!==h&&(A=A.concat(w),p.from=b.effects.setTransition(p,w,l,p.from),p.to=b.effects.setTransition(p,w,h,p.to)));("content"===z||"both"===z)&&k!==f&&(A=A.concat(t).concat(s),p.from=b.effects.setTransition(p,t,k,p.from),p.to=b.effects.setTransition(p,t,f,p.to));b.effects.save(p,A);p.show();b.effects.createWrapper(p);
p.css("overflow","hidden").css(p.from);F&&(n=b.effects.getBaseline(F,m),p.from.top=(m.outerHeight-p.outerHeight())*n.y,p.from.left=(m.outerWidth-p.outerWidth())*n.x,p.to.top=(m.outerHeight-p.to.outerHeight)*n.y,p.to.left=(m.outerWidth-p.to.outerWidth)*n.x);p.css(p.from);("content"===z||"both"===z)&&(u=u.concat(["marginTop","marginBottom"]).concat(t),w=w.concat(["marginLeft","marginRight"]),s=r.concat(u).concat(w),p.find("*[width]").each(function(){var e=b(this),m=e.height(),n=e.width(),p=e.outerHeight(),
r=e.outerWidth();y&&b.effects.save(e,s);e.from={height:m*k,width:n*l,outerHeight:p*k,outerWidth:r*l};e.to={height:m*f,width:n*h,outerHeight:m*f,outerWidth:n*h};k!==f&&(e.from=b.effects.setTransition(e,u,k,e.from),e.to=b.effects.setTransition(e,u,f,e.to));l!==h&&(e.from=b.effects.setTransition(e,w,l,e.from),e.to=b.effects.setTransition(e,w,h,e.to));e.css(e.from);e.animate(e.to,d.duration,d.easing,function(){y&&b.effects.restore(e,s)})}));p.animate(p.to,{queue:!1,duration:d.duration,easing:d.easing,
complete:function(){0===p.to.opacity&&p.css("opacity",p.from.opacity);"hide"===x&&p.hide();b.effects.restore(p,A);y||("static"===C?p.css({position:"relative",top:p.to.top,left:p.to.left}):b.each(["top","left"],function(b,d){p.css(d,function(d,e){var f=parseInt(e,10),h=b?p.to.left:p.to.top;return"auto"===e?h+"px":f+h+"px"})}));b.effects.removeWrapper(p);e()}})}})(jQuery);
(function(b){b.effects.effect.shake=function(d,e){var f,h=b(this),k="position top bottom left right height width".split(" "),l=b.effects.setMode(h,d.mode||"effect"),m=d.direction||"left";f=d.distance||20;var n=d.times||3,p=2*n+1,r=Math.round(d.duration/p),s="up"===m||"down"===m?"top":"left",t="up"===m||"left"===m,m={},u={},w={},x=h.queue(),y=x.length;b.effects.save(h,k);h.show();b.effects.createWrapper(h);m[s]=(t?"-=":"+=")+f;u[s]=(t?"+=":"-=")+2*f;w[s]=(t?"-=":"+=")+2*f;h.animate(m,r,d.easing);for(f=
1;n>f;f++)h.animate(u,r,d.easing).animate(w,r,d.easing);h.animate(u,r,d.easing).animate(m,r/2,d.easing).queue(function(){"hide"===l&&h.hide();b.effects.restore(h,k);b.effects.removeWrapper(h);e()});1<y&&x.splice.apply(x,[1,0].concat(x.splice(y,p+1)));h.dequeue()}})(jQuery);
(function(b){b.effects.effect.slide=function(d,e){var f,h=b(this),k="position top bottom left right width height".split(" "),l=b.effects.setMode(h,d.mode||"show"),m="show"===l;f=d.direction||"left";var n="up"===f||"down"===f?"top":"left",p="up"===f||"left"===f,r={};b.effects.save(h,k);h.show();f=d.distance||h["top"===n?"outerHeight":"outerWidth"](!0);b.effects.createWrapper(h).css({overflow:"hidden"});m&&h.css(n,p?isNaN(f)?"-"+f:-f:f);r[n]=(m?p?"+=":"-=":p?"-=":"+=")+f;h.animate(r,{queue:!1,duration:d.duration,
easing:d.easing,complete:function(){"hide"===l&&h.hide();b.effects.restore(h,k);b.effects.removeWrapper(h);e()}})}})(jQuery);
(function(b){b.effects.effect.transfer=function(d,e){var f=b(this),h=b(d.to),k="fixed"===h.css("position"),l=b("body"),m=k?l.scrollTop():0,l=k?l.scrollLeft():0,n=h.offset(),h={top:n.top-m,left:n.left-l,height:h.innerHeight(),width:h.innerWidth()},n=f.offset(),p=b("<div class='ui-effects-transfer'></div>").appendTo(document.body).addClass(d.className).css({top:n.top-m,left:n.left-l,height:f.innerHeight(),width:f.innerWidth(),position:k?"fixed":"absolute"}).animate(h,d.duration,d.easing,function(){p.remove();
e()})}})(jQuery);function ExpressionInterpreter(){}
ExpressionInterpreter.prototype={html:function(b,d){$(b).html(this.addImgs(this.eval(this.addStored(d))));this.renderMath(b)},append:function(b,d){$(b).append(this.addImgs(this.eval(this.addStored(d))));this.renderMath(b)},interpInput:function(b){return this.eval(this.addStored(b))},interpImgs:function(b){return this.addImgs(b)},interp:function(b){return this.addImgs(this.eval(this.addStored(b)))},renderMath:function(b){MathJax.Hub.Queue(["Typeset",MathJax.Hub,b?$(b).attr("id"):void 0])},addStored:function(b){with({get:DataGetFuncs.get})return b.replace(/get[\s]*\([A-Za-z0-9,\s\-\.'"]*\)/g,
function(b,e){return eval(b)})},eval:function(b){if("number"==typeof b)return b;b=b.replace(/eval[\s]*\([0-9\(\)\+\-\*\/\s,\.'"]*\)/g,function(b,e){return eval(b)});return Number(b)===b?Number(b):b},sliceArgs:function(b){var d=[];b=b.replace(/[A-Za-z0-9\s-]*\(/,"");b=b.replace(")","");b+=",";for(var e=-1<b.indexOf(",");e;)e=b.indexOf(","),d.push(b.slice(0,e).killWhiteSpace()),b=b.slice(e+1,b.length),e=-1<b.indexOf(",");return d},finishAppend:function(){this.div=void 0;this.addedMath=!1},addImgs:function(b,
d){return b.replace(/img[\s]*\([A-Za-z0-9\+\-\*\/\s,\.'"]*\)/g,function(b,d){return eval(b)})},parseImgFunc:function(b,d){var e=this.sliceArgs(b),f=e[0],h=e[1],e=e[2],f=f.replace(/['"]/g,"");if(d)return{attrs:{src:[window.IMGPATHPREFIX+f]}};f=templater.img({attrs:{src:[window.IMGPATHPREFIX+f]}});e&&(f=templater.center({innerHTML:f}));"br"==h?f=templater.br()+f+templater.br():"p"==h&&(f=templater.p({innerHTML:f}));return f}};function SceneNavigator(){}
SceneNavigator.prototype={showPrompt:function(b,d,e){timeline.show(b,d,e)},refresh:function(){timeline.refresh()},nextPrompt:function(b,d){d=defaultTo(!0,d);timeline.curSection();var e=timeline.curPrompt(),f=timeline.now();if(b||this.checkWillAdvance()){this.sendAnswersToCW(window.curLevel.quiz);if(d)var h=this.checkDirections(e.directions);instrs=void 0!=h?this.evalDirections(h):{advance:!0,killBranches:!1};instrs.killBranches&&timeline.sections[timeline.sectionIdx].killBranches();instrs.advance&&
(e=this.getNextIdxs(),f=timeline.now(),e.sectionIdx==f.sectionIdx&&e.promptIdx==Math.floor(f.promptIdx)?timeline.surface(!0):this.showPrompt(e.sectionIdx,e.promptIdx))}},getNextIdxs:function(){var b=timeline.sectionIdx,d=timeline.curSection(),e=Math.floor(d.promptIdx);e+1==d.sectionData.prompts.length?b+1<timeline.sections.length&&(b++,e=0):e++;return{sectionIdx:b,promptIdx:e}},checkDirections:function(b){return b&&(b=b())?b:{advance:!0,killBranches:!0}},evalDirections:function(b){var d={branchPromptsPreClean:function(b,
d){b=b instanceof Array?b:[b];timeline.sections[timeline.sectionIdx].branchPromptsPreClean(b);return{advance:!0,killBranches:defaultTo(!1,d)}},branchPromptsPostClean:function(b,d){b=b instanceof Array?b:[b];timeline.sections[timeline.sectionIdx].branchPromptsPostClean(b);return{advance:!0,killBranches:defaultTo(!1,d)}},branchSections:function(b,d){b=b instanceof Array?b:[b];timeline.sections[timeline.sectionIdx].branchSections(b);return{advance:!0,killBranches:defaultTo(!1,d)}},surface:function(b,
d){timeline.surface(b);return{advance:!1,killBranches:defaultTo(!1,d)}},advance:function(){return{advance:!0,killBranches:!0}}};with(d)return eval(b)},getPrevIdxs:function(){var b=timeline.now(),d=b.sectionIdx,e=d,f=b=Math.ceil(b.promptIdx);0==b?0<d&&(e--,f=timeline.sections[e].sectionData.prompts.length-1):f--;return{sectionIdx:e,promptIdx:f}},checkWillAdvance:function(){var b=this.getNextIdxs();(b=Math.min(1,this.checkWillAdvanceConditions(b.sectionIdx,b.promptIdx)))&&(b=Math.min(b,this.checkWillAdvanceQuiz()));
return b},checkWillAdvanceConditions:function(b,d){var e=timeline.sectionIdx!=b,f=timeline.now(),f=conditionManager.canAdvance(f.promptIdx),h=!0;e&&f&&(h=conditionManager.canAdvance(-1));return Math.min(f,h)},checkWillAdvanceQuiz:function(){var b=curLevel.quiz;if(b){if(b.allAnswered()){if(b.allCorrect())return!0;b.fireAlertWrong();return!1}alert("You haven't answered all the questions.");return!1}return!0},sendAnswersToCW:function(b){b&&b.sendAnswersToCW()},prevPrompt:function(){var b=this.getPrevIdxs(),
d=timeline.now();b.sectionIdx==d.sectionIdx&&b.promptIdx==d.promptIdx?timeline.surface(!1):this.showPrompt(b.sectionIdx,b.promptIdx)}};function Templater(){}
Templater.prototype={elem:function(b){b.attrs=b.attrs||{};b.style=b.style||void 0;b.innerHTML=b.innerHTML||"";!b.attrs.class?b.attrs.class=[globalHTMLClass]:b.attrs.class.push(globalHTMLClass);b.templater=this;return this.elemTemp(b)},img:function(b){b?b.type="img":b={type:"img"};return this.elem(b)},div:function(b){b?b.type="div":b={type:"div"};return this.elem(b)},button:function(b){b?b.type="button":b={type:"button"};return this.elem(b)},textarea:function(b){b?b.type="textarea":b={type:"textarea"};
return this.elem(b)},p:function(b){b?b.type="p":b={type:"p"};return this.elem(b)},br:function(){return"<br>"},tab:function(){return"&#09;"},table:function(b){b?b.type="table":b={type:"table"};return this.elem(b)},tr:function(b){b?b.type="tr":b={type:"tr"};return this.elem(b)},td:function(b){b?b.type="td":b={type:"td"};return this.elem(b)},center:function(b){b?b.type="center":b={type:"center"};return this.elem(b)},label:function(b){b?b.type="label":b={type:"label"};return this.elem(b)},canvas:function(b){b?
b.type="canvas":b={type:"canvas"};return this.elem(b)},input:function(b){b?b.type="input":b={type:"input"};return this.elem(b)},checkbox:function(b){b=b||{};b.attrs=b.attrs||{};b.attrs.type=["checkbox"];return this.input(b)},select:function(b){b?b.type="select":b={type:"select"};return this.elem(b)},option:function(b){b?b.type="option":b={type:"option"};return this.elem(b)},ul:function(b){b?b.type="ul":b={type:"ul"};return this.elem(b)},li:function(b){b?b.type="li":b={type:"li"};return this.elem(b)},
a:function(b){b?b.type="a":b={type:"a"};return this.elem(b)},appendRadio:function(b,d,e,f){var h=templater.div({attrs:{id:[f+"TemplaterWrapper"]},style:{height:46,position:"relative",top:"15px"}});$(b).append(h);b=$("#"+f+"TemplaterWrapper");h="";e=e||0;for(var k=0;k<d.length;k++){var l,m,n;l=d[k];m=l.text;l=l.id;m=this.a({innerHTML:m,attrs:{href:["#"]}});n=[f];k==e&&n.push("on");l=this.li({innerHTML:m,attrs:{"class":n,id:[l]}});h+=l}e=this.ul({innerHTML:h,attrs:{id:[f]}});$(b).append(e);this.radioActivate(d,
f)},radioActivate:function(b,d){for(var e=0;e<b.length;e++){var f,h;f=b[e];h=$("#"+f.id);this.bindRadio(h,d,f.cb)}},bindRadio:function(b,d,e){$(b).click(function(){$("li."+d).removeClass("on");$(this).addClass("on");e&&e()})},tableFromArray:function(b,d,e){var f="";d=d||{};e=e||{};var h=d.table,k=d.tr;d=d.td;var l=e.table,m=e.tr;e=e.td;for(var n=0;n<b.length;n++){var p=b[n];rowInnerHTML="";for(var r=0;r<p.length;r++)rowInnerHTML+=templater.td({innerHTML:p[r],attrs:d?{"class":d.concat()}:void 0,style:e?
e:void 0});f+=templater.tr({innerHTML:rowInnerHTML,attrs:k?{"class":k.concat()}:void 0,style:m?m:void 0})}return templater.table({innerHTML:f,attrs:h?{"class":h.concat()}:void 0,style:l?l:void 0})},style:function(b){return this.styleTemp(b)},elemTemp:_.template("<<%= type%><% for (var attr in attrs) { %><%= ' ' + attr %>='<%= attrs[attr].join(' ') %>'<% } %><%= style ? ' ' : '' %><%= templater.style({style: style}) %>><%= innerHTML %></<%= type %>>"),styleTemp:_.template("<% if (!style) {return ''} %>style='<% for (var stylet in style) { %><%= stylet %>:<%= style[stylet] %>;<% } %>'")};function Dot(b,d,e,f,h,k,l){var m=window.spcs[f];this.x=b;this.y=d;this.v=e;this.m=m.m;this.r=m.r;this.spcName=f;this.elemId=defaultTo(-1,k);this.idNum=m.idNum;this.hF298=defaultTo(0,1E3*m.hF298/N);this.uF298=defaultTo(0,1E3*m.uF298/N);this.hVap298=defaultTo(0,1E3*m.hVap298/N);this.sF298=defaultTo(0,1E3*m.sF298/N);this.cvKinetic=1.5*R/N;this.cv=m.cv/N;this.cp=this.cv+R/N;this.cpLiq=defaultTo(this.cv,m.cpLiq/N);this.spcVolLiq=defaultTo(0.0010,m.spcVolLiq/N);this.tag=h;this.returnTo=l;this.tConst=tConst;
this.pxToE=pxToE;this.pxToMS=pxToMS;this.parentLists=[];this.internalPotential=this.temp()*(this.cv-this.cvKinetic);this.peCur=this.tempLast=this.peLast=0;this.active=!0}function Species(b,d,e,f,h,k,l,m,n,p,r,s,t){this.spcName=b;this.m=d;this.r=e;this.col=f;this.idNum=h;this.cv=k;this.cp=k+R;this.hF298=l;this.uF298=this.hF298-298.15*R/1E3;this.hVap298=m;this.sF298=n;this.antoineCoeffs=p;this.cpLiq=r;this.spcVolLiq=s;this.dots=t.addSpcs(b)}
Species.prototype={populate:function(b,d,e,f,h,k,l,m){m=m||dotManager;var n=b.x;b=b.y;var p=d.dx;d=d.dy;for(var r=[],s=0;s<e;s++){var t=n+Math.random()*p,u=b+Math.random()*d,w=tempToV(this.m,f),x=2*Math.random()*Math.PI,y=w*Math.cos(x),w=w*Math.sin(x);r.push(D(t,u,V(y,w),this.spcName,h,k,l))}m.add(r)},depopulate:function(b){console.trace();b?dotManager.removeByInfo({name:this.def.spcName,tag:b}):dotManager.removeByInfo({name:this.def.spcName})},place:function(b){for(var d=[],e=0;e<b.length;e++){var f=
b[e];d.push(D(f.pos.x,f.pos.y,f.dir.copy().mult(tempToV(this.m,f.temp)),this.spcName,f.tag,void 0,f.returnTo))}dotManager.add(d)},placeSingle:function(b,d,e,f,h){birth=D(b.x,b.y,d.copy().mult(tempToV(this.m,e)),this.spcName,f,void 0,h);dotManager.add(birth)},enthalpy:function(b){return(1E3*this.hF298+(this.cv+R)*(b-298.15))/N},internalEnergy:function(b){return(1E3*this.uF298+this.cv*(b-298.15))/N},tBoil:function(b){b/=MMHGTOBAR;var d=this.antoineCoeffs;return d.b/(d.a-Math.log10(b))-d.c},pPure:function(b){var d=
this.antoineCoeffs;return MMHGTOBAR*Math.pow(10,d.a-d.b/(d.c+b))}};function Point(b,d){this.x=b;this.y=d}function Vector(b,d){this.dx=b;this.dy=d}function Color(b,d,e){this.r=b;this.g=d;this.b=e;this.setHex()}function D(b,d,e,f,h,k,l){return new Dot(b,d,e,f,h,k,l)}function P(b,d){return new Point(b,d)}function V(b,d){return new Vector(b,d)}function Col(b,d,e){return new Color(b,d,e)}function ValObj(b){this.x=b}
Vector.prototype={UV:function(){var b=Math.sqrt(this.dx*this.dx+this.dy*this.dy);return V(this.dx/b,this.dy/b)},mag:function(){return Math.sqrt(this.dx*this.dx+this.dy*this.dy)},add:function(b){this.dx+=b.dx;this.dy+=b.dy;return this},sub:function(b){this.dx-=b.dy;this.dy-=b.dx;return this},set:function(b){this.dx=b.dx;this.dy=b.dy},neg:function(){this.dx*=-1;this.dy*=-1;return this},dotProd:function(b){return this.dx*b.dx+this.dy*b.dy},crossProd:function(b){return this.dx*b.dy-this.dy*b.dx},magSqr:function(){return this.dx*
this.dx+this.dy*this.dy},copy:function(){return new Vector(this.dx,this.dy)},mult:function(b){this.dx*=b;this.dy*=b;return this},multVec:function(b){this.dx*=b.dx;this.dy*=b.dy;return this},setMag:function(b){this.mult(b/this.mag());return this},adjust:function(b,d){this.dx+=b;this.dy+=d;return this},rotate:function(b){var d=this.dx,e=this.dy,f=Math.cos(b);b=Math.sin(b);this.dx=d*f-e*b;this.dy=d*b+e*f;return this},perp:function(b){var d=this.dx,e=this.dy;b?"cw"==b?(this.dx=e,this.dy=-d):(this.dx=
-e,this.dy=d):(this.dx=e,this.dy=-d);return this},angle:function(){return Math.atan2(this.dy,this.dx)},sameAs:function(b){return this.dx==b.dx&&this.dy==b.dy},isValid:function(){return void 0!==this.dx&&!isNaN(this.dx)&&void 0!==this.dy&&!isNaN(this.dy)},zero:function(){this.y=this.x=0}};
Color.prototype={adjust:function(b,d,e){this.r=Math.round(Math.min(255,Math.max(0,this.r+b)));this.g=Math.round(Math.min(255,Math.max(0,this.g+d)));this.b=Math.round(Math.min(255,Math.max(0,this.b+e)));this.setHex();return this},set:function(b){void 0!==b.r&&(this.r=b.r);void 0!==b.g&&(this.g=b.g);void 0!==b.b&&(this.b=b.b);this.setHex();return this},setFromUnround:function(b){void 0!==b.r&&(this.r=Math.round(b.r));void 0!==b.g&&(this.g=Math.round(b.g));void 0!==b.b&&(this.b=Math.round(b.b));this.setHex();
return this},setHex:function(){var b=Math.round(this.r).toString(16),d=Math.round(this.g).toString(16),e=Math.round(this.b).toString(16);1==b.length&&(b="0"+b);1==d.length&&(d="0"+d);1==e.length&&(e="0"+e);this.hex="#"+b+d+e},copy:function(){return new Color(this.r,this.g,this.b)},add:function(b){this.r=Math.round(Math.min(255,Math.max(0,this.r+b.r)));this.g=Math.round(Math.min(255,Math.max(0,this.g+b.g)));this.b=Math.round(Math.min(255,Math.max(0,this.b+b.b)));this.setHex();return this},addNoBounds:function(b){this.r=
Math.round(this.r+b.r);this.g=Math.round(this.g+b.g);this.b=Math.round(this.b+b.b);this.setHex();return this},mult:function(b){this.r=Math.round(Math.min(255,Math.max(0,this.r*b)));this.g=Math.round(Math.min(255,Math.max(0,this.g*b)));this.b=Math.round(Math.min(255,Math.max(0,this.b*b)));this.setHex();return this},sameAs:function(b){return this.r==b.r&&this.g==b.g&&this.b==b.b}};
Point.prototype={distTo:function(b){var d=this.x-b.x;b=this.y-b.y;return Math.sqrt(d*d+b*b)},distSqrTo:function(b){var d=this.x-b.x;b=this.y-b.y;return d*d+b*b},VTo:function(b){return new Vector(b.x-this.x,b.y-this.y)},UVTo:function(b){var d=Math.sqrt((this.x-b.x)*(this.x-b.x)+(this.y-b.y)*(this.y-b.y));return new Vector((b.x-this.x)/d,(b.y-this.y)/d)},fracVTo:function(b,d){return this.VTo(b).mult(d)},fracMoveTo:function(b,d){this.movePt(this.fracVTo(b,d));return this},set:function(b){this.x=b.x;
this.y=b.y},avg:function(b){return new Point((this.x+b.x)/2,(this.y+b.y)/2)},area:function(b,d){var e=V(b.x-this.x,b.y-this.y),f=e.UV(),e=e.mag(),f=V(-f.dy,f.dx),h=V(d.x-this.x,d.y-this.y),f=Math.abs(f.dotProd(h));return 0.5*e*f},copy:function(){return new Point(this.x,this.y)},movePt:function(b){void 0!==b.dx&&(this.x+=b.dx);void 0!==b.dy&&(this.y+=b.dy);return this},moveInDir:function(b,d){this.x+=Math.cos(d)*b;this.y+=Math.sin(d)*b;return this},position:function(b){void 0!==b.x&&(this.x=b.x);void 0!==
b.y&&(this.y=b.y);return this},scale:function(b,d){var e=this.y-b.y;this.x=b.x+(this.x-b.x)*d;this.y=b.y+e*d;return this},rotate:function(b,d){var e=new Vector(b.x,b.y);this.movePt(e.copy().neg());var f=this.x,h=this.y;this.x=f*Math.cos(d)-h*Math.sin(d);this.y=f*Math.sin(d)+h*Math.cos(d);this.movePt(e);return this},mirror:function(b,d){var e=d.UV(),f=b.VTo(this),e=e.perp("cw"),f=f.dotProd(e);0>f?this.movePt(e.mult(Math.abs(2*f))):0<f&&this.movePt(e.neg().mult(2*f));return this},rect:function(b,d){var e=
Array(4);"ccw"==d?(e[0]=this.copy(),e[1]=this.copy().movePt({dy:b.dy}),e[2]=this.copy().movePt(b),e[3]=this.copy().movePt({dx:b.dx})):(e[0]=this.copy(),e[1]=this.copy().movePt({dx:b.dx}),e[2]=this.copy().movePt(b),e[3]=this.copy().movePt({dy:b.dy}));return e},roundedRect:function(b,d,e){b=this.rect(b,e);return this.roundPts(b,d)},roundPts:function(b,d){this.sameAs(b[0])||(b=[this].concat(b));var e=Array(2*b.length);b["-1"]=b[b.length-1];b.push(b[0]);for(var f=0;f<b.length-1;f++)e[2*f]=b[f].copy().fracMoveTo(b[String(f-
1)],d/2),e[2*f+1]=b[f].copy().fracMoveTo(b[String(f+1)],d/2);return e},sameAs:function(b){return this.x==b.x&&this.y==b.y},closeTo:function(b){return 1>Math.abs(this.x-b.x)&&1>Math.abs(this.y-b.y)},isValid:function(){return void 0!==this.x&&!isNaN(this.x)&&void 0!==this.y&&!isNaN(this.y)},track:function(b){var d,e,f,h,k;b instanceof Point?(d=b,e=V(0,0),b=f=!1):(d=b.pt,e=void 0==b.offset?V(0,0):V(b.offset.dx||0,b.offset.dy||0),f=/x/i.test(b.noTrack),b=/y/i.test(b.noTrack));h=!f?1:0;k=!b?1:0;f=function(){this.x+=
h*(d.x-this.x+e.dx);this.y+=k*(d.y-this.y+e.dy)};this.trackListenerId=unique(this.x+","+this.y+"tracksWithUniqueId",curLevel.updateListeners);addListener(curLevel,"update",this.trackListenerId,f,this);f||(console.log("tried to track "+this.trackListenerId+" but input wasn't right"),console.trace());this.tracking=!0;return this},trackStop:function(){this.tracking&&(removeListener(curLevel,"update",this.trackListenerId),this.trackListenerId=void 0,this.tracking=!1);return this}};
Dot.prototype={KE:function(){return 0.5*this.m*(this.v.dx*this.v.dx+this.v.dy*this.v.dy)},temp:function(){return 0.5*this.m*(this.v.dx*this.v.dx+this.v.dy*this.v.dy)*this.tConst},tempCondense:function(){return(this.cv*(this.temp()-298.15)+this.hVap298)/this.cpLiq+298.15},tempVaporize:function(b){return(this.cpLiq*(this.temp()-298.15)-this.hVap298)/this.cv+298.15},hVap:function(){return this.hVap298+(this.temp()-298.15)*(this.cv-this.cpLiq)},setTemp:function(b){var d=this.temp();this.v.mult(Math.sqrt(b/
d));this.internalPotential*=b/d;return this},setTempNoReference:function(b){var d=this.v.UV(),e=Math.sqrt(2*b/(this.m*this.tConst));this.v.dx=d.dx*e;this.v.dy=d.dy*e;this.internalPotential=b*(this.cv-this.cvKinetic)},addEnergy:function(b){var d=this.temp();tF=Math.max(1,d+b/this.cv);this.v.mult(Math.sqrt(tF/d));this.internalPotential*=tF/d;return(tF-d)*this.cv},adjTemp:function(b){var d=this.temp();this.internalPotential+=b*(this.cv-this.cvKinetic)/this.N;this.v.mult(Math.sqrt((d+b)/d));return this},
enthalpy:function(){return this.hF298+(this.temp()-298.15)*(this.cv+R/N)},internalEnergy:function(){return this.uF298+(this.temp()-298.15)*this.cv},kineticEnergy:function(){return this.temp()*this.cvKinetic},speed:function(){return this.v.mag()*this.pxToMS},kill:function(b){for(var d=0;d<this.parentLists.length;d++)this.parentLists[d].splice(this.parentLists[d].indexOf(this),1);this.parentLists.splice(0,this.parentLists.length);b&&(this.active=!1)}};toInherit={gridder:{makeGrid:function(){for(var b=this.numCols,d=this.numRows,e=Array(b),f=0;f<b;f++){for(var h=Array(d),k=0;k<d;k++)h[k]=[];e[f]=h}return e}},ArrayExtenders:{pushNumber:function(b){!isNaN(b)&&void 0!==b&&this.push(b);return this},append:function(b){for(var d=0;d<b.length;d++)this.push(b[d]);return this},average:function(){for(var b=0,d=0;d<this.length;d++)b+=this[d];return b/this.length},switchElements:function(b,d){var e=this[b];this[b]=this[d];this[d]=e;return this}},MathExtenders:{log10:function(b){return Math.log(b)/
2.302585092994046}},StringExtenders:{killWhiteSpace:function(){return this.replace(/\s+/g,"")},killNumbers:function(){return this.replace(/[0-9]/g,"")},toCamelCase:function(){return this.replace(/(?:^\w|[A-Z]|\b\w)/g,function(b,d){return 0==d?b.toLowerCase():b.toUpperCase()}).replace(/\s+/g,"")},toCapitalCamelCase:function(){return this.replace(/(?:^\w|[A-Z]|\b\w)/g,function(b,d){return b.toUpperCase()}).replace(/\s+/g,"")},sanitize:function(){return this.replace(/'/g,"&#39;").replace(/"/g,"&#34;").replace(/</g,
"&#60;").replace(/>/g,"&#62;").replace(/{/g,"&#123;").replace(/}/g,"&#125;")}},ArrowFuncs:{getPts:function(){var b=Array(3),d=this.dims.dx,e=this.dims.dy;b[0]=P(0,0.2*e);b[1]=P(0.7*d,0.2*e);b[2]=P(0.7*d,0.5*e);e=deepCopy(b).reverse();b.push(P(d,0));for(d=0;d<e.length;d++)b.push(P(e[d].x,-e[d].y));return b}}};function gauss(b,d){var e=Math.random()+Math.random()+Math.random()-1.5;return b+e*d}function bound(b,d,e){return Math.min(Math.max(b,d),e)}function stepTowards(b,d,e){e=Math.abs(e);return b<d?Math.min(d,b+e):Math.max(d,b-e)}function changeTemp(b,d){for(var e=dotManager.get(b),f=0;f<e.length;f++)e[f].setTemp(d)}function changeRMS(b,d){for(var e=dotManager.get(b),f=rms(dataHandler.velocities(b)),f=d/f,h=0;h<e.length;h++)e[h].v.mult(f)}function tempToV(b,d){d=2*d/tConst;return Math.sqrt(d/b)}
function VToTemp(b,d){return 0.5*b*d*d*tConst}function tempToKE(b){return b/tConst}function returnEscapist(b){returnTo=defaultTo(0,b.returnTo);var d=walls[returnTo][0],e=walls[returnTo][1],f=walls[returnTo].wallUVs[0],h=(d.x+e.x)/2-5*f.dy,d=(d.y+e.y)/2+5*f.dx;b.v.dy=Math.abs(b.v.dy);b.x=h;b.y=d}function defaultTo(b,d){return void 0===d?b:d}function validNumber(b){return isNaN(b)||void 0===b?!1:b}function round(b,d){var e=Math.pow(10,d);return Math.round(b*e)/e}
function averageLast(b,d){d=Math.min(b.length,d);for(var e=0,f=b.length-d;f<b.length;f++)e+=b[f];return e/d}function unique(b,d){if(d[b]){for(var e=1;d[b+e];)e++;return b+e}return b}function addListener(b,d,e,f,h){b[d+"Listeners"][e]=new Listener(f,h)}function addListenerOnce(b,d,e,f,h){b[d+"Listeners"][e]=new Listener(function(){f.apply(h);removeListener(b,d,e)},void 0)}function addInterval(b,d,e,f){extraIntervals[b]=window.setInterval(function(){d.apply(e)},f)}
function removeInterval(b){extraIntervals[b]&&(window.clearInterval(extraIntervals[b]),extraIntervals[b]=void 0)}function removeListener(b,d,e){delete b[d+"Listeners"][e]}function Listener(b,d){this.func=b;this.obj=d}function removeListenerByName(b,d,e){for(var f=!1,h=getListenerByName(b,d,e);void 0!==h;)f=!0,delete b[d+"Listeners"][h],h=getListenerByName(b,d,e);return f}function makeListenerHolder(b,d){b[d+"Listeners"]={};return b[d+"Listeners"]}
function listenerExists(b,d,e){return void 0!==b[d+"Listeners"][e]}function emptyListener(b,d){b[d+"Listeners"]={}}function getListenerByName(b,d,e){for(thisFuncName in b[d+"Listeners"])if(-1!=thisFuncName.indexOf(e))return thisFuncName}function store(b,d){stored[b]=d}function getStore(b){return stored[b]}function eraseStore(b){b?stored[b]=void 0:stored={}}
function getAndEval(b){if("number"==typeof b)return b;if("string"==typeof b)return interpreter.interpInput(b);if("boolean"==typeof b)return b;if(b instanceof Point){var d=getAndEval(b.x);b=getAndEval(b.y);return P(d,b)}if(b instanceof Vector)return d=getAndEval(b.dx),b=getAndEval(b.dy),V(d,b);if(b instanceof Color){var d=getAndEval(b.r),e=getAndEval(b.g);b=getAndEval(b.b);return Col(d,e,b)}if(b instanceof Array){d=[];for(e=0;e<b.length;e++)d.push(getAndEval(b[e]));return d}if("function"==typeof b)return b;
if(b instanceof Object){d={};for(e in b)d[e]=getAndEval(b[e]);return d}}function deepCopy(b){var d=new b.constructor,e;for(e in b)d[e]="object"==typeof b[e]?deepCopy(b[e]):b[e];return d}function deepCopySafe(b){return deepCopyStep(b,[b],[])}function deepCopyStep(b,d,e){var f;try{f=new b.constructor}catch(h){f={}}e.push(f);for(var k in b){var l=b[k];if("object"==typeof l){var m=d.indexOf(l);f[k]=-1==m?deepCopyStep(l,d.concat([l]),e.concat()):e[m]}else f[k]=l}return f}
function recordData(b,d,e,f){f=defaultTo("record",f);store("record"+b,f);var h=e.func,k=e.obj;addListener(curLevel,f,b,function(){d.push(h.apply(k))},k)}function recordDataStop(b){var d=getStore("record"+b);removeListener(curLevel,d,b)}function grabAttrs(b,d){var e={},f;for(f in b){e[f]={};for(var h=0;h<d.length;h++)e[f][d[h]]=b[f][d[h]]}return e}function execListeners(b){for(var d in b){var e=b[d];e.func.apply(e.obj)}}
function makeSlider(b,d,e,f,h,k,l,m){var n="";h=""+templater.center({innerHTML:h});n+=templater.div({attrs:{id:[f+"parent"]},style:{padding:"5px"},innerHTML:templater.div({attrs:{id:[f]}})});b.append(h);d.append(n);n=$(e+"parent");e=$(e);(!n.length||!e.length)&&n;addJQueryElems($(e),"slider");e.slider("option",k);for(k=0;k<l.length;k++){var p=l[k],n=p.eventType;h=p.obj;p=p.func;void 0===h?sliderBind(e,n,p,""):sliderBind(e,n,p,h)}if(m)div[m]();sliderList.push(f);return[b,d]}
function sliderBind(b,d,e,f){b.bind(d,function(b,d){e.apply(f,[b,d])});return b}function addJQueryElems(b,d){b=b instanceof Array?b:[b];for(var e=0;e<b.length;e++){var f=b[e];$(f)[d]();recursiveAddClass(f,globalHTMLClass)}}function recursiveAddClass(b,d){$(b).addClass(d);for(var e=$(b).children(),f=0;f<e.length;f++){var h=$(e[f]);recursiveAddClass(h,d)}}
function sendToCW(b,d){var e=new XMLHttpRequest,f=window.btoa(b);/^(http|https)/.test(document.URL)&&(f=window.stringTogetherGET({"goto":"simulation",command:"send_answer",question_id:d,answer_text_64:f}),e.open("GET","CW.php?"+f,!0),e.send(null))}function stringTogetherGET(b){var d=[],e;for(e in b)d.push(e+"="+b[e]);return d.join("&")}function hideSliders(){for(;0<sliderList.length;idIdx++)$("#"+sliderList[0]).hide()}function S(b,d,e){sceneNavigator.showPrompt(b,d,e)}
function alertValid(b){void 0!==b&&""!=b&&alert(b)}function fillEmptyGraphDivs(){for(var b=0;b<graphHolderDivs.length;b++)fillEmptyGraphDiv($("#"+graphHolderDivs[b]))}function fillEmptyGraphDiv(b){"empty"==$(b).attr("filledWith")&&new GraphBlank(b)}function rotatePts(b,d,e){for(var f=0;f<b.length;f++)b[f].rotate(d,e)}function mirrorPts(b,d,e){for(var f=0;f<b.length;f++)b[f].mirror(d,e);return b}function angleToUV(b){return V(Math.cos(b),Math.sin(b))}
function UVToAngle(b){return Math.atan2(b.dy,b.dx)}function getSign(b){return 0>b?-1:1}function fracDiff(b,d){return Math.abs(b-d)/Math.min(Math.abs(b),Math.abs(d))}function getLen(b){for(var d=0,e=0;e<b.length-1;e++)d+=b[e].distTo(b[e+1]);return d}function exprHasReturn(b){return/(\(|\:|\?|\s|\{)return/.test(" "+b)}function byAttr(b,d,e){if(b instanceof Array)for(var f=0;f<b.length;f++){if(b[f][e]==d)return b[f]}else for(f in b)if(b[f][e]==d)return b[f]}
function inRect(b,d,e){e=mouseOffset(e);return e.x>=b.x&&e.x<=b.x+d.dx&&e.y>=b.y&&e.y<=b.y+d.dy}function ptInRect(b,d,e){return e.x>=b.x&&e.x<=b.x+d.dx&&e.y>=b.y&&e.y<=b.y+d.dy}function extend(b,d){return function(){return d(b())}}function getNth(b,d){var e=0,f;for(f in b)if(e++==d)return b[f]}function countAttrs(b){var d=0,e;for(e in b)d++;return d}function objectsEqual(b,d){return Math.min(objectsEqualInDirection(b,d),objectsEqualInDirection(d,b))}
function objectsEqualInDirection(b,d){for(var e in b)if(d&&d.hasOwnProperty(e))if("object"==typeof b[e]){if(!objectsEqual(b[e],d[e]))return!1}else{if(b[e]!=d[e])return!1}else return!1;return!0}function rms(b){for(var d=0,e=0;e<b.length;e++)d+=b[e]*b[e];d/=b.length;return Math.sqrt(d)}globalMousePos=P(0,0);function mouseOffset(b){b=$(b).offset();return P(globalMousePos.x-b.left,globalMousePos.y-b.top)}
function mouseOffsetDiv(b){b=$("#"+b).offset();return P(globalMousePos.x-b.left,globalMousePos.y-b.top)}$(document).mousemove(function(b){globalMousePos.x=b.pageX;globalMousePos.y=b.pageY;for(var d in curLevel.mousemoveListeners)b=curLevel.mousemoveListeners[d],b.func.apply(b.obj)});$(document).mousedown(function(b){for(var d in curLevel.mousedownListeners)b=curLevel.mousedownListeners[d],b.func.apply(b.obj)});
$(document).mouseup(function(b){for(var d in curLevel.mouseupListeners)b=curLevel.mouseupListeners[d],b.func.apply(b.obj)});function DrawingTools(){}
DrawingTools.prototype={dots:function(b){for(var d in spcs){var e=spcs[d].dots;b.fillStyle=spcs[d].col.hex;if(e[0])var f=e[0].r;for(var h=0;h<e.length;h++)b.beginPath(),b.arc(e[h].x,e[h].y,f,0,2*Math.PI,!0),b.closePath(),b.fill()}},dotsAsst:function(b,d){for(var e=0;e<b.length;e++)d.fillStyle=spcs[b[e].spcName].col.hex,d.beginPath(),d.arc(b[e].x,b[e].y,b[e].r,0,2*Math.PI,!0),d.closePath(),d.fill()},walls:function(b,d){for(var e=0;e<b.length;e++){var f=b[e];if(f.show){d.beginPath();d.strokeStyle=f.col.hex;
d.moveTo(f[0].x,f[0].y);for(var h=1;h<f.length-1;h++)d.lineTo(f[h].x,f[h].y);d.closePath();d.stroke()}}},circle:function(b,d,e,f,h){h.beginPath();h.arc(b.x,b.y,d,0,2*Math.PI,!0);h.closePath();f?(h.fillStyle=e.hex,h.fill()):(h.strokeStyle=e.hex,h.stroke())},fillPts:function(b,d,e){e.fillStyle=d.hex;e.beginPath();e.moveTo(b[0].x,b[0].y);for(d=1;d<b.length;d++)e.lineTo(b[d].x,b[d].y);e.closePath();e.fill()},fillPtsAlpha:function(b,d,e,f){var h=f.globalAlpha;f.globalAlpha=e;draw.fillPts(b,d,f);f.globalAlpha=
h},fillPtsStroke:function(b,d,e,f){f.fillStyle=d.hex;f.strokeStyle=e.hex;f.beginPath();f.moveTo(b[0].x,b[0].y);for(d=1;d<b.length;d++)f.lineTo(b[d].x,b[d].y);f.closePath();f.stroke();f.fill()},roundedRect:function(b,d,e,f,h){var k=b.x;b=b.y;var l=d.dx;d=d.dy;h.fillStyle=f.hex;h.beginPath();h.moveTo(k+e,b);this.curvedLine(P(k+l-e,b),P(k+l,b),P(k+l,b+e),h);this.curvedLine(P(k+l,b+d-e),P(k+l,b+d),P(k+l-e,b+d),h);this.curvedLine(P(k+e,b+d),P(k,b+d),P(k,b+d-e),h);this.curvedLine(P(k,b+e),P(k,b),P(k+e,
b),h);h.closePath();h.fill()},fillRect:function(b,d,e,f){f.fillStyle=e.hex;f.fillRect(b.x,b.y,d.dx,d.dy)},fillStrokeRect:function(b,d,e,f,h){h.strokeStyle=f.hex;h.fillStyle=e.hex;h.fillRect(b.x,b.y,d.dx,d.dy);h.strokeRect(b.x,b.y,d.dx,d.dy)},strokeRect:function(b,d,e,f){f.strokeStyle=e.hex;f.strokeRect(b.x,b.y,d.dx,d.dy)},line:function(b,d,e,f){f.strokeStyle=e.hex;f.beginPath();f.moveTo(b.x,b.y);f.lineTo(d.x,d.y);f.closePath();f.stroke()},curvedLine:function(b,d,e,f){f.lineTo(b.x,b.y);f.quadraticCurveTo(d.x,
d.y,e.x,e.y)},path:function(b,d,e){e.strokeStyle=d.hex;e.beginPath();e.moveTo(b[0].x,b[0].y);for(d=1;d<b.length;d++)e.lineTo(b[d].x,b[d].y);e.stroke()},text:function(b,d,e,f,h,k,l){l.save();l.translate(d.x,d.y);l.rotate(k);l.fillStyle=f.hex;l.font=e;l.textAlign=h;d=parseFloat(e);e=0;for(f=b.indexOf("\n");-1!=f;)h=b.slice(0,f),l.fillText(h,0,e),e+=d+2,b=b.slice(f+1,b.length),f=b.indexOf("\n");l.fillText(b,0,e);l.restore()}};function DotManager(){this.lists={ALLDOTS:[]};this.spcLists={};this.count=0}
DotManager.prototype={add:function(b){b instanceof Array?this.count+=b.length:this.count++;this.execAllCombos(this.addFunc,b)},remove:function(b,d){d=void 0===d?!0:d;if(b instanceof Array){this.count-=b.length;for(var e=0;e<b.length;e++)b[e].kill(d)}else this.count--,b.kill(d)},removeByAttr:function(b,d){for(var e=this.lists.ALLDOTS,f=e.length-1;0<=f;f--)e[f][b]==d&&e[f].kill()},changeDotSpc:function(b,d){b instanceof Array||(b=[b]);for(var e=spcs[d],f=0;f<b.length;f++){var h=b[f],k=(h.hF298-1E3*
e.hF298/N+h.cv*(h.temp()-298.15))/(e.cv/N)+298.15;if(0<k){for(var l=0;l<h.parentLists.length;l++)h.parentLists[l].splice(h.parentLists[l].indexOf(h),1);h.parentLists=[];h.m=e.m;h.r=e.r;h.col=e.col;h.spcName=e.spcName;h.hF298=1E3*e.hF298/N;h.hVap298=1E3*e.hVap298/N;h.idNum=e.idNum;h.cvKinetic=1.5*R/N;h.cv=e.cv/N;h.cp=h.cv+R;h.cpLiq=e.cpLiq/N;h.spcVolLiq=e.spcVolLiq/N;h.setTempNoReference(k);k=this.getRelevantLists(h);for(l=0;l<k.length;l++)h.parentLists.push(k[l]),k[l].push(h)}}},changeDotWall:function(b,
d){var e,f;b instanceof Array||(b=[b]);for(var h=0;h<b.length;h++){var k=b[h];k.tag=d;k.returnTo=d;e=0;for(f=k.parentLists.length;e<f;e++)k.parentLists[e].splice(k.parentLists[e].indexOf(k),1);k.parentLists=[];var l=this.getRelevantLists(k);e=0;for(f=l.length;e<f;e++)k.parentLists.push(l[e]),l[e].push(k)}},addSpcs:function(b){this.lists[b]||(this.lists[b]=[],this.spcLists[b]=this.lists[b]);return this.lists[b]},removeByInfo:function(b){b.spcName&&b.tag?this.execAllCombos(this.removeByNameAndTagFunc,
b):b.spcName?this.execAllCombos(this.removeByNameFunc,b):b.tag?this.execAllCombos(this.removeByTagFunc,b):(console.log("No useful info given to removeByInfo func in DotManager"),console.trace())},getWithLog:function(b){var d=this.get(b);if(d)return d;console.log("Bad species data");console.log(b)},get:function(b){return this.createIfNotExists(b)},clearAll:function(){for(var b in this.lists)this.lists[b].splice(0,this.lists[b].length)},createIfNotExists:function(b){if(b){if(b.spcName&&b.tag)return this.getByNameAndTag(b);
if(b.spcName)return this.getByName(b.spcName);if(b.tag)return this.getByTag(b.tag)}else return this.lists.ALLDOTS},addFunc:function(b,d){b.push(d);d.parentLists.push(b)},removeFunc:function(b,d){var e=b.indexOf(d);-1<e?(b.splice(e,1),d.parentLists.splice(d.parentLists.indexOf(b),1)):(console.log("Tried to remove dot from global list of spcName "+d.spcName+" and tag "+d.tag+". Dot not present."),console.trace())},removeByNameAndTagFunc:function(b,d){for(var e=b.length-1;-1<e;e--)b[e].spcName==d.spcName&&
b[e].tag==d.tag&&b[e].kill()},removeByNameFunc:function(b,d){for(var e=b.length-1;-1<e;e--)b[e].spcName==d.spcName&&(b.splice(e,1),b[e].kill())},removeByNameAndTagFunc:function(b,d){for(var e=b.length-1;-1<e;e--)b[e].tag==d.tag&&(b.splice(e,1),b[e].kill())},execAllCombos:function(b,d){if(d instanceof Array&&d.length)var e=d,f={spcName:e[0].spcName,tag:e[0].tag};else f=d;f=this.getRelevantLists(f);if(e)for(var h=0;h<e.length;h++)this.execFuncOnLists(b,f,e[h]);else d instanceof Dot&&this.execFuncOnLists(b,
f,d)},execFuncOnLists:function(b,d,e){e.active=!0;for(var f=0;f<d.length;f++)b(d[f],e)},getRelevantLists:function(b){var d=[];d.push(this.lists.ALLDOTS);b.spcName&&b.tag&&d.push(this.getByNameAndTag(b));b.spcName&&d.push(this.getByName(b.spcName));b.tag&&d.push(this.getByTag(b.tag));return d},getByNameAndTag:function(b){if(this.lists[b.spcName+"-"+b.tag])return this.lists[b.spcName+"-"+b.tag];if(spcs[b.spcName])return this.lists[b.spcName+"-"+b.tag]=[],this.lists[b.spcName+"-"+b.tag];console.log("Tried to get bad spcName "+
spcName);console.trace()},getByName:function(b){if(this.lists[b])return this.lists[b];if(spcs[b])return this.lists[b]=[],this.lists[b];console.log("Tried to get bad spcName "+b);console.trace()},getByTag:function(b){this.lists[b]||(this.lists[b]=[]);return this.lists[b]}};AuxFunctions={getDims:function(){var b=$("#main").height(),b=b-$("#auxSpacer").height();return V(400,b/2)},pickParentDiv:function(b,d){if(void 0===d){for(var e=0;e<auxHolderDivs.length;e++){var f=$("#"+auxHolderDivs[e]),h=$(f).attr("filledWith");if(""==h)return $(f).attr("filledWith",b),f}console.log("Aux divs are all full!");console.trace()}else{f=$("#"+auxHolderDivs[d]);if(!f.length)return console.log("Bad div idx "+d+".  Defaulting to next empty slot"),this.pickParentDiv(b);h=$(f).attr("filledWith");
if(""==h||void 0==h)return $(f).attr("filledWith",b),f;console.log("Trying to add "+b+" in "+d+" but "+d+" is already filled with "+h+".");console.log("Defaulting to next empty slot");return this.pickParentDiv(b)}},parentDivEmpty:function(){var b=this.parentDiv.attr("filledWith");return void 0==b||""==b},cleanUpParent:function(){$(this.parentDiv).removeAttr("style");$(this.parentDiv).html("");$(this.parentDiv).attr("filledWith","")}};function PhaseEquilGenerator(){this.oneComp=new PhaseEquilGenerator.OneComp;this.twoComp=new PhaseEquilGenerator.TwoComp}PhaseEquilGenerator.TwoComp=function(){};
PhaseEquilGenerator.TwoComp.prototype={constP:function(b,d,e,f,h){var k=b.tBoil(f),l=d.tBoil(f),m=k<l?b:d;b=k>l?b:d;e=this.makeConstPEquil(f,m,b,k<l?k:l,k>l?k:l,e[m.spcName],e[b.spcName],h);return new PhaseEquilGenerator.TwoComp.EquilData(e,m.spcName,b.spcName,f)},makeConstPEquil:function(b,d,e,f,h,k,l,m){for(var n=[],p=1/(m-1),r=0,s=0;r<m;r++){var t=this.solveTAtStep(f+(h-f)*s,b,s,d,e,f,h,k,l);if(!1!==t){var u=this.solvePTotal(t,s,d,e,k,l),w=this.pSpc(d,t,k,1-s);n.push(new PhaseEquilGenerator.TwoComp.EquilPt(1-
s,s,w/u,1-w/u,t,b))}s+=p}return n},solveTAtStep:function(b,d,e,f,h,k,l,m,n){for(var p=this.solvePTotal(b,e,f,h,m,n),r=0;0.01<fracDiff(p,d);){r++;var s=this.getDPDT(b,e,f,h,k,l,m,n);b+=(d-p)/s;p=this.solvePTotal(b,e,f,h,m,n);if(40==r)return!1}return b},getDPDT:function(b,d,e,f,h,k,l,m){h=0.995*b;b*=1.005;k=this.solvePTotal(h,d,e,f,l,m);return(this.solvePTotal(b,d,e,f,l,m)-k)/(b-h)},solvePTotal:function(b,d,e,f,h,k){e=this.pSpc(e,b,h,1-d);b=this.pSpc(f,b,k,d);return e+b},pSpc:function(b,d,e,f){return b.pPure(d)*
e(f,d)*f}};PhaseEquilGenerator.TwoComp.EquilPt=function(b,d,e,f,h,k){this.xLight=b;this.xHeavy=d;this.yLight=e;this.yHeavy=f;this.temp=h;this.pressure=k};PhaseEquilGenerator.TwoComp.EquilData=function(b,d,e,f){this.data=b;this.keyLight=d;this.keyHeavy=e;this.pressure=f};PhaseEquilGenerator.OneComp=function(){};
PhaseEquilGenerator.OneComp.prototype={equilData:function(b,d,e,f,h){h=window.spcs[b];b=this.genLiqGasData(h,d,e);e=this.genSolidLiqEqData(h,d,e);d=this.genSolidGasEqData(h,f,d);return[b,e,d]},genLiqGasData:function(b,d,e){for(var f=[],h=d;h<=e;h+=(e-d)/20){var k=b.pPure(h);f.push(new PhaseEquilGenerator.OneComp.EquilPt(b.spcName,h,k))}return f},genSolidLiqEqData:function(b,d,e){var f=b.pPure(d);e=b.pPure(e);f=new PhaseEquilGenerator.OneComp.EquilPt(b.spcName,d,f);b=new PhaseEquilGenerator.OneComp.EquilPt(b.spcName,
d,e);return[f,b]},genSolidGasEqData:function(b,d,e){for(var f=[],h=b.pPure(e),k=0.5*b.pPure(d),l=Math.log(h/k)/(e-d),m=k/Math.exp(l*d),n=0;20>n;n++){var p=d+n/19*(e-d),r=m*Math.exp(p*l),r=k+(r-k)*Math.log((Math.E-1)*(r-k)/(h-k)+1);f.push(new PhaseEquilGenerator.OneComp.EquilPt(b.spcName,p,r))}return f}};PhaseEquilGenerator.OneComp.EquilPt=function(b,d,e){this.spcName=b;this.temp=d;this.pressure=e};GraphBase={setStds:function(){window.storedGraphs[this.handle]=this;window.curLevel.graphs[this.handle]=this;this.hashMarkLen=10;this.checkMarkOversize=3;this.bgCol=curLevel.bgCol;this.gridCol=Col(72,72,72);this.toggleCol=Col(255,255,255);this.data={};this.legend={};this.markers={};this.textCol=Col(255,255,255);this.flashMult=1.5;this.flashRate=0.1;this.graphBoundCol=Col(255,255,255);this.integralCol=Col(150,150,150);this.integralAlpha=0.5;this.ptStroke=Col(0,0,0);this.rectSideLen=8;this.characLen=
Math.sqrt(Math.pow(this.rectSideLen,2)/2);this.buttonId=this.handle+"Reset";this.graphId=this.handle+"Graph";this.parentDiv=this.pickParentDiv("graph");this.parentDivId=$(this.parentDiv).attr("id");this.makeReset=defaultTo(!0,this.makeReset);var b=this.makeCanvas(this.dims,this.parentDiv,this.handle+"Graph",this.makeReset,this.handle+"Button");this.graphDisplayHTMLElement=b.HTMLElem;this.graphDisplay=b.canvas;this.layers=new GraphBase.Layers;this.wrapperId;this.initDrawLayers();this.hasData=!1},makeDataFunc:function(b){with(DataGetFuncs)return exprHasReturn(b)?
eval("(function(){"+b+"})"):eval("(function(){return "+b+"})")},initDrawLayers:function(){addListener(curLevel,"update","drawLayers"+this.handle,this.drawLayers,this)},setNumGridLinesAndSpacing:function(b){var d,e,f;b=b?b:{};b.x?(d=b.x,e=this.getGridSpacing(d,this.graphRangeFrac.x,this.dims.dx)):(e=40,d=Math.ceil(this.dims.dx*Math.abs(this.graphRangeFrac.x.max-this.graphRangeFrac.x.min)/e));b.y?(b=b.y,f=this.getGridSpacing(b,this.graphRangeFrac.y,this.dims.dy)):(f=40,b=Math.ceil(this.dims.dy*Math.abs(this.graphRangeFrac.y.max-
this.graphRangeFrac.y.min)/f));this.numGridLines=P(d,b);this.gridSpacing=P(e,f)},makeCanvas:function(b,d,e,f,h){var k=this;d.html("");b=templater.canvas({attrs:{id:[e],"class":["noSelect"],width:[b.dx],height:[b.dy]}});f&&(b+=templater.button({attrs:{id:[h]},style:{position:"absolute",right:".5em",bottom:".5em"},innerHTML:templater.img({attrs:{src:[window.IMGPATHPREFIX+"img/refresh.gif"]}})}));b=$(b);$(d).append(b);f&&(addJQueryElems($("#"+h),"button"),$("#"+h).click(function(){k.reset()}));d=document.getElementById(e);
e=d.getContext("2d");return{HTMLElem:d,canvas:e}},restoreHTML:function(){this.parentDivEmpty()||(this.parentDiv=this.pickParentDiv("graph"),this.parentDivId=$(this.parentDiv).attr("id"));var b=this.makeCanvas(this.dims,this.parentDiv,this.handle+"Graph",this.makeReset,this.handle+"Button");this.graphDisplayHTMLElement=b.HTMLElem;this.graphDisplay=b.canvas;this.layers.setDrawCanvas(this.graphDisplay);if(this.legend)for(var d in this.legend)this.legend[d].setCanvas(this.graphDisplay),this.legend[d].toggleActivate()},
clearHTML:function(){this.cleanUpParent()},remove:function(){this.disable();removeListener(curLevel,"update","drawLayers"+this.handle);removeListenerByName(curLevel,"update","flashAdvance"+this.handle);this.layers.removeAll();this.cleanUpParent();return this},enable:function(b){for(var d in this.data)this.data[d].recordStart();this.active=!0;if(b){for(d in this.data)this.data[d].addVal();this.addLast()}return this},disable:function(){for(var b in this.data)this.data[b].recordStop();this.active=!1;
return this},integrate:function(b){this.data[b].integralPts=this.getIntegralPts(b);this.drawIntegral(b);return this},getIntegralPts:function(b){var d=this.data[b].src.x,e=this.data[b].src.y;b=Array(d.length);for(var f=0;f<d.length;f++)b[f]=this.valToCoord(P(d[f],e[f]));d=this.yStart*this.dims.dy;e=b[0].x;b.push(P(b[b.length-1].x,d));b.push(P(e,d));return b},setData:function(b,d){var e=this.data[b];e?e.setData(d):console.log("Bad set handle "+b)},drawAllBG:function(){this.drawBGRect();this.drawGrid();
this.drawBounds();this.legend&&this.drawLegend();this.drawLabels()},drawBGRect:function(){draw.roundedRect(P(0,0),V(this.dims.dx,this.dims.dy),20,this.bgCol,this.graphDisplay)},drawGrid:function(){for(var b=this.axisRange.x.min/10,d=0;d<this.numGridLines.x;d++){var b=this.logScale.x?10*b:this.axisRange.x.min+this.stepSize.x*d,e=this.valToCoord(P(b,1)),f=e.x,h=this.graphRangeFrac.y.max*this.dims.dy,e=P(f,this.graphRangeFrac.y.min*this.dims.dy+this.hashMarkLen),f=P(f,h);draw.line(e,f,this.gridCol,this.graphDisplay)}b=
this.axisRange.y.min/10;for(d=0;d<this.numGridLines.y;d++)b=this.logScale.y?10*b:this.axisRange.y.min+this.stepSize.y*d,e=this.valToCoord(P(1,b)),f=e.y,h=this.graphRangeFrac.x.min*this.dims.dx,e=P(this.graphRangeFrac.x.max*this.dims.dx-this.hashMarkLen,f),f=P(h,f),draw.line(e,f,this.gridCol,this.graphDisplay)},drawBounds:function(){var b=P(this.graphRangeFrac.x.min*this.dims.dx,this.graphRangeFrac.y.max*this.dims.dy),d=V(this.dims.dx*(this.graphRangeFrac.x.max-this.graphRangeFrac.x.min),this.dims.dy*
(this.graphRangeFrac.y.min-this.graphRangeFrac.y.max));draw.strokeRect(b,d,this.graphBoundCol,this.graphDisplay)},drawLabels:function(){var b=P(this.dims.dx*(this.graphRangeFrac.x.min+this.graphRangeFrac.x.max)/2,Math.min(this.dims.dy*this.graphRangeFrac.y.min+50,this.dims.dy-20)),d=P(Math.max(this.dims.dx*this.graphRangeFrac.x.min-50,20),this.dims.dy*(this.graphRangeFrac.y.min+this.graphRangeFrac.y.max)/2);b.y+=this.labelFontSize/2;d.y+=this.labelFontSize/2;draw.text(this.xLabel,b,this.labelFont,
this.textCol,"center",0,this.graphDisplay);draw.text(this.yLabel,d,this.labelFont,this.textCol,"center",-Math.PI/2,this.graphDisplay)},drawLegend:function(){for(var b in this.legend)this.legend[b].draw()},drawMarkers:function(){for(var b in this.markers)this.markers[b].draw()},clearData:function(b,d){var e=this.data[b];e&&e.clearData();d&&this.drawAllData()},enqueueData:function(b,d){var e=this.data[b];e&&e.enqueueData(d)},updateRange:function(){var b=this.valRange.copy(),d;for(d in this.data)this.data[d].updateRange(this.valRange);
this.setAxisBounds(b)},flushQueues:function(b,d){d=defaultTo(!1,d);b=defaultTo(!0,b);var e=this.valRange.copy(),f;for(f in this.data){var h=this.data[f];h.visible&&h.updateRange(this.valRange)}h=this.axisRange.copy();this.setAxisBounds(e);if(!this.rangeIsSame(h.x,this.axisRange.x)||!this.rangeIsSame(h.y,this.axisRange.y))d=!0;d?this.drawAllData():this.drawPts();b&&this.flashInit();for(f in this.data)this.data[f].flushQueue();this.drawLayers()},drawLayers:function(b){if((turn%2||b)&&this.hasData&&
this.layers.count){this.drawAllData();for(b=0;b<this.layers.layers.length;b++)for(var d=this.layers.layers[b],e=0;e<d.length;e++)d[e].draw()}},flashInit:function(){for(var b in this.data)this.data[b].flashInit()},rangeIsSame:function(b,d){return!(b.max!=d.max||b.min!=d.min)},getGridSpacing:function(b,d,e){d=e*Math.abs(d.max-d.min);return(d-20)/(b-1)},setAxisBounds:function(b){this.setAxisBoundsX(b);this.setAxisBoundsY(b)},setAxisBoundsX:function(b){var d=this.axisInit,e=this.valRange;!(d.x.min<e.x.min&&
d.x.max>e.x.max)&&!this.axesFixed.x?b?this.rangeIsSame(b.x,this.valRange.x)||this.getXBounds():this.getXBounds():this.setAxisToInit("x")},setAxisBoundsY:function(b){var d=this.axisInit,e=this.valRange;!(d.y.min<e.y.min&&d.y.max>e.y.max)&&!this.axesFixed.y?b?this.rangeIsSame(b.y,this.valRange.y)||this.getYBounds():this.getYBounds():this.setAxisToInit("y")},setAxisToInit:function(b){var d=this.axisRange[b],e=this.axisInit[b],f=this.numGridLines[b];d.min=e.min;d.max=e.max;this.stepSize[b]=(d.max-d.min)/
(f-1)},getXBounds:function(){var b=this.valRange.x.max-this.valRange.x.min,d=void 0,e=void 0;0!=b?this.logScale.x?(e=this.numGridLines.x-1,d=Math.pow(10,Math.floor(Math.log(this.valRange.x.min)/Math.LN10)),e=d*Math.pow(10,e),b=1):(d=b/(this.numGridLines.x-2),e=Math.pow(10,Math.floor(Math.log10(d))),b=Math.ceil(d/e)*e,d=Math.floor(this.valRange.x.min/b)*b,e=d+(this.numGridLines.x-1)*b):(b=0.2,d=Math.floor(this.valRange.x.min),e=d+b*this.numGridLines.x);if(d<this.axisRange.x.min||e>this.axisRange.x.max)this.axisRange.x.min=
d,this.axisRange.x.max=e,this.stepSize.x=b},getYBounds:function(){var b=Math.abs(this.valRange.y.max-this.valRange.y.min),d=void 0,e=void 0;0!=b?this.logScale.y?(e=this.numGridLines.y-1,d=Math.pow(10,Math.floor(Math.log(this.valRange.y.min)/Math.LN10)),e=d*Math.pow(10,e),b=1):(d=b/(this.numGridLines.y-2),e=Math.pow(10,Math.floor(Math.log10(d))),b=Math.ceil(d/e)*e,d=Math.floor(this.valRange.y.min/b)*b,e=d+(this.numGridLines.y-1)*b):(d=Math.floor(this.valRange.y.min),b=0.2,e=d+b*this.numGridLines.y);
if(d<this.axisRange.y.min||e>this.axisRange.y.max)this.axisRange.y.min=d,this.axisRange.y.max=e,this.stepSize.y=b},drawAxisVals:function(){0<this.stepSize.x&&0<this.stepSize.y&&(this.drawSingleAxisVals(this.numGridLines.x,this.graphRangeFrac,this.axisRange.x,this.logScale.x,this.stepSize.x,function(b,d,e,f,h,k){return b.x.min*d.dx+e.x*f},function(b,d,e,f,h,k){return b.y.min*d.dy+h+10+k/2}),this.drawSingleAxisVals(this.numGridLines.y,this.graphRangeFrac,this.axisRange.y,this.logScale.y,this.stepSize.y,
function(b,d,e,f,h,k){return b.x.min*d.dx-h-10},function(b,d,e,f,h,k){return b.y.min*d.dy-e.y*f}))},drawSingleAxisVals:function(b,d,e,f,h,k,l){for(var m=!1,n=!0,p=0;p<b;p++){var r=k(d,this.dims,this.gridSpacing,p,this.hashMarkLen,this.axisValFontSize),s=l(d,this.dims,this.gridSpacing,p,this.hashMarkLen,this.axisValFontSize),t;t=f?this.numToAxisVal(e.min*Math.pow(10,p)):this.numToAxisVal(e.min+h*p,1);(m=m||3<t.length)&&(n=!n);n&&draw.text(t,P(r,s),this.axisValFont,this.textCol,"center",0,this.graphDisplay)}},
makeLegendEntry:function(b,d,e,f){var h=this.dims.dx-this.legendWidth+5,k=30,l;for(l in this.legend)k+=35;b=new GraphBase.LegendEntry(this,b,d,h,k,this.legendFontSize,this.dims,this.toggleCol,this.legendFont,this.textCol,f);b.toggleActivate();this.legend[e]=b;this.drawAllBG()},numToAxisVal:function(b){return(0.1>=Math.abs(b)||1E3<=Math.abs(b))&&0!=b?b.toExponential():b.toFixed(1)},getRange:function(b){var d=Number.MAX_VALUE,e=-Number.MAX_VALUE,f;for(f in this.data)for(var h=this.data[f].data[b],k=
0;k<h.length;k++)var l=h[k],d=Math.min(d,l),e=Math.max(e,l);return{min:d,max:e}},resetStd:function(){for(var b in this.data)this.data[b].reset();removeListener(curLevel,"update","flash"+this.name);this.drawAllBG();this.resetRanges();this.hasData=!1},resetRanges:function(){this.axisRange=new GraphBase.Range(Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE);this.valRange=new GraphBase.Range(Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE)},ptsExist:function(b){for(var d=
0;d<b.length;d++){var e=b[d];if(void 0===e.x||void 0===e.y||isNaN(e.x)||isNaN(e.y))return!1}return!0},valToCoord:function(b){var d;d=this.logScale.x?this.graphRangeFrac.x.min*this.dims.dx+this.gridSpacing.x*(this.numGridLines.x-1)*Math.log(b.x/this.axisRange.x.min)/Math.log(this.axisRange.x.max/this.axisRange.x.min):this.graphRangeFrac.x.min*this.dims.dx+this.gridSpacing.x*(this.numGridLines.x-1)*(b.x-this.axisRange.x.min)/(this.axisRange.x.max-this.axisRange.x.min);b=this.logScale.y?this.dims.dy-
(1-this.graphRangeFrac.y.min)*this.dims.dy-this.gridSpacing.y*Math.log(b.y/this.axisRange.y.min)/Math.LN10:this.dims.dy-(1-this.graphRangeFrac.y.min)*this.dims.dy-this.gridSpacing.y*(this.numGridLines.y-1)*(b.y-this.axisRange.y.min)/(this.axisRange.y.max-this.axisRange.y.min);return P(d,b)},dataScaling:function(){return V(this.gridSpacing.x/this.stepSize.x,this.gridSpacing.y/this.stepSize.y)},checkMark:function(b,d,e,f,h){var k=Col(0,0,0);b.x-=e;b.y-=e;d.dx+=2*e;d.dy+=2*e;return new CheckMark(b,d,
f,k,h)},addMarker:function(b){b.handle?(b.graphDisplay=this.graphDisplay,b.graph=this,b.layers=this.layers,this.markers[b.handle]=new GraphBase.Marker(b)):console.log("Tried to add a graph marker for "+this.handle+" with no handle.  Add a handle.")},LegendEntry:function(b,d,e,f,h,k,l,m,n,p,r){this.graph=b;this.set=d;this.pos=P(f,h);this.font=n;this.textCol=p;this.toggleCol=m;this.text=e;this.textPos=P(f+10,h+k/2);this.fontSize=k;this.boxPos=P(l.dx-18,h-5);this.boxDims=V(13,13);this.mouseListenerName=
"toggle"+this.graph.handle.toCapitalCamelCase()+this.set.handle.toCapitalCamelCase();this.drawMarker=r;this.checkMark=b.checkMark(this.boxPos.copy(),this.boxDims.copy(),b.checkMarkOversize,b.toggleCol,b.graphDisplay)}};
GraphBase.LegendEntry.prototype={draw:function(){this.drawToggle();this.drawText();this.drawMarker(this.pos)},drawToggle:function(){draw.fillStrokeRect(this.boxPos,this.boxDims,this.graph.gridCol,this.toggleCol,this.graph.graphDisplay);this.set.visible&&this.checkMark.draw()},drawText:function(){draw.text(this.text,this.textPos,this.font,this.textCol,"left",0,this.graph.graphDisplay)},toggle:function(){ptInRect(this.boxPos,this.boxDims,mouseOffsetDiv(this.graph.parentDivId))&&(this.set.visible=this.set.visible?
!1:!0,this.graph.drawAllBG(),this.graph.drawAllData())},toggleActivate:function(){addListener(curLevel,"mouseup",this.mouseListenerName,this.toggle,this)},toggleDeactivate:function(){removeListener(curLevel,"mouseup",this.mouseListenerName)},setCanvas:function(b){this.checkMark.setCanvas(b)}};GraphBase.Range=function(b,d,e,f){this.x={min:b,max:d};this.y={min:e,max:f}};GraphBase.Range.prototype={copy:function(){return new GraphBase.Range(this.x.min,this.x.max,this.y.min,this.y.max)}};
GraphBase.Marker=function(b){this.handle=b.handle;this.dataX="function"==typeof b.x?b.x:this.wrapInDataGet(b.x);this.dataY="function"==typeof b.y?b.y:this.wrapInDataGet(b.y);this.graph=b.graph;this.graphDisplay=b.graphDisplay;validNumber(this.dataX())&&validNumber(this.dataY())?this.coordLast=this.graph.valToCoord(P(this.dataX(),this.dataY())):this.coordLast=void 0;this.markerType=b.markerType;this.col=b.col;this.visible=!0;this.layers=b.layers;this.dataValid=!0;if(this.drawFuncs[this.markerType])this.drawCB=
this.drawFuncs[this.markerType];else{console.log("Bad marker type "+this.markerType+".  Choices include ");for(var d in this.drawFuncs)console.log(d)}this.characLen=15;this.imgCharacLen=this.characLen+2;this.layers.addItem("marker",this);var e=this;b.label&&(this.legendEntry=this.addLegendEntry(b.label,function(b){e.drawCB(b)}))};
GraphBase.Marker.prototype={wrapInDataGet:function(b){with(DataGetFuncs)b=exprHasReturn(b)?eval("(function(){"+b+"})"):eval("(function(){return "+b+"})");return b},setDataValid:function(){try{this.dataValid=!1!==validNumber(this.dataX())&&!1!==validNumber(this.dataY())?!0:!1}catch(b){this.dataValid=!1}},setDrawCanvas:function(b){this.graphDisplay=b},addLegendEntry:function(b,d){this.graph.makeLegendEntry(this,b,this.handle,d)},draw:function(){this.visible&&(this.dataValid&&(this.coordLast=this.graph.valToCoord(P(this.dataX(),
this.dataY()))),this.drawCB(this.coordLast))},drawFuncs:{bullseye:function(b){var d=this.characLen;window.draw.circle(b,0.15*d,this.col,!0,this.graphDisplay);window.draw.line(b.copy().movePt(V(-d/2,0)),b.copy().movePt(V(d/2,0)),this.col,this.graphDisplay);window.draw.line(b.copy().movePt(V(0,-d/2)),b.copy().movePt(V(0,d/2)),this.col,this.graphDisplay);window.draw.circle(b,0.3*d,this.col,!1,this.graphDisplay)}},remove:function(){this.layers.removeItem("marker",this)}};
GraphBase.Layers=function(){this.layers=[];this.handleIdxPairs={};this.count=0};
GraphBase.Layers.prototype={addLayer:function(b){this.layers.push([]);this.handleIdxPairs[b]=this.layers.length-1},setDrawCanvas:function(b){for(var d=0;d<this.layers.length;d++)for(var e=this.layers[d],f=0;f<e.length;f++)e[f].setDrawCanvas(b)},removeLayer:function(b){var d=this.handleIdxPairs[b];for(b in this.handleIdxPairs)this.handleIdxPairs[b]>d&&this.handleIdxPairs[b]--;this.count-=this.layers[d].length;this.layers.splice(d,1);delete this.handleIdxPairs[b]},addItem:function(b,d){this.layers[this.handleIdxPairs[b]].push(d);
this.count++},removeItem:function(b,d){var e=this.layers[this.handleIdxPairs[b]].indexOf(d);this.layers[this.handleIdxPairs[b]].splice(e,1);this.count--},removeAll:function(){for(var b=0;b<this.layers.length;b++)for(var d=this.layers[b],e=0;e<d.length;e++)d[e].remove()}};function GraphPhaseTwoComp(b){this.spcAName=b.spcAName;this.spcBName=b.spcBName;this.spcA=spcs[this.spcAName];this.spcB=spcs[this.spcBName];this.wallGas=b.wallGas;this.liquid=b.liquid;this.primaryKeyType=/light/i.test(b.primaryKey)?"Light":"Heavy";this.handle=b.handle;this.actCoeffFuncs=b.actCoeffFuncs;this.pressure=b.pressure||1;b.axesFixed={x:!0};b.numGridLines={x:6};this.keyNamePairs=this.getKeyNamePairs(this.spcA,this.spcB,this.pressure);(!this.spcA||!this.spcB)&&console.log("Bad species data for phase diagram "+
this.spcAName+" "+this.spcBName);b.yLabel="Temp";b.xLabel="frac "+this.keyNamePairs[this.primaryKeyType].toCapitalCamelCase();b.makeReset=!1;this.graph=new GraphScatter(b);this.equilData;this.updateEquilData(this.pressure);this.equilDataHandle=this.handle+"PhaseData";this.graph.addSet({handle:this.equilDataHandle,label:"Phase\nData",pointCol:Col(255,255,255),flashCol:Col(0,0,0),trace:!0,recording:!1,showPts:!1});this.recordFracData(this.wallGas,this.keyNamePairs[this.primaryKeyType]);this.recordFracData(this.liquid.wallLiq,
this.keyNamePairs[this.primaryKeyType]);var d=this.liquid;this.liqTempFunc=function(){return d.temp};this.gasTempFunc=this.makeTempFunc(this.wallGas);this.yFuncKillLow=this.makeFracFunc(this.wallGas,this.keyNamePairs[this.primaryKeyType],!0);this.yFunc=this.makeFracFunc(this.wallGas,this.keyNamePairs[this.primaryKeyType]);this.xFuncKillLow=this.makeFracFunc(this.liquid.wallLiq,this.keyNamePairs[this.primaryKeyType],!0);this.xFunc=this.makeFracFunc(this.liquid.wallLiq,this.keyNamePairs[this.primaryKeyType]);
this.updateGraph();this.active=!1;defaultTo(!0,b.makeLiquidMarker)&&this.makeLiquidMarker();defaultTo(!0,b.makeSystemMarker)&&this.makeSystemMarker();defaultTo(!0,b.makeGasMarker)&&this.makeGasMarker();this.graph.hasData=!0}
GraphPhaseTwoComp.prototype={recordFracData:function(b,d){b.recordFrac({spcName:d,tag:b.handle})},setDataValid:function(){this.graph.setDataValid()},makeLiquidMarker:function(){this.graph.addMarker({handle:"liquid",col:Col(200,0,0),markerType:"bullseye",x:this.xFuncKillLow,y:this.liqTempFunc,label:"Liquid"})},makeSystemMarker:function(){var b=this,d=b.liquid,e=d.wallGas,f=d.wallGas.dotManager,h=d.wallLiq.dotManager;this.graph.addMarker({handle:"system",col:Col(200,200,0),markerType:"bullseye",x:function(){return(b.xFunc()*
h.count+b.yFunc()*f.count)/(f.count+h.count)},y:function(){var f=e.getCv();return(f*b.gasTempFunc()+d.Cp*b.liqTempFunc())/(f+d.Cp)},label:"System"})},makeGasMarker:function(){this.graph.addMarker({handle:"gas",col:Col(0,200,0),markerType:"bullseye",x:this.yFuncKillLow,y:this.gasTempFunc,label:"Gas"})},makeTempFunc:function(b){var d=b.getDataSrc("temp");return function(){for(var b=0,f=Math.max(0,d.length-30);f<d.length;f++)b+=d[f];return b/Math.min(Math.max(1,d.length),30)}},makeFracFunc:function(b,
d,e){var f=b.getDataSrc("frac",{spcName:d,tag:b.handle}),h=b.dotManager;return e?function(){if(50<h.count){for(var b=0,d=Math.max(0,f.length-30);d<f.length;d++)b+=f[d];return b/Math.min(Math.max(1,f.length),30)}return-1E5}:function(){for(var b=0,d=Math.max(0,f.length-30);d<f.length;d++)b+=f[d];return b/Math.min(Math.max(1,f.length),30)}},clearHTML:function(){this.graph.clearHTML()},restoreHTML:function(){this.graph.restoreHTML()},drawAllData:function(){this.graph.drawAllData()},disable:function(){this.graph.disable()},
save:function(){},addLast:function(){this.graph.addLast()},remove:function(){this.graph.remove()},setPressure:function(b){var d=this.updateEquilData(b);this.updateGraph();this.pressure=b;return d},getKeyNamePairs:function(b,d,e){return b.tBoil(e)<d.tBoil(e)?{Light:b.spcName,Heavy:d.spcName}:{Light:d.spcName,Heavy:b.spcName}},updateEquilData:function(b){b=phaseEquilGenerator.twoComp.constP(this.spcA,this.spcB,this.actCoeffFuncs,b,20);for(var d=[],e=[],f=0;f<b.data.length;f++){var h=b.data[f],k=h.temp,
l=h["y"+this.primaryKeyType];d.push(P(h["x"+this.primaryKeyType],k));e.push(P(l,k))}this.equilData=d.concat(e.reverse());return b},updateGraph:function(){this.graph.clearData(this.equilDataHandle,!1);this.graph.enqueueData(this.equilDataHandle,this.equilData);this.graph.updateRange();this.graph.drawAllData()}};function GraphPhaseOneComp(b){this.spcName=b.spcName;this.spc=spcs[this.spcName];this.wallGas=b.wallGas;this.liquid=b.liquid;this.handle=b.handle;this.pressure=b.pressure||1;b.axesFixed={x:!1,y:!1};b.numGridLines={x:6};b.xLabel="Temperature (K)";b.yLabel="Pressure "+this.spcName+" (bar)";b.makeReset=!1;this.equilDataSets=void 0;this.triplePointTemp=b.triplePointTemp;this.criticalPointTemp=b.criticalPointTemp;this.updateEquilData();var d=this.getYMin(this.equilDataSets),e=this.getYMax(this.equilDataSets),
e=this.getOrderOfMagRange(d,e);b.numGridLines=defaultTo({},b.numGridLines);b.numGridLines.y=e+1;b.axisInit.y={min:Math.pow(10,Math.floor(Math.log(d)/Math.LN10)),step:1};b.logScale={y:!0};this.graph=new GraphScatter(b);this.equilDataHandles=this.makeEqDataHandles(this.equilDataSets,this.handle);this.addEqDataSets(this.graph,this.equilDataSets,this.equilDataHandles);this.tempFunc=this.makeTempFunc(this.wallGas,this.liquid);this.pressureFunc=this.makePressureFunc(this.wallGas,this.spcName);this.updateGraph();
this.active=!1;defaultTo(!0,b.makeSystemMarker)&&this.makeMarker();this.graph.hasData=!0}
GraphPhaseOneComp.prototype={addEqDataSets:function(b,d,e){for(b=0;b<d.length;b++)this.graph.addSet({handle:this.equilDataHandles[b],label:"Phase\nData",pointCol:Col(255,255,255),flashCol:Col(0,0,0),trace:!0,recording:!1,showPts:!1})},makeMarker:function(){this.graph.addMarker({handle:"system",col:Col(200,0,0),markerType:"bullseye",x:this.tempFunc,y:this.pressureFunc,label:"System"})},updateEquilData:function(){this.equilDataSets=phaseEquilGenerator.oneComp.equilData(this.spcName,this.triplePointTemp,
this.criticalPointTemp,this.triplePointTemp-25,!1)},getYMin:function(b){for(var d=Number.MAX_VALUE,e=0;e<b.length;e++)for(var f=b[e],h=0;h<f.length;h++)d=Math.min(f[h].pressure,d);return d},getYMax:function(b){for(var d=Number.MIN_VALUE,e=0;e<b.length;e++)for(var f=b[e],h=0;h<f.length;h++)d=Math.max(f[h].pressure,d);return d},getOrderOfMagRange:function(b,d){return Math.ceil(Math.log(d)/Math.LN10)-Math.floor(Math.log(b)/Math.LN10)},makePressureFunc:function(b,d){var e=b.recordFrac({spcName:d,tag:b.handle}).src(),
f=b.getDataSrc("pExt",void 0,!0),h=!1!==f?f:b.getDataSrc("pInt",void 0,!0);return function(){for(var b=0,d=Math.max(0,h.length-30);d<h.length;d++)b+=h[d];d=e[e.length-1]?e[e.length-1]:1;return b/Math.min(h.length,30)*d}},makeTempFunc:function(b,d){var e=b.getDataSrc("temp");return function(){var f=d.Cp,h=b.getCv();return(e[e.length-1]*h+d.temp*f)/(h+f)}},updateGraph:function(){for(var b=0;b<this.equilDataSets.length;b++)this.graph.clearData(this.equilDataHandles[b],!1),this.graph.enqueueData(this.equilDataHandles[b],
this.equilDataToPoints(this.equilDataSets[b]));this.graph.updateRange();this.graph.drawAllData()},setPressure:function(){},makeEqDataHandles:function(b,d){for(var e=[],f=0;f<b.length;f++)e.push(d+"PhaseDataSet"+f);return e},equilDataToPoints:function(b){for(var d=[],e=0;e<b.length;e++)d.push(P(b[e].temp,b[e].pressure));return d}};function GraphScatter(b){this.active=!0;this.handle=b.handle;this.dims=this.getDims();this.xLabel=b.xLabel;this.yLabel=b.yLabel;var d=b.axesInit||b.axisInit;this.labelFontSize=15;this.legendFontSize=12;this.axisValFontSize=11;this.labelFont=this.labelFontSize+"pt calibri";this.legendFont=this.legendFontSize+"pt calibri";this.axisValFont=this.axisValFontSize+"pt calibri";this.borderSpacing=70;this.logScale=b.logScale?{x:defaultTo(!1,b.logScale.x),y:defaultTo(!1,b.logScale.y)}:{x:!1,y:!1};this.legendWidth=
80;b.axesFixed=b.axesFixed||{};this.axesFixed={x:defaultTo(!1,b.axesFixed.x),y:defaultTo(!1,b.axesFixed.y)};this.graphRangeFrac=new GraphBase.Range(this.borderSpacing/this.dims.dx,(this.dims.dx-(this.legendWidth+8))/this.dims.dx,1-this.borderSpacing/this.dims.dy,0.05);this.makeReset=b.makeReset;this.setNumGridLinesAndSpacing(b.numGridLines);this.axisInit=this.setAxesInit(d,this.numGridLines);this.resetRanges();this.stepSize=new GraphScatter.Coord(0,0);this.setStds();this.layers.addLayer("flasher");
this.layers.addLayer("marker");this.drawAllBG()}
_.extend(GraphScatter.prototype,AuxFunctions,GraphBase,{setAxesInit:function(b,d){var e,f,h,k;this.logScale.x?(k=d.x-1,Math.pow(10,Math.floor(Math.log(b.x.min)/Math.LN10)),Math.pow(10,k)):(e=b.x.min,f=e+b.x.step*(d.x-1));this.logScale.y?(k=d.y-1,h=Math.pow(10,Math.floor(Math.log(b.y.min)/Math.LN10)),k=h*Math.pow(10,k)):(h=b.y.min,k=h+b.y.step*(d.y-1));return new GraphBase.Range(e,f,h,k)},addSet:function(b){if(!this.data[b.handle]){var d=this,e=new GraphScatter.Set(this,b.handle,b.label,b.data,b.pointCol,
b.flashCol,b.fillInPts,b.fillInPtsMin,b.trace,b.recording,b.showPts),f=b.pointCol.copy();this.data[b.handle]=e;var h;h=b.trace&&defaultTo(!0,b.showPts)?function(b){draw.line(b.copy().movePt(V(-9,0)),b.copy().movePt(V(9,0)),f,d.graphDisplay);d.drawPtStd(b,f)}:b.trace?function(b){draw.line(b.copy().movePt(V(-9,0)),b.copy().movePt(V(9,0)),f,d.graphDisplay)}:function(b){d.drawPtStd(b,f)};this.makeLegendEntry(e,e.label,b.handle,h);this.drawAllBG()}},setDataValid:function(){for(var b in this.data)this.data[b].setDataValid();
for(var d in this.markers)this.markers[d].setDataValid()},drawAllData:function(){this.drawAllBG();this.drawAxisVals();this.drawPts(!1)},drawPts:function(b){for(var d in this.data)this.data[d].drawPts(!1!==b)},addLast:function(){for(var b in this.data){var d=this.data[b];d.recording&&d.dataValid&&(d.trimNewData(),d.enqueuePts())}this.flushQueues(!0,!1);this.hasData=!0},getAxisBounds:function(){this.getXBounds();this.getYBounds()},graphPt:function(b,d,e){b=this.valToCoord(P(b,d));this.drawPtStd(b,e)},
drawPtStd:function(b,d){this.drawPt(b,d,this.characLen)},drawPt:function(b,d,e,f){f=f||this.graphDisplay;var h=b.x,k=b.y;b=P(h-e,k);var l=P(h,k-e),m=P(h+e,k);e=P(h,k+e);draw.fillPtsStroke([b,l,m,e],d,this.ptStroke,f)},reset:function(){this.resetStd()}});
GraphScatter.Set=function(b,d,e,f,h,k,l,m,n,p,r){this.graph=b;this.handle=d;this.label=e;this.data=new GraphScatter.Data;this.showPts=defaultTo(!0,r);this.graphedPts=[];this.graphedPtIdxs=[];f=f||{};this.dataFuncs=new GraphScatter.DataFuncs(b,f.x,f.y);this.pointCol=h;this.flashCol=k;this.fillInPts=defaultTo(!0,l);this.fillInPtsMin=defaultTo(5,m);this.trace=defaultTo(!1,n);this.visible=!0;this.recordListenerName=this.graph.handle+this.handle.toCapitalCamelCase()+"Record";this.traceLastIdxs=new GraphScatter.Coord(0,
0);this.flashers=[];this.queuePts=[];this.queueIdxs=[];this.recording=defaultTo(!0,p);this.dataValid=!0;this.recording&&this.recordStart()};
GraphScatter.Set.prototype={reset:function(){this.graphedPts.splice(0,this.graphedPts.length);this.graphedPtIdxs.splice(0,this.graphedPtIdxs.length);this.flashers.splice(0,this.flashers.length);this.queueIdxs.splice(0,this.queueIdxs.length);this.queuePts.splice(0,this.queuePts.length)},setDataValid:function(){try{var b=this.dataFuncs.x(),d=this.dataFuncs.y();this.dataValid=!1!==validNumber(b)&&!1!==validNumber(d)?!0:!1}catch(e){this.dataValid=!1}},addVal:function(){this.data.x.push(this.dataFuncs.x());
this.data.y.push(this.dataFuncs.y())},clearData:function(){this.queuePts.splice(0,this.queuePts.length);this.queueIdxs.splice(0,this.queueIdxs.length);this.data.clear()},enqueueData:function(b){var d=this.data.x.length;this.queuePts=this.queuePts.concat(b);this.addData(b);for(b=d;b<this.data.x.length;b++)this.queueIdxs.push(P(b,b))},addData:function(b){this.data.addData(b)},recordStart:function(){addListener(curLevel,"update",this.recordListenerName,function(){this.dataValid&&this.addVal()},this)},
recordStop:function(){removeListener(curLevel,"update",this.recordListenerName)},trimNewData:function(){if(this.graphedPtIdxs.length){var b=this.data.x,d=this.data.y,e=this.graphedPtIdxs[this.graphedPtIdxs.length-1].x,f=this.graphedPtIdxs[this.graphedPtIdxs.length-1].y,h=b.length-e;if(h!=d.length-f)return!1;e=this.findRuns(b,d,f,e,h);for(f=e.length-1;0<=f;f--)this.trimRun(b,d,e[f])}},findRuns:function(b,d,e,f,h){for(var k=function(b,d,e){this.xStartIdx=b;this.yStartIdx=d;this.length=e},l=[],m=[],
n=void 0,p=e,r=f,s=0;s<h-1;s++){var t=P(b[e+s],d[f+s]);if(1>=m.length)m.push(t),2==m.length&&(n=m[0].VTo(m[1]).UV());else{var u=m[m.length-1].VTo(t).UV();0.99<Math.abs(u.dotProd(n))?m.push(t):(3<=m.length&&l.push(new k(p,r,e+s-p,f+s-r)),m=[t],p=e+s,r=f+s)}}3<=m.length&&l.push(new k(p,r,e+s-p,f+s-r));return l},trimRun:function(b,d,e){for(var f=P(b[e.xStartIdx],d[e.yStartIdx]),h=P(b[e.xStartIdx+e.length-1],d[e.yStartIdx+e.length-1]),k=f,l=h,m=k.VTo(l),n=l.VTo(k),p=!0,r=1;r<e.length-1;r++){var s=P(b[e.xStartIdx+
r],d[e.yStartIdx+r]);if(p&&(0>f.VTo(s).dotProd(m)||0>h.VTo(s).dotProd(n)))p=!1;0>m.dotProd(k.VTo(s))?(k=s,m=k.VTo(l)):0>n.dotProd(l.VTo(s))&&(l=s,n=l.VTo(k))}n=[f.x];m=[f.y];k!=f&&(n.push(k.x),m.push(k.y));l!=h&&(n.push(l.x),m.push(l.y));n.push(h.x);m.push(h.y);f=[e.xStartIdx,e.length].concat(n);e=[e.yStartIdx,e.length].concat(m);Array.prototype.splice.apply(b,f);Array.prototype.splice.apply(d,e)},enqueuePts:function(){var b=this.data.pt(),d=[],e=[];if(b.isValid()){var f=new GraphScatter.Coord(this.data.x.length-
1,this.data.y.length-1);if(this.fillInPts&&this.data.x.length&&this.data.y.length&&this.graphedPtIdxs.length)var h=this.graphedPtIdxs[this.graphedPtIdxs.length-1],k=this.data.pt(h.x,h.y),h=this.fillInPtsFunc(b,f,k,h,this.data),d=d.concat(h.newPts),e=e.concat(h.dataIdxs);d.push(b);e.push(f)}this.queuePts=this.queuePts.concat(d);this.queueIdxs=this.queueIdxs.concat(e)},fillInPtsFunc:function(b,d,e,f,h){var k=d.x-f.x;if(k!=d.y-f.y)return{newPts:[],dataIdxs:[]};b=this.graph.valToCoord(b);var l=this.graph.valToCoord(e);
d=this.graph.dataScaling();for(var l=b.VTo(l).UV().perp(),m=k-1;0<m;m--){var k=f.x+m,n=f.y+m,p=b.VTo(this.graph.valToCoord(P(h.x[k],h.y[n]))),p=Math.abs(p.dotProd(l));if(p>this.fillInPtsMin){m=P(h.x[k],h.y[n]);d=this.getEdgePt({x:k,y:n},f,l,m,p,b,h,d);if(!d)break;b=d.dataIdx;d=d.pt;e=this.fillInPtsFunc(d,b,e,f,h);return{newPts:[d].concat(e.newPts),dataIdxs:[b].concat(e.dataIdxs)}}}return{newPts:[],dataIdxs:[]}},getEdgePt:function(b,d,e,f,h,k,l,m){for(b=b.x-d.x-1;0<b;b--){m=d.x+b;var n=d.y+b,p=k.VTo(this.graph.valToCoord(P(l.x[m],
l.y[n]))),p=Math.abs(p.dotProd(e));if(p<h)return{pt:f,dataIdx:{x:m+1,y:n+1}};f=P(l.x[m],l.y[n]);h=p}},updateRange:function(b){this.trace?this.updateRangeFromData(b):this.updateRangeFromPts(b)},updateRangeFromData:function(b){for(var d=this.queueIdxs[0]?this.queueIdxs[0].x:0;d<this.data.x.length;d++){var e=this.data.x[d],f=this.data.y[d];b.x.max=Math.max(b.x.max,e);b.x.min=Math.min(b.x.min,e);b.y.max=Math.max(b.y.max,f);b.y.min=Math.min(b.y.min,f)}},updateRangeFromPts:function(b){for(var d=0;d<this.queuePts.length;d++){var e=
this.queuePts[d].x,f=this.queuePts[d].y;b.x.max=Math.max(b.x.max,e);b.x.min=Math.min(b.x.min,e);b.y.max=Math.max(b.y.max,f);b.y.min=Math.min(b.y.min,f)}},drawPts:function(b){if(this.visible&&(this.showPts||this.trace)&&(this.queuePts.length||this.graphedPts.length)){var d,e=[];b?(d=this.queuePts,e=this.queueIdxs):(d=this.graphedPts.concat(this.queuePts),e=this.graphedPtIdxs.concat(this.queueIdxs));this.trace&&(b?this.graphedPtIdxs.length&&e.length&&this.drawTrace(this.graphedPtIdxs[this.graphedPtIdxs.length-
1].x,e[e.length-1].x,this.graphedPtIdxs[this.graphedPtIdxs.length-1].y,e[e.length-1].y):this.drawTrace(e[0].x,e[e.length-1].x,e[0].y,e[e.length-1].y));if(this.showPts)for(b=0;b<d.length;b++)this.graph.graphPt(d[b].x,d[b].y,this.pointCol)}},flashInit:function(){if(this.visible&&this.showPts)for(var b=0;b<this.queuePts.length;b++){var d=this.queuePts[b],e=this.pointCol,f=this.flashCol,h=f.copy();new GraphScatter.Flasher(d,e,f,h,this.graph.characLen*this.graph.flashMult,2*this.graph.characLen*this.graph.flashMult,
this.graph.characLen,this.graph.flashMult,this.graph.flashRate,this.graph.graphDisplay,this.graph.layers,this.graph)}},flushQueue:function(){this.graphedPts=this.graphedPts.concat(this.queuePts);this.graphedPtIdxs=this.graphedPtIdxs.concat(this.queueIdxs);this.queuePts.splice(0,this.queuePts.length);this.queueIdxs.splice(0,this.queueIdxs.length)},drawTrace:function(b,d,e,f){if(d-b==f-e&&void 0!==b&&void 0!==e){d-=b;f=[this.graph.valToCoord(P(this.data.x[b],this.data.y[e]))];for(var h=1;h<d+1;h++){var k=
this.graph.valToCoord(P(this.data.x[b+h],this.data.y[e+h]));k.closeTo(f[f.length-1])||f.push(k)}draw.path(f,this.pointCol,this.graph.graphDisplay)}else console.log("Data count mismatch for tracing"),console.trace()}};GraphScatter.DataFuncs=function(b,d,e){this.x=b.makeDataFunc(d);this.y=b.makeDataFunc(e)};GraphScatter.Data=function(){this.x=[];this.y=[]};
GraphScatter.Data.prototype={pt:function(b){return void 0===b?P(this.x[this.x.length-1],this.y[this.y.length-1]):P(this.x[b],this.y[b])},addData:function(b){for(var d=0;d<b.length;d++)this.x.push(b[d].x),this.y.push(b[d].y)},toPts:function(){for(var b=[],d=0;d<this.x.length;d++)b.push(this.x[d],this.y[d]);return b},clear:function(){this.x.splice(0,this.x.length);this.y.splice(0,this.y.length)}};GraphScatter.Coord=function(b,d){this.x=b;this.y=d};
GraphScatter.Coord.prototype={copy:function(){return new GraphScatter.prototype.Coord(this.x,this.y)}};
GraphScatter.Flasher=function(b,d,e,f,h,k,l,m,n,p,r,s){this.pt=b;this.pointCol=d;this.flashCol=e;this.curCol=f;this.curCharacLen=h;this.imgCharacLen=k;this.finalCharacLen=l;this.flashMult=m;this.flashRate=n;this.graphDisplay=p;this.layers=r;this.graph=s;this.coordLast=this.graph.valToCoord(this.pt);this.advanceListenerHandle=this.addAdvanceListener();this.lifetime=1/this.flashRate;this.age=0;r.addItem("flasher",this)};
GraphScatter.Flasher.prototype={addAdvanceListener:function(){var b="flashAdvance"+this.graph.handle+this.pt.x+this.pt.y;addListener(curLevel,"update",b,function(){this.advance()},this);return b},setDrawCanvas:function(b){this.graphDisplay=b},draw:function(){this.coordLast=this.graph.valToCoord(this.pt);this.graph.drawPt(this.coordLast,this.curCol,this.curCharacLen,this.graphDisplay)},remove:function(){this.layers.removeItem("flasher",this);removeListener(curLevel,"update",this.advanceListenerHandle)},
advance:function(){this.curCharacLen=stepTowards(this.curCharacLen,this.finalCharacLen,-this.finalCharacLen*this.flashMult*this.flashRate);var b=this.curCol,d=Col(0,0,0);d.r=this.colStep("r");d.g=this.colStep("g");d.b=this.colStep("b");b.set(d);this.age>this.lifetime+1&&this.remove();this.age++},colStep:function(b){var d=this.pointCol[b];return stepTowards(this.curCol[b],d,(d-this.flashCol[b])*this.graph.flashRate)}};function GraphHist(b){this.active=!0;this.handle=b.handle;this.dims=this.getDims();this.xLabel=b.xLabel;this.yLabel=b.yLabel;this.labelFontSize=15;this.axisValFontSize=11;var d=b.axesInit;this.labelFont=this.labelFontSize+"pt calibri";this.axisValFont=this.axisValFontSize+"pt calibri";this.borderSpacing=70;this.graphRangeFrac=new GraphBase.Range(this.borderSpacing/this.dims.dx,0.95,1-this.borderSpacing/this.dims.dy,0.05);this.logScale=b.logScale?{x:defaultTo(!1,b.logScale.x),y:defaultTo(!1,b.logScale.y)}:
{x:!1,y:!1};this.numBins=18;this.axesFixed={x:defaultTo(!1,b.axesFixed.x),y:defaultTo(!1,b.axesFixed.y)};this.setNumGridLinesAndSpacing(b.numGridLines);this.axisInit=new GraphBase.Range(d.x.min,d.x.min+d.x.step*(this.numGridLines.x-1),d.y.min,d.y.min+d.y.step*(this.numGridLines.y-1));this.resetRanges();this.stepSize={x:0,y:0};Col(255,100,0);this.setStds();this.drawAllBG()}
_.extend(GraphHist.prototype,AuxFunctions,GraphBase,{addSet:function(b){this.data[b.handle]||(b=new GraphHist.Set(this,b.handle,b.data,b.barCol),this.data[b.handle]=b,this.drawAllBG())},drawAllData:function(){this.drawAllBG();this.bins&&(this.drawAxisVals(),this.graphBins())},addLast:function(){var b="",d;for(d in this.data)b=d;b=this.data[b];b.addVal();this.makeBins(b);this.hasData=!0},plotData:function(b){var d="",e;for(e in this.data)d=e;this.data[d].data.x=b;this.makeBins(this.data[d])},makeBins:function(b){this.valRange.x=
this.getRange("x");this.setAxisBoundsX();this.bins=this.makeBinBlanks(b.data.x);this.populateBins(b.data.x);this.setYAxis();this.drawAllData()},makeBinBlanks:function(b){b=[];this.binWidth=round((this.valRange.x.max-this.valRange.x.min)/(this.numBins-1),1);for(var d=0;d<this.numBins;d++)b.push(0);return b},populateBins:function(b){for(var d=0;d<b.length;d++)this.bins[Math.floor((b[d]-this.valRange.x.min)/this.binWidth)]++},setYAxis:function(){for(var b=0,d=0;d<this.bins.length;d++)b=Math.max(this.bins[d],
b);this.valRange.y.min=0;this.valRange.y.max=b;this.setAxisBoundsY()},graphBins:function(){var b,d;for(d in this.data)b=d;b=this.data[b].barCol;for(d=0;d<this.bins.length;d++){var e=this.binWidth*(d+1),f=this.valToCoord(P(this.binWidth*d,this.bins[d])),e=this.valToCoord(P(e,0)),e=f.VTo(e);draw.fillStrokeRect(f,e,b,this.bgCol,this.graphDisplay)}},clear:function(){this.clearStd()}});
GraphHist.Set=function(b,d,e,f){this.graph=b;this.handle=d||"onlyData";this.data=new GraphHist.Data;this.dataFunc=new GraphHist.DataFunc(b,e);this.dataValid=!0;this.barCol=f;this.visible=!0};GraphHist.Set.prototype={addVal:function(){this.data.x=this.dataFunc.x()},recordStop:function(){},setDataValid:function(){try{this.dataValid=!1!==validNumber(this.dataFunc.x())?!0:!1}catch(b){}}};GraphHist.Data=function(){this.x=[]};GraphHist.DataFunc=function(b,d){this.x=b.makeDataFunc(d)};function GraphBlank(b){this.dims=this.getGraphDims();this.borderSpacing=70;this.xStart=this.borderSpacing/this.dims.dx;this.yStart=1-this.borderSpacing/this.dims.dy;this.legendWidth=80;this.xEnd=(this.dims.dx-(this.legendWidth+8))/this.dims.dx;this.yEnd=0.05;this.gridSpacing=40;this.setNumGridLines();this.setStds();this.handle="blank"+Math.round(1E5*Math.random());this.parentDiv=b;this.makeCanvasNoReset(this.dims,b);this.parentDiv.attr("filledWith","blank");this.drawBGBlank()}
_.extend(GraphBlank.prototype,GraphBase,{drawBGBlank:function(){this.graph.save();this.drawBGRect();this.graph.globalAlpha=0.2;this.drawGrid();this.drawBounds();this.graph.restore()}});function DataDisplayer(){this.entries={}}
DataDisplayer.prototype={setReadouts:function(b){this.readouts=b},addEntry:function(b){var d=b.label||"",e=defaultTo(1,b.decPlaces),f=b.handle,h=b.expr||"",k=b.units||"",l=this.readouts[b.readout];l||console.log("Bad readout name "+b.readout);b="display"+d+this.entries.length;var m=l.addEntry(d+f),n=new DataDisplayer.Entry(f,d,e,h,k,b,this,m);this.entries[n.handle]=n;addListener(curLevel,"update",b,function(){var b=d,f;f=n.func();f=void 0===f?"":"number"==typeof f?f.toFixed(e):f;b=b+(f+" ")+k;m.setText(b)});
return n},setEntryValue:function(b,d){var e=this.entries[b];e||console.log("bad handle "+b);var f=d-e.func();e.expr=e.expr+" + "+f;e.func=e.wrapExprInFunc()},removeEntry:function(b){this.entries[b]&&this.entries[b].remove()}};DataDisplayer.Entry=function(b,d,e,f,h,k,l,m){this.handle=b;this.label=d;this.decPlaces=e;this.expr=f;this.func=this.wrapExprInFunc();this.units=h;this.listenerStr=k;this.dataDisplayer=l;this.readoutEntry=m;this.removed=!1};
DataDisplayer.Entry.prototype={remove:function(){this.removed||(delete this.dataDisplayer.entries[this.handle],this.readoutEntry.remove(),removeListener(curLevel,"update",this.listenerStr),this.removed=!0)},wrapExprInFunc:function(){var b=this.expr;with(DataGetFuncs)b=exprHasReturn(b)?eval("(function(){"+b+"})"):eval("(function(){return "+b+"})");return b}};DataGetFuncs={tempSmooth:function(b){b=walls[b].getDataSrc("temp");for(var d=Math.min(15,b.length),e=b.length-d,f=0,h=0;h<d;h++)f+=b[e+h];return f/d},collisions:function(){for(var b=collide.hitsPerTurn,d=Math.min(15,b.length),e=b.length-d,f=0,h=0;h<d;h++)f+=b[e+h];return 1E3*f/d/updateInterval},temp:function(b){b=walls[b].getDataSrc("temp");return b[b.length-1]},pInt:function(b){b=walls[b].getDataSrc("pInt");return b[b.length-1]},pExt:function(b){b=walls[b].getDataSrc("pExt");return b[b.length-1]},
vol:function(b){b=walls[b].getDataSrc("vol");return b[b.length-1]},q:function(b){b=walls[b].getDataSrc("q");return b[b.length-1]},mass:function(b){b=walls[b].getDataSrc("mass");return b[b.length-1]},moles:function(b,d){var e=walls[b].getDataSrc("moles",d);return e[e.length-1]},frac:function(b,d){var e=walls[b].getDataSrc("frac",d);return e[e.length-1]},time:function(b){b=walls[b].getDataSrc("time");return b[b.length-1]},work:function(b){b=walls[b].getDataSrc("work");return b[b.length-1]},enthalpy:function(b){b=
walls[b].getDataSrc("enthalpy");return b[b.length-1]},internalEnergy:function(b){b=walls[b].getDataSrc("internalEnergy");return b[b.length-1]},vDist:function(b,d){var e=walls[b].getDataSrc("vDist",d);return e[e.length-1]},get:function(b,d,e,f,h){b=getStore(b);var k,l="int"==d||"float"==d;b&&(k="int"==d?Math.round(parseFloat(b)):"float"==d?parseFloat(b):"string"==d?b.sanitize():Number(b)==b?Number(b):b,l&&(h=void 0===h||isNaN(h)?k:h,f=void 0===f||isNaN(f)?k:f,k=bound(k,f,h)));if(void 0===k||l&&isNaN(k))k=
e;return k},img:function(b,d,e,f){if(f)return{attrs:{src:[window.IMGPATHPREFIX+b]}};b=templater.img({attrs:{src:[window.IMGPATHPREFIX+b]}});e&&(b=templater.center({innerHTML:b}));"br"==d?b=templater.br()+b+templater.br():"p"==d&&(b=templater.p({innerHTML:b}));return b}};function Experiment(){this.mutables={count:new Experiment.Mutable("LevelData.mainSequence[0].sceneData.dots[0].count")};this.data={tempFinal:new Experiment.Data('walls.wally.getDataSrc("temp")')};this.listData={vol:new Experiment.Data('walls.wally.getDataSrc("vol")'),temp:new Experiment.Data('walls.wally.getDataSrc("temp")')};this.everyNth=4;this.dataToEval={};this.dimensions=[new Experiment.Dimension([{paths:["count"],testVals:"[300, 500 ... 500]"}])];this.appendEqData=!1;this.numReps=1;this.runTime=
10;this.draw=!1;this.runNum=0;this.totalRuns=this.getTotalRuns();console.log("Running "+this.totalRuns+" tests at "+this.runTime+" seconds each.");console.log("Total run time: "+this.totalRuns*this.runTime+" seconds");this.resultsSets=[];this.repIdx=0;this.dimValIdxs=this.makeDimValIdxs(this.dimensions);this.finished=!1;this.measureNext()}
Experiment.prototype={measureNext:function(){var b=this;this.finished?(console.log("Done!  Ready to print"),curLevel.pause()):(this.setVals(this.mutables,this.dimensions,this.dimValIdxs),sceneNavigator.refresh(),this.draw||(curLevel.drawRun=function(){}),setTimeout(function(){b.tryNextMeasurement()},1E3*this.runTime))},print:function(b){b||(b=Experiment.Dimension.prototype.extendSet("[0 ... "+(this.dimensions.length-1)+"]"));b=this.sortResults(this.resultsSets,b);var d;d='<table border="1" cellpadding="3">'+
this.makeHeaderRow();for(var e=0;e<b.length;e++)d+=b[e].asTableBlock(this.appendEqData,this.everyNth,!0);d+="</table>";$("body").append("<br>");$("body").append(d)},sortResults:function(b,d){if(!d.length)return b;for(var e=d[0],f=this.sortSetsByDimIdx(b.concat(),e),e=this.pluckGroups(f,e),h=f=0;h<e.length;h++){var k=[f,e[h].length].concat(this.sortResults(e[h],d.slice(1,d.length-1)));Array.prototype.splice.apply(b,k);f+=e[h].length}return b},pluckGroups:function(b,d){for(var e=[],f=-1,h=0;h<b.length;h++)b[h].dimValIdxs[d]!=
f&&(e.push([]),f=b[h].dimValIdxs[d]),e[e.length-1].push(b[h]);return e},sortSetsByDimIdx:function(b,d){for(var e=0;e<b.length;e++)for(var f=0;f<b.length-1;f++){var h=b[f],k=b[f+1];k.dimValIdxs[d]<h.dimValIdxs[d]&&(b[f]=k,b[f+1]=h)}return b},tryNextMeasurement:function(){this.recordPt(this.data,this.mutables,this.listData,this.dimValIdxs);this.finished=this.tick();this.measureNext()},tick:function(){this.runNum++;console.log(Math.round(100*this.runNum/this.totalRuns)+" %");var b=this.dimensions,d=
this.dimValIdxs;this.repIdx++;return this.repIdx==this.numReps?(this.repIdx=0,this.nextDimVal(b,d)):!1},nextDimVal:function(b,d){for(var e=b.length-1;0<=e;e--)if(d[e]++,d[e]==b[e].numPts)d[e]=0;else return!1;return!0},makeDimValIdxs:function(b){for(var d=[],e=0;e<b.length;e++)d.push(0);return d},makeHeaderRow:function(){var b="<tr>",d;for(d in this.mutables)b+="<td>"+d+"</td>";for(d in this.data)b+="<td>"+d+"</td>";for(d in this.listData)b+="<td>"+d+"</td>";for(d in this.dataToEval)b+="<td>"+d+"</td>";
this.appendEqData&&(b+="<td>eq const</td><td>mole frac prods</td>");return b+="</tr>"},getTotalRuns:function(){for(var b=1,d=0;d<this.dimensions.length;d++)b*=this.dimensions[d].numPts;return b*this.numReps},recordPt:function(b,d,e,f){this.resultsSets.length?this.resultsSets[this.resultsSets.length-1].isAtIdxs(f)||this.resultsSets.push(new Experiment.ResultsSet(f)):this.resultsSets.push(new Experiment.ResultsSet(f));this.resultsSets[this.resultsSets.length-1].results=new Experiment.Results(b,d,e,
this.dataToEval)},setVals:function(b,d,e){for(var f=0;f<d.length;f++)for(var h=d[f],k=e[f],l=0;l<h.paths.length;l++)for(var m=h.testVals[l][k],n=h.paths[l],p=0;p<n.length;p++)eval(b[n[p]].path+" = "+m)}};Experiment.ResultsSet=function(b){this.dimValIdxs=b.concat();this.results=void 0};
Experiment.ResultsSet.prototype={addResults:function(b){this.results=b},isAtIdxs:function(b){for(var d=0;d<b.length;d++)if(b[d]!=this.dimValIdxs[d])return!1;return!0},asTableBlock:function(b,d,e){var f="";e&&(f+="<tr><td></td></tr>");return f+=this.results.asTableBlock(b,d)}};Experiment.Dimension=function(b){this.paths=_.pluck(b,"paths");b=_.pluck(b,"testVals");this.testVals=this.extendSets(b,this.paths);this.numPts=this.testVals[0].length};
Experiment.Dimension.prototype={extendSets:function(b,d){for(var e=[],f=0;f<b.length;f++)b[f]instanceof Array?e.push(b[f]):e.push(this.extendSet(b[f]));this.checkValLens(e,d);return e},extendSet:function(b){-1==b.indexOf("...")&&console.log("Unrecognized set "+b);b=b.replace("..."," ... ");var d=this.cleanSigVals(b.match(/[\-0-9\.]+/g)),e;b=d[0];3==d.length?(e=d[1]-d[0],d=d[2]):(d=d[1],e=d>b?1:-1);return this.setFromSigVals(b,e,d)},checkValLens:function(b,d){for(var e=b[0].length,f=b[0].length,h=
0;h<b.length;h++)e=Math.min(b[h].length,e),f=Math.max(b[h].length,f);e!=f&&(console.log("Dimension with paths "),console.log(d),console.log("has mismatched values sets: max length is "+f+" and min length is "+e),console.log("THIS EXPERIMENT WILL NOT WORK"))},cleanSigVals:function(b){for(var d=[],e=0;e<b.length;e++){var f=/[\.]+/.exec(b[e]);f&&f[0]!=b[e]?d.push(Number(b[e])):f||d.push(Number(b[e]))}return d},setFromSigVals:function(b,d,e){var f=[];if(b<e)for(;b<=e;b+=d)f.push(b);else for(;b>=e;b+=
d)f.push(b);return f}};Experiment.Results=function(b,d,e,f){this.data={};this.spcDefs=deepCopy(LevelData.spcDefs);var h=walls[0].getDataSrc("temp");this.finalTemp=this.avgLast(h,300);this.setPts=this.recordMutables(d);for(var k in b)this.data[k]=b[k].avg(200);this.listData={};for(a in e)this.listData[a]=eval(e[a].path);this.evaledData=this.evalData(f,this.data)};
Experiment.Results.prototype={log:function(){console.log("\nSet point");console.log(this.objToStr(this.setPts));console.log("Produced data");console.log(this.objToStr(this.data)+"\n")},recordMutables:function(b){var d={},e;for(e in b)d[e]=eval(b[e].path);return d},evalData:function(b,d){var e={};with(d)for(var f in b)e[f]=eval(b[f].path);return e},asTableBlock:function(b,d){var e="<tr>",f;for(f in this.setPts)e+="<td>"+this.setPts[f]+"</td>";for(f in this.data)e+="<td>"+this.data[f]+"</td>";for(f in this.listData)e+=
"<td>"+this.listData[f][0]+"</td>";for(f in this.evaledData)e+="<td>"+this.evaledData[f]+"</td>";b&&(e+=this.makeEqData(this.spcDefs));e+="</tr>";countAttrs(this.listData)&&(e=this.appendListDataToTableBlock(this.setPts,this.data,this.listData,this.evaledData,b,e,d));return e},makeEqData:function(b){var d=this.finalTemp,e=1E3*(b[2].hF298+b[3].hF298-(b[1].hF298+b[0].hF298));b=Math.exp(-(e-298*(b[2].sF298+b[3].sF298-b[1].sF298-b[0].sF298))/(298.15*R))*Math.exp(-(e/R)*(1/d-1/298.15));for(var f,d=0;1>=
d&&!(f=Newton(b+" - (x*x)/((1-x)*(1-x))",{x:d},"x"),0<=f&&1>=f);d+=0.1);return"<td>"+b+"</td><td>"+f+"</td>"},appendListDataToTableBlock:function(b,d,e,f,h,k,l){h=0;for(var m in e)h=Math.max(e[m].length,h);for(var n=1;n<h;n++)if(0==n%l){k+="<tr>";for(m in b)k+="<td></td>";for(m in d)k+="<td></td>";for(m in e)k+="<td>"+(void 0!==this.listData[m][n]?this.listData[m][n]:"")+"</td>";for(m in f)k+="<td></td>";k+="</tr>"}return k},objToStr:function(b){var d="",e;for(e in b)d+=e+": "+b[e]+", ";return d},
avgLast:function(b,d){for(var e=0,f=Math.max(0,b.length-d);f<b.length;f++)e+=b[f];return e/Math.min(d,b.length)}};Experiment.Mutable=function(b){this.path=b};Experiment.Mutable.prototype={get:function(){return eval(this.path)},set:function(b){eval(this.path+" = "+b)}};Experiment.Data=function(b){this.path=b};
Experiment.Data.prototype={all:function(){return eval(this.path)},last:function(){var b=eval(this.path);return b[b.length-1]},avg:function(b){for(var d=eval(this.path),e=0,f=Math.max(0,d.length-b);f<d.length;f++)e+=d[f];return e/b}};
function Newton(b,d,e){for(var f=function(d){d=deepCopy(d);with(d){d[e]+=1E-7;var f=eval(b);d[e]-=2E-7;d=eval(b);return(f-d)/2E-7}},h=function(d){with(d)return eval(b)},k=h(d),l=0;1E-7<Math.abs(k);){var m=f(d);d[e]-=k/m;k=h(d);l++;if(1E3<l)return d[e]+" EQ DID NOT CONVERGE"}return d[e]};ReactionFuncs={rxnIsEnabled:function(b){return this.getRxn(this.activeRxns,b)?!0:!1},rxnsAreType:function(b,d){if(b.length)for(var e=1;e<b.length;e++)if(!b[e]instanceof d)return!1;return!0},getRxn:function(b,d){for(var e=0;e<b.length;e++)if(d==b[e].handle)return b[e]},react:function(b,d,e){for(var f=b.internalEnergy()+d.internalEnergy(),h=0,k=0,l=0.5*(b.x+d.x),m=0.5*(b.y+d.y),n=[],p=0;p<e.length;p++){for(var r=e[p],s=[],h=h+r.def.uF298*r.count,k=k+this.spcs[r.spcName].cv*r.count,t=0;t<r.count;t++){var u=
2*Math.random()*Math.PI,u=V(Math.sin(u),Math.cos(u));s.push(D(l+3*u.dx,m+3*u.dy,u,r.spcName,b.tag,b.elemId,b.returnTo))}n.push(s)}h*=1E3/N;k/=N;e=(f-h)/k+298.15;if(0<e){this.dotManager.remove([b,d],!0);for(b=0;b<n.length;b++){s=n[b];this.dotManager.add(s);for(d=0;d<s.length;d++)s[d].setTemp(e)}return!0}return!1},canReact:function(b,d,e){b=b.internalEnergy()+d.internalEnergy();for(var f=d=0,h=0;h<e.length;h++){var k=e[h];d+=k.def.uF298*k.count;f+=this.spcs[k.spcName].cv*k.count}d*=1E3/N;f/=N;return 0<
(b-d)/f+298.15}};ReactionComponent=function(b,d){this.spcName=b;this.count=d;this.def=window.spcs[b]};ReactionComponent.prototype={copy:function(){return new ReactionComponent(this.spcName,this.count)},flatten:function(b){for(var d=[],e=0;e<this.count;e++)d.push(this[b]);return d}};function ReactionHandlerEmergent(b,d,e,f,h,k){this.collide=b;this.dotManager=d;this.tConst=f;this.rxns=e;this.spcs=void 0;this.activeRxns=h;this.pausedRxns=k}
_.extend(ReactionHandlerEmergent.prototype,ReactionFuncs,{addReaction:function(b){b.parent=this;b=new ReactionHandlerEmergent.Reaction(b);this.initRxn(b);return b},enableRxn:function(b){if(b=this.getRxn(this.pausedRxns,b))this.pausedRxns.splice(this.pausedRxns.indexOf(b),1),this.initRxn(b)},disableRxn:function(b){this.removeRxn(b)},removeRxn:function(b){for(var d in this.rxns){for(var e=this.rxns[d],f=!1,h=e.length-1;0<=h;h--)e[h].handle==b&&(e.splice(h,1),f=!0);f&&(0==e.length?this.collide.setHandlerByIdStr(d,
{func:this.collide.impactStd,obj:this.collide}):1==e.length&&(e=e[0],this.initPair(e,!0)))}if(e=this.getRxn(this.activeRxns,b))this.activeRxns.splice(this.activeRxns.indexOf(e),1),this.pausedRxns.push(e)},initRxn:function(b){this.initPair(b);this.activeRxns.push(b)},removeAllReactions:function(){this.collide.setDefaultHandler({func:this.collide.impactStd,obj:this})},initPair:function(b){var d=this.collide.getIdStr(b.rctADef,b.rctBDef);this.rxns[d]?this.rxns[d].push(b):this.rxns[d]=[b];1<this.rxns[d].length?
this.rxnsAreType(this.rxns[d],ReactionHandlerEmergent.Reaction)?this.collide.setHandler(b.rctA,b.rctB,{func:this.rctHandlerMultPairs(d),obj:this}):(console.log("Cannot mix reaction types."),console.log("Failed to add reaction: "),console.log(b)):this.collide.setHandler(b.rctA,b.rctB,{func:this.rctHandlerSinglePair(d),obj:this})},countProds:function(b){var d=0,e;for(e in b)d+=b[e];return d},hitE:function(b,d,e,f){return 0.5*(Math.abs(e)*e*b.m*b.cvKinetic+Math.abs(f)*f*d.m*d.cvKinetic)*this.tConst},
probFunc:function(b,d,e){return b>1.5*d?1/(1+Math.exp(-e/R)):0},rctHandlerSinglePair:function(b){var d=this.rxns[b][0],e=d.activeE,f=this.collide,h=d.prods;return function(b,l,m,n,p){var r=this.hitE(b,l,n,-p);return Math.random()<this.probFunc(r,e,d.sRxn298)?!this.react(b,l,h)?f.impactStd(b,l,m,n,p):!1:f.impactStd(b,l,m,n,p)}},rctHandlerMultPairs:function(b){var d=this.rxns[b],e=this.collide;return function(b,h,k,l,m){for(var n=this.hitE(b,h,l,-m),p=[],r=0,s=0;s<d.length;s++)p[s]=this.probFunc(n,
d[s].activeE,rxn.sF298),r+=p[s];s=this.pickRxnIdx(p,1<r?1/r:1);return!1===s?e.impactStd(b,h,k,l,m):this.react(b,h,d[s].prods)?!1:e.impactStd(b,h,k,l,m)}},pickRxnIdx:function(b,d){for(var e=Math.random(),f=0,h=0;h<b.length;h++)if(f+=b[h]*d,f>e)return h;return!1}});
ReactionHandlerEmergent.Reaction=function(b){this.attrs=b;this.handle=b.handle;this.parent=b.parent;this.rctA=b.rctA||b.rctB;this.rctB=b.rctA&&b.rctB?b.rctB:void 0;this.rctADef=this.parent.spcs[this.rctA];this.rctBDef=this.parent.spcs[this.rctB];this.activeE=1E3*b.activeE/N;if(this.rctA&&!this.rctADef)return console.log("reactant a "+this.rctA+" doesn't exist");if(this.rctB&&!this.rctBDef)return console.log("reactant b "+this.rctB+" doesn't exist");this.prods=this.reformatProds(b.prods);this.prodCount=
this.countProds(this.prods);this.sRxn298=this.calcSRxn([new ReactionComponent(this.rctA,1),new ReactionComponent(this.rctB,1)],this.prods,this.parent.spcs)};
ReactionHandlerEmergent.Reaction.prototype={copy:function(){return new this.parent.Reaction(this.attrs)},doubleProds:function(){for(var b=0;b<this.prods.length;b++)this.prods[b].count*=2;this.prodCount*=2;return this},calcSRxn:function(b,d,e){for(var f=0,h=0;h<d.length;h++)f+=e[d[h].spcName].sF298*d[h].count;for(h=0;h<b.length;h++)f-=e[b[h].spcName].sF298*b[h].count;return f},increaseProd:function(b,d){for(var e=!1,f=0;f<this.prods.length;f++){var h=this.prods[f];if(h.spcName==b){h.count+=d;e=!0;
break}}e||this.prods.push(new ReactionComponent(b,d));this.prodCount+=d;return this},reformatProds:function(b){var d=[],e;for(e in b)d.push(new ReactionComponent(e,b[e]));return d},countProds:function(b){for(var d=0,e=0;e<b.length;e++)d+=b[e].count;return d},remove:function(){this.parent.removeRxn(this.handle)}};function ReactionHandlerNonEmergent(b,d,e,f,h,k){this.collide=b;this.dotManager=d;this.tConst=f;this.rxns=e;this.chanceMap=this.spcs=void 0;this.activeRxns=h;this.pausedRxns=k}
_.extend(ReactionHandlerNonEmergent.prototype,ReactionFuncs,{setSpcs:function(b){this.spcs=b;this.chanceMap={};for(var d in this.rxns)this.chanceMap[d]={}},addReaction:function(b){var d=this;b.parent=this;var e=new ReactionHandlerNonEmergent.Reaction(b,this.rxns);this.activeRxns.push(e);addListenerOnce(curLevel,"update","initRxn"+e.handle,function(){e.init();d.readyHandlers(d.collide,d.rxns,e,d.chanceMap)},void 0)},disableRxn:function(b){this.removeRxn(b)},removeRxn:function(b){if(b=this.getRxn(this.activeRxns,
b)){b.inited||removeListener(curLevel,"update","initRxn"+b.handle);var d=b.pairs,e=this.chanceMap,f=this.rxns;b.removeListener();this.splicePairsFromRxns(d,f);this.splicePairsFromChanceMap(d,e);this.activeRxns.splice(this.activeRxns.indexOf(b),1);this.pausedRxns.push(b);this.readyHandlers(this.collide,this.rxns,b,this.chanceMap)}},rxnIsEnabled:function(b){return this.getRxn(this.activeRxns,b)?!0:!1},enableRxn:function(b){if(b=this.getRxn(this.pausedRxns,b))b.init(),this.pausedRxns.splice(this.pausedRxns.indexOf(b),
1),this.activeRxns.push(b),this.readyHandlers(this.collide,this.rxns,b,this.chanceMap)},splicePairsFromRxns:function(b,d){for(var e in d)for(var f=d[e],h=0;h<b.length;h++){var k=f.indexOf(b[h]);0<=k&&f.splice(k,1)}},splicePairsFromChanceMap:function(b,d){for(var e in d){var f=d[e],h;for(h in f)for(var k=f[h],l=0;l<b.length;l++)k.removePair(b[l])}},readyHandlers:function(b,d,e,f){for(var h=0;h<e.pairs.length;h++){var k=e.pairs[h].idStr;pairRxns=d[k];1==pairRxns.length?this.initSingleRxnPair(pairRxns[0],
k,b):1<pairRxns.length?this.initMultiRxnPair(pairRxns,k,b,f):0==pairRxns.length&&b.resetHandlerByIdStr(k)}},initSingleRxnPair:function(b,d,e){d=b.idStr;e.setHandlerByIdStr(d,new Listener(function(d,h,k,l,m){var n=b.rxn.wallGroupsMap[d.tag],p=n[b.queuePath];if(Math.random()<n[b.chancePath]){if(0<p.now)return this.react(d,h,b.prods)?(p.now--,!1):e.impactStd(d,h,k,l,m);this.canReact(d,h,b.prods)&&p.now--}return e.impactStd(d,h,k,l,m)},this))},initMultiRxnPair:function(b,d,e,f){e.setHandlerByIdStr(d,
new Listener(function(h,k,l,m,n){var p=f[d][h.tag],r=1/Math.max(1,p.total),s=Math.random();if(p.total<s)return e.impactStd(h,k,l,m,n);for(var t=0,u=0;u<b.length;u++){var p=b[u],w=p.rxn.wallGroupsMap[h.tag],t=t+r*w[p.chancePath];if(t>=s){r=w[p.queuePath];if(0<r.now)return this.react(h,k,p.prods)?(r.now--,!1):e.impactStd(h,k,l,m,n);this.canReact(h,k,p.prods)&&r.now--;return e.impactStd(h,k,l,m,n)}}},this))}});
ReactionHandlerNonEmergent.Reaction=function(b,d){this.parent=b.parent;this.chanceMap=this.parent.chanceMap;this.collide=this.parent.collide;this.handle=b.handle;this.enqueueListenerHandle=this.handle+"Enqueue";this.checkRxnSideCount(b.rcts);this.checkRxnSideCount(b.prods);this.allRxns=d;this.rctsNet=this.reformatSide(b.rcts);this.prodsNet=this.reformatSide(b.prods);this.sRxn298=this.calcSRxn298(this.rctsNet,this.prodsNet);this.pairs=[];this.preExpForward=b.preExpForward;this.activeEForward=1E3*b.activeEForward;
this.updateWalls();this.updateQueue=this.wrapUpdateQueue();this.listenerHandle=this.handle+"UpdateQueue";this.inited=!1};
ReactionHandlerNonEmergent.Reaction.prototype={init:function(){var b=this.chanceMap;this.inited=!0;addListener(curLevel,"data",this.listenerHandle,function(){this.updateWalls();for(var d=0;d<this.wallGroups.length;d++)this.updateQueue(this.wallGroups[d],b)},this);this.addCollisionPairs(this.collide,this.rctsNet,this.prodsNet,this.allRxns,this.chanceMap,window.dotManager,window.spcs);for(var d=0;d<this.wallGroups.length;d++)this.updateQueue(this.wallGroups[d],b)},getWallTemp:function(b){b=window.walls[b.wallHandle].data.temp;
var d=b.src();if(d.length)return d[d.length-1];b=b.listener();return b.func.apply(b.obj)},remove:function(){this.parent.removeRxn(this.handle)},removeListener:function(){removeListener(curLevel,"data",this.listenerHandle)},updateWalls:function(){var b=this.chanceMap;this.wallGroups=this.makeWallGroups(window.walls,this.wallGroups||[],this.rctsNet,this.prodsNet);this.wallGroupsMap={};for(var d=0;d<this.wallGroups.length;d++){var e=this.wallGroups[d].wallHandle;this.wallGroupsMap[e]=this.wallGroups[d];
for(var f in b)void 0===b[f][e]&&(b[f][e]=new ReactionHandlerNonEmergent.WallChanceObj)}},addCollisionPairs:function(b,d,e,f,h,k,l){k=this.countRxnSide(d);var m=this.countRxnSide(e);d=this.copyRxnSide(d);e=this.copyRxnSide(e);2==k&&2==m?this.addTwoTwo(l,f,b,d,e,h):1==k&&1==m?this.addOneOne(l,f,b,d,e,h):(1==k&&2==m||2==k&&1==m)&&this.addOneTwo(l,f,b,d,e,h)},addOneOne:function(b,d,e,f,h,k){var l,m;for(m in b)k=this.copyRxnSide(f),l=this.copyRxnSide(h),this.addToRxnSide(k,m,1),this.addToRxnSide(l,m,
1),this.addTwoTwo(b,d,e,k,l)},addOneTwo:function(b,d,e,f,h,k){var l=!1;1==this.countRxnSide(h)&&(l=!0);var m=!l?"chanceForward":"chanceBackward",n=!l?"chanceBackward":"chanceForward",p=!l?"rctQueue":"prodQueue",r=!l?"prodQueue":"rctQueue";k=!l?this.copyRxnSide(f):this.copyRxnSide(h);f=!l?this.copyRxnSide(h):this.copyRxnSide(f);for(var s in b)h=this.copyRxnSide(k),l=this.copyRxnSide(f),this.copyRxnSide(f),this.copyRxnSide(k),this.addToRxnSide(h,s,1),this.addToRxnSide(l,s,1),h=new ReactionHandlerNonEmergent.ReactivePair(this,
e,h,l,m,p),this.pushPair(e,d,b,h);s=new ReactionHandlerNonEmergent.ReactivePair(this,e,this.copyRxnSide(f),this.copyRxnSide(k),n,r);this.pushPair(e,d,b,s)},addTwoTwo:function(b,d,e,f,h,k){var l=new ReactionHandlerNonEmergent.ReactivePair(this,e,f,h,"chanceForward","rctQueue");f=new ReactionHandlerNonEmergent.ReactivePair(this,e,h,f,"chanceBackward","prodQueue");this.pushPair(e,d,b,l,k);this.pushPair(e,d,b,f,k)},pushPair:function(b,d,e,f){b=f.idStr;this.pairs.push(f);void 0==d[b]?d[b]=[f]:d[b].push(f)},
countRxnSide:function(b){for(var d=0,e=0;e<b.length;e++)d+=b[e].count;return d},addToRxnSide:function(b,d,e){for(var f=0;f<b.length;f++)if(b[f].spcName==d){b[f].count+=e;return}b.push(new ReactionComponent(d,e))},copyRxnSide:function(b){for(var d=[],e=0;e<b.length;e++)d.push(b[e].copy());return d},wrapUpdateQueue:function(){var b=this,d=this.preExpForward,e=this.activeEForward,f=this.sRxn298,h=this.calcHRxn298(this.rctsNet,this.prodsNet),k=Math.exp(-(h-298.15*f)/(8.314*298.15)),l=this.pairs;return function(f,
n){var p=f.temp[f.temp.length-1],r=f.rctQueue,s=f.prodQueue,t=r.init,u=r.now,w=s.init,x=s.now;f.chanceForward=b.moveAlongSigmoid(f.chanceForward,0!==u?0.2*u/(0<t?Math.sqrt(t):1):0);f.chanceBackward=b.moveAlongSigmoid(f.chanceBackward,0!==x?0.2*x/(0<w?Math.sqrt(w):1):0);f.rateScalar=0.999<f.chanceForward||0.999<f.chanceBackward?b.moveAlongSigmoid(f.rateScalar,-0.3):b.moveAlongSigmoid(f.rateScalar,0.3);t=k*Math.exp(-h/8.314*(1/p-1/298.15));p=f.rateScalar*d*Math.exp(-e/(8.314*p));t=p/t;p=Math.max(0,
Math.round(b.getNumInDir(p,b.rctsNet,f.moles,f.vol[f.vol.length-1])+Math.random()-0.5));t=Math.max(0,Math.round(b.getNumInDir(t,b.prodsNet,f.moles,f.vol[f.vol.length-1])+Math.random()-0.5));r.init=p;r.now=p;s.init=t;s.now=t;for(r=0;r<l.length;r++)s=l[r],n[s.idStr][f.wallHandle].updatePairChance(s,f[s.chancePath])}},avgLast:function(b,d){var e=0;d=Math.min(d,b.length);for(var f=b.length-d;f<b.length;f++)e+=b[f];return e/d},moveAlongSigmoid:function(b,d){return Math.min(Math.max(1E-4,1/(1+(1/b-1)*Math.exp(-d))),
0.9999)},getNumInDir:function(b,d,e,f){b=0.0010*N*b*dataInterval;for(var h=0;h<d.length;h++){var k=e[d[h].spcName];b*=Math.pow(k[k.length-1]/f,d[h].count)}return b},checkRxnSideCount:function(b){if(2<this.countRxnSide(b)||0>=this.countRxnSide(b))console.log("Bad number of products or reactions for non-emergent reaction"),console.log("Reaction will not work"),console.log(b)},calcHRxn298:function(b,d){for(var e=0,f=0;f<d.length;f++)e+=d[f].def.hF298*d[f].count;for(f=0;f<b.length;f++)e-=b[f].def.hF298*
b[f].count;return 1E3*e},makeWallGroups:function(b,d,e,f){for(var h=[],k=0;k<b.length;k++){var l=b[k];if(l.data.temp&&l.closed&&!l.isLiquid){var m=this.getWallGroup(d,l.handle);m?h.push(m):h.push(new ReactionHandlerNonEmergent.WallGroup(l,l.handle,e,f))}}return h},getWallGroup:function(b,d){for(var e=0;e<b.length;e++)if(b[e].wallHandle==d)return b[e]},makeQueues:function(b,d){for(var e={},f=0;f<b.length;f++)e[b[f].handle]=d[b[f].handle]?d[b[f].handle]:new ReactionHandlerNonEmergent.Queue;return e},
countRxnSide:function(b){for(var d=0,e=0;e<b.length;e++)d+=b[e].count;return d},flatten:function(b,d){for(var e=[],f=0;f<b.length;f++)e=e.concat(b[f].flatten(d));return e},reformatSide:function(b){for(var d=[],e=0;e<b.length;e++)d.push(new ReactionComponent(b[e].spcName,b[e].count));return d},calcSRxn298:function(b,d){for(var e=0,f=0;f<d.length;f++)e+=d[f].def.sF298*d[f].count;for(f=0;f<b.length;f++)e-=b[f].def.sF298*b[f].count;return e}};
ReactionHandlerNonEmergent.WallGroup=function(b,d,e,f){this.temp=b.getDataSrc("temp");this.vol=b.getDataSrc("vol");this.moles={};this.wallHandle=b.handle;this.chanceBackward=this.chanceForward=0.1;this.rateScalar=0.9999;this.rctQueue=new ReactionHandlerNonEmergent.Queue;this.prodQueue=new ReactionHandlerNonEmergent.Queue;this.populateMoles(b,d,this.moles,e);this.populateMoles(b,d,this.moles,f)};
ReactionHandlerNonEmergent.WallGroup.prototype={populateMoles:function(b,d,e,f){for(var h=0;h<f.length;h++){var k=b.recordMoles({tag:d,spcName:f[h].spcName});k.recordVal();e[f[h].spcName]=k.src()}}};ReactionHandlerNonEmergent.Queue=function(){this.now=this.init=0};ReactionHandlerNonEmergent.ReactivePair=function(b,d,e,f,h,k){this.rxn=b;this.rcts=e;this.prods=f;this.chancePath=h;this.queuePath=k;b=b.flatten(this.rcts,"def");this.idStr=d.getIdStr(b[0],b[1])};
ReactionHandlerNonEmergent.WallChanceObj=function(b){this.total=0;this.pairChances=[]};
ReactionHandlerNonEmergent.WallChanceObj.prototype={updatePairChance:function(b,d){for(var e=!1,f=0;f<this.pairChances.length;f++)this.pairChances[f].pair==b&&(this.pairChances[f].chance=d,e=!0);e||this.pairChances.push(new ReactionHandlerNonEmergent.PairChances(b,d));this.updateTotal()},removePair:function(b){for(var d=this.pairChances.length-1;0<=d;d--)this.pairChances[d].pair==b&&this.pairChances.splice(d,1);this.updateTotal()},updateTotal:function(){for(var b=this.total=0;b<this.pairChances.length;b++)this.total+=
this.pairChances[b].chance}};ReactionHandlerNonEmergent.PairChances=function(b,d){this.pair=b;this.chance=d};function CollideHandler(b){this.tConst=tConst;this.rxns={};this.dotManager=b;this.activeRxns=[];this.pausedRxns=[];this.numHits=0;this.hitsPerTurn=[];this.checkStore=this.check;this.breakUpStore=this.breakUp;this.recordingHits=!1;this.recordCleanUpListenerName="recordCollideHits";this.rxnHandlerEmergent=new ReactionHandlerEmergent(this,this.dotManager,this.rxns,this.tConst,this.activeRxns,this.pausedRxns);this.rxnHandlerNonEmergent=new ReactionHandlerNonEmergent(this,this.dotManager,this.rxns,this.tConst,
this.activeRxns,this.pausedRxns)}
_.extend(CollideHandler.prototype,toInherit.gridder,{setSpcs:function(b){this.spcs=b;this.setDefaultHandler({func:this.impactStd,obj:this},this.spcs);this.rxnHandlerEmergent.spcs=b;this.rxnHandlerNonEmergent.setSpcs(b);this.setup(this.spcs)},setDefaultHandler:function(b,d){for(var e=countAttrs(d),f=0;f<e;f++)for(var h=f;h<e;h++)this[f+"-"+h]=b,this.rxns[f+"-"+h]=[]},getIdStr:function(b,d){return b.idNum<d.idNum?b.idNum+"-"+d.idNum:d.idNum+"-"+b.idNum},setHandler:function(b,d,e){var f=this.getIdStr(this.spcs[b],
this.spcs[d]);this.isIdStr(f)?this[f]=e:console.log("bad spc names "+b+" "+d)},setHandlerByIdStr:function(b,d){this.isIdStr(b)?this[b]=d:console.log("bad id string "+b)},resetHandlerByIdStr:function(b){this.isIdStr(b)?(this.rxns[b]=[],this.setHandlerByIdStr(b,new Listener(this.impactStd,this))):console.log("Bad id str "+b)},isIdStr:function(b){return/^[0-9]+\-[0-9]+$/.test(b)},recordCollisions:function(){this.check=this.checkRecord;this.breakUp=this.breakUpRecord;this.recordingCollisions=!0;addListener(curLevel,
"sectionCleanUp",this.recordCleanUpListenerName,this.recordCollisionsStop,this)},recordCollisionsStop:function(){this.check=this.checkStore;this.breakUp=this.breakUpStore;this.recordingCollisions=!1;removeListener(curLevel,"sectionCleanUp",this.recordCleanUpListenerName)},check:function(){for(var b=this.gridSize,d=this.xSpan,e=this.ySpan,f=this.grid=this.makeGrid(),h=dotManager.lists.ALLDOTS,k=h.length-1;-1<k;k--){var l=h[k],m=Math.floor(l.x/b),n=Math.floor(l.y/b),p=!0,r=Math.max(m-1,0),s=Math.min(m+
1,d)+1;a:for(;r<s;r++)for(var t=Math.max(n-1,0),u=Math.min(n+1,e)+1;t<u;t++)for(var w=f[r][t].length-1;0<=w;w--){var x=f[r][t][w],y=l.x-x.x,z=l.y-x.y;if(y*y+z*z<=(l.r+x.r)*(l.r+x.r)&&(y=this[Math.min(l.idNum,x.idNum)+"-"+Math.max(l.idNum,x.idNum)],z=V(x.x-l.x,x.y-l.y).UV(),!1===y.func.apply(y.obj,[l,x,z,l.v.dotProd(z),x.v.dotProd(z)]))){p=!1;f[r][t].splice(w,1);break a}}0<=m&&0<=n&&m<this.numCols&&n<this.numRows?p&&f[m][n].push(l):(returnEscapist(l),console.log("ball out of bounds"))}},checkRecord:function(){var b=
this.gridSize,d=this.xSpan,e=this.ySpan,f=this.grid=this.makeGrid();this.hitsPerTurn.push(this.numHits);this.numHits=0;for(var h=dotManager.lists.ALLDOTS,k=h.length-1;-1<k;k--){var l=h[k],m=Math.floor(l.x/b),n=Math.floor(l.y/b),p=!0,r=Math.max(m-1,0),s=Math.min(m+1,d)+1;a:for(;r<s;r++)for(var t=Math.max(n-1,0),u=Math.min(n+1,e)+1;t<u;t++)for(var w=f[r][t].length-1;-1<w;w--){var x=f[r][t][w],y=l.x-x.x,z=l.y-x.y;if(y*y+z*z<=(l.r+x.r)*(l.r+x.r)&&(y=this[Math.min(l.idNum,x.idNum)+"-"+Math.max(l.idNum,
x.idNum)],z=V(x.x-l.x,x.y-l.y).UV(),!1===y.func.apply(y.obj,[l,x,z,l.v.dotProd(z),x.v.dotProd(z)]))){p=!1;f[r][t].splice(w,1);break a}}0<=m&&0<=n&&m<this.numCols&&n<this.numRows?p&&f[m][n].push(l):(returnEscapist(l),console.log("ball out of bounds"))}},impactStd:function(b,d,e,f,h){var k=(f*(b.m-d.m)+2*d.m*h)/(b.m+d.m),l=(h*(d.m-b.m)+2*b.m*f)/(b.m+d.m),m=b.temp(),n=d.temp();b.v.dx+=e.dx*(k-f);b.v.dy+=e.dy*(k-f);d.v.dx+=e.dx*(l-h);d.v.dy+=e.dy*(l-h);f=b.temp();h=d.temp();k=m+(f-m)*b.cvKinetic/b.cv;
l=n+(h-n)*d.cvKinetic/d.cv;b.v.mult(Math.sqrt(k/f));b.internalPotential*=k/m;d.v.mult(Math.sqrt(l/h));d.internalPotential*=l/n;this.breakUp(b,d,e);return!0},breakUp:function(b,d,e){var f=b.r+d.r,h=d.x-e.dx*f,k=d.y-e.dy*f;d.x=b.x+e.dx*f;d.y=b.y+e.dy*f;b.x=h;b.y=k},breakUpRecord:function(b,d,e){this.numHits++;var f=b.r+d.r,h=d.x-e.dx*f,k=d.y-e.dy*f;d.x=b.x+e.dx*f;d.y=b.y+e.dy*f;b.x=h;b.y=k},setup:function(b){this.gridSize=Math.max(5,2*this.getMaxR(b));this.numCols=Math.ceil(myCanvas.width/this.gridSize+
1);this.numRows=Math.ceil(myCanvas.height/this.gridSize+1);this.xSpan=Math.floor(myCanvas.width/this.gridSize);this.ySpan=Math.floor(myCanvas.height/this.gridSize)},getMaxR:function(b){var d=0,e;for(e in b)d=Math.max(d,b[e].r);return d}});function DotMigrator(b){this.numCols=this.numRows=100}
DotMigrator.prototype={migrateDots:function(b,d,e,f,h){if(!e||!h)console.log("One or more of the order types wasn't sent to the dot migrator"),console.trace(),console.log(e),console.log(h);var k=document.getElementById("myCanvas").width,l=document.getElementById("myCanvas").height,k=k/this.numCols,l=l/this.numRows,m=this.spliceOpenWalls(window.walls),n=_.sortBy(m,function(b){return b.handle});d=_.sortBy(d,function(b){return b});f=_.sortBy(f,function(b){return b});m=this.makeModifiedMap(n,"contract",
0.12345,k,l);n=this.makeModifiedMap(n,"expand",0.12345,k,l);f=this.makeBooleanMap(n,f,h);d=this.makeBooleanMap(m,d,e);this.subtractBooleanMap(d,f);d=this.mapToCoordList(d);if(!d.length)return!1;e=this.numCols;h=this.numRows;for(m=0;m<b.length;m++)f[Math.floor((b[m].x+0.12345)/k)][Math.floor((b[m].y+0.12345)/l)]&&this.migrateDot(b[m],d,0.12345,e,h,k,l)},spliceOpenWalls:function(b){for(var d=[],e=0;e<b.length;e++)b[e].closed&&d.push(b[e]);return d},mapToCoordList:function(b){for(var d=[],e=0;e<b.length;e++)for(var f=
0;f<b[0].length;f++)b[e][f]&&d.push(P(e,f));return d},migrateDot:function(b,d,e,f,h,k,l){d=d[Math.floor(Math.random()*d.length)];b.x=e+(d.x+Math.random())*k;b.y=e+(d.y+Math.random())*l},makeBooleanMap:function(b,d,e){for(var f=this.makeGridBoolean(this.numCols,this.numRows),h=0,k=b.length;h<k;h++)for(var l=0,m=b[0].length;l<m;l++)f[h][l]=this.listsOverlap(d,b[h][l],e);return f},listsOverlap:function(b,d,e){if("and"==e){for(e=0;e<b.length;e++)if(0>d.indexOf(b[e]))return!1;return!0}if("only"==e){if(b.length!=
d.length)return!1;for(e=0;e<b.length;e++)if(b[e]!=d[e])return!1;return!0}if("or"==e){for(e=0;e<b.length;e++)if(-1<d.indexOf(b[e]))return!0;return!1}},subtractBooleanMap:function(b,d){for(var e=0,f=b.length;e<f;e++)for(var h=0,k=b[0].length;h<k;h++)b[e][h]=b[e][h]&&!d[e][h]},makeModifiedMap:function(b,d,e,f,h){for(var k=this.makeGrid(this.numCols,this.numRows),l=[],m=0;m<b.length;m++){var n=new DotMigrator.WallMap(b[m],this.numCols,this.numRows,e,f,h);n[d]();l.push(n)}for(m=0;m<this.numCols;m++)for(b=
0;b<this.numRows;b++)for(d=0;d<l.length;d++)l[d].grid[m][b]&&k[m][b].push(l[d].wall.handle);return k},makeGrid:function(b,d){for(var e=Array(b),f=0;f<b;f++){for(var h=Array(d),k=0;k<d;k++)h[k]=[];e[f]=h}return e},makeGridBoolean:function(b,d){for(var e=Array(b),f=0;f<b;f++){for(var h=Array(d),k=0;k<d;k++)h[k]=!1;e[f]=h}return e}};DotMigrator.WallMap=function(b,d,e,f,h,k){this.wall=b;this.grid=this.makeGrid(d,e);this.mapWallOntoGrid(b,this.grid,f,h,k)};
DotMigrator.WallMap.prototype={makeGrid:function(b,d){for(var e=Array(b),f=0;f<b;f++){for(var h=Array(d),k=0;k<d;k++)h[k]=!1;e[f]=h}return e},mapWallOntoGrid:function(b,d,e,f,h){for(var k,l,m=0;m<d.length;m++){var n=e+h*(m+0.5),p=[];k=0;for(l=b.length-1;k<b.length;k++)(b[k].y<n&&b[l].y>=n||b[l].y<n&&b[k].y>=n)&&p.push(b[k].x+(n-b[k].y)/(b[l].y-b[k].y)*(b[l].x-b[k].x)),l=k;for(k=0;k<p.length-1;)p[k]>p[k+1]?(l=p[k],p[k]=p[k+1],p[k+1]=l,k&&k--):k++;for(k=0;k<p.length;k+=2)for(l=p[k];l<p[k+1];l+=5)xGridIdx=
Math.floor((l-e)/f),d[xGridIdx][m]=!0}},expand:function(){for(var b=this.grid,d=this.makeGrid(b.length,b[0].length),e=0;e<b.length;e++)for(var f=0;f<b[0].length;f++)if(b[e][f]||b[e][f+1]||b[e-1]&&b[e-1][f]||b[e+1]&&b[e+1][f])d[e][f]=!0;this.grid=d},contract:function(){for(var b=this.grid,d=this.makeGrid(b.length,b[0].length),e=0;e<b.length;e++)for(var f=0;f<b[0].length;f++)if(b[e][f]&&b[e][f+1]&&(b[e-1]?b[e-1][f]:1)&&(b[e+1]?b[e+1][f]:1))d[e][f]=!0;this.grid=d}};
DotMigrator.MigratingDot=function(b,d,e){this.dot=b;this.allowedWallHandles=d;this.disallowedWallHandles=e};function CanvasManager(){this.canvases=[]}
CanvasManager.prototype={draw:function(){for(var b=0;b<this.canvases.length;b++){this.canvases[b].clear();for(var d=this.canvases[b],e=this.canvases[b].listeners,f=0;f<e.length;f++)e[f].cb.apply(e[f].obj,[d.ctx])}},addCanvas:function(b,d,e,f){b=new CanvasManager.Canvas(b,d,e,f);this.canvases.push(b)},addListener:function(b,d,e,f,h){var k=this.getByHandle(this.canvases,b);if(k){b=new CanvasManager.Canvas.Listener(d,h,e,f);if(d=this.getByHandle(k.listeners,d))k.listeners.splice(k.listeners.indexOf(d,
1)),console.log("overwriting listener "+d.handle);this.spliceByZIndex(k.listeners,b)}else console.log("Bad canvas handle "+b)},removeCanvas:function(b){for(var d=0;d<this.canvases.length;d++)this.canvases[d].handle==b&&this.canvases.splice(d,1)},removeListener:function(b,d){var e=this.getByHandle(this.canvases,b);if(e){var f=this.getByHandle(e.listeners,d);f&&e.listeners.splice(e.listeners.indexOf(f),1)}},spliceByZIndex:function(b,d){for(var e=b.length,f=0;f<b.length;f++)if(b[0].zIndex>=d.zIndex){e=
f;break}b.splice(e,0,d)},getByHandle:function(b,d){for(var e=0;e<b.length;e++)if(b[e].handle==d)return b[e]}};CanvasManager.Canvas=function(b,d,e,f){this.handle=b;this.htmlElem=d;this.ctx=e;this.listeners=[];this.bgCol=f};CanvasManager.Canvas.prototype={clear:function(){var b=this.htmlElem.width,d=this.htmlElem.height;this.ctx.clearRect(0,0,b,d);this.ctx.fillStyle=this.bgCol.hex;this.ctx.fillRect(0,0,b,d)}};
CanvasManager.Canvas.Listener=function(b,d,e,f){this.handle=b;this.zIndex=d;this.cb=e;this.obj=f};function Attractor(){this.eDebt=0;this.k1=0.5;this.k2=0.07}
_.extend(Attractor.prototype,toInherit.gridder,{setup:function(){this.gridSize=30;this.numCols=Math.ceil(myCanvas.width/this.gridSize+1);this.numRows=Math.ceil(myCanvas.height/this.gridSize+1);this.xSpan=Math.floor(myCanvas.width/this.gridSize);this.ySpan=Math.floor(myCanvas.height/this.gridSize);this.dotManager=dotManager;return this},attract:function(){for(var b=this.makeGrid(),d=this.gridSize,e=this.xSpan,f=this.ySpan,h=dotMagnager.lists.ALLDOTS,k=0;k<h.length;k++){var l=h[k];if(0<l.attractStr){l.tempLast=
l.temp();for(var m=Math.floor(l.x/d),n=Math.floor(l.y/d),p=Math.max(m-1,0);p<=Math.min(m+1,e);p++)for(var r=Math.max(n-1,0);r<=Math.min(n+1,f);r++)for(var s=b[p][r].length-1;-1<s;s-=1){var t=b[p][r][s],u=l.x-t.x,w=l.y-t.y,x=Math.sqrt(u*u+w*w),y=V(u,w);y.dx/=x;y.dy/=x;var x=Math.max(0,x-l.r-t.r)*pxToE,u=l.attractStrs[t.idNum],w=(l.attractRad+t.attractRad)/2,z=w*w*w*w*w,F=(0.97*w+x)*(0.97*w+x)*(0.97*w+x)*(0.97*w+x)*(0.97*w+x),C=-u*(5*z/(F*(0.97*w+x))-8*z*w*w*w/(F*(0.97*w+x)*(0.97*w+x)*(0.97*w+x)*(0.97*
w+x))),A=y.copy().mult(C/l.m),y=y.mult(-C/t.m);l.v.add(A);t.v.add(y);x=-u*(z*w*w*w/(F*(0.97*w+x)*(0.97*w+x)*(0.97*w+x))-z/F);l.peCur+=x;t.peCur+=x}b[m][n].push(l)}}this.adjustE()},adjustE:function(){for(var b=dotManager.lists.ALLDOTS,d=0;d<b.length;d++){var e=b[d];if(0<e.attractStr){var f=e.tempLast+e.peCur-e.peLast;0>f&&(this.eDebt+=10-f,f=10);e.setTemp(f);e.peLast=e.peCur;e.peCur=0}}0<this.eDebt&&this.exactDebt()},exactDebt:function(){for(var b=0.3*dataHandler.avgTemp(),d=dotManager.lists.ALLDOTS,
e=0;e<d.length;e++){var f=d[e],h=f.temp();if(h>b){var k=Math.min(Math.min(h-b,5),this.eDebt);this.eDebt-=k;f.setTemp(h-k);if(0>=this.eDebt)break}}},zeroAllEnergies:function(){for(var b=dotManager.lists.ALLDOTS,d=0;d<b.length;d++)b[d].peLast=0,b[d].keLast=0,b[d].tempLast=0},assignELastAll:function(){for(var b=this.makeGrid(),d=this.gridSize,e=this.xSpan,f=this.ySpan,h=dotManager.lists.ALLDOTS,k=0;k<h.length;k++){var l=h[k];if(0<l.attrStr){l.tempLast=l.temp();for(var m=Math.floor(l.x/d),n=Math.floor(l.y/
d),p=Math.max(m-1,0);p<=Math.min(m+1,e);p++)for(var r=Math.max(n-1,0);r<=Math.min(n+1,f);r++)for(var s=b[p][r].length-1;-1<s;s-=1){var t=b[p][r][s],u=pxToE*V(l.x-t.x,l.y-t.y).mag(),u=Math.max(0,u-l.r-t.r)*pxToE,w=(l.attractRad+t.attractRad)/2,x=w*w*w*w*w,y=(0.97*w+u)*(0.97*w+u)*(0.97*w+u)*(0.97*w+u)*(0.97*w+u),u=-l.attractStrs[t.idNum]*(x*w*w*w/(y*(0.97*w+u)*(0.97*w+u)*(0.97*w+u))-x/y);l.peLast+=u;t.peLast+=u}b[m][n].push(l)}}}});function DataHandler(){this.tConst=tConst}
DataHandler.prototype={temp:function(b){return this.KEAvg(b)*this.tConst},tempFunc:function(b){var d=this;return function(){return d.KEAvg(b)*d.tConst}},countFunc:function(b){var d=this;return function(){return d.count(b)}},count:function(b){return dotManager.get(b).length},RMS:function(b){var d=0;b=dotManager.get(b);for(var e=0;e<b.length;e++)d+=b[e].v.magSqr();return pxToMS*Math.sqrt(d/b.length)},velocities:function(b){b=dotManager.get(b);for(var d=Array(b.length),e=0;e<b.length;e++)d[e]=b[e].v.mag();
return d},velocityAvg:function(b){vList=this.velocities(b);for(var d=b=0;d<vList.length;d++)b+=vList[d];return b/vList.length},KEAvg:function(b){var d=0;b=dotManager.get(b);for(var e=0;e<b.length;e++)d+=b[e].KE();return d/b.length},volume:function(b){return void 0===b?walls.totalVolume():walls.wallVolume(b)},volumeFunc:function(b){var d=this;return function(){return d.volume(b)}}};function WallHandler(b){var d=b?Array(b.pts.length):[];_.extend(d,WallMethods.main,WallMethods.collideMethods);d.defaultCol=Col(255,255,255);b&&(d.assemble(b),b.handles.length!=b.pts.length&&console.log("NAME YOUR WALLS"),b.handlers&&d.doInitHandlers(b.handlers));d.setup();return d}
WallMethods={main:{assemble:function(b){this.removed=!1;var d=b.pts,e=b.handles;this.numWalls=d.length;this.qArrowFill=Col(200,0,0);this.qArrowFillFinal=Col(100,0,0);this.qArrowStroke=Col(255,255,255);var f=defaultTo([],b.bounds),h=defaultTo([],b.vols),k=defaultTo([],b.shows),l=defaultTo([],b.records);b=defaultTo([],b.temps);for(var m=0;m<d.length;m++)this.setWallVals(m,d[m],e[m],f[m],h[m],k[m],l[m],b[m])},setDefaultReadout:function(b){this.defaultReadout=b;return this},unsetDefaultReadout:function(){this.defaultReadout=
void 0;return this},setup:function(){this.gridDim=20;this.xSpan=Math.floor(myCanvas.width/this.gridDim);this.ySpan=Math.floor(myCanvas.height/this.gridDim);this.numCols=Math.ceil(myCanvas.width/this.gridDim);this.numRows=Math.ceil(myCanvas.height/this.gridDim);for(var b=0;b<this.length;b++)this.setupWall(b)},setAllHandler:function(b){for(var d=0;d<this.length;d++)this.setWallHandler(d,b)},pareData:function(){for(var b=0;b<this.length;b++)this[b].pareData()},setWallHandler:function(b,d){var e=this.idxByInfo(b);
/isothermal/i.test(d)&&this[e].isothermalInit();for(var f=0;f<this[e].length;f++)"string"==typeof d?this[e].handlers[f]=new Listener(this[d],this):"object"==typeof d&&(this[e].handlers[f]=d)},setSubWallHandler:function(b,d,e){b=this.idxByInfo(b);"string"==typeof e?(this[b][d].isothermal=/isothermal/i.test(e),this[b].handlers[d]=new Listener(this[e],this)):"object"==typeof e&&(this[b].handlers[d]=e)},getSubWallHandler:function(b,d){return this[this.idxByInfo(b)].handlers[d]},setupWall:function(b){this[b].wallUVs=
this.getWallUV(b);this[b].wallPerpUVs=this.getPerpUVs(b);this[b].wallGrids=this.scatterPts(b)},scatterPts:function(b){var d=this.makeBlankGrid(),e=this[b];e.scatter=Array(e.length-1);var f=e.wallUVs,h=this.gridDim;for(b=0;b<e.scatter.length;b++)for(var k=f[b],l=e[b].distTo(e[b+1]),l=Math.ceil(l/h),m=e[b],n=0;n<l;n++){var p=Math.floor((m.x+k.dx*h*n)/h),r=Math.floor((m.y+k.dy*h*n)/h);(-1!=p||-1!=r)&&d[p][r].push(b)}return d},makeBlankGrid:function(){for(var b=Array(this.numCols+1),d=0;d<this.numCols+
1;d++){for(var e=Array(this.numRows+1),f=0;f<this.numRows+1;f++)e[f]=[];b[d]=e}return b},setWallVals:function(b,d,e,f,h,k,l,m,n,p,r,s){f={min:P(0,f&&f.yMin?f.yMin:30),max:P(0,f&&f.yMax?f.yMax:435)};this[b]=d;_.extend(this[b],WallMethods.wall,WallMethods.wallDataHandler);this[b].handle=e;this[b].hitMode="didHitStd";this[b].vs=this.makeWallVs(d);this[b].bounds=f;this[b].dotManager=p||dotManager;h&&this[b].setVol(h);this[b].col=defaultTo(this.defaultCol,n);this[b].show=defaultTo(!0,k);!1!==r?(this.closeWall(this[b]),
this[b].closed=!0):this[b].closed=!1;this[b].ptsInit=this.copyWallPts(this[b]);this[b].g=g;this[b].pConst=pConst;this[b].liquids={};this[b].data={};this[b].q=0;this[b].hitThreshold=15;this[b].handlers=[];this[b].pIntLen=35;this[b].surfAreaAdj={};this[b].eToAdd=0;this[b].isLiquid=!1;this[b].isothermal=!1;this[b].removed=!1;this[b].tSet=m;this[b].massChunks={};this[b].forceInternal=0;this[b].pLastRecord=turn;this[b].containedWalls=[];this[b].isothermalRate=defaultTo(1,s);this[b].boundMaxHandlers=[];
this[b].boundMinHandlers=[];this[b].mass=0;this[b].Cp=this[b].setupCp();this[b].parent=this;makeListenerHolder(this[b],"cleanUp");this[e]=this[b];(l=defaultTo(!0,l))&&this[b].recordDefaults()},addWall:function(b){this.numWalls++;var d=this.length;this.setWallVals(d,b.pts,b.handle,b.bounds,b.vol,b.show,b.record,b.temp,b.col,b.dotManager,b.close,b.isothermalRate);this.setupWall(d);this.setWallHandler(d,b.handler);b.border&&this[d].addBorder(b.border);b.hitMode&&this[d].setHitMode(b.hitMode);return this[d]},
makeWallVs:function(b){for(var d=[],e=0;e<b.length;e++)d.push(V(0,0));d.push(d[0]);return d},setPtsInit:function(){for(var b=0;b<this.length;b++)this[b].ptsInit=this.copyWallPts(this[b])},copyWallPts:function(b){for(var d=b.length,e=Array(d),f=0;f<d;f++)e[f]=b[f].copy();return e},idxByHandle:function(b){for(var d=0;d<this.length;d++)if(b==this[d].handle)return d;console.log("Failed to get wall idx by handle\nHandle:"+b)},idxByInfo:function(b){return"number"!=typeof b?this.idxByHandle(b):b},remove:function(){for(var b=
this.length-1;0<=b;b-=1)this.removeWall(b);this.removed=!0;emptyListener(curLevel,"wallMove")},removeWall:function(b){this[b]&&(this.numWalls-=1,this[b].recordAllStop(),this[b].cleanUp(),this[b].removeBorder(),this[b].removed=!0,b=this.idxByInfo(b),this[this[b].handle]=void 0,this.splice(b,1),this.removeHandlers(b))},removeHandlers:function(b){for(var d in this)-1!=d.indexOf(b+"-")&&(this[d]=void 0)},closeWall:function(b){b.push(P(b[0].x,b[0].y))},getPerpUVs:function(b){b=this[b].wallUVs;for(var d=
Array(b.length),e=0;e<b.length;e++){var f=b[e];d[e]=V(-f.dy,f.dx)}return d},getWallUV:function(b){for(var d=this[b].length-1,e=Array(d),f=0;f<d;f++){var h=this[b][f],k=this[b][f+1];e[f]=V(k.x-h.x,k.y-h.y).UV()}return e},check:function(){for(var b=this.gridDim,d=this.xSpan,e=this.ySpan,f=dotManager.lists.ALLDOTS,h=0;h<f.length;h++){var k=f[h],l=[],m=[],n=Math.floor(k.x/b),p=Math.floor(k.y/b),r=Math.max(n-1,0),n=Math.min(n+1,d)+1;a:for(;r<n;r++)for(var s=Math.max(p-1,0),t=Math.min(p+1,e)+1;s<t;s++)for(var u=
0;u<this.length;u++)for(var w=this[u].wallGrids[r][s],x=0;x<w.length;x++){var y=w[x];if(!1===this.haveChecked(u,y,l,m)){if(!0===this[u].checkWallHit(k,y))break a;l.push(u);m.push(y)}}}},haveChecked:function(b,d,e,f){for(var h=0;h<e.length;h++)if(e[h]==b&&f[h]==d)return!0;return!1},getWallsByHandles:function(b){for(var d=[],e=0;e<b.length;e++){var f=this[b[e]];f?d.push(f):console.log("Bad wall handle "+b[e])}return d},wallVolume:function(b){return this.area(this[b].slice(0,this[b].length-1))*vConst},
area:function(b){var d=0,e=this.isConvex(b);if(e.isConvex)return this.areaConvex(b);3<b.length&&(b=this.splitConcave(b,e.multiplier),d+=this.area(b[0]),d+=this.area(b[1]));return d},isConvex:function(b){for(var d=function(b,d){this.isConvex=b;this.multiplier=d},e=this.getMult(b),f=1;f<b.length-1;f++){var h=this.abcs(b,f),h=this.angleBetweenPts(h.a,h.b,h.c,e);if(h>Math.PI)return new d(!1,e)}h=this.angleBetweenPts(b[b.length-2],b[b.length-1],b[0],e);h=this.angleBetweenPts(b[b.length-1],b[0],b[1],e);
return h>Math.PI?new d(!1,e):new d(!0,e)},getMult:function(b){var d=Math.PI*(b.length-2),e=this.getAreaUVs(b),f=this.getIntAngles(b,e,1);b=this.getIntAngles(b,e,-1);if(round(f,2)==round(d,2))return 1;if(round(b,2)==round(d,2))return-1},getAreaUVs:function(b){for(var d=Array(b.length),e=0;e<b.length-1;e++){var f=b[e],h=b[e+1];d[e]=f.VTo(h).UV()}f=b[b.length-1];h=b[0];d[d.length]=f.VTo(h).UV();return d},getIntAngles:function(b,d,e){d=0;for(var f=1;f<b.length-1;f++)d+=this.angleBetweenPts(b[f-1],b[f],
b[f+1],e);d+=this.angleBetweenPts(b[b.length-2],b[b.length-1],b[0],e);return d+=this.angleBetweenPts(b[b.length-1],b[0],b[1],e)},splitConcave:function(b,d){for(var e=Array(b.length+2),f=0;f<b.length;f++)e[f]=b[f];e[e.length-2]=b[0];e[e.length-1]=b[1];for(f=1;f<e.length-1;f++){var h=this.abcs(e,f);if(this.angleBetweenPts(h.a,h.b,h.c,d)>Math.PI)return f==b.length&&(f=0),this.splitAt(e.slice(0,e.length-2),f,d)}},splitAt:function(b,d,e){b=b.slice(d,b.length).concat(b.slice(0,d));e=b[0];for(d=2;d<b.length-
1;d++)if(!this.crossesWall(e,b[d],b))return e=b.slice(0,d+1),b=b.slice(0,1).concat(b.slice(d,b.length)),[e,b]},abcs:function(b,d){return{a:b[d-1],b:b[d],c:b[d+1]}},crossesWall:function(b,d,e){b.VTo(d);for(var f=1;f<e.length;f++){var h,k;f==e.length-1?(h=e[f],k=e[0]):(h=e[f],k=e[f+1]);if(this.linesCross(b,d,h,k))return!0}return!1},linesCross:function(b,d,e,f){var h=b.VTo(d),k=e.VTo(f),l=h.mag(),m=k.mag(),h=h.UV(),n=k.UV(),k=this.getDist(b,d,e,f,h,n,"p1");b=this.getDist(b,d,e,f,h.neg(),n.neg(),"p2");
k.dx=round(k.dx,5);k.dy=round(k.dy,5);b.dx=round(b.dx,5);b.dy=round(b.dy,5);l=round(l,5);m=round(m,5);return!(k.dx>=l||k.dy>=m||b.dx>=l||b.dy>=m)},getDist:function(b,d,e,f,h,k,l){"p1"!=l&&(b=d,e=f);if(0==h.dx&&0==k.dx)return new Vector(Infinity,Infinity);if(0==h.dx)return f=b.x-e.x,f=Math.abs(f/k.dx),h=e.copy().movePt(k.copy().mult(f)),new Vector(b.distTo(h),e.distTo(h));if(0==k.dx)return f=e.x-b.x,f=Math.abs(f/h.dx),h=b.copy().movePt(h.copy().mult(f)),new Vector(b.distTo(h),e.distTo(h));if(0==h.dy&&
0==k.dy)return new Vector(Infinity,Infinity);if(0==h.dy)return f=b.y-e.y,f=Math.abs(f/k.dy),h=e.copy().movePt(k.copy().mult(f)),new Vector(b.distTo(h),e.distTo(h));if(0==k.dy)return f=e.y-b.y,f=Math.abs(f/h.dy),h=b.copy().movePt(h.copy().mult(f)),new Vector(b.distTo(h),e.distTo(h));f=k.dx*h.dy/h.dx-k.dy;if(0==f)return new Vector(Infinity,Infinity);f=(e.y-b.y-h.dy*e.x/h.dx+b.x*h.dy/h.dx)/f;return new Vector((e.x+k.dx*f-b.x)/h.dx,f)},angleBetweenPts:function(b,d,e,f){var h=b.VTo(d).UV();b=h.copy().neg();
d=d.VTo(e).UV();f=h.copy().add(d).perp(1==f?"cw":"ccw");b=Math.atan2(b.dy,b.dx);d=Math.atan2(d.dy,d.dx);f=Math.atan2(f.dy,f.dx);return this.distBetweenAngles(b,f)+this.distBetweenAngles(f,d)},distBetweenAngles:function(b,d){0>b&&(b+=2*Math.PI);0>d&&(d+=2*Math.PI);var e=Math.max(b,d)-Math.min(b,d);return e>Math.PI?2*Math.PI-e:e},areaConvex:function(b){for(var d=0,e=b[0],f=2;f<b.length;f++)d+=e.area(b[f-1],b[f]);return d}}};WallMethods.DataObj=function(){this.srcVal=[];this.wallHandleVal=this.idArgsVal=this.typeVal=this.idVal=void 0;this.recordingVal=!1;this.recordStopVal=this.listenerVal=void 0;this.readoutVal};
WallMethods.DataObj.prototype={recordVal:function(){this.srcVal.push(this.listenerVal.func.apply(this.listenerVal.obj))},id:function(b){b&&(this.idVal=b);return this.idVal},listener:function(b){b&&(this.listenerVal=b);return this.listenerVal},type:function(b){b&&(this.typeVal=b);return this.typeVal},idArgs:function(b){b&&(this.idArgsVal=b);return this.idArgsVal},argsMatch:function(b){return objectsEqual(this.idArgsVal,b)},readout:function(b){b&&(this.readoutVal=b);return this.readoutVal},wallHandle:function(b){b&&
(this.wallHandleVal=b);return this.wallHandleVal},src:function(b){b&&(this.srcVal=b);return this.srcVal},recording:function(b){void 0!==b&&(this.recordingVal=b);return this.recordingVal},recordStop:function(b){b?this.recordStopVal=b:this.recordStopVal&&this.recordingVal&&this.recordStopVal()}};WallMethods.wall={reset:function(){for(var b=this.ptsInit,d=0;d<b.length;d++)this[d].x=b[d].x,this[d].y=b[d].y;for(b=this.forceInternal=0;b<this.vs.length;b++)this.vs[b].zero();this.parent.setupWall(this.parent.indexOf(this))},setVol:function(b){b=this.volToY(b);this[0].position({y:b});this[1].position({y:b})},volToY:function(b){var d=this[2].distTo(this[3]);return this[2].y-b/(vConst*d)},checkWallHit:function(b,d){var e=this.wallUVs[d],f=this.wallPerpUVs[d],h=new Vector(b.x+b.v.dx-f.dx*b.r-this[d].x,
b.y+b.v.dy-f.dy*b.r-this[d].y),h=-f.dotProd(h),k=-f.dotProd(b.v);return 0<=h&&h<=this.hitThreshold&&this.isBetween(b,d,e)?(this[this.hitMode](b,d,e,k,f),!0):!1},didHitStd:function(b,d,e,f,h){var k=this.handlers[d];k.func.apply(k.obj,[b,this,d,e,f,h])},isBetween:function(b,d,e){var f=new Point(this[d].x-e.dx*b.r,this[d].y-e.dy*b.r);d=new Point(this[d+1].x+e.dx*b.r,this[d+1].y+e.dy*b.r);f=new Vector(b.x-f.x,b.y-f.y);b=new Vector(b.x-d.x,b.y-d.y);return 0<=f.dotProd(e)&&0>=b.dotProd(e)},didHitArrowDV:function(b,
d,e,f,h){var k=b.v.copy(),l=this.handlers[d];l.func.apply(l.obj,[b,this,d,e,f,h]);d=P(b.x,b.y);e=b.v.copy();b=-h.dotProd(b.v);this.drawArrowV(d,k,e,f,b)},didHitArrowSpd:function(b,d,e,f,h){var k=b.v.copy(),l=this.handlers[d];l.func.apply(l.obj,[b,this,d,e,f,h]);d=P(b.x,b.y);e=b.v.copy();b=-h.dotProd(b.v);this.drawArrowSpd(d,k,e,f,b)},didHitGravity:function(b,d,e,f,h){var k=this.handlers[d];if(0!=e.dx)var l=b.y,m=b.v.dy;k.func.apply(k.obj,[b,this,d,e,f,h]);0!=e.dx&&(d=b.v.dy*b.v.dy+2*gInternal*(b.y-
l),0<=d?b.v.dy=0<b.v.dy?Math.sqrt(d):-Math.sqrt(d):(b.v.dy=-1E-7,b.y=(b.v.dy*b.v.dy-m*m)/(2*gInternal)+l))},drawArrowV:function(b,d,e,f,h){var k=Array(3);k[0]=b.copy().movePt(d.copy().mult(10).neg());k[1]=b.copy();k[2]=b.copy().movePt(e.copy().mult(10));d="drawArrow"+round(b.x,0)+round(b.y,0);new ArrowLine(d,k,Col(255,0,0),50,"main");b=b.copy().movePt(e.mult(15));f=(Math.abs(f)+Math.abs(h))*pxToMS;animText.newAnim({pos:b},{pos:b.copy().movePt({dy:-20}),col:curLevel.bgCol},{text:"deltaV = "+round(f,
1)+"m/s",time:3E3})},drawArrowSpd:function(b,d,e,f,h){f=Array(3);f[0]=b.copy().movePt(d.copy().mult(10).neg());f[1]=b.copy();f[2]=b.copy().movePt(e.copy().mult(10));d="drawArrow"+round(b.x,0)+round(b.y,0);new ArrowLine(d,f,Col(255,0,0),50,"main");b=b.copy().movePt(e.mult(15));e=0.1*e.mag()*pxToMS;animText.newAnim({pos:b},{pos:b.copy().movePt({dy:-20}),col:curLevel.bgCol},{text:"Speed = "+round(e,1)+"m/s",time:3E3})},changeSetPt:function(b,d,e){if(/isothermal/i.test(d))var f="cVIsothermal";else/adiabatic/i.test(d)&&
(f="cVAdiabatic");removeListener(curLevel,"wallMove","cV"+this.handle);d=b-this[0].y;0!=d&&(d=getSign(d),this.vs[0].dy=e*d,this.vs[1].dy=e*d,this.parent.setSubWallHandler(this.handle,0,f),addListener(curLevel,"wallMove","cV"+this.handle,function(){var d=this[0].y,e=stepTowards(d,b,this.vs[0].dy);this[0].y=e;this[1].y=e;this[this.length-1].y=e;this.parent.setupWall(this.handle);round(d,2)==round(b,2)&&(removeListener(curLevel,"wallMove","cV"+this.handle),this.parent.setSubWallHandler(this.handle,0,
"staticAdiabatic"),this.vs[0].dy=0,this.vs[1].dy=0)},this))},releaseWithBounds:function(b,d,e,f){this.moveStop();removeListener(curLevel,"wallMove","releaseWithBounds"+this.handle);removeListener(curLevel,"wallMove","cP"+this.handle);this.parent.setSubWallHandler(this.handle,0,e);b=defaultTo(0,b);d=defaultTo(Number.MAX_VALUE,d);var h=g,k=this.bounds;addListener(curLevel,"wallMove","releaseWithBounds"+this.handle,function(){var e=this[0].y,m=e+this.vs[0].dy+0.5*h;m<b||m>d?(this.moveStop(),this.parent.setSubWallHandler(this.handle,
0,"staticAdiabatic"),m<b?(f(b),e=b):(f(d),e=d)):m>k.max.y||m<k.min.y?e=this.hitBounds(e,h,k.min.y,k.max.y):(e=m,this.vs[0].dy+=h,this.vs[1].dy+=h);this[0].y=e;this[1].y=e;this[this.length-1].y=e;this.parent.setupWall(this.handle)},this)},moveInit:function(){var b=g,d=this.bounds;addListener(curLevel,"wallMove","cP"+this.handle,function(){var e=this[0].y,f,h=e+this.vs[0].dy+0.5*b;if(h>d.max.y){for(var k=!0,l=0;l<this.boundMaxHandlers.length;l++)this.boundMaxHandlers[l].replacesStd?(f=this.boundMaxHandlers[l].func.apply(this.boundMaxHandlers[l].obj,
[this,h,d.max.y]),k=!1):this.boundMaxHandlers[l].func.apply(this.boundMaxHandlers[l].obj,[this,h,d.max.y]);k&&(f=this.hitBounds(e,b,d.min.y,d.max.y))}else if(h<d.min.y){k=!0;for(l=0;l<this.boundMinHandlers.length;l++)this.boundMinHandlers[l].replacesStd?(f=this.boundMinHandlers[l].func.apply(this.boundMinHandlers[l].obj,[this,h,d.min.y]),k=!1):this.boundMinHandlers[l].func.apply(this.boundMinHandlers[l].obj,[this,h,d.min.y]);k&&(f=this.hitBounds(e,b,d.min.y,d.max.y))}else f=h,this.vs[0].dy+=b,this.vs[1].dy+=
b;this[0].y=f;this[1].y=f;this[this.length-1].y=f;this.parent.setupWall(this.handle)},this)},addBoundHandler:function(b,d){var e=this["bound"+b.toCapitalCamelCase()+"Handlers"];e?e.push(d):console.log("Bad wall bound handler type "+b)},removeBoundHandler:function(b,d){var e=this["bound"+b.toCapitalCamelCase()+"Handlers"];if(e){var f=e.indexOf(d);0<=f&&e.splice(f,1)}else console.log("Bad wall bound handler type "+b)},moveStop:function(){this.vs[0].dy=0;this.vs[1].dy=0;removeListener(curLevel,"wallMove",
"cP"+this.handle);removeListener(curLevel,"wallMove","releaseWithBounds"+this.handle)},hitBounds:function(b,d,e,f){var h=1,k=this.vs[0].dy,l=Math.max(e,Math.min(f,b+k*h+0.5*d*h*h));b=k*k+2*d*(l-b);if(l==f)var m=(-k+Math.sqrt(b))/d;else l==e&&(m=(-k-Math.sqrt(b))/d);this.vs[0].dy+=d*m;this.vs[1].dy+=d*m;this.vs[0].dy*=-1;this.vs[1].dy*=-1;h-=m;k=this.vs[0].dy;-2*k<h*d&&0>k&&(e=Math.abs(2*k/d),h-=Math.floor(h/e)*e);this.vs[0].dy+=d*h;this.vs[1].dy+=d*h;return l+k*h+0.5*d*h*h},setHitMode:function(b){/^[sS]td$/.test(b)||
/^[aA]rrowDV$/.test(b)||/^[aA]rrowSpd$/.test(b)||/^[gG]ravity$$/.test(b)?this.hitMode="didHit"+b.toCapitalCamelCase():console.log("bad hitMode "+b)},setDefaultReadout:function(b){this.defaultReadout=b;return this},unsetDefaultReadout:function(){this.defaultReadout=void 0;return this},setTemp:function(b){this.tSet=b},getCv:function(){var b=0,d;for(d in window.spcs)var e=dotManager.get({tag:this.handle,spcName:d}),b=b+(e?e.length:0)*spcs[d].cv/N;return b},isothermalInit:function(b){if(b)if("number"==
typeof b)this.tSet=b;else if(/current/i.test(b)){var d=this.getDataSrc("temp");d.length&&(this.tSet=d[d.length-1])}this.eToAdd=0;dotManager.get({tag:this.handle});d=this.data.temp.src();this.isothermal||(addListener(curLevel,"data","recordEnergyForIsothermal"+this.handle,function(){var b;b=this.tSet-(d[d.length-1]||this.tSet);this.eToAdd=this.getCv()*b;for(var f in this.liquids){var h=this.liquids[f],k="setT"+h.handle;removeListener(curLevel,"update",k);var l=this.tSet;b=l-h.temp;if(1<Math.abs(b)){var m=
b/15;addListener(curLevel,"update",k,function(){var b=stepTowards(h.temp,l,m);this.q+=(b-h.temp)*h.Cp*JtoKJ;h.temp=b;b==l&&removeListener(curLevel,"update",k)},this)}}},this),this.recordQ());for(b=0;b<this.length;b++)this[b].isothermal=!0;this.isothermal=!0},isothermalStop:function(){this.isothermal=!1;removeListener(curLevel,"data","recordEnergyForIsothermal"+this.handle)},surfArea:function(){var b=0;for(ptIdx=0;ptIdx<this.length-1;ptIdx++)b+=this[ptIdx].distTo(this[ptIdx+1]);return b},updateMass:function(){var b=
0,d;for(d in this.massChunks)b+=this.massChunks[d];this.mass=b},setMass:function(b,d){this.massChunks[b]=d;this.updateMass();return this},unsetMass:function(b){if(b)delete this.massChunks[b];else for(b in this.massChunks)delete this.massChunk[b];this.updateMass();return this},addLiquid:function(b){this.liquids[b.handle]=b},removeLiquid:function(b){"string"==typeof b&&(b=this.liquids[b]);b&&b.handle&&delete this.liquids[b.handle]},setBounds:function(b,d){var e=this.bounds;d&&(d instanceof Point?e.max=
d:e.max.y=d);b&&(b instanceof Point?e.min=b:e.min.y=b)},addBorder:function(b){b.wall=this;this.border=new WallMethods.Border(b)},removeBorder:function(){this.border&&this.border.remove()},addPts:function(b,d){for(var e=[],f=this.parent.idxByInfo(this.handle),h=b;h<this.length;h++)e.push(this.parent.getSubWallHandler(f,h));this.concat();f=[];for(h=0;h<d.length;h++)f.push(V(0,0));f=[b,0].concat(f);h=[b,0].concat(d);Array.prototype.splice.apply(this,h);Array.prototype.splice.apply(this.vs,f);for(f=b+
d.length;f<this.length;f++)this.parent.setSubWallHandler(this.handle,f,e[f-d.length-b]);e=e[0]||this.handlers[b-1];for(f=b;f<b+d.length;f++)this.parent.setSubWallHandler(this.handle,f,e);this.parent.setupWall(this.handle);this.border&&!this.border.removed&&this.border.update()},removePts:function(b,d){for(var e=[],f=this.parent.idxByInfo(this.handle),h=b+d;h<this.length;h++)e.push(this.parent.getSubWallHandler(f,h));this.splice(b,d);this.vs.splice(splice,d);for(h=b;h<this.length;h++)this.parent.setSubWallHandler(f,
h,e[h-b]);this.parent.setupWall(this.handle);this.border&&!this.border.removed&&this.border.update()},removeContainedWall:function(b){b=this.containedWalls.indexOf(b);-1<b&&this.containedWalls.splice(b,1)},getPt:function(b){return this[b]},getUV:function(b){return this.wallUVs[b]},getPerpUV:function(b){return this.wallPerpUVs[b]},populateArrows:function(b){var d=this.parent.qArrowFill,e=this.parent.qArrowFillFinal,f=this.parent.qArrowStroke,h=getSign(b),k={"-1":"cw",1:"ccw"}[h];this.turnLastArrow=
this.data.q.src().length-1;b=V(110*Math.abs(b),170*Math.abs(b));var l=b.copy();l.dx*=1.4;l.dy*=0.85;var m={"-1":0,1:-l.dx-30};if(7<b.dx||7<b.dy)for(var n=0;n<this.length-1;n++)if(this[n].isothermal)for(var p=this[n].distTo(this[n+1]),r=Math.round(p/150),s=p/=r+1,t=0;t<r;t++){var u=this[n].copy().movePt(this.wallUVs[n].copy().mult(s)).movePt(this.wallPerpUVs[n].copy().mult(m[h]));new ArrowFly({pos:u,dist:30,UV:this.wallUVs[n].copy().perp(k),fill:d,fillFinal:e,stroke:f,dims:b,dimsFinal:l,lifespan:3500});
s+=p}},cleanUp:function(){var b=this.cleanUpListeners,d;for(d in b){var e=b[d];e.func.apply(e.obj)}}};WallMethods.BoundHandler=function(b,d,e){this.func=b;this.obj=d;this.replacesStd=e};WallMethods.wallDataHandler={setupCp:function(){for(var b=this.handle,d=[],e=[],f=0;f<LevelData.spcDefs.length;f++){var h=dotManager.get({tag:b,spcName:LevelData.spcDefs[f].spcName});h&&(d.push(h),e.push(LevelData.spcDefs[f].cv/N))}return function(){for(var b=0,f=0;f<d.length;f++)b+=d[f].length*e[f];return b}},pExt:function(){return this.pConst*this.mass*this.g/(this[1].x-this[0].x)},pInt:function(){var b=this.surfArea(),d;for(d in this.surfAreaAdj)b+=this.surfAreaAdj[d].val;b=this.pConst*this.forceInternal/
((turn-this.pLastRecord)*b);this.forceInternal=0;this.pLastRecord=turn;this.pIntList[this.pIntIdx]=b;this.pIntIdx++;this.pIntIdx==this.pIntLen&&(this.pIntIdx=0);return this.pIntList.average()},addSurfAreaAdjust:function(b){this.surfAreaAdj[b]={val:0};return this.surfAreaAdj[b]},removeSurfAreaAdjust:function(b){delete this.surfAreaAdj[b]},getDataObj:function(b,d,e){if(this.data[b])if(this.data[b]instanceof Array)for(e=0;e<this.data[b].length;e++){if(this.data[b][e].argsMatch(d))return this.data[b][e]}else return this.data[b];
else!0!==e&&(console.log('Tried to get bad data type "'+b+'" with args'),console.log(d));return!1},getDataSrc:function(b,d,e){if(this.data[b])if(this.data[b]instanceof Array)for(e=0;e<this.data[b].length;e++){if(this.data[b][e].argsMatch(d))return this.data[b][e].srcVal}else return this.data[b].srcVal;else e||(console.log('Tried to get bad data type "'+b+'" with args'),console.log(d));return!1},removeDataObj:function(b,d){if(this.data[b])if(this.data[b]instanceof Array){for(var e=0;e<this.data[b].length;e++)if(this.data[b][e].argsMatch(d))return this.data[b].splice(e,
1);console.log("Couldn't find data "+b+" with args "+d)}else return delete this.data[b]},pareData:function(){for(var b in this.data){var d=this.data[b];if(d instanceof Array)for(var e=0;e<d.length;e++)600<d[e].srcVal.length&&d[e].srcVal.splice(0,d[e].srcVal.length-300);else 600<d.srcVal.length&&d.srcVal.splice(0,d.srcVal.length-300)}},createSingleValDataObj:function(b,d,e){var f=new WallMethods.DataObj;e?this.data[b]?this.data[b].push(f):this.data[b]=[f]:this.data[b]=f;this.setupStdDataObj(f,b);f.recordStop(function(){});
f.srcVal=[d()];return f},recordDefaults:function(){this.recordTime();this.recordTemp();this.recordPInt();this.recordVol()},recordTime:function(){this.data.time=new WallMethods.DataObj;var b=this.data.time,d=new Listener(function(){return(Date.now()-e)/1E3},this);this.setupStdDataObj(b,"time",d);var e=Date.now();recordData(b.id()+b.wallHandle(),b.src(),d,"update")},recordTemp:function(b){var d=this.data.temp;if(!d||!d.recording()){this.data.temp=new WallMethods.DataObj;d=this.data.temp;b||(b=function(){for(var b=
0,d=0;d<e.length;d++)b+=e[d].KE();return e.length?tConst*b/e.length:0});b=new Listener(b,this);this.setupStdDataObj(d,"temp",b);var e=this.dotManager.getWithLog({tag:this.handle});recordData(d.id()+d.wallHandle(),d.src(),b,"update")}return this},recordRMS:function(){},getRMSMass:function(b){if(b)for(var d in spcs)for(var e=spcs[d].dots,f=0;f<e.length;f++)if(b){if(e[f].tag==b)return e[f].m}else return e[f].m},recordPInt:function(){var b=this.data.pInt;if(!b||!b.recording()){this.data.pInt=new WallMethods.DataObj;
var b=this.data.pInt,d=new Listener(this.pInt,this);this.setupStdDataObj(b,"pInt",d);this.pIntList=[];this.pIntIdx=0;recordData(b.id()+b.wallHandle(),b.src(),d,"update")}return b},recordPExt:function(){var b=this.data.pExt;if(!b||!b.recording()){var d=new Listener(this.pExt,this);this.data.pExt=new WallMethods.DataObj;b=this.data.pExt;this.setupStdDataObj(b,"pExt",d);recordData(b.id()+b.wallHandle(),b.src(),d,"update")}return b},recordVol:function(){var b=this.data.vol;if(!b||!b.recording()){var d=
new Listener(function(){return this.parent.wallVolume(this.handle)},this);this.data.vol=new WallMethods.DataObj;b=this.data.vol;this.setupStdDataObj(b,"vol",d);recordData(b.id()+b.wallHandle(),b.src(),d,"update")}return b},recordWork:function(){var b=this.data.work;if(!b||!b.recording()){this.data.work=new WallMethods.DataObj;b=this.data.work;this.work=0;var d=LtoM3,e=PUNITTOPA,f=JtoKJ,h=this,k=this.getDataObj("vol").src(),l=new Listener(function(){var b=k.length,b=d*(k[b-1]-k[b-2]);if(isNaN(b))return h.work=
0;var l=h.pExt()*e;h.work-=f*l*b;return h.work},this);this.setupStdDataObj(b,"work",l);recordData(b.id()+b.wallHandle(),b.src(),l,"update")}return b},recordMass:function(){var b=this.data.mass;if(!b||!b.recording()){this.data.mass=new WallMethods.DataObj;var d=new Listener(function(){return this.mass},this),b=this.data.mass;this.setupStdDataObj(b,"mass",d);recordData(b.id()+b.wallHandle(),b.src(),d,"update")}return b},recordQ:function(){var b=this.data.q;if(!b||!b.recording()){this.data.q=new WallMethods.DataObj;
var b=this.data.q,d=new Listener(function(){return this.q},this);this.setupStdDataObj(b,"q",d);recordData(b.id()+b.wallHandle(),b.src(),d,"update")}return b},recordEnthalpyTotal:function(){return this.recordEnergy("enthalpyTotal","cp","hF298",!1)},recordInternalEnergyTotal:function(){return this.recordEnergy("internalEnergyTotal","cv","uF298",!1)},recordEnthalpy:function(){return this.recordEnergy("enthalpy","cp","hF298",!0)},recordInternalEnergy:function(){return this.recordEnergy("internalEnergy",
"cv","uF298",!0)},recordEnergy:function(b,d,e,f){f=defaultTo(!0,f);var h=[],k=[],l=[],m=[],n=[],p=this.data[b];if(!p||!p.recording()){this.data[b]=new WallMethods.DataObj;var p=this.data[b],r=this.getDataSrc("temp");if(this.isLiquid){for(var s=0;s<LevelData.spcDefs.length;s++)if(void 0!==LevelData.spcDefs[s][e]&&void 0!==LevelData.spcDefs[s].cpLiq){var t=this.dotManager.get({tag:this.handle,spcName:LevelData.spcDefs[s].spcName});n.push(t);k.push(1E3*LevelData.spcDefs[s][e]/N);l.push(1E3*LevelData.spcDefs[s].hVap298/
N);m.push(LevelData.spcDefs[s].cpLiq/N)}d=function(){for(var b=0,d=0,e=r[r.length-1]-298.15,h=0;h<n.length;h++)b+=n[h].length*(k[h]+m[h]*e-l[h]),d+=n[h].length;return f?b*N/d:b}}else{for(s=0;s<LevelData.spcDefs.length;s++)t=this.dotManager.get({tag:this.handle,spcName:LevelData.spcDefs[s].spcName}),n.push(t),k.push(1E3*LevelData.spcDefs[s][e]/N),h.push(LevelData.spcDefs[s][d]/N);d=function(){for(var b=0,d=0,e=r[r.length-1]-298.15,l=0;l<n.length;l++)b+=n[l].length*(k[l]+h[l]*e),d+=n[l].length;return f?
b*N/d:b}}d=new Listener(d,this);this.setupStdDataObj(p,b,d);recordData(p.id()+p.wallHandle(),p.src(),d,"update")}return p},recordVDist:function(b){var d=this.dotManager.createIfNotExists(b);this.data.vDist||(this.data.vDist=[]);if(!this.getDataObj("vDist",b)){this.data.vDist.push(new WallMethods.DataObj);var e=this.data.vDist[this.data.vDist.length-1],f=new Listener(function(){for(var b=[],e=0;e<d.length;e++)b.push(d[e].speed());return b},this);this.setupInfoDataObj(e,"vDist",b,f);recordData(e.id()+
e.wallHandle(),e.src(),f,"update")}},recordMoles:function(b){var d,e=this.dotManager.createIfNotExists(b);this.data.moles||(this.data.moles=[]);if(d=this.getDataObj("moles",b))return d;this.data.moles.push(new WallMethods.DataObj);d=this.data.moles[this.data.moles.length-1];var f=new Listener(function(){return e.length/N},this);this.setupInfoDataObj(d,"moles",b,f);recordData(d.id()+d.wallHandle(),d.src(),f,"update");return d},recordFrac:function(b){var d,e=this.dotManager.createIfNotExists(b),f=this.dotManager.createIfNotExists(b.tag?
{tag:b.tag}:void 0);this.data.frac||(this.data.frac=[]);if(this.getDataObj("frac",b))d=this.getDataObj("frac",b);else{this.data.frac.push(new WallMethods.DataObj);d=this.data.frac[this.data.frac.length-1];var h=new Listener(function(){return!f.length?1:e.length/(f.length||1)},this);this.setupInfoDataObj(d,"frac",b);recordData(d.id()+d.wallHandle(),d.src(),h,"update")}return d},setupStdDataObj:function(b,d,e){b.recording(!0);b.recordStop(this.recordStop);b.id(d);b.type(d);b.listener(e);b.wallHandle(this.handle)},
setupInfoDataObj:function(b,d,e,f){b.recording(!0);b.recordStop(this.recordStopDestroy);b.id(d+(e.spcName||"").toCapitalCamelCase()+(e.tag||"").toCapitalCamelCase());b.wallHandle(this.handle);b.listener(f);b.type(d);b.idArgs(e)},recordStopDestroy:function(){this.recording(!1);walls[this.wallHandle()].removeDataObj(this.type(),this.idArgs());recordDataStop(this.id()+this.wallHandle())},recordStop:function(){this.recording(!1);recordDataStop(this.id()+this.wallHandle())},recordAllStop:function(){for(var b in this.data){var d=
this.data[b];if(d instanceof Array)for(var e=0;e<d.length;e++)d[e].recordStop();else d.recordStop()}return this},resetWork:function(){this.work=0;return this},resetQ:function(){this.q=0;return this},displayQArrowsRate:function(b){b=b.threshold;if(this.data.q.recording()&&(!this.data.qArrowsRate||!this.data.qArrowsRate.recording())&&(!this.data.qArrowsAmmt||!this.data.qArrowsAmmt.recording())){this.data.qArrowsRate=new WallMethods.DataObj;var d=this.data.qArrowsRate;d.displaying(!0);d.wallHandle(this.handle);
d.id("qArrowsRate");this.turnLastArrow=Math.max(0,this.data.q.length-1);this.qArrowThreshold=defaultTo(b,0.3);var e="checkForDisplayArrows"+d.wallHandle(),f=this;qSrc=this.data.q.src();addListener(curLevel,"update",e,function(){f.checkDisplayArrows(qSrc)},this);this.turnLastArrow=turn;addListener(this,"cleanUp","qArrowsRate",function(){removeListener(curLevel,"update",e);removeListenerByName(curLevel,"update","ArrowFly")})}else console.log("Tried to display q arrowsRate for wall "+this.handle+" while not recording or already displaying.  Will not display."),
console.trace()},makeDataList:function(){var b=[];b.displaying=!1;b.recording=!1;return b},resetQ:function(){this.q=0;this.displayingQArrowsAmmt&&(this.displayQArrowsAmmtStop(),this.displayQArrowsAmmt(this.qArrowAmmtMax))},resetWork:function(){this.work=0},checkDisplayArrows:function(b){b=b[b.length-1]-b[this.turnLastArrow];Math.abs(b)>this.qArrowThreshold&&(this.populateArrows(b),this.turnLastArrow=turn)}};WallMethods.collideMethods={cPAdiabaticDamped:function(b,d,e,f,h,k){f=b.temp();k=0.5*b.m*(b.v.dx*b.v.dx+b.v.dy*b.v.dy);b.v.copy();var l=b.v.dy,m=d.vs[e].dy,n=b.m,p=d.mass,r=Math.abs(m);if(1<r){e=l*l;var s=m*m,r=0.0017*r*r*r-0.0281*r*r+0.205*r+0.8466,t=r*r,u=n*(1+n/(t*p)),w=-2*n*(l*n/p+m)/t;e=(-w+Math.sqrt(w*w-4*u*((n*(n*e/p+2*m*l)+p*s)/t-n*e-p*s)))/(2*u);b.y+=b.r;d.vs[0].dy=(n*l+p*m-n*e)/(p*r);d.vs[1].dy=d.vs[0].dy}else s=d[e],e=(l*(n-p)+2*p*m)/(b.m+p),d.vs[0].dy=(m*(p-n)+2*n*l)/(p+n),d.vs[1].dy=
d.vs[0].dy,b.y=s.y+b.r;l=0.5*b.m*(b.v.dx*b.v.dx+e*e);k=Math.sqrt((k+2*(l-k)/3)/l);e*=k;b.v.dx*=k;b.setTemp(f+(0.5*tConst*b.m*(b.v.dx*b.v.dx+e*e)-f)*b.cvKinetic/b.cv);0>b.v.dy*e&&(b.v.dy*=-1);d.forceInternal+=b.m*(Math.abs(h)+Math.abs(b.v.dy))},cPAdiabatic:function(b,d,e,f,h,k){f=b.temp();b.v.copy();k=b.v.dy;var l=d.vs[e].dy,m=b.m,n=d.mass,p=d[e];e=(k*(m-n)+2*n*l)/(b.m+n);d.vs[0].dy=(l*(n-m)+2*m*k)/(n+m);d.vs[1].dy=d.vs[0].dy;b.y=p.y+b.r;k=Math.sqrt((KEO+2*(KEF-KEO)/3)/KEF);e*=k;b.v.dx*=k;b.setTemp(f+
(0.5*tConst*b.m*(b.v.dx*b.v.dx+e*e)-f)*b.cvKinetic/b.cv);0>b.v.dy*e&&(b.v.dy*=-1);d.forceInternal+=b.m*(Math.abs(h)+Math.abs(b.v.dy))},staticAdiabatic:function(b,d,e,f,h,k){this.reflect(b,f,h);d.forceInternal+=2*b.m*Math.abs(h)},cVIsothermal:function(b,d,e,f,h,k){if(d.eToAdd){k=getSign(d.eToAdd);e=b.temp();k*=Math.min(Math.abs(d.eToAdd),20*b.cv*d.isothermalRate);0>k&&e<=20*d.isothermalRate&&(k=-Math.max(0,e-1)*b.cv);d.eToAdd-=k;var l=e+k/b.cv,m=Math.sqrt(l/e),n=h*m;this.reflect(b,f,h);b.v.dx*=m;b.v.dy*=
m;b.internalPotential*=l/e;d.forceInternal+=b.m*(Math.abs(h)+Math.abs(n));d.q+=k*JtoKJ}else d.forceInternal+=2*b.m*Math.abs(h),this.reflect(b,f,h)},cVAdiabatic:function(b,d,e,f,h,k){b.v.dy=-b.v.dy+2*d.vs[e].dy},reflect:function(b,d,e){b.v.dx-=2*d.dy*e;b.v.dy+=2*d.dx*e;b.x-=d.dy;b.y+=d.dx}};WallMethods.Border=function(b){this.wall=b.wall;this.type=b.type;this.yMin=void 0!==b.yMin?b.yMin:this.wall[0].y;this.col=b.col||this.wall.col.copy().adjust(-100,-100,-100);this.thick=b.thickness||5;this.update=this.pickGenerator(this.type);this.canvasHandle=this.wall.canvasHandle||"main";this.update();this.removed=!1};
WallMethods.Border.prototype={remove:function(){this.removed=!0;canvasManager.removeListener(this.canvasHandle,this.listenerName)},pickGenerator:function(b){if("open"==b)return this.genOpen();if("wrap"==b)return this.genWrap()},genOpen:function(){return this.genBorder(this.thick,this.col,1,"end",!0)},genWrap:function(){return this.genBorder(this.thick,this.col,0,"end",!1)},genBorder:function(b,d,e,f,h){var k=this;this.listenerName="drawBorder"+this.wall.handle.toCapitalCamelCase();return function(){k.remove();
var l=k.genSegs(e,f,b,h);canvasManager.addListener(this.canvasHandle,k.listenerName,function(b){for(var e=0;e<l.length;e++)draw.fillPts(l[e],d,b)},this,1);k.removed=!1}},genSegs:function(b,d,e,f){var h=[];d="end"==d?this.wall.length-1:d;for(var k=b;k<d;k++){var l=this.wall.wallPerpUVs[k].copy().neg(),m=this.wall[k].copy(),n=this.wall[k+1].copy(),p=k+1==d?0:k+1,r;r=this.getExtendV(l,this.wall[k-1]?k-1:this.wall.length-2,b-1,e,f);l=this.getExtendV(l,p,0,e,f);l=n.copy().movePt(l);r=m.copy().movePt(r);
"open"==this.type&&(k==b?(m.y=this.yMin,r.y=this.yMin):k==d-1&&(n.y=this.yMin,l.y=this.yMin));h.push([m,n,l,r])}return h},getExtendV:function(b,d,e,f,h){var k=this.wall.wallPerpUVs[d].copy().neg();d=h&&d==e?b.copy():k.add(b).UV();b=b.dotProd(d);return d.mult(f/b)}};function ButtonManager(b){this.wrapperDivId=b;this.groups=[]}
ButtonManager.prototype={addGroup:function(b,d,e,f,h){var k=$("#"+this.wrapperDivId),l="group"+b,m=l+"Wrapper",n=l+"Padder",p=templater.div({attrs:{id:[l],"class":["buttonGroup"]}}),p=d+templater.br()+p,m=templater.div({attrs:{id:[m],handle:[b],"class":["buttonManagerElem","displayText","buttonGroupWrapper"]},innerHTML:p}),n=templater.div({attrs:{id:[n],handle:[b],"class":["buttonManagerElem","buttonGroupPadder"]},innerHTML:m});k.append(n);this.groups.push(new ButtonManager.Group(k,l,b,d,e,f,h))},
removeGroup:function(b){var d=this.getGroup(b);d?(b=this.groups.indexOf(d),d=this.getGroupDiv(d),this.groups.splice(b,1),d.remove()):console.log("Bad group handle "+b)},clickButton:function(b,d){var e=this.getGroup(b);e?e.clickButton(d):console.log("Tried to click button in bad group handle "+b)},hideButton:function(b,d){var e=this.getGroup(b);e?e.hideButton(d):console.log("Bad group handle "+b)},showButton:function(b,d){var e=this.getGroup(b);e?e.showButton(d):console.log("Bad group handle "+b)},
removeButton:function(b,d){var e=this.getGroup(b);e?e.removeButton(d):console.log("Bad group handle "+b)},getGroupDiv:function(b){for(var d=$("#"+this.wrapperDivId).children(),e=0;e<d.length;e++)if($(d[e]).attr("handle")==b.handle)return $(d[e])},arrangeGroupWrappers:function(){var b=this.arrangeObjs(this.groups);this.arrangeHTML($("#"+this.wrapperDivId),b)},arrangeAllGroups:function(){for(var b=0;b<this.groups.length;b++)this.arrangeGroup(this.groups[b].handle)},arrangeGroup:function(b){var d=this.getGroup(b);
d?(b=this.arrangeObjs(d.buttons),this.arrangeHTML($("#"+d.groupId),b)):console.log("Bad group name "+b)},setButtonWidth:function(){for(var b=$("button.buttonManagerElem"),d=100,e=0;e<b.length;e++)var f=b[e],d=Math.max(d,$(f).outerWidth());for(e=0;e<b.length;e++)f=b[e],$(f).css("width",d)},arrangeHTML:function(b,d){for(var e=b.children(),f=!1,h=0;h<e.length;h++){var k=e[h],l=d[h],k=$(k).attr("handle");if(f=Math.max(f,k!=l.handle))break}if(f){f={};for(h=0;h<e.length;h++)k=e[h],f[$(k).attr("handle")]=
$(k).clone(!0);b.html("");for(e=0;e<d.length;e++)b.append(f[d[e].handle])}},addButton:function(b,d,e,f,h,k){var l=this.getGroup(b);l?l.addButton(d,e,f,h,k):console.log("Bad group handle "+b)},getGroup:function(b){for(var d=0;d<this.groups.length;d++)if(this.groups[d].handle==b)return this.groups[d]},arrangeObjs:function(b){var d=[];b=this.sortObjs(b.concat());var e=this.slicePrefs(b);b=this.sliceNoPrefs(b);for(var f=0;f<e.length;f++){var h=e[f].prefIdx;d[h]?d.push(e[f]):d[h]=e[f]}for(f=e=0;e<b.length;)void 0==
d[f]&&(d[f]=b[e],e++),f++;for(f=d.length-1;0<=f;f--)void 0==d[f]&&d.splice(f,1);return d},sortObjs:function(b){for(var d=0;d<b.length;d++)for(var e=0;e<b.length-1;e++)if(b[e].prefIdx>b[e+1].prefIdx||void 0==b[e].prefIdx){var f=b[e];b[e]=b[e+1];b[e+1]=f}return b},slicePrefs:function(b){for(var d=0;d<b.length;d++)if(void 0==b[d].prefIdx)return b.slice(0,d);return b.slice(0,b.length)},sliceNoPrefs:function(b){for(var d=0;d<b.length;d++)if(void 0==b[d].prefIdx)return b.slice(d,b.length);return[]}};
ButtonManager.Group=function(b,d,e,f,h,k,l){this.mgrDiv=b;this.groupId=d;this.handle=e;this.label=f;this.prefIdx=h;this.buttons=[];this.isRadio=k;this.isToggle=l&&!k};
ButtonManager.Group.prototype={addButton:function(b,d,e,f,h,k){var l=b+"Button",m=b+"Wrapper";this.buttons.push(new ButtonManager.Button(b,l,m,d,e,f,k));d=templater.button({innerHTML:d,attrs:{id:[l],"class":["buttonManagerElem","buttonManagerButton"],handle:[b]}});b=templater.div({innerHTML:d,attrs:{id:[m],"class":["buttonManagerElem","buttonWrapper"],handle:[b]}});$("#"+this.groupId).append(b);l=$("button#"+l);addJQueryElems(l,"button");b=this.buttons[this.buttons.length-1];m=b.click;d=b.mousedown;
e=b.mouseup;this.isRadio?m=this.wrapInRadio(b,m):this.isToggle&&(m=this.wrapInToggle(b,m));h&&m&&m();h&&this.isRadio?this.pushRadio(b):h&&this.isToggle&&this.toggleButton(b);m&&$(l).click(m);d&&$(l).mousedown(d);e&&$(l).mouseup(e)},clickButton:function(b){b=this.getButton(b);$("button#"+b.buttonId).click()},hideButton:function(b){b=this.getButton(b);$("button#"+b.buttonId).hide()},showButton:function(b){b=this.getButton(b);$("button#"+b.buttonId).show()},removeButton:function(b){b=this.getButton(b);
this.getButtonDiv(b).remove();this.buttons.splice(this.buttons.indexOf(b),1)},wrapInRadio:function(b,d){var e=d,f=this;return function(){f.pushRadio(b);e()}},wrapInToggle:function(b,d){var e=d,f=this;return function(){f.toggleButton(b);e()}},pushRadio:function(b){for(var d=0;d<this.buttons.length;d++)$("#"+this.buttons[d].buttonId).removeClass("ui-button-as-radio-selected");$("#"+b.buttonId).addClass("ui-button-as-radio-selected")},toggleButton:function(b){b=$("#"+b.buttonId);b.hasClass("ui-button-as-radio-selected")?
b.removeClass("ui-button-as-radio-selected"):b.addClass("ui-button-as-radio-selected")},getButton:function(b){for(var d=0;d<this.buttons.length;d++)if(this.buttons[d].handle==b)return this.buttons[d];console.log("Bad button handle "+b)},getButtonDiv:function(b){for(var d=$("#"+this.groupId).children(),e=0;e<d.length;e++)if($(d[e]).attr("handle")==b.handle)return $(d[e])}};
ButtonManager.Button=function(b,d,e,f,h,k,l){this.handle=b;this.buttonId=d;this.wrapperId=e;this.label=f;this.click;this.mousedown;this.mouseup;h.mousedown||h.mouseup?(h.mousedown&&(this.mousedown=this.wrapExprs(h.mousedown)),h.mouseup&&(this.mouseup=this.wrapExprs(h.mouseup))):this.click=this.wrapExprs(h);this.prefIdx=k};
ButtonManager.Button.prototype={wrapExprs:function(b){if("function"==typeof b)return b;b=b instanceof Array?b.join(";")+";":b+";";with(DataGetFuncs)b=eval("(function() {"+b+"})");return b}};function QuizRenderer(){this.hoverCol=Col(0,81,117);this.selectedCol=Col(40,121,147)}
QuizRenderer.prototype={render:function(b,d){var e=new QuizRenderer.Quiz(b);if(this.checkQuizTyping(e)){var f=templater.div({attrs:{id:["quizWrapper"]}}),h=templater.div({attrs:{id:["quizContent"],"class":["niceFont","whiteFont"]}}),k=templater.div({attrs:{id:["quizFooter"]}});$(d).append(f);f=$("#quizWrapper");$(f).append(h);$(f).append(k);h=$("#quizContent");k=$("#quizFooter");for(f=0;f<e.questions.length;f++)this.renderQuestion(e.questions[f],h);b[0]&&"setVals"==b[0].type?this.appendButtons(k,
function(){sceneNavigator.prevPrompt();wasReset=!1},function(){sceneNavigator.refresh()},"Back","Set values"):this.appendButtons(k,function(){sceneNavigator.prevPrompt();wasReset=!1},function(){sceneNavigator.nextPrompt()},"Back","Submit");return e}},checkQuizTyping:function(b){b=b.questions;for(var d=!1,e=!1,f=0;f<b.length;f++)"setVals"==b.type?d=!0:e=!0;return d&&e?(console.log("Bad quiz typing.  Can't mix setVals with others"),!1):!0},renderQuestion:function(b,d){"multChoice"==b.type?this.renderMultChoice(b,
d):"text"==b.type?this.renderTextBox(b,d,3,50):"textSmall"==b.type?this.renderTextBox(b,d,1,10):"setVals"==b.type&&this.renderTextBox(b,d,1,10)},renderMultChoice:function(b,d){for(var e=b.options,f=void 0===b.questionText?"":interpreter.interp(b.questionText)+templater.br(),f=f+"<div style = 'padding-top:4px;'>",h=0;h<e.length;h++)var k=e[h],f=f+templater.div({attrs:{id:[b.storeAs+String(h)],"class":["multChoiceBlock"]},innerHTML:k.text});d.append(f+"</div>");for(h=0;h<e.length;h++)k=e[h],k.div=$("#"+
b.storeAs+String(h));this.bindMultChoiceQuestion(b)},bindMultChoiceQuestion:function(b){var d=this,e=b.options,f=function(f){var h=e[f];b.answered=!0;if(!h.selected){for(var m=0;m<e.length;m++)e[m]!=h&&(e[m].div.css("background-color","transparent"),e[m].selected=!1);h.selected=!0;store(b.storeAs,f);b.hasCorrectAnswer()?b.correct=h.correct?!0:!1:b.correct=!0;$(h.div).css("background-color",d.selectedCol.hex)}};void 0!==getStore(b.storeAs)&&f(getStore(b.storeAs));for(var h=0;h<b.options.length;h++)this.bindMultChoiceOption(b,
f,b.options,b.options[h])},bindMultChoiceOption:function(b,d,e,f){var h=this;f.div.click(function(){d(e.indexOf(f))});f.div.hover(function(){f.selected||$(this).css("background-color",h.hoverCol.hex)},function(){f.selected||$(this).css("background-color","transparent")})},renderTextBox:function(b,d,e,f){var h=b.storeAs,k=defaultTo("Type your answer here.",b.boxText);textareaHTML=templater.textarea({attrs:{id:[h],rows:[e],cols:[f],placeholder:[k]}});e=(void 0===b.questionText?"":interpreter.interp(b.questionText)+
templater.br())+templater.table({attrs:{"class":["niceFont","whiteFont"]},innerHTML:templater.tr({innerHTML:templater.td({innerHTML:b.label})+templater.td({innerHTML:"&#32;&#32;"})+templater.td({innerHTML:textareaHTML})+templater.td({innerHTML:b.units||""})})});d.append(e);b.div=$("#"+h);var l=function(d){d=void 0!==d?d:b.div.val();""!=d&&(store(b.storeAs,d),b.answered=!0,b.hasCorrectAnswer()?0.05>fracDiff(parseFloat(b.answer),parseFloat(val))?b.correct=!0:b.correct=!1:b.correct=!0)};getStore(b.storeAs)&&
(l(getStore(b.storeAs)),b.div.html(getStore(b.storeAs)));b.div.change(function(){l()})},appendButtons:function(b,d,e,f,h){f=templater.button({attrs:{id:["quizButtonLeft"]},innerHTML:f})+templater.button({attrs:{id:["quizButtonRight"]},innerHTML:h});f=templater.div({attrs:{id:["quizSubmitWrapper"]},style:{"float":"right"},innerHTML:f});$(b).append(f);$("#quizButtonLeft").click(d);$("#quizButtonRight").click(e);addJQueryElems($("#quizButtonLeft"),"button");addJQueryElems($("#quizButtonRight"),"button");
$(b).css("min-height",$("#quizButtonLeft").height()+5+"px")}};QuizRenderer.Quiz=function(b){this.questions=[];for(var d=0;d<b.length;d++)this.questions.push(new QuizRenderer.Question(b[d]))};
QuizRenderer.Quiz.prototype={allAnswered:function(){for(var b=0;b<this.questions.length;b++)if(!this.questions[b].answered)return!1;return!0},allCorrect:function(){for(var b=0;b<this.questions.length;b++)if(!this.questions[b].correct)return!1;return!0},fireAlertWrong:function(){for(var b=0;b<this.questions.length;b++){var d=this.questions[b];if(d.hasCorrectAnswer()&&!d.correct)if("multChoice"==d.type)for(var e=0;e<d.options.length;e++){if(d.options[e].selected&&d.options[e].message){alert(d.options[e].message);
return}}else if(d.message){alert(d.message);break}}},sendAnswersToCW:function(){for(var b=0;b<this.questions.length;b++)this.questions[b].sendAnswerToCW()}};
QuizRenderer.Question=function(b){this.type=b.type;this.label=this.getQuestionLabel(b.label,this.CWQuestionId);this.boxText=defaultTo(b.text,b.boxText);this.CWQuestionId=b.CWQuestionId;this.questionText=this.getQuestionText(b.questionText||b.preText,this.CWQuestionId);this.units=b.units;this.message=b.message;this.storeAs=b.storeAs;this.options=this.makeOptions(b.options);this.answered=!1;this.answer=b.answer;this.correct=!1;this.div=void 0};
QuizRenderer.Question.prototype={makeOptions:function(b){if(b){for(var d=[],e=0;e<b.length;e++)d.push(new QuizRenderer.MultChoiceOption(b[e],this.CWQuestionId));return d}},getQuestionText:function(b,d){if(void 0===d)return b;var e=new XMLHttpRequest;if(/^(http|https)/.test(document.URL)){var f=window.stringTogetherGET({"goto":"simulation",command:"get_question_text",question_id:d});e.open("GET","CW.php?"+f,!1);e.send(null)}return e.responseText?e.responseText.replace(/\\\\/g,"\\"):b},getQuestionLabel:function(b,
d){if(void 0===d)return b;var e=new XMLHttpRequest;if(/^(http|https)/.test(document.URL)){var f=window.stringTogetherGET({"goto":"simulation",command:"get_question_label",question_id:d});e.open("GET","CW.php?"+f,!1);e.send(null)}return e.responseText?e.responseText.replace(/\\\\/g,"\\"):defaultText},hasCorrectAnswer:function(){if(("text"==this.type||"textSmall"==this.type||"setVals"==this.type)&&void 0!==this.answer)return!0;if("multChoice"==this.type)for(var b=0;b<this.options.length;b++)if(this.options[b].correct)return!0;
return!1},sendAnswerToCW:function(){var b=new XMLHttpRequest,d;if("text"==this.type||"textSmall"==this.type||"setVals"==this.type)d=getStore(this.storeAs),d=btoa(d),/^(http|https)/.test(document.URL)&&(d=window.stringTogetherGET({"goto":"simulation",command:"send_answer",question_id:this.CWQuestionId,answer_text_64:d}),b.open("GET","CW.php?"+d,!1),b.send(null));else if("multChoice"==this.type)for(var e=0;e<this.options.length;e++)this.options[e].selected&&(void 0!==this.options[e].CWAnswerId&&/^(http|https)/.test(document.URL))&&
(d=window.stringTogetherGET({"goto":"simulation",command:"send_answer",question_id:this.CWQuestionId,answer_id:this.options[e].CWAnswerId}),b.open("GET","CW.php?"+d,!1),b.send(null))}};QuizRenderer.MultChoiceOption=function(b,d){this.CWAnswerId=b.CWAnswerId;this.correct=b.correct||!1;this.text=this.getAnswerText(b.text,d,this.CWAnswerId);this.selected=!1;this.message=b.message;this.div=void 0};
QuizRenderer.MultChoiceOption.prototype={getAnswerText:function(b,d,e){if(void 0===d||void 0===e)return b;var f=new XMLHttpRequest;d=window.stringTogetherGET({"goto":"simulation",command:"get_answer_text",question_id:d,answer_id:e});/^(http|https)/.test(document.URL)&&(f.open("GET","CW.php?"+d,!1),f.send(null));return f.responseText?f.responseText.replace(/\\\\/g,"\\"):b}};function SliderManager(b){this.containerId=b;this.sliderGroupWrapper=this.appendSliderGroupWrapper(this.containerId)}
SliderManager.prototype={addSlider:function(b,d,e,f,h){h="number"!=typeof h&&0<=h?this.getMaxIdx(this.sliderGroupWrapper)+1:h;h=this.insertSliderWrapper(this.containerId,this.sliderGroupWrapper,h,d);var k=this.insertSliderPadding(this.containerId,h);d="sliderInnerContainer"+this.containerId+"Handle"+d;var l="#"+this.containerId+" #"+d;makeSlider(k,k,l,d,b,e,f);this.setWidths();return new SliderManager.Slider(this,h,$(l))},setWidths:function(){var b=this.sliderGroupWrapper.children();if(b.length){this.sliderGroupWrapper.css("width",
150*b.length/(1+1.5*b.length)+"%");for(var d=100/b.length,e=0;e<b.length;e++)$(b[e]).css("width",d+"%")}},insertSliderWrapper:function(b,d,e,f){for(var h="sliderIdx"+e+"Handle"+f,k=d.children(),l=-1,m=0;m<k.length;m++){var n=$(k[m]).attr("sliderIdx");if(void 0!==n&&e<=n){l=m;break}}e=templater.div({attrs:{id:[h],handle:[f],sliderIdx:[e],"class":["sliderWrapper"]}});-1==l?d.append(e):$(k[m]).before(e);return $("#"+b+" #"+h)},insertSliderPadding:function(b,d){var e=d.attr("id")+"Padding",f=templater.div({attrs:{id:[e],
"class":["sliderPadding"]}});d.append(f);return $("#"+b+" #"+d.attr("id")+" #"+e)},getMaxIdx:function(b){b=b.children();for(var d=-1,e=0;e<b.length;e++){var f=$(b[e]).attr("sliderIdx");void 0!==f&&!isNaN(f)&&(d=Math.max(f,d))}return d},appendSliderGroupWrapper:function(b){$("#"+b).append(templater.div({attrs:{id:["sliderWrapper"],"class":["sliderGroupWrapper"]}}));return $("#"+b+" #sliderWrapper")}};
SliderManager.Slider=function(b,d,e){this.manager=b;this.wrapper=d;this.slider=e;this.selector=e.selector;this.removed=!1};SliderManager.Slider.prototype={remove:function(){this.removed||(this.wrapper.remove(),this.manager.setWidths(),this.removed=!0)},enable:function(){$(this.selector).slider("enable")},disable:function(){$(this.selector).slider("disable")}};function ActivationEnergySpcChanger(b){this.collideHandler=b;this.pairs={};this.active=!1;this.standardBreakUp=this.collideHandler.breakUp;this.breakUpFunc=this.makeBreakUpFunc()}
ActivationEnergySpcChanger.prototype={addPair:function(b){var d=b.spcNameLow,e=b.spcNameHigh;this.pairs[d]||this.pairs[e]?console.log("Trying to add another energy threshold to either "+d+" or "+e):(this.pairs[b.spcNameLow]=b,this.pairs[b.spcNameHigh]=b,this.active||this.addActiveEBreakUp())},removePair:function(b){delete this.pairs[b.spcNameLow];delete this.pairs[b.spcNameHigh];countAttrs(this.pairs)||(this.active=!1,this.restoreBreakUp())},addActiveEBreakUp:function(){this.collideHandler.breakUp=
this.breakUpFunc},restoreBreakUp:function(){this.collideHandler.breakUp=this.standardBreakUp},makeBreakUpFunc:function(){var b=this;return function(d,e,f){var h,k=b.pairs[d.spcName],l=b.pairs[e.spcName];k&&(h=d.kineticEnergy(),k.activationEnergy>=h&&d.spcName==k.spcNameHigh?dotManager.changeDotSpc([d],k.spcNameLow):k.activationEnergy<h&&d.spcName==k.spcNameLow&&dotManager.changeDotSpc([d],k.spcNameHigh));l&&(h=e.kineticEnergy(),l.activationEnergy>=h&&e.spcName==l.spcNameHigh?dotManager.changeDotSpc([e],
l.spcNameLow):l.activationEnergy<h&&e.spcName==l.spcNameLow&&dotManager.changeDotSpc([e],l.spcNameHigh));b.standardBreakUp(d,e,f)}}};function ConditionManager(){this.conditionSets={}}
ConditionManager.prototype={add:function(b){var d=this.timeStrToStamp(b.requiredFor);this.conditionSets[d]||(this.conditionSets[d]=[]);var d=this.conditionSets[d],e=this.getIfExists(b,d);b=new ConditionManager.TriggerEntry(b);e&&(b.satisfied=e.satisfied,d.splice(d.indexOf(e,1)));d.push(b)},canAdvance:function(b){var d;"number"==typeof b?d=b:/prompt/i.test(b)?d=/[0-9]+/.exec(b):/section/i.test(b)&&(d=-1);return this.checkConditions(this.conditionSets[d]||[])},checkConditions:function(b,d){d=defaultTo(!0,
d);for(var e,f=-1,h=!0,k=0;k<b.length;k++){var l=b[k],m=l.trigger;l.satisfied||(l=!0,"conditions"==m.checkOn&&!m.conditionFunc()?l=!1:!m.isSatisfied()&&!m.conditionFunc()&&(l=!1),!l&&(m.priority>f&&m.message)&&(e=m.message,f=m.priority),l||(h=!1))}d&&e&&alert(e);h&&b.map(function(b){b.satisfied=!0;/conditions/i.test(b.checkOn)&&b.recordVals()});return h},stripForInheritance:function(){for(var b in this.conditionSets)for(var d=this.conditionSets[b],e=d.length-1;0<=e;e--)d[e].satisfied&&d.splice(e,
1);return this},getIfExists:function(b,d){for(var e=0;e<d.length;e++)if(b.handle==d[e].trigger.handle)return d[e]},timeStrToStamp:function(b){return/section/i.test(b)?-1:/prompt/i.test(b)?Number(/[0-9]+/.exec(b)):isNaN(Number(b))?timeline.nowTime().promptIdx:Number(b)}};ConditionManager.TriggerEntry=function(b){this.trigger=b;this.satisfied=!1};compressorFuncs={getBinPts:function(b,d,e,f){var h=[];f=defaultTo(5,f);h.push(P(b.x-d*e.dx/2,b.y-e.dy));h.push(P(b.x-e.dx/2,b.y));h.push(P(b.x+e.dx/2,b.y));h.push(P(b.x+d*e.dx/2,b.y-e.dy));h.push(P(b.x+d*e.dx/2+f,b.y-e.dy));h.push(P(b.x+e.dx/2+f,b.y+f));h.push(P(b.x-e.dx/2-f,b.y+f));h.push(P(b.x-d*e.dx/2-f,b.y-e.dy));h.push(P(b.x-d*e.dx/2,b.y-e.dy));return h}};
objectFuncs={setupStd:function(){this.enabled=!0;this.removed=!1;this.handle&&this.addToCurLevel();this.wrapRemove()},wrapRemove:function(){var b=this.remove;this.remove=function(){this.removed=!0;this.handle&&this.removeFromCurLevel();b.apply(this)}},addToCurLevel:function(){curLevel[curLevel.key(this.type,this.handle)]=this},removeFromCurLevel:function(){var b=curLevel.key(this.type,this.handle);delete curLevel[b]},pickSliderPos:function(){var b;this.wall?b=(this.wall[0].x+this.wall[1].x)/2:this.pos&&
this.dims?b=this.pos.x+this.dims.dx/2:this.pos&&(b=this.pos.x);if(b){var d=$("#main").width()/3;b=Math.floor(b/d);if(0==b)return"left";if(1!=b&&2==b)return"right"}return this.checkForMigrateCenter()},addSlider:function(b,d,e,f,h,k){if(!h||!k){f||(f=this.pickSliderPos());switch(f){case "left":h=$(".active #sliderHolderLeft");$(".active #sliderHolderSingle").hide();$(".active #sliderHolderDouble").show();break;case "center":h=$(".active #sliderHolderCenter");$(".active #sliderHolderSingle").show();
$(".active #sliderHolderDouble").hide();break;case "right":h=$(".active #sliderHolderRight"),$(".active #sliderHolderSingle").hide(),$(".active #sliderHolderDouble").show()}k=h}f=".active #slider"+this.handle.toCapitalCamelCase();h=makeSlider(k,h,f,b,d,e);this.sliderWrapperSelectors||(this.sliderWrapperSelectors=[]);this.sliderWrapperSelectors.push(".active #"+$(k).attr("id"));this.sliderWrapperSelectors.push(".active #"+$(h).attr("id"));return f},checkForMigrateCenter:function(){return""!=$("#sliderHolderCenter").html().killWhiteSpace()?
(this.migrateCenterSlider(),"right"):"center"},migrateCenterSlider:function(){var b=$("#sliderHolderCenter").html();$("#sliderHolderCenter").html("");$("#sliderHolderLeft").html(b)},removeSlider:function(){if(this.sliderWrapperSelectors)for(var b=0;b<this.sliderWrapperSelectors.length;b++)$(this.sliderWrapperSelectors[b]).html("")},hideSliderDivs:function(){$(".active #sliderHolderSingle").hide();$(".active #sliderHolderDouble").hide()},valToPercent:function(b){return 100*(b-this.min)/(this.max-this.min)},
percentToVal:function(b){return b*(this.max-this.min)/100+this.min},pressureToMass:function(b){return b*(this.wall[1].x-this.wall[0].x)/(pConst*g)},massToPressure:function(b){return b*pConst*g/(this.wall[1].x-this.wall[0].x)},toggle:function(){this.enabled?this.disable():this.enable()}};function ActivationEnergyPair(b){this.type="ThresholdEnergyPair";spcs[b.spcNameLow]&&spcs[b.spcNameHigh]?(this.spcNameLow=b.spcNameLow,this.spcNameHigh=b.spcNameHigh,this.spcDefLow=spcs[this.spcNameLow],this.spcDefHigh=spcs[this.spcNameHigh],this.activationEnergy=b.activationEnergy,this.addToChanger(),this.setupStd()):(console.log("One of the species names in threshold energy pair is bad"),console.log("The names are "+b.spcNameLow+" and "+b.spcNameHigh))}
_.extend(ActivationEnergyPair.prototype,objectFuncs,{addToChanger:function(){activationEnergySpcChanger.addPair(this)},remove:function(){activationEnergySpcChanger.removePair(this)}});function ArrowFly(b){this.type="ArrowFly";this.pos=b.pos.copy();if(b.posFinal)this.posFinal=b.posFinal,this.UV=this.pos.VTo(this.posFinal).UV(),this.dir=this.UV.angle(),this.dist=this.pos.distTo(this.posFinal);else if(b.V)this.posFinal=this.pos.copy().movePt(b.V),this.UV=b.V.UV(),this.dir=this.UV.angle();else if((b.dir||b.UV)&&b.dist)b.dir?(this.dir=b.dir,this.UV=angleToUV(b.dir)):(this.UV=b.UV,this.dir=this.UV.angle(),this.UV=b.UV),this.posFinal=this.pos.copy().movePt(this.UV.copy().mult(b.dist)),
this.dist=b.dist;this.canvasHandle=b.canvasHandle||"main";this.dims=b.dims.copy();this.dimsFinal=defaultTo(this.dims,b.dimsFinal);this.fill=b.fill.copy();this.fillUnround={r:this.fill.r,g:this.fill.g,b:this.fill.b};this.fillFinal=defaultTo(this.fill,b.fillFinal);this.stroke=defaultTo(this.fill,b.stroke.copy());this.fade=defaultTo(!0,b.fade);this.fadeTurns=defaultTo(4,b.fadeTurns);this.strokeUnround={r:this.stroke.r,g:this.stroke.g,b:this.stroke.b};this.strokeFinal=defaultTo(this.fillFinal,b.strokeFinal);
this.alpha=defaultTo(1,b.alpha);this.alphaFinal=defaultTo(this.alpha,b.alphaFinal);this.age=0;this.lifespan=Math.round(b.lifespan/updateInterval);this.getSteps();this.pts=this.getPts();this.onFinish=b.onFinish;return this.init()}
_.extend(ArrowFly.prototype,objectFuncs,toInherit.ArrowFuncs,{getSteps:function(){var b=1/this.lifespan;this.posStep=this.pos.VTo(this.posFinal).mult(b);this.dimsStep=V(this.dimsFinal.dx-this.dims.dx,this.dimsFinal.dy-this.dims.dy).mult(b);this.fillStep={r:b*(this.fillFinal.r-this.fill.r),g:b*(this.fillFinal.g-this.fill.g),b:b*(this.fillFinal.b-this.fill.b)};this.strokeStep={r:b*(this.strokeFinal.r-this.stroke.r),g:b*(this.strokeFinal.g-this.stroke.g),b:b*(this.strokeFinal.b-this.stroke.b)};this.alphaStep=
(this.alphaFinal-this.alpha)*b},init:function(){this.updateListenerName=unique(this.type+defaultTo("",this.handle),curLevel.updateListeners);this.drawListenerName=this.updateListenerName+"Draw";canvasManager.addListener(this.canvasHandle,this.drawListenerName,this.draw,this,998);addListener(curLevel,"update",this.updateListenerName,this.run,this);this.setupStd();return this},draw:function(b){b.save();b.globalAlpha=this.alpha;b.translate(this.pos.x,this.pos.y);b.rotate(this.dir);draw.fillPtsStroke(this.pts,
this.fill,this.stroke,b);b.restore()},run:function(){this.takeStep();this.age++;this.age==this.lifespan&&(this.onFinish&&this.onFinish.func.apply(this.onFinish.obj),this.fade?(this.alphaStep=-this.alpha/this.fadeTurns,this.remove(),this.updateListenerName=unique(this.type+defaultTo("",this.handle)+"fade",curLevel.updateListeners),addListener(curLevel,"update",this.updateListenerName,this.runFade,this),this.addCleanUp()):this.remove())},runFade:function(){this.drawCanvas.save();this.drawCanvas.globalAlpha=
this.alpha;this.drawCanvas.translate(this.pos.x,this.pos.y);this.drawCanvas.rotate(this.dir);draw.fillPtsStroke(this.pts,this.fill,this.stroke,this.drawCanvas);this.drawCanvas.restore();this.takeStepFade();this.age++;this.age==this.lifespan+this.fadeTurns&&this.remove()},scale:function(){for(var b=(this.dims.dx+this.dimsStep.dx)/this.dims.dx,d=(this.dims.dy+this.dimsStep.dy)/this.dims.dy,e=0;e<this.pts.length;e++)this.pts[e].x*=b,this.pts[e].y*=d},takeStep:function(){this.pos.movePt(this.posStep);
this.dims.add(this.dimsStep);this.scale();this.alpha+=this.alphaStep;this.fillUnround.r+=this.fillStep.r;this.fillUnround.g+=this.fillStep.g;this.fillUnround.b+=this.fillStep.b;this.strokeUnround.r+=this.strokeStep.r;this.strokeUnround.g+=this.strokeStep.g;this.strokeUnround.b+=this.strokeStep.b;this.fill.setFromUnround(this.fillUnround);this.stroke.setFromUnround(this.strokeUnround)},takeStepFade:function(){this.pos.movePt(this.posStep);this.dims.add(this.dimsStep);this.scale();this.alpha+=this.alphaStep},
remove:function(){canvasManager.removeListener(this.canvasHandle,this.drawListenerName);removeListener(curLevel,"update",this.updateListenerName)}});function ArrowLine(b,d,e,f,h){this.handle=b;this.pts={line:d,arrow:Array(3)};this.col=e;this.canvasHandle="string"===typeof h?h:"main";b=this.pts.line[this.pts.line.length-1];e=b.VTo(this.pts.line[this.pts.line.length-2]).UV();d=e.copy().rotate(0.5);e=e.copy().rotate(-0.5);this.pts.arrow[0]=b.copy().movePt(d.mult(10));this.pts.arrow[1]=b;this.pts.arrow[2]=b.copy().movePt(e.mult(10));return this.show(f)}
ArrowLine.prototype={draw:function(b){for(var d=this.pts.line,e=0;e<d.length-1;e++)draw.line(d[e],d[e+1],this.col,b);d=this.pts.arrow;draw.line(d[0],d[1],this.col,b);draw.line(d[1],d[2],this.col,b)},show:function(b){canvasManager.addListener(this.canvasHandle,"drawArrow"+this.handle,this.draw,this,2);addListener(curLevel,"update","updateArrow"+this.handle,this.makeDrawFunc(b),this);return this},makeDrawFunc:function(b){var d=0;return void 0!==b?function(){d++>=b&&(canvasManager.removeListener(this.canvasHandle,
"drawArrow"+this.handle),removeListener(curLevel,"update","updateArrow"+this.handle))}:function(){}},hide:function(){canvasManager.removeListener(this.handleHandle,"drawArrow"+this.handle);removeListener(curLevel,"update","updateArrow"+this.handle)}};function ArrowStatic(b){this.type="ArrowStatic";this.pos=b.pos.copy();this.dims=b.dims.copy();this.handle=b.handle;this.pts=this.getPts();this.canvasHandle=b.canvasHandle||"main";this.label=b.label?b.label:!1;b.angle?this.angle=b.angle:b.UV&&(this.angle=UVToAngle(b.UV));this.setTextOffset();this.fill=b.fill.copy();this.textCol=defaultTo(Col(255,255,255),b.textCol);this.stroke=defaultTo(b.stroke,Col(0,0,0));this.init()}
_.extend(ArrowStatic.prototype,objectFuncs,toInherit.ArrowFuncs,{init:function(){this.drawListenerName="arrowStatic"+this.handle;this.label?canvasManager.addListener(this.canvasHandle,this.drawListenerName,this.runLabel,this,2):canvasManager.addListener(this.canvasHandle,this.drawListenerName,this.runNoLabel,this,2);this.setupStd()},runLabel:function(b){b.save();b.translate(this.pos.x,this.pos.y);b.rotate(this.angle);draw.fillPtsStroke(this.pts,this.fill,this.stroke,b);b.translate(this.textOffset.dx,
this.textOffset.dy);b.rotate(-this.angle);draw.text(this.label,P(0,0),"13pt calibri",this.textCol,"center",0,b);b.restore()},runNoLabel:function(b){b.save();b.translate(this.pos.x,this.pos.y);b.rotate(this.angle);draw.fillPtsStroke(this.pts,this.fill,this.stroke,b);b.restore()},setTextOffset:function(){this.textOffset=V(7+5*Math.sin(Math.abs(-this.angle)),5*Math.cos(this.angle))},getDims:function(){return this.dims},move:function(b){this.pos.movePt(b);return this},scale:function(b){this.dims.multVec(b);
this.pts=this.getPts();return this},size:function(b){this.dims=b.copy();this.pts=this.getPts();return this},rotate:function(b){this.angle+=b;this.setTextOffset();return this},getAngle:function(){return this.angle},setFill:function(b){this.fill=b.copy()},setStroke:function(b){this.stroke=b.copy()},remove:function(){canvasManager.removeListener(this.canvasHandle,this.drawListenerName)}});function Cell(b){this.type="Cell";this.handle=b.handle;var d=b.pos;this.nodeMass=b.nodeMass||700;var e=b.rad;this.canvasHandle=b.canvasHandle||"main";var f=d.copy().movePt(V(e,e)),h=Math.max(3,b.numCorners)||8;this.membraneColor=b.col;this.sideLenMin=15;this.energyTransferMax=0.5;this.guideNodes=this.makeGuideNodes(d,e,h,this.nodeMass);d=this.makeOuterWallPts(this.guideNodes,10);e=this.makeInnerWallPts(this.guideNodes,10);this.outerWall=walls.addWall({pts:d,handle:"cell"+this.handle.toCapitalCamelCase()+
"Outer",handler:"staticAdiabatic",show:!1,record:!1,col:Col(255,255,255)});this.innerWall=walls.addWall({pts:e,handle:"cell"+this.handle.toCapitalCamelCase()+"Inner",handler:"staticAdiabatic",show:!1,record:!0,col:Col(255,255,255)});this.outerWall.recordVol();this.innerWall.hitThreshold=10;this.outerWall.hitThreshold=10;this.parentWallMemberTag=b.parentWallHandle;walls[this.parentWallMemberTag].containedWalls.push(this.outerWall);this.cellMemberTag=this.innerWall.handle;d=b.innerChanceTransport||
{};e=b.outerChanceTransport||{};this.fillInUnspecdSpcs(d);this.fillInUnspecdSpcs(e);this.assignWallHandlers(this.guideNodes,this.innerWall,this.outerWall,this.parentWallMemberTag,this.cellMemberTag,this.energyTransferMax,d,e,10);this.wallUpdateListenerName=this.addWallUpdateListener(this.guideNodes,this.innerWall,this.outerWall,this.handle,10,this.sideLenMin,b.boundingCorner,b.boundingVector,this.wallColor);this.drawListenerName=this.addDrawListener(this.guideNodes,this.innerWall,this.outerWall,this.membraneColor,
this.canvasHandle);this.dotId=timeline.takeNumber();this.addDots(f,this.innerWall,b.dots||{},b.temp,this.dotId,this.cellMemberTag);this.energyBank=this.energyToTransfer=0;this.energyBankMax=20;this.calcHeatTransferListenerName="calcHeatTrans"+this.handle;this.setupCalcHeatTransfer(this.calcHeatTransferListenerName,this.innerWall,walls[b.parentWallHandle]);window.dotMigrator.migrateDots(window.dotManager.get({tag:this.parentWallMemberTag}),[this.parentWallMemberTag],"only",[this.outerWall.handle],
"or");this.setupStd()}
_.extend(Cell.prototype,objectFuncs,{makeGuideNodes:function(b,d,e,f){center=b.copy().movePt(V(d,d));b=[];for(var h=0,k=Math.PI*(e-2)/e,l=2*Math.PI/e,m=0;m<e;m++){var n=P(center.x+d*Math.cos(h),center.y+d*Math.sin(h));b.push(new Cell.GuideNode(n,f,k));h+=l}for(m=0;m<b.length;m++)b[m].prev=0==m?b[b.length-1]:b[m-1],b[m].next=m==b.length-1?b[0]:b[m+1];return b},fillInUnspecdSpcs:function(b){for(var d=0;d<LevelData.spcDefs.length;d++){var e=LevelData.spcDefs[d].spcName;void 0===b[e]&&(b[e]=0)}},makeOuterWallPts:function(b,
d){for(var e=[],f=0,h=b[0];f<b.length;){h.prev.outerWallIdx=f;var k=h.next.pos.VTo(h.pos).perp("ccw"),l=h.pos.VTo(h.prev.pos).perp("ccw"),k=h.pos.copy().movePt(k.add(l).UV().mult(d/2));e.push(k);f++;h=h.prev}return e},makeInnerWallPts:function(b,d){for(var e=[],f=0,h=b[0];f<b.length;){h.innerWallIdx=f;var k=h.prev.pos.VTo(h.pos).perp("ccw"),l=h.pos.VTo(h.next.pos).perp("ccw"),k=h.pos.copy().movePt(k.add(l).UV().mult(d/2));e.push(k);f++;h=h.next}return e},assignWallHandlers:function(b,d,e,f,h,k,l,
m,n){for(var p=0;p<b.length;p++)this.assignWallHandler(d,b[p].innerWallIdx,e,b[p].outerWallIdx,b[p],b[p].next,h,f,-1,k,l,n),this.assignWallHandler(e,b[p].outerWallIdx,d,b[p].innerWallIdx,b[p].next,b[p],f,h,1,k,m,n)},assignWallHandler:function(b,d,e,f,h,k,l,m,n,p,r,s){walls.setSubWallHandler(b.handle,d,{func:function(b,d,w,x,y,z){if(b.tag==l)if(Math.random()<r[b.spcName])this.transferDot(b,m,z,s);else{d=x.dx*(k.pos.x-h.pos.x)+x.dy*(k.pos.y-h.pos.y);var F=x.dx*(b.x-h.pos.x)+x.dy*(b.y-h.pos.y),C=-x.dx*
(b.x-k.pos.x)-x.dy*(b.y-k.pos.y);w=new Point(h.pos.x+0.5*x.dx*d,h.pos.y+0.5*x.dy*d);var F=F/d,A=C/d;vecNodeAPerp=z.copy().mult(h.v.dotProd(z));vecNodeBPerp=z.copy().mult(k.v.dotProd(z));h.v.dx-=vecNodeAPerp.dx;h.v.dy-=vecNodeAPerp.dy;k.v.dx-=vecNodeBPerp.dx;k.v.dy-=vecNodeBPerp.dy;var C=vecNodeAPerp.dx*z.dx+vecNodeAPerp.dy*z.dy,v=vecNodeBPerp.dx*z.dx+vecNodeBPerp.dy*z.dy,F=y+(1-F)*C+(1-A)*v;y=-0.5*(C+v);C+=y;v=h.m*w.distSqrTo(h.pos)+k.m*w.distSqrTo(k.pos);x=x.dx*(b.x-w.x)+x.dy*(b.y-w.y);w=-2*F/(1/
b.m+1/(h.m+k.m)+x*x/v);b.v.dx-=z.dx*w/b.m;b.v.dy-=z.dy*w/b.m;x=0.5*(C/(0.5*d)-x*w/v)*d;vWallTrans_F=y-w/(h.m+k.m);d=-(vWallTrans_F-x);x=-(vWallTrans_F+x);h.v.dx+=z.dx*d;h.v.dy+=z.dy*d;k.v.dx+=z.dx*x;k.v.dy+=z.dy*x;b.x+=z.dx;b.y+=z.dy;z=n*this.energyToTransfer;0<z?(z=Math.min(z,Math.min(this.energyBank,p)),b.addEnergy(z),this.energyBank-=z,this.energyToTransfer-=z*n):(z=Math.min(this.energyBank-z,Math.min(this.energyBankMax-this.energyBank,Math.min(p,Math.max(0,(b.temp()-10)*b.cv)))),b.addEnergy(-z),
this.energyBank+=z)}else b.tag==m&&(z=e.handlers[f],z.func.apply(z.obj,[b,e,f,e.wallUVs[f],-b.v.dotProd(e.wallPerpUVs[f]),e.wallPerpUVs[f]]))},obj:this})},transferDot:function(b,d,e,f){f=2*b.r+f;b.x-=f*e.dx;b.y-=f*e.dy;dotManager.changeDotWall(b,d)},addWallUpdateListener:function(b,d,e,f,h,k,l,m){var n=l.x,p=l.x+m.dx,r=l.y,s=l.y+m.dy;addListener(curLevel,"wallMove","moveCell"+this.handle.toCapitalCamelCase(),function(){for(var f=0;f<b.length;f++)b[f].pos.x+=b[f].v.dx,b[f].pos.y+=b[f].v.dy,b[f].v.dx*=
0.995,b[f].v.dy*=0.995,e[b[f].prev.outerWallIdx].x<n?this.containCell(b,"x",1,this.handle):e[b[f].prev.outerWallIdx].x>p&&this.containCell(b,"x",-1,this.handle),e[b[f].prev.outerWallIdx].y<r?this.containCell(b,"y",1,this.handle):e[b[f].prev.outerWallIdx].y>s&&this.containCell(b,"y",-1,this.handle);for(f=0;f<b.length;f++){var l=b[f],m=l.prev.pos.UVTo(l.pos).perp("cw"),x=l.next.pos.UVTo(l.pos).perp("ccw"),m=m.add(x).UV();this.addAngleForce(l,l.prev,l.next,new Vector(-m.dx,-m.dy));this.addExpansionForce(l,
l.next,k);e[l.outerWallIdx+1].x=l.pos.x+m.dx*h/2;e[l.outerWallIdx+1].y=l.pos.y+m.dy*h/2;d[l.innerWallIdx].x=l.pos.x-m.dx*h/2;d[l.innerWallIdx].y=l.pos.y-m.dy*h/2}e[0].x=e[e.length-1].x;e[0].y=e[e.length-1].y;d[d.length-1].x=d[0].x;d[d.length-1].y=d[0].y;window.walls.setupWall(walls.indexOf(d));window.walls.setupWall(walls.indexOf(e))},this)},addAngleForce:function(b,d,e,f){d=this.angleBetweenPts(b.pos,d.pos,e.pos,f);b.v.dx-=3*f.dx*(d-b.nativeAngle);b.v.dy-=3*f.dy*(d-b.nativeAngle)},addExpansionForce:function(b,
d,e){var f=b.pos.VTo(d.pos);f.magSqr()<e*e&&(e=f.UV(),d.v.dx+=0.2*e.dx,d.v.dy+=0.2*e.dy,b.v.dx-=0.2*e.dx,b.v.dy-=0.2*e.dy)},angleBetweenPts:function(b,d,e,f){f=Math.atan2(f.dy,f.dx);d=b.VTo(d);b=b.VTo(e);e=Math.atan2(d.dy,d.dx);b=Math.atan2(b.dy,b.dx);return this.distBetweenAngles(e,f)+this.distBetweenAngles(f,b)},distBetweenAngles:function(b,d){0>b&&(b+=2*Math.PI);0>d&&(d+=2*Math.PI);var e=Math.max(b,d)-Math.min(b,d);return e>Math.PI?2*Math.PI-e:e},containCell:function(b,d,e,f){var h="contain"+f+
d+e,k=0;listenerExists(curLevel,"update",h)||addListener(curLevel,"update",h,function(){for(var f=2*e/15*Math.sqrt(k*(15-k)),m=0;m<b.length;m++)b[m].pos[d]+=f;k++;15==k&&removeListener(curLevel,"update",h)},void 0)},addDrawListener:function(b,d,e,f,h){canvasManager.addListener(h,"drawCell"+this.handle,function(h){for(var l=0;l<b.length;l++){var m=b[l];draw.fillPts([d[m.innerWallIdx],d[m.next.innerWallIdx],e[m.outerWallIdx],e[m.prev.outerWallIdx]],f,h)}},this,1)},setupCalcHeatTransfer:function(b,d,
e){var f=d.getDataSrc("temp"),h=e.getDataSrc("temp");addListener(curLevel,"update",b,function(){var b=d.Cp(),l=e.Cp();this.energyToTransfer=((b*f[f.length-1]+l*h[h.length-1])/(b+l)-h[h.length-1])*l},this)},addDots:function(b,d,e,f,h,k){for(var l in e){var m=window.spcs[l];m||console.log("Bad species name sent to cell: "+l);for(var n=e[l],p=Math.floor(e[l]/(2*(d.length-1))),r=0;r<d.length-1;r++){var s=d[r],t=d[r+1],u=b.VTo(s.avg(t)).UV();this.populateRightTriangle(b,s,s.avg(t),p,m,f,u,k,h,l);this.populateRightTriangle(b,
t,s.avg(t),p,m,f,u,k,h,l);n-=2*p}this.populateRightTriangle(b,s,s.avg(t),n,m,f,u,k,h,l)}},populateRightTriangle:function(b,d,e,f,h,k,l,m,n,p){h=l.copy().perp("cw");0>e.VTo(d).dotProd(h)&&(h=l.copy().perp("ccw"));var r=[];d=e.distTo(d);e=b.distTo(e);for(var s=0;s<f;s++){var t=Math.sqrt(Math.random())*e,u=Math.random()*d*t/e,w=b.x+l.dx*t+h.dx*u,t=b.y+l.dy*t+h.dy*u,u=V(Math.random()-0.5,Math.random()-0.5).UV();r.push(new Dot(w,t,u,p,m,n,m));r[r.length-1].setTemp(k)}window.dotManager.add(r)},remove:function(){walls[this.parentWallHandle].removeContainedWall(this.outerWall);
walls.removeWall(this.innerWall.handle);walls.removeWall(this.outerWall.handle);dotManager.removeByAttr("elemId",this.dotId);removeListener(curLevel,"update","moveCell"+this.handle.toCapitalCamelCase());canvasManager.removeListener(this.canvasHandle,"drawCell"+this.handle)}});Cell.GuideNode=function(b,d,e){this.pos=b;this.prev=this.next=void 0;this.v=V(0,0);this.m=d;this.outerWallIdx=this.innerWallIdx=void 0;this.nativeAngle=e};Cell.GuideNode.prototype={};function CheckMark(b,d,e,f,h){var k=P(b.x,b.y+0.6*d.dy),l=P(b.x+0.4*d.dx,b.y+d.dy),m=P(b.x+d.dx,b.y);b=P(b.x+0.35*d.dx,b.y+0.75*d.dy);this.pts=[k,l,m,b];this.col=e;this.stroke=f;this.drawCanvas=h}CheckMark.prototype={draw:function(){draw.fillPtsStroke(this.pts,this.col,this.stroke,this.drawCanvas)},setCanvas:function(b){this.drawCanvas=b}};function Clamps(b){this.type="Clamps";this.handle=b.handle;this.draw=defaultTo(!1,b.draw);this.releaseWith=defaultTo("button",b.releaseWith);this.currentClamper=void 0;this.clamps=b.clamps;this.wall=walls[b.wallInfo];this.buttonId="clampRelease"+this.wall.handle;this.wallHandler=this.wall.parent.getSubWallHandler(this.wall.handle,0);this.init()}
_.extend(Clamps.prototype,objectFuncs,{init:function(){this.setupStd();this.wall.moveStop();this.assembleClamps();"button"==this.releaseWith?this.makeReleaseButton():this.setupClampClicking();this.draw&&this.drawClamps();this.freezeWall()},assembleClamps:function(){for(var b=0;b<this.clamps.length;b++){var d=this.clamps[b];d.vol&&(d.y=this.wall.volToY(d.vol),delete d.vol);d.clamping=!1}this.sortClamps();this.addInitClamp()},sortClamps:function(){for(var b=0;b<this.clamps.length;b++){for(var d=!1,
e=0;e<this.clamps.length-1;e++)this.clamps[e].y>this.clamps[e+1].y&&(this.clamps.switchElements(e,e+1),d=!0);if(!d)break}},addInitClamp:function(){for(var b=this.wall[0].y,d=0;d<this.clamps.length;d++)if(this.clamps[d].y>b){this.clamps.splice(d,0,{y:b,clamping:!0});this.currentClamper=this.clamps[d];break}},makeReleaseButton:function(){var b=this;addButton(this.buttonId,"Release");$("#"+this.buttonId).click(function(){b.release()})},removeReleaseButton:function(){removeButton(this.buttonId)},release:function(){var b=
void 0,d=void 0;this.currentClamper.clamping=!1;var e=this.clamps.indexOf(this.currentClamper),f=this.clamps[e+1],e=this.clamps[e-1];f&&(b=f.y);e&&(d=e.y);var h=this;this.wall.releaseWithBounds(d,b,this.wallHandler,function(b){h.activateClamp(b)})},activateClamp:function(b){var d=this.clamps.indexOf(this.currentClamper);this.currentClamper.clamping=!1;this.currentClamper=b<this.currentClamper.y?this.clamps[d-1]:this.clamps[d+1];this.currentClamper.clamping=!0;this.freezeWall()},freezeWall:function(){walls.setSubWallHandler(this.wall.handle,
0,"staticAdiabatic")},remove:function(){this.wall.removed||(this.wall.moveInit(),this.wall.parent.setSubWallHandler(walls.indexOf(this.wall),0,this.wallHandler));"button"==this.releaseWith&&this.removeReleaseButton()}});function CompArrow(b){this.type="CompArrow";var d=defaultTo(0,b.wallInfo),e=defaultTo(1.5,b.speed),f=defaultTo("adiabatic",b.compMode),h=defaultTo(!0,b.stops),k=defaultTo({y:{min:30,max:350}},b.bounds);this.wall=walls[d];var l={};l.outer=Col(44,118,172);l.onClick=Col(44,118,172);l.inner=curLevel.bgCol.copy();var m=V(25,15),n="volDragger"+defaultTo("",b.handle);b=b.canvasHandle||"main";var p=canvas,r={};h&&(this.stops=new Stops({stopPt:{height:k.y.max},wallInfo:d}));var s=this.wall;r.onDown=function(){};
r.onMove=function(){s.changeSetPt(this.pos.y,f,e)};r.onUp=function(){};this.dragArrowFunc=this.makeDragArrowFunc(this.wall,0,l,m,n,b,p,r,k);this.dragArrow=this.dragArrowFunc();this.setupStd();return this}
_.extend(CompArrow.prototype,objectFuncs,{remove:function(){this.dragArrow.remove();this.stop&&this.stops.remove()},makeDragArrowFunc:function(b,d,e,f,h,k,l,m,n){return function(){var p=b[1].copy();return(new DragArrow(p,d,e,f,h,k,l,m,n)).show()}},enable:function(){this.dragArrow.setPos(this.wall[1].copy());this.dragArrow.show();this.enabled=!0},disable:function(){this.dragArrow.hide();this.enabled=!1}});function DragArrow(b,d,e,f,h,k,l,m,n){this.type="DragArrow";this.pos=b;this.rotation=d;this.posInit=this.pos.copy();this.cols=e;this.dims=f;this.handle=h;this.listeners=m;this.canvasHandle=k||"main";this.canvasElement=l;this.bounds=n;this.bounds.x?(this.bounds.x.max||(this.bounds.x.max=l.width-f.dx),this.bounds.x.min||(this.bounds.x.min=0)):this.bounds.x={min:0,max:l.width-f.dx};this.bounds.y?(this.bounds.y.max||(this.bounds.y.max=l.height-f.dy),this.bounds.y.min||(this.bounds.y.min=0)):this.bounds.y=
{min:0,max:l.height-f.dy};this.pts={};this.pts.outer=[];this.pts.inner=[];b=this.dims.dx;d=this.dims.dy;this.pts.outer.push(P(0,0));this.pts.outer.push(P(0.9*b,-d/2));this.pts.outer.push(P(b,0));this.pts.outer.push(P(0.9*b,d/2));this.pts.outer.push(P(0,0));this.dirUV=V(Math.cos(this.rotation+Math.PI/2),Math.sin(this.rotation+Math.PI/2));this.draw=this.makeDrawFunc();this.clickListeners=this.makeListenerFuncs()}
DragArrow.prototype={makeDrawFunc:function(){var b,d=this;b=[function(b){b.save();b.translate(d.pos.x,d.pos.y);b.rotate(d.rotation)}];this.cols.stroke?b.push(function(b){draw.fillPtsStroke(d.pts.outer,d.cols.outer,d.cols.stroke,b)}):b.push(function(b){draw.fillPts(d.pts.outer,d.cols.outer,b)});if(this.cols.inner||this.cols.onClick){for(var e=0;e<this.pts.outer.length;e++){var f=this.pts.outer[e].copy().movePt({dx:-this.dims.dx/2}).scale(P(0,0),0.6).movePt({dx:this.dims.dx/2});this.pts.inner.push(f)}this.cols.curInner=
this.cols.inner?this.cols.inner:this.cols.outer;b.push(function(b){draw.fillPts(d.pts.inner,d.cols.curInner,b)})}b.push(function(b){b.restore()});return function(d){for(var e=0;e<b.length;e++)b[e](d)}},makeListenerFuncs:function(){var b=this.listeners,d=this;d.amSelected=new Boolean;if(b.onDown||b.onMove||b.onUp){var e=function(){};d.cols.onClick&&(e=extend(e,function(){d.cols.curInner=d.cols.onClick}));var e=extend(e,function(){b.onDown.apply(d)}),f=this.makeMoveListenerFunc(d),e=extend(e,f);b.onUp&&
(f=this.makeUpListenerFunc(d),e=extend(e,f));return function(){d.amSelected=d.checkSelected();d.amSelected&&(d.posInit=d.pos.copy(),d.mouseInit=mouseOffset(d.canvasElement),e())}}},makeMoveListenerFunc:function(b){var d=b.listeners,e=function(){var d=mouseOffset(b.canvasElement),e=V(d.x-b.mouseInit.x,d.y-b.mouseInit.y).dotProd(b.dirUV),d=b.posInit.x+e*Math.cos(b.rotation+Math.PI/2),e=b.posInit.y+e*Math.sin(b.rotation+Math.PI/2);b.pos.x=Math.max(b.bounds.x.min,Math.min(d,b.bounds.x.max));b.pos.y=Math.max(b.bounds.y.min,
Math.min(e,b.bounds.y.max))};d.onMove&&(e=extend(e,function(){d.onMove.apply(b)}));var f=function(){addListener(curLevel,"mouseup","dragArrow"+b.handle+"RemoveMove",function(){removeListener(curLevel,"mousemove","dragArrow"+b.handle);removeListener(curLevel,"mouseup","dragArrow"+b.handle+"RemoveMove")},"")};return function(){addListener(curLevel,"mousemove","dragArrow"+b.handle,e,"");f()}},makeUpListenerFunc:function(b){var d=function(){addListener(curLevel,"mouseup","mouseup"+b.handle,function(){b.listeners.onUp.apply(b)},
"");addListener(curLevel,"mouseup","mouseup"+b.handle+"remove",function(){removeListener(curLevel,"mouseup","mouseup"+b.handle);removeListener(curLevel,"mouseup","mouseup"+b.handle+"remove")},"")};if(b.cols.onClick)var e=function(){},e=b.cols.inner?extend(e,function(){b.cols.curInner=b.cols.inner}):extend(e,function(){b.cols.curInner=b.cols.outer}),d=extend(d,function(){addListener(curLevel,"mouseup","revertCols"+b.handle,function(){e();removeListener(curLevel,"mouseup","revertCols"+b.handle)},"")});
return d},setPos:function(b){"number"==typeof b.x&&(this.pos.x=b.x);"number"==typeof b.y&&(this.pos.y=b.y)},show:function(){addListener(curLevel,"mousedown","dragArrow"+this.handle,this.clickListeners,"");canvasManager.addListener(this.canvasHandle,"drawDragArrow"+this.handle,this.draw,this,2);return this},hide:function(){removeListener(curLevel,"mousedown","dragArrow"+this.handle);canvasManager.removeListener(this.canvasHandle,"drawDragArrow"+this.handle);return this},reset:function(){this.pos=this.posInit.copy();
removeListener(curLevel,"update","moveWall");return this},remove:function(){removeListener(curLevel,"mousedown","dragArrow"+this.handle);removeListener(curLevel,"update","drawDragArrow"+this.handle)},checkSelected:function(){var b=mouseOffset(this.canvasElement).rotate(this.pos,-this.rotation),d=this.pos.copy().movePt({dy:-this.dims.dy/2});return ptInRect(d,this.dims,b)}};function DragWeights(b){this.type="DragWeights";this.handle=b.handle;this.wallInfo=defaultTo(0,b.wallInfo);this.wall=walls[this.wallInfo];this.zeroY=defaultTo(this.wall[2].y,b.min);this.pistonPt=defaultTo(this.wall[0],b.pistonPt);this.pistonOffset=defaultTo(void 0,b.pistonOffset);this.wallHandler=defaultTo("cPAdiabaticDamped",b.compMode);this.storeBinY=defaultTo(myCanvas.height-15,b.storeBinY);this.blockCol=defaultTo(Col(224,165,75),b.blockCol);this.binCol=defaultTo(Col(150,150,150),b.binCol);void 0!==
b.pInit?this.massInit=this.pressureToMass(b.pInit):this.massInit=this.pressureToMass(1);this.binHeight=defaultTo(45,b.binHeight);this.weightDimRatio=defaultTo(0.5,b.weightDimRatio);this.moveSpeed=defaultTo(20,b.moveSpeed);this.weightScalar=defaultTo(70,b.weightScalar);this.displayText=defaultTo(!0,b.displayText);this.imgSrc=this.binSlant=1.3;this.storeBinWidth=110;this.storeBinSpacing=60;this.pistonBinWidth=150;this.pistonBinSpacing=15;this.blockSpacing=2;this.mass=this.massInit;this.img=this.makeImg("brickImg");
this.massChunkName="dragWeights";this.weightsOnPiston=[];this.font="12pt Calibri";this.fontCol=Col(255,255,255);this.binThickness=5;this.canvasHandle=b.canvasHandle||"main";this.trackingPts=[];this.wall.setMass(this.massChunkName,this.massInit);this.wall.recordPExt();this.wall.recordWork();this.wall.recordMass();this.weightGroups=this.makeWeightGroups(b.weightDefs);this.addWeights(this.weightGroups);this.setupStd();this.init(b.weightDefs)}
_.extend(DragWeights.prototype,objectFuncs,compressorFuncs,{init:function(){this.bins=new DragWeights.Bins(this,this.wall,this.weightGroups,this.storeBinSpacing,this.pistonBinSpacing,this.blockSpacing,this.pistonOffset,this.pistonPt,this.storeBinWidth,this.pistonBinWidth,this.storeBinY);this.savedWallHandler=this.wall.handlers[0];walls.setSubWallHandler(this.wallInfo,0,this.wallHandler);this.displayText||(this.draw=this.drawNoText);canvasManager.addListener(this.canvasHandle,"drawDragWeights"+this.wallInfo,
this.draw,this,1);this.enable();this.wall.moveInit();this.dropAllIntoBins("instant");delete this.tempWeightDefs;return this},remove:function(){this.wall.moveStop();this.trackingPts.map(function(b){b.trackStop()});this.trackingPts.splice(0,this.trackingPts.length);walls.setSubWallHandler(walls.indexOf(this.wall),0,this.savedWallHandler);canvasManager.removeListener(this.canvasHandle,"drawDragWeights"+this.wallInfo);removeListener(curLevel,"mousedown","weights"+this.wallInfo)},getWeightDims:function(b){for(var d=
{},e=this.storeBinWidth-this.blockSpacing,f=0,h=0,k=0;k<b.length;k++){var l=b[k],m=Math.sqrt(l.mass*this.weightScalar/this.weightDimRatio);Math.max(m,f)>f&&(h=l.mass,f=m);d[l.handle]=V(m,m*this.weightDimRatio)}return f>e?(this.weightScalar=0.99*e*e*this.weightDimRatio/h,this.getWeightDims(b)):d},addDefHandles:function(b){for(var d=0;d<b.length;d++)b[d].handle="grp"+d},assignMasses:function(b){for(var d=0;d<b.length;d++)weightDef=b[d],weightDef.mass=this.pressureToMass(weightDef.pressure)},makeWeightGroups:function(b){this.addDefHandles(b);
var d={};this.assignMasses(b);for(var e=this.getWeightDims(b),f=0;f<b.length;f++){var h=b[f],h=new DragWeights.WeightGroup(h.handle,h.pressure,h.mass,e[h.handle],h.count);d[h.handle]=h}return d},addWeights:function(b){var d=0,e;for(e in b)for(var f=b[e],h=0;h<f.count;h++)f.weights.push(new DragWeights.Weight(P(300,500),f.handle,"",d++))},binIsEmpty:function(b,d){var e=this.bins[b][d].slots;for(rowIdx=0;rowIdx<e.length;rowIdx++)for(var f=e[rowIdx],h=0;h<f.length;h++)if(f[h].isFull)return!1;return!0},
weightCount:function(b,d){var e=this.bins[b][d].slots,f=0;for(rowIdx=0;rowIdx<e.length;rowIdx++)for(var h=e[rowIdx],k=0;k<h.length;k++)f+=h[k].isFull;return f},binIsFull:function(b,d){var e=this.bins[b][d].slots;for(rowIdx=0;rowIdx<e.length;rowIdx++)for(var f=e[rowIdx],h=0;h<f.length;h++)if(!f[h].isFull)return!1;return!0},allEmpty:function(b){var d=!0,e;for(e in this.bins[b])d=Math.min(d,this.binIsEmpty(b,e));return d},getPistonMass:function(){var b=0,d;for(d in this.weightGroups)for(var e=this.weightGroups[d],
f=e.weights,e=e.mass,h=0;h<f.length;h++)"piston"==f[h].status&&(b+=e);return b+this.massInit},dropAllIntoBins:function(b){for(var d in this.weightGroups)for(var e=this.weightGroups[d],f=0;f<e.weights.length;f++){var h=e.weights[f];"piston"==h.status?(h.status="inTransit",h.slot.isFull=!1,this.takeOffPiston(h),this.dropIntoBin(h,"store",b)):"store"!=h.status&&(h.status="inTransit",this.dropIntoBin(h,"store",b))}return this},dropAllOntoPiston:function(b){for(var d in this.weightGroups)for(var e=this.weightGroups[d],
f=0;f<e.weights.length;f++){var h=e.weights[f];"store"==h.status?(h.status="inTransit",h.slot.isFull=!1,this.takeOffPiston(h),this.dropIntoBin(h,"piston",b)):"piston"!=h.status&&(h.status="inTransit",this.dropIntoBin(h,"piston",b))}return this},dropIntoBin:function(b,d,e){var f=this;b.status="inTransit";var h=this.getDropSlot(b.groupHandle,d),k=h.slot;k.isFull=!0;b.slot=k;h=h.id;if("instant"==e)this.dropInstant(b,k);else{e=b.groupHandle+b.id+"endId"+this.wallInfo;var l="moveWeight"+e+d+h;removeListenerByName(curLevel,
"update",e)&&(b.slot.isFull=!1,b.slot=void 0);addListener(curLevel,"update",l,function(){var d=k.pos,e=V(d.x-b.pos.x,d.y-b.pos.y).UV();!1!==validNumber(e.dx)&&!1!==validNumber(e.dy)&&(b.pos.x=stepTowards(b.pos.x,d.x,e.dx*this.moveSpeed),b.pos.y=stepTowards(b.pos.y,d.y,e.dy*this.moveSpeed));this.weightArrived(b,k)&&(removeListener(curLevel,"update",l),f.placeWeight(b,k))},this)}},placeWeight:function(b,d){b.status=d.type;"piston"==b.status&&this.putOnPiston(b,d)},dropInstant:function(b,d){b.pos=d.pos.copy();
this.placeWeight(b,d)},weightArrived:function(b,d){return b.pos.sameAs(d.pos)},getDropSlot:function(b,d){for(var e=this.bins[d][b],f=0;f<e.slots.length;f++)for(var h=e.slots[f],k=0;k<h.length;k++){var l=e.slots[f][k];if(!l.isFull)return{slot:l,id:String(f)+String(k)}}alert("BOX IS FULL!  WHY IS THIS HAPPENING?")},draw:function(b){this.drawWeights(b);this.drawBins(b);this.drawBinLabels(b)},drawNoText:function(b){this.drawWeights(b);this.drawBins(b)},drawWeights:function(b){for(var d in this.weightGroups){var e=
this.weightGroups[d],f=e.weights,e=e.dims;if(this.img){b.save();b.scale(e.dx/this.img.width,e.dy/this.img.height);for(var h=0;h<f.length;h++)b.drawImage(this.img,f[h].pos.x*this.img.width/e.dx,f[h].pos.y*this.img.height/e.dy);b.restore()}else for(h=0;h<f.length;h++)draw.fillRect(f[h].pos,e,this.blockCol,b)}},drawBins:function(b){for(var d in this.bins){var e=this.bins[d],f;for(f in e){var h=e[f];h.visible&&draw.fillPts(h.pts,this.binCol,b)}}},drawBinLabels:function(b){for(var d in this.bins.store){var e=
this.bins.store[d];e.visible&&draw.text(this.weightGroups[d].pressure+" bar each",P(e.x+this.storeBinWidth/2,e.y-this.binHeight),this.font,this.fontCol,"center",0,b)}},putOnPiston:function(b,d){this.weightsOnPiston.push(b);b.pos.track({pt:d.pos,noTrack:"x"});this.trackingPts.push(b.pos);b.status="piston";this.mass=this.getPistonMass();this.wall.setMass(this.massChunkName,this.mass)},takeOffPiston:function(b){for(var d=0;d<this.weightsOnPiston.length;d++)b==this.weightsOnPiston[d]&&this.weightsOnPiston.splice([d],
1);b.pos.trackStop();this.trackingPts.splice(this.trackingPts.indexOf(b.pos),1);this.mass=this.getPistonMass();this.wall.setMass(this.massChunkName,this.mass)},mousedown:function(){var b=this.getClicked();b&&(this.pickup(b),"piston"==this.selected.cameFrom&&this.takeOffPiston(this.selected),addListener(curLevel,"mousemove","weights",this.mousemove,this),addListener(curLevel,"mouseup","weights",this.mouseup,this))},mousemove:function(){var b=mouseOffset(myCanvas),d=this.selected.origPos,e=d.weight,
d=d.mouse,f=e.y+(b.y-d.y);this.selected.pos.x=e.x+(b.x-d.x);this.selected.pos.y=f},mouseup:function(){removeListener(curLevel,"mousemove","weights");removeListener(curLevel,"mouseup","weights");var b=this.getDest(),d=this.selected;this.dropIntoBin(d,b);delete this.origPos;this.selected=d.origPos=void 0},getDest:function(){var b=this.selected,d=this.weightGroups[b.groupHandle].dims.dy;return"piston"==b.cameFrom||b.pos.y+d>this.zeroY?"store":"piston"},pickup:function(b){b.cameFrom=b.status;b.status=
"holding";var d=mouseOffset(myCanvas);void 0!==b.slot&&(b.slot.isFull=!1);"piston"==b.status&&this.takeOffPiston(b);delete b.slot;this.selected=b;this.selected.origPos={mouse:d.copy(),weight:b.pos.copy()}},getClicked:function(){for(var b in this.weightGroups){b=this.weightGroups[b];for(var d=0;d<b.weights.length;d++){var e=b.weights[d];if(inRect(e.pos,b.dims,myCanvas)&&("inTransit"==e.status||this.isOnTop(e)))return e}}return!1},mouseOnWeight:function(b,d){var e=mouseOffset(myCanvas);return e.x>=
d.x&&e.x<=d.x+b.dx&&e.y<=d.y&&e.y>=d.y-b.dy},isOnTop:function(b){var d=b.slot;b=this.bins[d.type][b.groupHandle];for(var e=d.col,d=d.row+1;d<b.slots.length;d++)if(b.slots[d][e].isFull)return!1;return!0},mass:function(){return this.mass},disable:function(){removeListener(curLevel,"mousedown","weights"+this.wallInfo);this.enabled=!1},enable:function(){addListener(curLevel,"mousedown","weights"+this.wallInfo,this.mousedown,this);this.enabled=!0},makeImg:function(b){b=document.getElementById(b);if(null==
b)return!1;var d=new Image;d.src=b.src;return d}});DragWeights.Bins=function(b,d,e,f,h,k,l,m,n,p,r){this.piston=this.makePistonBins(b,d,e,p,h,l,m,k);this.store=this.makeStoreBins(b,d,e,n,f,r,k)};
DragWeights.Bins.prototype={makePistonBins:function(b,d,e,f,h,k,l,m){var n=(d[0].x+d[1].x)/2;d={};var p=countAttrs(e),n=n-f*(p-1)/2-h*(p-1)/2,r;for(r in e)d[r]=new DragWeights.PistonBin(b,n,e[r],k,f,m,l,V(b.pistonBinWidth,b.binHeight),b.binSlant,b.binThickness),n+=f+h;return d},makeStoreBins:function(b,d,e,f,h,k,l){var m=(d[0].x+d[1].x)/2;d={};var n=countAttrs(e),m=m-f*(n-1)/2-h*(n-1)/2,p;for(p in e)n=e[p],d[p]=new DragWeights.StoreBin(P(m,k),n,f,l,n,V(b.storeBinWidth,b.binHeight),b.binSlant,b.binThickness),
m+=f+h;return d}};DragWeights.WeightGroup=function(b,d,e,f,h){this.handle=b;this.pressure=d;this.mass=e;this.dims=f;this.weights=[];this.count=h};DragWeights.Weight=function(b,d,e,f){this.pos=b;this.groupHandle=d;this.status=e;this.id=f;this.origPos=this.cameFrom=void 0};
DragWeights.PistonBin=function(b,d,e,f,h,k,l,m,n,p){this.pos;f?(m=f.dx,this.pos=P(d-h/2,0).movePt(V(m,0)).track({pt:l,noTrack:"x",offset:{dy:f.dy}})):this.pos=P(d-h/2,0).track({pt:l,noTrack:"x"});this.pts=[];b.trackingPts.push(this.pos);this.slots=this.getSlots(b,this.pos,e,h,k);this.visible=!1};
DragWeights.PistonBin.prototype={getSlots:function(b,d,e,f,h){var k=e.weights.length,l=e.dims,m=Math.floor(f/(l.dx+h));startX=d.x+(f-m*(l.dx+h))/2;f=Math.ceil(k/m);for(var k=[],n=h,p=0;p<f;p++){for(var r=[],s=startX+h,t=0;t<m;t++){var u=P(s,0).track({pt:d,offset:{dy:-(n+l.dy)},noTrack:"x"});b.trackingPts.push(u);r.push(new DragWeights.Slot(!1,u,e.handle,"piston",p,t));s+=l.dx+h}k.push(r);n+=l.dy+h}return k}};
DragWeights.StoreBin=function(b,d,e,f,h,k,l,m){this.pts=compressorFuncs.getBinPts(b,l,k,m);this.pos=b.copy().movePt(V(-k.dx/2,0));this.slots=this.getSlots(this.pos,h,e,f);this.visible=!0};
DragWeights.StoreBin.prototype={getSlots:function(b,d,e,f){var h=d.weights.length,k=d.dims,l=Math.floor(e/(k.dx+f));e-=l*(k.dx+f);b=b.copy();b.x+=e/2;h=Math.ceil(h/l);e=[];for(var m=b.y-f-k.dy,n=0;n<h;n++){for(var p=[],r=b.x+f,s=0;s<l;s++)p.push(new DragWeights.Slot(!1,P(r,m),d.handle,"store",n,s)),r+=k.dx+f;e.push(p);m-=k.dy+f}return e}};DragWeights.Slot=function(b,d,e,f,h,k){this.isFull=b;this.pos=d;this.handle=e;this.type=f;this.row=h;this.col=k};var flowFuncs={getPts:function(b,d,e,f,h){e=b.VTo(d).mag();var k=this.width/e;this.fracOffset=Math.max(Math.min(this.fracOffset,1-k/2),k/2);e=h+k/2;h=b.copy().fracMoveTo(d,h-k/2);b=b.copy().fracMoveTo(d,e);d=h.copy().movePt(f.copy().neg().mult(this.depth));f=b.copy().movePt(f.copy().neg().mult(this.depth));return this.deleteDuplicatePts([h,d,f,b])},addPts:function(){var b=Math.min(this.ptIdxs[0],this.ptIdxs[1]),d=Math.max(this.ptIdxs[0],this.ptIdxs[1]),e=this.wall[b].copy(),d=this.wall[d].copy();
this.perp=this.wall.getPerpUV(b);b=this.wall.getUV(b);this.pts=this.getPts(e,d,b,this.perp,this.fracOffset)},addFlowSliders:function(b,d){for(var e=[],f=0;f<b.length;f++){var h=b[f],k=this.pluckFlows(d,h.flowHandles),l=h.handle,m=h.title,h=h.fracOpen,k=new Inlet.FlowGroupSlider(m,l,k),l=sliderManager.addSlider(m,this.handle+"Slider"+l.toCapitalCamelCase(),{value:100*h},[{eventType:"slide",obj:k,func:k.parseSlider}],void 0);k.slider=l;e.push(k)}return e},fracToTemp:function(b,d,e){return b+(d-b)*e},
tempToFrac:function(b,d,e){return(e-b)/(d-b)},pluckFlows:function(b,d){for(var e=[],f=0;f<d.length;f++){for(var h=!1,k=0;k<b.length;k++)b[k].handle==d[f]&&(e.push(b[k]),h=!0);h||console.log("Could not find flow "+d[f]+" for inlet slider")}return e},deleteDuplicatePts:function(b){for(var d=0;d<b.length-1;d++)for(var e=d+1;e<b.length;e++)b[d].sameAs(b[e])&&(b.splice(e,1),e--);return b},addArrows:function(b,d){var e=[],f=30<this.width?2:1,h=this.pts[1].copy();h.movePt(b.copy().neg().mult(this.arrowDims.dy/
3));for(var k=this.pts[1].VTo(this.pts[2]),k=k.copy().UV().copy().mult(k.mag()/(f+1)),l=0;l<f;l++)h.movePt(k),e.push(new ArrowStatic({pos:h,dims:this.arrowDims,UV:b.copy(),handle:this.handle+"Idx"+l,fill:this.arrowFill,stroke:this.arrowStroke,cleanUpWith:this.cleanUpWith}));return e}};function CompositionController(b){this.type="CompositionController";this.handle=b.handle;this.inletDepth=Math.max(defaultTo(b.inletDepth,20),20);this.outletDepth=Math.max(defaultTo(b.outletDepth,20),20);this.flowWidth=Math.max(defaultTo(30,b.width),30);this.flowSpacing=35;this.wallInfo=b.wallInfo;this.wall=walls[this.wallInfo];this.inlets=[];this.outlets=[];(this.temp=b.temp)||console.log("No/zero temperature sent to inlet "+this.handle);this.segmentIdxs=this.capPtIdxs(_.sortBy(b.ptIdxs,function(b){return b}),
this.wall);this.tempSlider=void 0;this.tempMin=b.tempMin;this.tempMax=b.tempMax;this.pControlListenerHandler=void 0;b.makeTempSlider&&(this.willMakeTempSlider=!0,this.tempSliderTitle=b.tempSliderTitle||"Inlet temp");this.pSetPt=b.pressure;this.attrSliders=b.sliders;this.attrFlows=b.flows;this.setupStd();this.flowsBySpc={};this.compositions=this.recordCompositions(this.wall);this.init()}
_.extend(CompositionController.prototype,objectFuncs,flowFuncs,{init:function(){this.tileWallSegments(this.wall,this.segmentIdxs,this.inletDepth,this.outletDepth,this.flowWidth,this.flowSpacing,this.attrFlows,this.temp,this.tempMin,this.tempMax,this.inlets,this.outlets);this.scaleInletFlows(this.inlets);this.willMakeTempSlider&&(this.tempSlider=this.addTempSlider(this.tempSliderTitle));var b=this.getAllFlows(this.inlets);this.populateFlowsBySpc(this.flowsBySpc,b);this.flowGroupSliders=this.addFlowSliders(this.attrSliders||
[],b);this.pSetPt&&(this.pControlListenerHandle=this.initPressureControl(this.wall,b))},initPressureControl:function(b,d){var e=this.handle+"PressureControl";this.wall.getDataSrc("temp");dotManager.get({tag:b.handle});this.wall.getDataSrc("vol");var f=this.wall.getDataSrc("pInt");addListener(curLevel,"data",e,function(){for(var b=averageLast(f,60),b=(this.pSetPt/b+5)/6,e=0;e<d.length;e++)d[e].scalar*=b},this);return e},recordCompositions:function(b){var d={},e;for(e in spcs)d[e]=b.recordFrac({spcName:e,
tag:b.handle}).src();return d},initCompControl:function(b){var d=0,e;for(e in b)d+=b[e];if(1<e)for(e in b)b[e]*=1/d;var f=this.compositions,h;this.compComtrolHandle="controlComp"+this.handle.toCapitalCamelCase();h=this.flowsBySpc;addListener(curLevel,"data",handle,function(){for(var d in b){var e=h[d],m=(b[d]/f[d][f[d].length-1]+5)/6;if(Infinity!=m)for(var n=0;n<e.length;n++)e[n].fracOpen*=m;else for(n=0;n<e.length;n++)e[n].fracOpen+=b[d]}},this)},addTempSlider:function(b){("number"!=typeof this.tempMin||
"number"!=typeof this.tempMax)&&console.log("Making heater "+this.handle+" temp slider without tempMin or tempMax");return sliderManager.addSlider(b,this.handle+"TempSlider",{value:100*this.tempToFrac(this.tempMin,this.tempMax,this.temp)},[{eventType:"slide",obj:this,func:this.parseTempSlider}],void 0)},setControl:function(b,d){/slider/i.test(b)?this.enableSliders():/(comp|auto)/i.test(b)&&(this.compControllerHandle=this.initCompControl(d))},parseTempSlider:function(b,d){for(var e=0;e<this.inlets.length;e++)this.inlets[e].parseTempSlider(b,
d)},scaleInletFlows:function(b){for(var d=function(d){d.nDotMax/=b.length},e=0;e<b.length;e++)b[e].modifyFlows(d,void 0)},tileWallSegments:function(b,d,e,f,h,k,l,m,n,p,r,s){for(var t=d.length-1;0<=t;t--)this.tileWallSegment(b,d[t],e,f,h,k,l,m,n,p,r,s)},tileWallSegment:function(b,d,e,f,h,k,l,m,n,p,r,s){r=b[d].distTo(b[d+1]);s=Math.floor((r-k)/(h+k));for(var t=(r-s*h-(s-1)*k)/2,u=0;u<s;u++){var w=r-t-u*(h+k)-0.5*h,x=b[d].distTo(b[d+1]),w=w/x,x=this.handle+"Wall"+b.handle+"Segment"+d+"Flow"+u;u%2?this.inlets.push(new Inlet({handle:x,
wallInfo:b.handle,ptIdxs:[d,d+1],addArrows:!1,temp:m,tempMin:n,tempMax:p,flows:l,width:h,depth:e,fracOffset:w})):this.outlets.push(new Outlet({handle:x,wallInfo:b.handle,ptIdxs:[d,d+1],width:h,depth:f,fracOffset:w}))}},capPtIdxs:function(b,d){for(var e=d.length-2,f=0;f<b.length;f++)b[f]>e&&(b.splice(f,1),f--);return b},getAllFlows:function(b){for(var d=[],e=0;e<b.length;e++)d=d.concat(b[e].flows);return d},populateFlowsBySpc:function(b,d){for(var e in spcs)b[e]=[];for(e=0;e<d.length;e++)b[d[e].spcName].push(d[e])},
remove:function(){for(var b=0;b<this.inlets.length;b++)this.inlets[b].remove();for(b=0;b<this.outlets.length;b++)this.outlets[b].remove();this.tempSlider&&this.tempSlider.remove();removeListener(curLevel,"data",this.pControlListenerHandle);for(b=0;b<this.flowGroupSliders.length;b++)this.flowGroupSliders[b].slider.remove();this.inlets=[];this.outlets=[]}});function Heater(b){this.type="Heater";this.dims=defaultTo(V(100,40),b.dims);this.sliderWrapper=b.sliderWrapper;this.sliderTitleWrapper=b.sliderTitleWrapper;this.wall=walls[b.wallInfo];this.pos=b.pos?b.pos:this.centerOnWall(b.wallInfo,this.dims);b.offset&&this.pos.movePt(b.offset);this.wall.recordQ();this.wall.hitThreshold=30;this.makeSlider=defaultTo(!0,b.makeSlider);this.handle=b.handle;this.canvasHandle=b.canvasHandle||"main";this.cornerRound=0.2;this.qRate=defaultTo(0,b.init);this.qRateMax=defaultTo(1,
b.max);this.qRateMin=-this.qRateMax;this.rot=defaultTo(0,b.rotation);this.tempMax=defaultTo(Number.MAX_VALUE,b.tempMax);this.tempMin=defaultTo(1,b.tempMin);this.center=this.pos.copy().movePt(this.dims.copy().mult(0.5));var d=defaultTo(Col(200,0,0),b.colMax),e=defaultTo(Col(0,0,200),b.colMin),f=defaultTo(Col(100,100,100),b.colDefault);this.draw=this.makeDrawFunc(e,f,d);this.wallPts=this.pos.roundedRect(this.dims,0.3,"ccw");this.addWallHump(this.wallPts);this.eAdded=0;b.liquidHandle&&this.setupLiquidHeat(b.liquidHandle);
this.wallHandleHeater="heater"+this.handle.toCapitalCamelCase();this.hit=this.wrapHit(this.wall.getDataSrc("temp"));this.setupStd();this.makeSlider&&(this.slider=sliderManager.addSlider("Heater",this.handle+"Slider",{value:50},[{eventType:"slide",obj:this,func:this.parseSlider},{eventType:"slidestop",obj:this,func:function(b,d){$(this.slider.slider).slider("option",{value:50});d.value=50;this.parseSlider(b,d)}}],b.sliderIdx));this.init(this.wallHandleHeater,this.wall)}
_.extend(Heater.prototype,objectFuncs,{parseSlider:function(b,d){this.setQRate(d.value)},setQRate:function(b){this.enabled&&(this.qRate=0.02*this.qRateMax*(b-50),this.liquid&&(50!=b?addListener(curLevel,"update","heatLiquid"+this.handle,this.heatLiq,this):removeListener(curLevel,"update","heatLiquid"+this.handle)))},heatLiq:function(){this.liquid.addQ(0.15*this.qRate*updateInterval)},addWallHump:function(b){for(var d=[],e=0;e<b.length-1;e++)b[e].y==b[e+1].y&&d.push(e);b[b.length-1].y==b[0].y&&d.push(b.length-
1);for(var f=d[0],e=0;e<d.length;e++)f=b[d[e]].y<b[f].y?d[e]:f;b.splice(f+1,0,P(f==b.length-1?(b[f].x+b[0].x)/2:(b[f].x+b[f+1].x)/2,b[f].y-5))},disable:function(){this.slider&&this.slider.disable();this.setQRate(50);this.enabled=!1},enable:function(){this.slider&&this.slider.enable();this.enabled=!0},makeDrawFunc:function(b,d,e){this.pts=this.getPts(this.pos,this.dims);rotatePts(this.pts,this.center,this.rot);var f=this.getColorSteps(b,d,e),h=this,k=this.pts;return function(b){var e=getSign(h.qRate),
n=f[String(e)],e=e*h.qRate/h.qRateMax,n=d.copy().adjust(n[0]*e,n[1]*e,n[2]*e);draw.path(k,n,b)}},centerOnWall:function(b,d){var e=walls[b];return P((e[3].x+e[2].x)/2-d.dx/2,e[2].y-30-d.dy)},getPts:function(b,d,e){e=[];b=b.copy().movePt({dy:d.dy/2});var f=d.dy/2+2.5,h=d.dy/2-2.5,k=Math.floor((d.dx-2*f)/(2*(f-h)));e.push(b.copy().movePt({dy:200}));e.push(b.copy());e=e.concat(this.halfElipse(b,f,d.dy/2,0,5));b.movePt({dx:2*f});for(var l=0;l<k;l++)e=e.concat(this.halfElipse(b,h,d.dy/2,Math.PI,5)),b.movePt({dx:-2*
h}),e=e.concat(this.halfElipse(b,f,d.dy/2,0,5)),b.movePt({dx:2*f});e.push(b.copy());e.push(b.copy().movePt({dy:200}));this.endX=e[e.length-1].x;this.dims=V(this.endX-this.pos.x,d.dy);this.center=this.pos.copy().movePt(this.dims.copy().mult(0.5));return e},halfElipse:function(b,d,e,f,h){h=defaultTo(5,h);for(var k=Array(h),l=Math.PI/h,m=b.x+d,n=Math.PI,p=0;p<h;p++){var r=m+d*Math.cos(n),s=b.y+e*Math.sin(n);k[p]=P(r,s);n+=l}rotatePts(k,b,f);return k},getColorSteps:function(b,d,e){var f={};e=[e.r-d.r,
e.g-d.g,e.b-d.b];f["-1"]=[b.r-d.r,b.g-d.g,b.b-d.b];f["1"]=e;return f},init:function(b,d){canvasManager.addListener(this.canvasHandle,"drawHeater"+this.handle,this.draw,this,1);this.setupWalls(b,d);this.eAdded=0},setupWalls:function(b,d){walls.addWall({pts:this.wallPts,handler:{func:this.hit,obj:this},handle:b,record:!1,show:!1});walls[b].createSingleValDataObj("vol",function(){return walls.wallVolume(b)});d.containedWalls.push(walls[b]);window.dotMigrator.migrateDots(window.dotManager.get({tag:d.handle}),
[d.handle],"only",[b],"or")},wrapHit:function(b){return function(d,e,f,h,k,l){walls.reflect(d,h,k);d.temp();if(0<this.qRate&&b[b.length-1]<this.tempMax||0>this.qRate&&b[b.length-1]>this.tempMin)d=0.0010*d.addEnergy(this.qRate),this.eAdded+=d,this.wall.q+=d}},setupLiquidHeat:function(b){var d=this;timeline.curSection().addCmmdPoint("now","setup",function(){var e=curLevel.selectObj("Liquid",b);e||console.log("Bad liquid handle for heater "+this.handle+".  Handle "+handle);e.heater=d;e.getWallLiq().recordQ();
d.liquid=e},!0,!0)},removeLiquid:function(){this.liquid=void 0},remove:function(){this.slider.remove();canvasManager.removeListener(this.canvasHandle,"drawHeater"+this.handle);window.walls&&!walls.removed&&(this.wall&&this.wall.removeContainedWall(window.walls[this.wallHandleHeater]),walls.removeWall(this.wallHandleHeater))}});function Inlet(b){this.arrowDims=V(15,20);this.arrowFill=Col(200,0,0);this.arrowStroke=Col(100,100,100);this.type="Inlet";this.addArrows=defaultTo(!0,b.addArrows);(this.temp=b.temp)||console.log("No/zero temperature sent to inlet "+this.handle);this.handle=b.handle;this.width=defaultTo(30,b.width);this.depth=defaultTo(20,b.depth);this.makePts=Boolean(this.depth);this.wallInfo=b.wallInfo;this.wall=walls[this.wallInfo];this.dotTag=b.tag||this.wall.handle;this.dotReturnTo=b.returnTo||this.wall.handle;
this.ptIdxs=b.ptIdxs;this.fracOffset=defaultTo(0.5,b.fracOffset);this.flows=this.processFlows(b.flows);this.flowGroupSliders=this.addFlowSliders(b.sliders||[],this.flows);this.tempSlider=void 0;this.tempMin=b.tempMin;this.tempMax=b.tempMax;b.makeTempSlider&&(this.tempSlider=this.addTempSlider(b.tempMin,b.tempMax,b.temp,b.tempSliderTitle||"Inlet temp"));this.setupStd();this.init()}
_.extend(Inlet.prototype,flowFuncs,objectFuncs,{init:function(){this.addPts();this.makePts&&this.wall.addPts(this.ptIdxs[1],this.pts);var b={pos:this.pts[1].copy(),vec:this.pts[1].VTo(this.pts[2]),dir:this.perp.copy()};this.arrows=this.addArrows?this.addArrows(this.pts[1].VTo(this.pts[2]).UV().perp("ccw")):[];this.makeInlet(b,this.flows,this.dotTag,this.dotReturnTo)},parseSlider:function(b,d){this.fracOpen=d.value/100},addTempSlider:function(b,d,e,f){("number"!=typeof b||"number"!=typeof d)&&console.log("Making heater "+
this.handle+" temp slider without tempMin or tempMax");e=Math.min(Math.max(b,e),d);return sliderManager.addSlider(f,this.handle+"TempSlider",{value:100*this.tempToFrac(b,d,e)},[{eventType:"slide",obj:this,func:this.parseTempSlider}],void 0)},modifyFlows:function(b,d){for(var e=0;e<this.flows.length;e++)b.apply(d,[this.flows[e]])},processFlows:function(b){for(var d=[],e=0;e<b.length;e++){var f=b[e];d.push(new Inlet.Flow(f.spcName,1E3*f.nDotMax/updateInterval,f.handle))}return d},setFracOpen:function(b,
d){var e=this.getSlider(b);e&&e.setFracOpenExternal(bound(d,0,1))},parseTempSlider:function(b,d){this.setTemp(this.fracToTemp(this.tempMin,this.tempMax,d.value/100),!1)},enableSlider:function(b){/temp/i.test(b)?this.tempSlider&&this.tempSlider.enable():(b=this.getSlider(b))&&b.slider.enable()},disableSlider:function(b){/temp/i.test(b)?this.tempSlider&&this.tempSlider.disable():(b=this.getSlider(b))&&b.slider.disable()},setTemp:function(b,d){this.temp=bound(b,this.tempMin,this.tempMax);!1!==d&&this.tempSlider&&
this.tempSlider.slider.slider("value",100*this.tempToFrac(this.tempMin,this.tempMax,b))},getSlider:function(b){for(var d=0;d<this.flowGroupSliders.length;d++)if(this.flowGroupSliders[d].handle==b)return this.flowGroupSliders[d];return!1},makeInlet:function(b,d,e,f){var h=b.pos,k=b.vec,l=b.dir,m=Array(d.length),n=d.length;for(b=0;b<m.length;b++)m[b]=0;addListener(curLevel,"update",this.type+this.handle,function(){for(var b=0;b<n;b++){var r=d[b];m[b]+=r.fracOpen*r.nDotMax*r.scalar;var s=Math.floor(m[b]);
if(s){for(var t=[],u=0;u<s;u++){var w=Math.random(),w=P(h.x+k.dx*w,h.y+k.dy*w);t.push({pos:w,dir:l,temp:this.temp,returnTo:f,tag:e})}r.spc.place(t);m[b]-=s}}},this)},remove:function(){for(var b=0;b<this.flowGroupSliders.length;b++)this.flowGroupSliders[b].slider.remove();for(b=0;b<this.arrows.length;b++)this.arrows[b].remove();this.tempSlider&&this.tempSlider.remove();removeListener(curLevel,"update",this.type+this.handle)}});
Inlet.Flow=function(b,d,e){this.spcName=b;this.spc=window.spcs[b];this.nDotMax=d;this.handle=e;this.scalar=this.fracOpen=1};Inlet.FlowGroupSlider=function(b,d,e){this.title=b;this.handle=d;this.slider=void 0;this.flows=e};
Inlet.FlowGroupSlider.prototype={parseSlider:function(b,d){this.setFracOpen(d.value/100)},disable:function(){},setFracOpen:function(b){for(var d=this.flows,e=0;e<d.length;e++)d[e].fracOpen=b},setFracOpenExternal:function(b){this.setFracOpen(b);this.slider.slider.slider("value",100*b)}};function Liquid(b){this.type="Liquid";this.wallInfo=b.wallInfo;this.wallGas=walls[this.wallInfo];this.wallPtIdxs=b.wallPts||[this.wallGas.length-2,this.wallGas.length-3];this.handle=b.handle;this.actCoeffType=b.actCoeffType||"ideal";this.actCoeffInfo=b.actCoeffInfo;var d=b.makePhaseDiagram;this.Cp=0;var e=b.tempInit;this.temp=e;var f=b.spcCounts;this.spcDefs=this.getSpcDefs(f);this.tempDisplay=this.temp;this.criticalPointTemp=b.criticalPointTemp;this.triplePointTemp=b.triplePointTemp;this.isTwoComp=
2==countAttrs(this.spcDefs);this.spcA=getNth(this.spcDefs,0);this.isTwoComp&&(this.spcB=getNth(this.spcDefs,1));this.canvasHandle=b.canvasHandle||"main";this.drivingForce=this.makeDrivingForce(this.spcDefs);this.dotMgrLiq=this.makeDotManager(this.spcDefs);this.wallLiq=this.makeWallLiq(this.spcDefs,f,this.wallGas,this.wallPtIdxs,this.dotMgrLiq);this.wallLiq.isLiquid=!0;this.surfAreaObj=this.wallGas.addSurfAreaAdjust(this.handle);this.numAbs=deepCopy(this.drivingForce);this.numEjt=deepCopy(this.numAbs);
this.makeDots(this.wallLiq,this.wallGas,this.wallPtIdxs,f,e,this.dotMgrLiq)&&this.deleteCount(this.spcDefs);this.dataGas=this.initData(this.wallGas,this.spcDefs,["pInt","temp","vol"]);this.setupGrabPExt(this.wallGas,this.dataGas);this.dataLiq=this.initData(this.wallLiq,this.spcDefs);this.recordTempLiq(this.wallLiq);this.drawList=this.makeDrawList(this.dotMgrLiq);this.actCoeffFuncs=this.makeActCoeffFuncs(this.actCoeffType,this.actCoeffInfo,this.spcDefs);this.chanceZeroDf=0.4;this.drivingForceSensitivity=
10;this.updateListenerName=this.type+this.handle;this.phasePressure=b.phasePressure||1;this.makePhaseDiagram=this.wrapMakePhaseDiagram(this,this.spcDefs,this.actCoeffFuncs,"liquid"+this.handle.toCapitalCamelCase(),b.primaryKey,b.makeGasMarker,b.makeSystemMarker,b.makeLiquidMarker,this.phasePressure);d&&(this.phaseDiagram=this.makePhaseDiagram());this.updateEquilData(this.phaseDiagram,[this.phasePressure]);this.setupUpdate(this.spcDefs,this.dataGas,this.dataLiq,this.actCoeffFuncs,this.drivingForce,
this.updateListenerName,this.drawList,this.dotMgrLiq,this.wallLiq,this.numAbs,this.drivingForceSensitivity,this.numEjt,this.wallGas,this.wallPtIdxs,this.surfAreaObj);this.wallGas.addLiquid(this);this.wallBound=this.addWallBound(this.wallGas);this.phaseChangeEnabled=!0;this.equilData;this.energyForDots=0;this.setupStd()}
_.extend(Liquid.prototype,objectFuncs,{getSpcDefs:function(b){var d={},e;for(e in b)d[e]=window.spcs[e];return d},setupGrabPExt:function(b,d){timeline.curSection().addCmmdPoint("now","setup",function(){var e=b.getDataSrc("pExt",void 0,!0);e&&(d.pExt=e)},!0,!0)},makeActCoeffFuncs:function(b,d,e){b=b||"ideal";if(/(twoSfxMrg|twosuffixmargoules)/i.test(b))return this.makeTwoSfxMrgFuncs(e,d.a);if(/van[\s]*laar/i.test(b))return this.makeVanLaar(e,d);if(/ideal/i.test(b)){b={};for(var f in e)b[f]=function(b,
d){return 1};return b}},makeTwoSfxMrgFuncs:function(b,d){var e={},f=R,h;for(h in b)e[h]=function(b,e){return Math.exp(d*(1-b)*(1-b)/(f*e))};return e},makeVanLaar:function(b,d){var e={},f;for(f in b){var h=d[f],k=this.getActCoeffOther(f,d);void 0===h&&console.log("Missing activity coefficient for "+f);e[f]=this.makeVanLaarFunc(h,k)}return e},makeVanLaarFunc:function(b,d){return function(e,f){return Math.exp(b*d*(1-e)/(b*e+d*(1-e))*d*(1-e)/(b*e+d*(1-e)))}},getActCoeffOther:function(b,d){for(var e in d)if(e!=
b)return d[e]},makeWallLiq:function(b,d,e,f,h,k){b=this.getLiqWallVol(b,d);e=this.getWallLiqPts(e,f,b);return window.walls.addWall({pts:e,handler:{func:this.hit,obj:this},handle:"liquid"+this.handle.toCapitalCamelCase(),record:!1,show:!0,dotManager:h,close:!1})},makeNumAbsorbed:function(b){var d={},e;for(e in b)d[e]=0;return d},togglePhaseChange:function(){this.phaseChangeEnabled?this.disablePhaseChange():this.enablePhaseChange()},enablePhaseChange:function(){window.walls.setWallHandler(this.wallLiq.handle,
{func:this.hit,obj:this});this.phaseChangeEnabled=!0},disablePhaseChange:function(){window.walls.setWallHandler(this.wallLiq.handle,{func:this.hitNoPhaseChange,obj:this});this.phaseChangeEnabled=!1},getLiqWallVol:function(b,d,e){var f=0;if(e)for(h in b)f+=b[h].spcVolLiq*e.get({spcName:h}).length/N;else for(var h in b)f+=b[h].spcVolLiq*d[h]/N;return f},getWallLiqPts:function(b,d,e){var f=b[d[0]];d=b[d[1]];b=f.x<d.x?f:d;f=b==f?d:f;e=this.getWallHeight(f.x-b.x,e);b=b.copy().movePt(V(0,-e));return[f.copy().movePt(V(0,
-e)),b]},getWallHeight:function(b,d){return d/(vConst*b)+2},makeDotManager:function(b){var d=new DotManager,e;for(e in b)d.addSpcs(e);return d},makeDots:function(b,d,e,f,h,k){var l=b[1].copy();d=P(Math.max(d[e[0]].x,d[e[1]].x),d[e[0]].y);d=l.VTo(d);for(var m in f)spcs[m].populate(l,d,f[m],h,b.handle,void 0,b.handle,k)},recordTempLiq:function(b){var d=this;b.recordTemp(function(){return d.tempDisplay})},initData:function(b,d,e){var f={};if(e)for(var h=0;h<e.length;h++){var k=e[h],l=b.getDataObj(k,
void 0,!0);l&&(f[k]=l.src())}for(var m in d)d={spcName:m,tag:b.handle},b.recordFrac(d),f[m]=b.getDataObj("frac",d).src();return f},makeDrivingForce:function(b){var d={},e;for(e in b)d[e]=0;return d},setupUpdate:function(b,d,e,f,h,k,l,m,n,p,r,s,t,u,w){this.calcCp=this.setupCalcCp(b,m);this.calcEquil=this.setupUpdateEquil(t,n,b,d,e,f,h,m);this.addDrawListener(l);this.moveDots=this.setupMoveDots(m,b,n,t,u);this.ejectDots=this.setupEjectDots(m,b,h,p,r,l,n,s);var x=this.setupSizeWall(n,t,b,m,u,w),y=this.setupFixLiquidTemp(t,
dotManager,d),z=this.calcCp,F=this.calcEquil,C=this.moveDots,A=this.ejectDots;z();var v=0,B=this,T=t.getDataSrc("pExt",void 0,!0)||t.getDataSrc("pInt",void 0,!0);addListener(curLevel,"update",k,function(){if(5==v){var b;B.isTwoComp?(B.checkUpdateEquilAndPhaseDiagram=B.setupCheckUpdateEquilPhaseDiagram(B.phaseDiagram,B.wallGas.getDataSrc("pExt",void 0,!0),B.wallGas.getDataSrc("pInt")),b=B.checkUpdateEquilAndPhaseDiagram):b=function(){};removeListener(curLevel,"update",k);var d=B.dotMgrLiq.lists.ALLDOTS,
e=dotManager.lists.ALLDOTS;addListener(curLevel,"update",k,function(){0<d.length&&d.length<Math.min(75*T[T.length-1],0.95*(d.length+e.length))&&y();B.tempDisplay=B.temp;z();F();C();B.phaseChangeEnabled&&A();x();b();B.energyForDots=B.addEnergyToDots(window.dotManager.lists.ALLDOTS,B.energyForDots)})}B.tempDisplay=B.temp;z();F();C();x();v++})},willFixTemp:function(b,d,e,f){return 0<b.length&&b.length<75*Math.max(1,this.fluxCoeff(d,e,f))},fluxCoeff:function(b,d,e){return b.length/(d*N)/0.1*Math.sqrt(e/
298)},setupFixLiquidTemp:function(b,d,e){var f=this;return function(){var b=f.tDew(f.spcA,f.spcB,e,f.equilData),d=e.temp[e.temp.length-1],l=getSign(d-b),b=b+l*Math.min(3,l*(d-b)),d=(b-f.temp)*f.Cp;f.temp=b;f.energyForDots-=d}},tDew:function(b,d,e,f){if(b&&d){b=f.data;e=e[f.keyLight][e[f.keyLight].length-1]+1E-5;f=1;for(d=b.length;f<d;f++)if(b[f].yLight<=e){d=b[f-1].yLight;var h=b[f-1].temp;return h+(e-d)*(b[f].temp-h)/(b[f].yLight-d)}}else return b.tBoil(e.pExt?e.pExt[e.pExt.length-1]:e.pInt[e.pInt.length-
1])},addEnergyToDots:function(b,d){if(b.length&&d){for(var e=0,f=0,h=getSign(d),k=Math.floor(Math.random()*b.length);Math.abs(f)<Math.abs(d)&&e<b.length;)f+=b[k].addEnergy(h*Math.min(Math.abs(d-f),0.5)),k++,e++,k==b.length&&(k=0);return d-f}return d},setupCalcCp:function(b,d){var e=this,f={},h;for(h in b)f[h]=d.get({spcName:h});return function(){var d=0,h;for(h in b)d+=b[h].cpLiq*f[h].length/N;e.Cp=d}},setupUpdateEquil:function(b,d,e,f,h,k,l,m){var n=this;return function(){var p=5>Math.abs(b[0].y-
d[0].y);0==m.count?n.updateEquilAllVap(b,d,e,f,h,k,l,m):p?n.updateEquilWithPExt(b,d,e,f,h,k,l,m):n.updateEquilStd(b,d,e,f,h,k,l,m)}},updateEquilAllVap:function(b,d,e,f,h,k,l,m){b=this.tDew(this.spcA,this.spcB,f,this.equilData)-f.temp[f.temp.length-1];for(var n in e)l[n]=b},updateEquilWithPExt:function(b,d,e,f,h,k,l,m){d=0;f={};for(var n in e){m=h[n][h[n].length-1];var p=this.temp,r=k[n](m,p),s=e[n].antoineCoeffs;m*=this.getPPure(s.a,s.b,s.c,p)*r;d+=m;f[n]=m}b=b.pExt()-d;for(n in e)l[n]=b*f[n]/d},
updateEquilStd:function(b,d,e,f,h,k,l,m){for(var n in e){b=f[n][f[n].length-1];d=h[n][h[n].length-1];m=this.temp;var p=k[n](d,m),r=e[n].antoineCoeffs;d*=this.getPPure(r.a,r.b,r.c,m)*p;l[n]=b*(f.pExt?f.pExt[f.pExt.length-1]:f.pInt[f.pInt.length-1])-d}},addDrawListener:function(b){canvasManager.addListener(this.canvasHandle,"drawDots"+this.handle,function(d){draw.dotsAsst(b,d)},void 0,0)},setupMoveDots:function(b,d,e,f,h){var k=this,l=[],m;for(m in d)l.push(b.get({spcName:m}));return function(){for(var b,
d,m,s,t=e[0].x,u=e[1].x,w=f[h[0]].y,x=e[0].y,y=0;y<l.length;y++){var z=l[y];if(d=z.length){s=z[0].m;b=15+Math.ceil(15*Math.random());for(var F=0;F<b;F++){m=0.5*tempToV(s,k.temp);var C=2*Math.PI*Math.random();m=V(Math.cos(C)*m,Math.sin(C)*m);for(C=F;C<d;C+=b)z[C].x=Math.max(u,Math.min(t,z[C].x+m.dx)),z[C].y=Math.max(x,Math.min(w,z[C].y+m.dy))}}}}},setupEjectDots:function(b,d,e,f,h,k,l,m){var n=this,p=this.wallGas,r={},s;for(s in d)r[s]=b.get({spcName:s});return function(){for(var s in d){var u=e[s],
w=f[s];f[s]=0;0<u?m[s]+=w/(u*h+1):0>u&&(m[s]+=1+Math.sqrt(w*(-u*h+1)),m[s]+=(l[0].x-l[1].x)*-u*h/2E3);m[s]=Math.min(m[s],r[s].length);(u=Math.floor(m[s]))&&n.eject(b,window.dotManager,d,s,u,p,k,l);m[s]=0}}},setupSizeWall:function(b,d,e,f,h,k){var l=this;return function(){var m=l.getLiqWallVol(e,void 0,f),m=l.getWallHeight(Math.abs(d[h[0]].x-d[h[1]].x),m);b[0].y=d[h[0]].y-m;b[1].y=d[h[0]].y-m;b.parent.setupWall(b.parent.indexOf(b));k.val=2*m+b[1].x-b[0].x}},setupCheckUpdateEquilPhaseDiagram:function(b,
d,e){var f=d?d:e,h=0,k=this;return function(){f[f.length-1]!=k.equilData.pressure&&h++;15<h&&(k.updateEquilData(b,f),h=0)}},updateEquilData:function(b,d){b?this.equilData=b.setPressure(d[d.length-1]):this.isTwoComp&&(this.equilData=phaseEquilGenerator.constP(this.spcA,this.spcB,this.actCoeffFuncs,d[d.length-1],20))},eject:function(b,d,e,f,h,k,l,m){e=b.get({spcName:f});h=Math.min(e.length,h);h=e.slice(0,h);for(e=0;e<h.length;e++){f=h[e];0==f.temp()&&(f.v.dy=-1);f.setTemp(this.temp);var n=f.hVap();
f.v.dy=-Math.abs(f.v.dy);f.y=m[0].y-1;f.tag=k.handle;f.returnTo=k.handle;l.splice(l.indexOf(f),1);b.remove(f,!1);this.calcCp();this.temp-=n/this.Cp;0==this.Cp&&(this.temp=0,this.energyForDots-=n);0>this.temp&&(this.energyForDots-=this.Cp*(1-this.temp),this.temp=1)}d.add(h)},getPPure:function(b,d,e,f){return Math.pow(10,b-d/(f+e))*MMHGTOBAR},makeDrawList:function(b){for(var d=b.lists.ALLDOTS.concat(),e=[],f=0;f<b.lists.ALLDOTS.length;f++){var h=Math.floor(Math.random()*d.length);e.push(d[h]);d.splice(h,
1)}return e},hit:function(b,d,e,f,h,k,l){d=this.drivingForce;if(void 0!==d[b.spcName]&&(e=this.chanceZeroDf,e/=1-e,e/(e+Math.exp(-d[b.spcName]*this.drivingForceSensitivity))>Math.random()&&this.dataGas.temp.length))return this.absorbDot(b,this.drawList,this.dotMgrLiq,this.wallLiq,this.spcDefs,this.dataGas.temp);this.dotMgrLiq.count?this.adjTemps(b,f,h,this.dataGas,this.dataLiq,this.temp,window.dotManager.spcLists,this.spcDefs):WallMethods.collideMethods.reflect(b,f,h)},hitNoPhaseChange:function(b,
d,e,f,h,k,l){this.adjTemps(b,f,h,this.dataGas,this.dataLiq,this.temp,window.dotManager.spcLists,this.spcDefs)},absorbDot:function(b,d,e,f,h,k){window.dotManager.remove(b,!1);d.splice(Math.floor(Math.random()*d.length),0,b);b.tag=f.handle;b.returnTo=f.handle;d=k[k.length-1];this.energyForDots+=(b.temp()-d)*b.cv;b.setTemp(d);d=this.Cp;e.add(b);this.calcCp();this.temp=(this.temp*d+b.tempCondense()*b.cpLiq)/this.Cp;this.numAbs[b.spcName]++;return!1},adjTemps:function(b,d,e,f,h,k,l,m){var n=f.temp[f.temp.length-
1];f=b.temp();h=b.cv;var p=0,r;for(r in m)p+=l[r].length*m[r].cv/N;l=getSign(k-n);k=Math.abs((k-(this.Cp*k+p*n)/(this.Cp+p))*this.Cp);k=Math.max(l*Math.min(k,100*h),(5-f)*h);h=f+k/h;l=1;0<this.temp-k/this.Cp&&(this.temp-=k/this.Cp,l=Math.sqrt(h/f),b.v.mult(l),b.internalPotential*=h/f);WallMethods.collideMethods.reflect(b,d,e*l)},getWallLiq:function(){return this.wallLiq},getWallGas:function(){return this.wallGas},addQ:function(b){var d=this.Cp;if(0!=d){var e=this.temp;b=Math.min(d*(3E3-e),Math.max((-e+
10)*d,b));this.temp+=b/d;this.wallLiq.q+=0.0010*b}},wrapMakePhaseDiagram:function(b,d,e,f,h,k,l,m,n){var p=this,r=this.makePhaseDiagram;return function(){return r.apply(p,[b,d,e,f,h,k,l,m,n])}},makePhaseDiagram:function(b,d,e,f,h,k,l,m,n){var p,r,s;for(s in d)p?r=s:p=s;this.isTwoComp?(b={x:{min:0,step:0.2},y:{min:300,step:1}},e=new GraphPhaseTwoComp({spcAName:p,spcBName:r,axisInit:b,actCoeffFuncs:e,handle:f,primaryKey:h,liquid:this,wallGas:this.wallGas,makeGasMarker:k,makeSystemMarker:l,makeLiquidMarker:m,
pressure:n})):(b={x:{min:200,step:1}},e=new GraphPhaseOneComp({spcName:p,axisInit:b,handle:f,liquid:this,wallGas:this.wallGas,makeSystemMarker:l,logScale:{y:!0},criticalPointTemp:this.criticalPointTemp,triplePointTemp:this.triplePointTemp}));return e},addWallBound:function(b){b.setBounds(void 0,this.wallLiq[0]);var d=new WallMethods.BoundHandler(function(b,d,h){d=b.vs[0].dy;var k=b.mass;d=(0.5*k*d*d+k*window.g*(h-b[0].y))*window.tConst*window.KB;b.vs[0].dy=0;b.vs[1].dy=0;this.temp+=d/this.Cp;return h},
this,!0);b.addBoundHandler("max",d);return d},remove:function(){canvasManager.removeListener(this.canvasHandle,"drawDots"+this.handle);removeListener(curLevel,"update",this.updateListenerName);this.wallGas.removeLiquid(this);this.heater&&this.heater.removeLiquid();this.wallLiq.removed||walls.removeWall(this.wallLiq.handle);this.wallGas.removed||this.wallGas.removeSurfAreaAdjust(this.handle)}});function Outlet(b){this.arrowDims=V(15,20);this.arrowFill=Col(200,0,0);this.arrowStroke=Col(100,100,100);this.type="Outlet";this.handle=b.handle;this.width=defaultTo(30,b.width);this.depth=defaultTo(20,b.depth)||20;this.wallInfo=b.wallInfo;this.wall=walls[this.wallInfo];this.ptIdxs=b.ptIdxs;this.fracOffset=defaultTo(0.5,b.fracOffset);this.arrows=[];this.pFloor=b.pressureFloor||0;this.pList=this.wall.getDataSrc("pInt");this.subWallPt=this.currentSubwallHandler=void 0;this.setupStd();this.init()}
_.extend(Outlet.prototype,flowFuncs,objectFuncs,{init:function(){this.addPts();this.wall.addPts(this.ptIdxs[1],this.pts);var b=Math.min(this.ptIdxs[0],this.ptIdxs[1])+(4==this.pts.length?2:1);this.arrows=this.addArrows(this.pts[1].VTo(this.pts[2]).UV().perp("cw"));this.origSubWallHandler=walls.getSubWallHandler(this.wallInfo,b);this.subWallPt=this.wall[b];walls.setSubWallHandler(this.wallInfo,b,new Listener(this.hit,this))},hit:function(b,d,e,f,h,k){var l=this.pList[this.pList.length-1],m=Math.min(0.75,
0.1*this.pFloor),l=(l-this.pFloor+m)/(2*m);return Math.random()<l?dotManager.remove(b,!0):WallMethods.collideMethods.staticAdiabatic.apply(walls,[b,d,e,f,h,k])},remove:function(){walls.setSubWallHandler(this.wall.handle,this.wall.indexOf(this.subWallPt),this.origSubWallHandler);this.arrows.map(function(b){b.remove()})}});function ParticleEmitter(b){this.type="ParticleEmitter";this.pos=b.pos;this.handle=b.handle;this.dir=b.dir;this.parentList=b.parentList;this.width=b.width;this.col=b.col;this.dist=b.dist;this.onGenerate=b.onGenerate;this.onArrive=b.onArrive;this.onRemove=b.onRemove;this.rate=defaultTo(Math.round(0.1*this.width),b.rate);this.speed=defaultTo(5,b.speed);this.speedSpread=defaultTo(1,b.speedSpread);2*this.speedSpread>this.speed&&console.log("Uh-oh.  Making particle emitter with handle "+this.handle+" with speed spread such that particles will hit ~0 speed");
this.accel=defaultTo(0.5,b.accel);this.accelSpread=defaultTo(1,b.accelSpread);this.dirSpread=defaultTo(0,b.dirSpread);this.canvasHandle=b.canvasHandle||"main";this.drawCanvas=defaultTo(c,b.drawCanvas);this.makeBounds();this.setupStd();this.particles=[];return this.init()}
_.extend(ParticleEmitter.prototype,objectFuncs,{init:function(){this.runListenerName=unique("particle"+this.handle,curLevel.updateListeners);this.drawListenerName="drawParticle"+this.handle;canvasManager.addListener(this.canvasHandle,this.drawListenerName,this.draw,this,2);addListener(curLevel,"update",this.runListenerName,this.run,this);return this},adjust:function(b){for(var d in b)this[d]=b[d];this.makeBounds()},makeBounds:function(){this.UV=angleToUV(this.dir);var b=this.pos.copy().movePt(this.UV.copy().rotate(-Math.PI/
2).mult(this.width/2)),d=this.pos.copy().movePt(this.UV.copy().rotate(Math.PI/2).mult(this.width/2));this.prodPt=b;this.prodV=b.VTo(d);this.finishPt=b.copy().movePt(this.UV.copy().mult(this.dist));this.finishV=this.finishPt.VTo(this.prodPt)},run:function(){this.generateNew();this.updateParticles()},trickleOut:function(){this.updateParticles();0==this.particles.length&&this.remove()},generateNew:function(){for(var b=Math.round(Math.random()*this.rate),d=0;d<b;d++)this.particles.push(this.newParticle()),
this.onGenerate&&this.onGenerate.func.apply(this.onGenerate.obj)},newParticle:function(){var b=this.prodPt.copy().movePt(this.prodV.copy().mult(Math.random())),d=Math.max(0.01,this.speed+this.speedSpread*(Math.random()-0.5)),e=Math.max(0,this.accel+this.accelSpread*(Math.random()-0.5)),f=angleToUV(this.dir+this.dirSpread*(Math.random()-0.5)),h=this.getlifespan(b,d,e,f);return{pos:b,V:f.copy().mult(d),accelV:f.copy().mult(e),age:0,lifespan:h}},getlifespan:function(b,d,e,f){b=f.dotProd(this.UV);e=0.5*
e*b;d*=b;return(-d+Math.sqrt(d*d-4*e*-this.dist))/(2*e)},updateParticles:function(){for(var b=this.particles.length-1;0<=b;b-=1){var d=this.particles[b];d.pos.movePt(d.V);d.V.add(d.accelV);d.age++;d.age>d.lifespan&&(this.particles.splice(b,1),this.onArrive&&this.onArrive.func.apply(this.onArrive.obj))}},draw:function(b){b.strokeStyle=this.col.hex;for(var d=0;d<this.particles.length;d++){var e=this.particles[d];b.beginPath();b.moveTo(e.pos.x,e.pos.y);b.lineTo(e.pos.x+2,e.pos.y+2);b.stroke()}},stopFlow:function(){removeListener(curLevel,
"update",this.runListenerName);addListener(curLevel,"update",this.runListenerName,this.trickleOut,this)},remove:function(){this.onRemove&&this.onRemove.func.apply(this.onRemove.obj);this.parentList&&this.parentList.splice(_.indexOf(this.parentList,this),1);canvasManager.removeListener(this.canvasHandle,this.drawListenerName);removeListener(curLevel,"update",this.runListenerName);this.removed=!0}});function Piston(b){this.type="Piston";this.handle=b.handle;this.wallInfo=defaultTo(0,b.wallInfo);this.wall=walls[this.wallInfo];this.min=defaultTo(2,b.min);this.max=defaultTo(15,b.max);this.makeSlider=defaultTo(!1,b.makeSlider);this.drawCanvas=defaultTo(c,b.drawCanvas);this.slant=0.04;this.sliderWrapper=b.sliderWrapper;this.sliderTitleWrapper=b.sliderTitleWrapper;this.left=this.wall[0].x;this.width=this.wall[1].x-this.left;this.shaftThickness=13+17*Math.max(0,Math.min(1,(this.width-200)/300));this.pistonPt=
this.wall[0];var d=defaultTo(2,b.init);this.setPressure(d);this.canvasHandle=b.canvasHandle||"main";this.height=500;this.pistonTop;this.pistonBottom;this.pistonAdjust=9;this.draw=this.makeDrawFunc(this.height,this.left,this.width);this.dataSlotFontCol=Col(255,255,255);this.pStep=0.05;var e=this.left+0.1*this.width*this.slant,f=this.left+this.width/2-this.shaftThickness/2,h=this.left+this.width/2+this.shaftThickness/2,k=this.left+this.width-0.1*this.width*this.slant,l=this.pistonBottom.pos.y-this.pistonAdjust+
this.pistonPt.y,m=Col(255,255,255);this.readoutLeft=new Readout("piston"+this.handle.toCapitalCamelCase()+"Left",e,f,l,"11pt calibri",m,"center",curLevel);this.readoutRight=new Readout("piston"+this.handle.toCapitalCamelCase()+"Right",h,k,l,"11pt calibri",m,"center",curLevel);this.wall.moveInit();this.wall.recordPExt();this.wall.recordWork();this.savedWallHandler=this.wall.handlers[0];this.wallHandler=defaultTo("cPAdiabaticDamped",b.compMode);walls.setSubWallHandler(this.wallInfo,0,this.wallHandler);
this.makeSlider&&(this.slider=sliderManager.addSlider("Pressure",this.handle+"Slider",{value:this.pToPercent(d)},[{eventType:"slide",obj:this,func:this.parseSlider}],b.sliderIdx));this.setupStd();return this.show()}
_.extend(Piston.prototype,objectFuncs,compressorFuncs,{makeDrawFunc:function(b,d,e){var f=b-15;this.pistonTop=this.makeTop(d,e,this.shaftThickness,f,b,7.5,7.5);this.pistonBottom=this.makePlateBottom(P(d,-b+f+7.5),V(e,7.5));var h=this;return function(b){h.setReadoutY();b.save();b.translate(0,h.pistonPt.y);draw.fillPts(h.pistonTop.pts,h.pistonTop.col,b);draw.fillRect(h.pistonBottom.pos,h.pistonBottom.dims,h.pistonBottom.col,b);b.restore()}},makeTop:function(b,d,e,f,h,k,l){var m=this.slant,n=1-m,p=[];
h=P(b+d/2-e/2,-h);var r=Col(150,150,150);d=V(d,k);b=h.copy().movePt({dy:f}).position({x:b});p.push(P(b.x,b.y+d.dy+1));p.push(P(b.x+d.dx*m,b.y));p.push(P(h.x-d.dx*m,b.y));p.push(P(h.x,b.y-15*d.dy*m));p.push(P(h.x,h.y));p.push(P(h.x+e,h.y));p.push(P(h.x+e,b.y-15*d.dy*m));p.push(P(h.x+e+d.dx*m,b.y));p.push(P(b.x+d.dx*n,b.y));p.push(P(b.x+d.dx,b.y+d.dy+1));p.push(P(b.x+d.dx-l,b.y+d.dy+1));p.push(P(b.x+l,b.y+d.dy+1));r=Col(150,150,150);return{pts:p,col:r}},makePlateBottom:function(b,d){var e=Col(100,100,
100);d.adjust(0,1);return{pos:b,dims:d,col:e}},enable:function(){this.slider&&this.slider.slider("option","disabled",!1);this.setMass(this.massStore);delete this.massStore;this.enabled=!0},disable:function(){this.slider&&this.slider.slider("option","disabled",!0);this.massStore=this.mass;this.setMass(0);this.enabled=!1},show:function(){canvasManager.addListener(this.canvasHandle,"drawPiston"+this.handle,this.draw,this,1);this.readoutLeft.show();this.readoutRight.show();return this},pToPercent:function(b){return 100*
(b-this.min)/(this.max-this.min)},hide:function(){canvasManager.removeListener(this.canvasHandle,"drawPiston"+this.handle);this.readoutLeft.hide();this.readoutRight.hide()},parseSlider:function(b,d){this.setPressure(this.percentToVal(d.value))},setPressure:function(b){this.setMass(this.pressureToMass(b))},setMass:function(b){this.mass=b;this.wall.setMass("piston"+this.handle,this.mass)},setReadoutY:function(){this.readoutLeft.position({y:this.pistonBottom.pos.y-this.pistonAdjust+this.pistonPt.y});
this.readoutRight.position({y:this.pistonBottom.pos.y-this.pistonAdjust+this.pistonPt.y})},remove:function(){this.wall.moveStop();this.wall.unsetMass("piston"+this.handle);walls.setSubWallHandler(walls.indexOf(this.wall),0,this.savedWallHandler);this.hide();this.slider&&this.slider.remove();removeListener(curLevel,"update","moveWalls")}});function QArrowsAmmt(b){this.type="QArrowsAmmt";this.rate=void 0!=b.rate?b.rate:!1;this.wallHandle=b.wallInfo;this.wall=walls[this.wallHandle];this.handle=b.handle;var d=this.wall;d.recordQ();var e=3*(1/b.scale);this.qArrowAmmtMax=isNaN(e)?3:e;this.qArrowAmmtMax=defaultTo(3,3*(1/b.scale));addListener(d,"cleanUp","qArrowsAmmt",function(){for(var b=0;b<this.qArrowsAmmt.length;b++)this.qArrowsAmmt[b].remove();removeListener(curLevel,"update",this.listenerName)},this);this.init(this.wall,this.qArrowAmmtMax);
this.setupStd()}
_.extend(QArrowsAmmt.prototype,objectFuncs,{init:function(b,d){Col(175,0,0);var e=V(30,10),f=b[3].copy().fracMoveTo(b[2],0.25),h=b[3].copy().fracMoveTo(b[2],0.75),k=h.VTo(f).perp("cw").UV();f.movePt(k.copy().mult(5));h.movePt(k.copy().mult(5));var f=new ArrowStatic({pos:f,dims:e,fill:Col(175,0,0),stroke:Col(0,0,0),label:"Q",UV:k,handle:this.handle+"Left"}),e=new ArrowStatic({pos:h,dims:e,fill:Col(175,0,0),stroke:Col(0,0,0),label:"Q",UV:k,handle:this.handle+"Right"}),l=d/65;this.qArrowsAmmt=[f,e];
var m="out",n,p=[],r=b.q;this.setAmmtArrowDims(this.qArrowsAmmt,15,80,70,90,b.q,d);0<=b.q&&(m="in",this.flipAmmtArrows(this.qArrowsAmmt));this.listenerName=this.handle+"updateQAmmtArrows";this.rate?addListener(curLevel,"update",this.listenerName,function(){p.push(b.q-r);for(var e=Math.min(75,p.length),f=p.length-e,h=0,k=0;k<e;k++)h+=p[f+k];e=h/e;n=0>e?"out":"in";this.setAmmtArrowDims(this.qArrowsAmmt,0,80,70,90,150*e,d);m!=n&&(this.flipAmmtArrows(this.qArrowsAmmt),m=n);r=b.q},this):addListener(curLevel,
"update",this.listenerName,function(){Math.abs(b.q-r)>l&&(n=0>b.q?"out":"in",this.setAmmtArrowDims(this.qArrowsAmmt,15,80,70,90,b.q,d),m!=n&&(this.flipAmmtArrows(this.qArrowsAmmt),m=n),r=b.q)},this)},flipAmmtArrows:function(b){for(var d=0;d<b.length;d++){var e=b[d],f=angleToUV(e.getAngle()).mult(1);e.move(f.mult(e.getDims().dx));e.rotate(Math.PI)}},setAmmtArrowDims:function(b,d,e,f,h,k,l){for(var m=0;m<b.length;m++){var n=b[m];n.getDims();var p=Math.abs(k)/l;n.size(V(d+(e-d)*p,f+(h-f)*p))}},remove:function(){removeListener(curLevel,
"update",this.listenerName)}});function RMSChanger(b){this.type="RMSChanger";this.info=b.info;this.min=defaultTo(1,b.min);this.val=dataHandler.RMS(this.info);this.max=defaultTo(15,b.max);this.handle=b.handle;this.totalDots=dataHandler.count(this.info);this.sliderPos=b.sliderPos;this.setupStd();return this.init()}
_.extend(RMSChanger.prototype,objectFuncs,{init:function(){this.sliderId=this.addSlider(1<this.totalDots?"Molecules' RMS":"Molecule's RMS",{value:this.valToPercent(this.val)},[{eventType:"slide",obj:this,func:this.parseSlider}],this.sliderPos)},parseSlider:function(b,d){changeRMS(this.info,this.percentToVal(d.value))},remove:function(){this.removeSlider()}});function Sandbox(b){this.type="Sandbox";this.handle=b.handle;this.emitterNum=0;b=defaultTo({},b);this.bin={};this.sand={};this.canvasHandle=b.canvasHandle||"main";this.wallInfo=defaultTo(0,b.wallInfo);this.wall=walls[this.wallInfo];this.mass=this.pressureToMass(defaultTo(2,b.init));this.massMin=this.pressureToMass(defaultTo(0.5,b.min));this.massMax=this.pressureToMass(defaultTo(15,b.max));this.particleMass=defaultTo(0.01,b.partMass);this.buttonAddId="sandAdd"+this.handle;this.buttonRemoveId="sandRemove"+
this.handle;this.makeButtons();this.massChunkName="sandMass"+defaultTo("",this.handle);this.wall.setMass(this.massChunkName,this.mass);this.wall.recordPExt();this.wall.recordWork();this.wallHandler=defaultTo("cPAdiabaticDamped",b.compMode);walls.setSubWallHandler(this.wallInfo,0,this.wallHandler);this.trackingPts=[];this.wallPt=this.wall[0];this.emitters=[];this.binX=(this.wall[1].x+this.wall[0].x)/2;this.spcVol=70;this.sand.col=defaultTo(Col(224,165,75),b.sandCol);this.sand.pts=this.getSandPts();
this.sand.pos=P(this.binX,this.wall[0].y).track({pt:this.wallPt,noTrack:"x"});this.trackingPts.push(this.sand.pos);this.pistonPt=this.wall[0].y;this.setupStd();return this.init()}
_.extend(Sandbox.prototype,compressorFuncs,objectFuncs,{init:function(){this.drawListenerName="drawSand"+this.handle;canvasManager.addListener(this.canvasHandle,this.drawListenerName,this.draw,this,2);this.wall.moveInit();this.wall.recordMass();this.wall.recordPExt();return this},makeButtons:function(){var b=this,d=this.handle+"SandButtons";buttonManager.addGroup(d,"Sand controls");buttonManager.addButton(d,"add","Add mass",{mousedown:function(){b.buttonAddDown()}});buttonManager.addButton(d,"remove",
"Remove mass",{mousedown:function(){b.buttonRemoveDown()}})},removeButtons:function(){$("#"+this.buttonAddId).remove();$("#"+this.buttonRemoveId).remove()},draw:function(b){b.save();b.translate(this.sand.pos.x,this.sand.pos.y);var d=Math.sqrt(0.4*this.mass);b.scale(d,d);draw.fillPts(this.sand.pts,this.sand.col,b);this.width=d*(this.sand.pts[this.sand.pts.length-1].x-this.sand.pts[0].x);b.restore()},getSandPts:function(){var b=Array(4);b[0]=P(-10,0);b[1]=P(-7,-2);b[2]=P(-3,-6);b[3]=P(0,-7);ptsRight=
deepCopy(b).splice(0,b.length-1).reverse();mirrorPts(ptsRight,P(0,0),V(0,-10));return b=b.concat(ptsRight)},buttonAddDown:function(){this.mass<this.massMax&&(this.boundUpper(),this.addMass(),addListener(curLevel,"mouseup","mouseUpSandbox",this.buttonAddUp,this))},buttonAddUp:function(){this.boundUpperStop();this.addMassStop();removeListener(curLevel,"mouseup","mouseUpSandbox")},buttonRemoveDown:function(){this.mass>this.massMin&&(this.boundLower(),this.removeMass(),addListener(curLevel,"mouseup",
"mouseUpSandbox",this.buttonRemoveUp,this))},buttonRemoveUp:function(){this.boundLowerStop();this.removeMassStop();removeListener(curLevel,"mouseup","mouseUpSandbox")},boundUpper:function(){var b=this.handle+"BoundUpper";curLevel.updateListeners[b]||addListener(curLevel,"update",b,function(){this.mass>this.massMax&&(this.stopAllEmitters(),removeListener(curLevel,"update",b))},this)},boundLower:function(){var b=this.handle+"BoundLower";curLevel.updateListeners[b]||addListener(curLevel,"update",b,function(){this.mass<
this.massMin&&(this.stopAllEmitters(),removeListener(curLevel,"update",b))},this)},boundUpperStop:function(){removeListener(curLevel,"update",this.handle+"BoundUpper")},boundLowerStop:function(){removeListener(curLevel,"update",this.handle+"BoundLower")},stopAllEmitters:function(){for(var b=0;b<this.emitters.length;b++)this.emitters[b].stopFlow()},addMass:function(){this.emitters.push(this.makeAddEmitter())},addMassStop:function(){this.emitters[this.emitters.length-1].stopFlow()},removeMass:function(){this.emitters.push(this.makeRemoveEmitter())},
removeMassStop:function(){this.emitters[this.emitters.length-1].stopFlow()},makeAddEmitter:function(){var b=this.handle+this.emitterNum;this.emitterNum++;var d={func:this.onArriveAdd,obj:this},e=this.emitters.length,f=Math.PI/2,h=this.sand.col,k=this.wall[0].y,l=new ParticleEmitter({pos:P((this.wall[0].x+this.wall[1].x)/2,0),width:this.width,dist:k,dir:f,col:h,onRemove:m,parentList:this.emitters,onArrive:d,handle:b});l.adding=!0;moveListenerName=unique("adjustEmitter"+e,curLevel.updateListeners);
addListener(curLevel,"update",moveListenerName,function(){l.adjust({dist:this.wallPt.y,width:this.width})},this);var m={func:function(){removeListener(curLevel,"update",moveListenerName)},obj:this};return l},makeRemoveEmitter:function(){var b=this.handle+this.emitterNum;this.emitterNum++;var d={func:this.onGenerateRemove,obj:this},e=this.emitters.length,f=-Math.PI/2,h=this.sand.col,k=(this.wall[0].x+this.wall[1].x)/2,l=this.wall[0].y,m=new ParticleEmitter({pos:P(k,0),width:this.width,dist:l,dir:f,
col:h,onRemove:p,parentList:this.emitters,onGenerate:d,handle:b});m.removing=!0;moveListenerName=unique("adjustEmitter"+e,curLevel.updateListeners);var n=this.wall[0];addListener(curLevel,"update",moveListenerName,function(){m.adjust({pos:P(k,n.y),dist:n.y,width:this.width})},this);var p={func:function(){removeListener(curLevel,"update",moveListenerName)},obj:this};return m},onGenerateRemove:function(){this.mass-=this.particleMass;this.wall.setMass(this.massChunkName,this.mass)},onArriveAdd:function(){this.mass+=
this.particleMass;this.wall.setMass(this.massChunkName,this.mass)},remove:function(){for(var b=0;b<this.emitters.length;b++)this.emitters[b].remove();this.emitters=[];this.trackingPts.map(function(b){b.trackStop()});this.trackingPts.splice(0,this.trackingPts.length);this.removeButtons();canvasManager.removeListener(this.canvasHandle,this.drawListenerName);removeListener(curLevel,"data",this.cleanUpEmittersListenerName);this.wall.moveStop()}});function Stops(b){this.type="Stops";this.handle=b.handle;this.stopWidth=20;this.stopHeight=5;this.boundToSet=void 0;var d=b.stopPt;this.wallInfo=defaultTo(0,b.wallInfo);this.pts=this.wall=walls[this.wallInfo];this.canvasHandle=b.canvasHandle||"main";if(d.vol){var e=this.pts[0].distTo(this.pts[1]);this.height=this.pts[2].y-d.vol/(vConst*e)}else d.y&&(this.height=d.height);if(this.willDraw=defaultTo(!0,b.draw))this.draw=this.makeDrawFunc(this.height);this.setupStd();return this.init()}
_.extend(Stops.prototype,objectFuncs,{makeDrawFunc:function(b){var d=this.pts[3].copy().position({y:b}),e=this.pts[2].copy().position({y:b}).movePt({dx:-this.stopWidth}),f=V(this.stopWidth,this.stopHeight),h=borderCol;return function(b){draw.fillRect(d,f,h,b);draw.fillRect(e,f,h,b)}},init:function(){this.boundToSet=this.height>this.wall[0].y?"max":"min";this.yBoundSave=this.wall.bounds[this.boundToSet];"max"==this.boundToSet?walls[this.wallInfo].setBounds(void 0,this.height):"min"==this.boundToSet&&
walls[this.wallInfo].setBounds(this.height,void 0);this.willDraw&&canvasManager.addListener(this.canvasHandle,"drawStops"+this.wallInfo,this.draw,this,1);return this},remove:function(){window.walls&&!walls.removed&&("max"==this.boundToSet?walls[this.wallInfo].setBounds(void 0,this.yBoundSave):"min"==this.boundToSet&&walls[this.wallInfo].setBounds(this.yBoundSave,void 0));this.willDraw&&canvasManager.addListener(this.canvasHandle,"drawStops"+this.wallInfo);return this}});function TempChanger(b){this.type="tempChanger";this.info=b.info;this.min=defaultTo(100,b.min);this.val=dataHandler.temp(this.info);this.max=defaultTo(1500,b.max);this.sliderPos=b.sliderPos;this.handle=b.handle;this.totalDots=dataHandler.count(this.info);this.setupStd();return this.init()}
_.extend(TempChanger.prototype,objectFuncs,{init:function(){this.sliderId=this.addSlider(1<this.totalDots?"System temperature":"Molecule's kinetic energy",{value:this.valToPercent(this.val)},[{eventType:"slide",obj:this,func:this.parseSlider}],this.sliderPos)},parseSlider:function(b,d){changeTemp(this.info,this.percentToVal(d.value))},remove:function(){this.removeSlider()}});function Tracer(b){this.handle=b.handle;this.type="Tracer";this.info=b.info;this.col=defaultTo(Col(175,175,175),b.col);this.lifespan=Math.round(1E3/updateInterval*defaultTo(5,b.lifespan));this.listenerHandle=this.type+this.handle+"Draw";this.listenerHandleSearch=this.type+this.handle+"Search";this.setupStd();this.canvasHandle=b.canvasHandle||"main";this.drawingTools=draw;this.init()}
_.extend(Tracer.prototype,objectFuncs,{init:function(){this.dot=this.getDot();this.pts=[];this.dot?(removeListener(curLevel,"update",this.listenerHandleSearch),canvasManager.addListener(this.canvasHandle,this.listenerHandle,this.draw,this,3)):addListener(curLevel,"update",this.listenerHandleSearch,this.init,this)},getDot:function(){var b=dotManager.get(this.info);if(0<b.length)return this.info.idx&&this.info.idx<b.length?b[this.info.idx]:b[Math.floor(Math.random()*b.length)]},draw:function(b){this.dot.active?
(this.pts.push(P(this.dot.x,this.dot.y)),this.pts.length>this.lifespan&&this.pts.splice(0,1),this.drawingTools.path(this.pts,this.col,b)):(canvasManager.removeListener(this.canvasHandle,this.listenerHandle),this.init())},remove:function(){removeListener(curLevel,"update",this.listenerHandleSearch);canvasManager.removeListener(this.canvasHandle,this.listenerHandle)}});function Trigger(b){this.type="Trigger";this.handle=b.handle;this.conditionFunc=this.wrapExpr(b.expr);this.checkOn=b.checkOn;this.requiredFor=!1===b.requiredFor?void 0:b.requiredFor||"now";this.message=b.message;this.priority=defaultTo(0,b.priorityUnsatisfied||b.priority);this.satisfyStore=defaultTo(void 0,b.satisfyStore);this.satisfyCmmds=defaultTo(void 0,b.satisfyCmmds);this.amSatisfied=!1;this.setupStd();this.init()}
_.extend(Trigger.prototype,objectFuncs,{init:function(){"conditions"==this.checkOn?this.initCheckOnConditions():this.initCheckOnInterval()},wrapExpr:function(b){with(DataGetFuncs)b=eval("(function() {return "+b+"})");return b},initCheckOnConditions:function(){this.requiredFor&&conditionManager.add(this)},initCheckOnInterval:function(){addListener(curLevel,"update",this.handle,function(){if(this.conditionFunc()){this.amSatisfied=!0;this.recordVals();if(this.satisfyCmmds)for(var b=0;b<this.satisfyCmmds.length;b++)eval(this.satisfyCmmds[b]);
removeListener(curLevel,"update",this.handle)}},this);this.requiredFor&&conditionManager.add(this)},recordVals:function(){with(DataGetFuncs)if(this.satisfyStore)for(var b=0;b<this.satisfyStore.length;b++){var d=this.satisfyStore[b],e=d.storeAs,d=eval(d.expr);store(e,d)}},isSatisfied:function(){return this.amSatisfied},remove:function(){removeListener(curLevel,"update",this.handle)}});function AuxImage(b){this.type="AuxImage";this.handle=b.handle;this.imgFunc=b.imgFunc;this.slotNum=b.slotNum;this.dims=this.getDims();this.bgCol=curLevel.bgCol;this.makeDiv(this.slotNum);this.addImage(this.imgFunc);curLevel.auxs[this.handle]=this;this.setupStd()}
_.extend(AuxImage.prototype,AuxFunctions,objectFuncs,{makeDiv:function(b){this.parentDiv=this.pickParentDiv("picture",b);this.parentDiv.html("");$(this.parentDiv).css({width:this.dims.dx,height:this.dims.dy,"background-color":this.bgCol.hex,"border-radius":20,padding:0})},addImage:function(b){var d=this;b=interpreter.parseImgFunc(b,!0);b.attrs||(b.attrs={});b.attrs.id=[this.type+this.handle];$(this.parentDiv).append(templater.img(b));var e=$("#"+b.attrs.id[0]);$(e).load(function(){var b=V(d.parentDiv.width(),
d.parentDiv.height()),h=V(e.width(),e.height()),k=Math.min(h.dx,b.dx)/h.dx,l=Math.min(h.dy,b.dy)/h.dy,k=Math.min(k,l),h=h.copy().mult(k),b=P(b.dx/2-h.dx/2,b.dy/2-h.dy/2);$(e).css({position:"absolute",left:b.x,top:b.y,width:h.dx,height:h.dy})})},clearHTML:function(){this.cleanUpParent()},restoreHTML:function(){$(this.parentDiv).css({width:this.dims.dx,height:this.dims.dy,"background-color":this.bgCol.hex,"border-radius":20,padding:0});this.addImage(this.imgFunc)},remove:function(){this.cleanUpParent();
delete curLevel.auxs[this.handle]}});function AnimText(b){this.drawCanvas=b}
AnimText.prototype={newAnim:function(b,d,e){var f=unique("animText",curLevel.updateListeners),h=e.text,k=new Boolean,l=new Boolean,m=new Boolean,n=new Boolean,k=void 0!==d.pos,l=void 0!==d.col,m=void 0!==d.rotation,n=void 0!==d.size,p;p=Col(255,255,255);var r=defaultTo("calibri",e.font),s=defaultTo("center",e.align);e=defaultTo(300,e.time);var t,u,w,x;b.size=defaultTo(13,b.size);b.rot=defaultTo(0,b.rot);b.col=defaultTo(p,b.col);t=b.size;u=b.rot;w=b.col;x=b.pos.copy();var y=Math.floor(e/updateInterval),
z=function(){},F=function(){},C=function(){},A=function(){},v,B,T,E,Q,M;k&&(k=V(d.pos.x-b.pos.x,d.pos.y-b.pos.y),v=k.UV().mult(k.mag()/y),z=function(){x.x+=v.dx;x.y+=v.dy});l&&(B=Math.ceil((d.col.r-b.col.r)/y),T=Math.ceil((d.col.g-b.col.g)/y),E=Math.ceil((d.col.b-b.col.b)/y),F=function(){w.adjust(B,T,E)});m&&(l=d.rotation-b.rotation,Q=l<=Math.PI?l/y:-l/y,C=function(){u+=Q});n&&(M=(d.size-b.size)/y,A=function(){t+=M});var L=0,K=this.drawCanvas;addListener(curLevel,"update",f,function(){draw.text(h,
x,Math.floor(t)+"pt "+r,w,s,u,K);z();F();C();A();L==y&&removeListener(curLevel,"update",f);L++},"")}};function Readout(b,d,e,f,h,k,l,m,n){this.handle=b;this.align=defaultTo("left",l);this.canvasHandle=n||"main";this.font=defaultTo("11pt calibri",h);this.fontCol=defaultTo(Col(255,255,255),k);this.leftBound=d;this.width=e-d;this.y=f;this.entries=[];m.readouts[b]=this}
Readout.prototype={draw:function(b){b.save();b.translate(this.leftBound,this.y);for(var d=0;d<this.entries.length;d++){var e=this.entries[d];draw.text(e.text,e.pos,this.font,this.fontCol,this.align,0,b)}b.restore()},update:function(b,d){var e=byAttr(this.entries,b,"name");e.val=round(d,e.decPlaces)},addEntry:function(b,d){var e=new Readout.Entry(b,"",this);d?this.entries.splice(d,0,e):this.entries.push(e);this.positionEntries();this.hide().show();return e},removeEntry:function(b){for(var d=0;d<this.entries.length;d++)if(this.entries[d].handle==
b)return this.entries.splice(d,1),this.positionEntries(),this;console.log("Tried to remove entry that does not exist: "+b)},entryExists:function(b){for(var d=0;d<this.entries.length;d++)if(this.entries[d].name==b)return!0;return!1},removeAllEntries:function(){this.entries=[]},positionEntries:function(){var b=this.entries.length,d;d=1<b?Math.floor(this.width/(b-1)):this.width;if("center"==this.align){d=this.width/(b+1);for(var e=0;e<b;e++){var f=this.entries[e],h=d*(e+1),k=0;f.pos=P(h,k)}}else if("left"==
this.align)for(e=0;e<b;e++)f=this.entries[e],h=d*e,k=0,f.pos=P(h,k)},getNumEntries:function(){var b=0,d;for(d in this.entries)b++;return b},reset:function(b){var d=byName(this.entries,b);this.tickReadout(d.curVal,d.setPt,b)},resetAll:function(){for(var b=0;b<this.entries.length;b++){var d=this.entries[b];this.hardUpdate(d.initVal,d.name)}},position:function(b){void 0!==b.x&&(this.leftBound=b.x);void 0!==b.y&&(this.y=b.y)},show:function(){curLevel.readouts[this.handle]=this;canvasManager.addListener(this.canvasHandle,
"drawReadout"+this.handle,this.draw,this,999);return this},hide:function(){delete curLevel.readouts[this.handle];canvasManager.removeListener(this.canvasHandle,"drawReadout"+this.handle);removeListener(curLevel,"update","drawReadout"+this.handle);return this}};Readout.Entry=function(b,d,e){this.handle=b;this.text=d;this.pos=void 0;this.readout=e};Readout.Entry.prototype={setText:function(b){this.text=b},remove:function(){this.readout.removeEntry(this.handle)}};LevelSettings={bgCol:Col(5,17,26)};
LevelTools={setStds:function(){this.graphs={};this.bgCol=LevelSettings.bgCol.copy();this.wallCol=Col(255,255,255);this.numUpdates=0;this.wallSpeed=defaultTo(1,this.wallSpeed);this.makeListenerHolders();this.auxs={};this.gravitying=this.attracting=!1;this.setUpdateRunListener();addListener(this,"data","run",this.dataRun,this)},addStoreAs:function(b){for(var d=0,e=0;e<b.length;e++)for(var f=b[e],h=0;h<f.prompts.length;h++){var k=f.prompts[h];if(k.quiz)for(var l=0;l<k.quiz.length;l++){var m=k.quiz[l];
void 0===m.storeAs&&(m.storeAs="questionAnswer"+String(d));d++}}},addImgsAndQuestionIds:function(b,d){for(var e=0;e<b.length;e++){var f=b[e];f.prompts||console.log("Section "+e+" has no prompts!  Sections must have at least one prompt.");for(var h=0;h<f.prompts.length;h++){var k=prompt.title,l=prompt.text,m=prompt.quiz;k&&(prompt.title=interpreter.interpImgs(k));l&&(prompt.text=interpreter.interpImgs(k));if(m)for(k=0;k<m.length;k++)if(l=m[k],l.storeAs||(l.storeAs="storeAs"+d),d++,l.options)for(optionIdx=
0;optionIdx<l.options.length;optionIdx++){var n=l.options[optionIdx];for(optionElement in n){var p=n[optionElement];"string"==typeof p&&(n[optionElement]=interpreter.interpImgs(p))}}}}return d},assumeDefaultRxnType:function(b){for(var d=0;d<b.length;d++){var e=b[d];e.sceneData&&!e.sceneData.rxnsEmergent&&(e.sceneData.rxnsEmergent=e.sceneData.rxns);for(var f=0;f<e.prompts.length;f++){var h=e.prompts[f].sceneData;h&&!h.rxnsEmergent&&(h.rxnsEmergent=h.rxns)}}},transferObjCleanUp:function(b){for(var d=
0;d<b.length;d++){var e=b[d];e.sceneData&&this.transferObjDataCleanUp(e.sceneData.objs);for(var f=0;f<e.prompts.length;f++){var h=e.prompts[f];h.sceneData&&this.transferObjDataCleanUp(h.sceneData.objs)}}},transferObjDataCleanUp:function(b){if(b)for(var d=0;d<b.length;d++){var e=b[d];e.attrs.cleanUpWith&&!e.cleanUpWith&&(e.cleanUpWith=e.attrs.cleanUpWith)}},addTriggerCleanUp:function(b){for(var d=0;d<b.length;d++){var e=b[d];e.sceneData&&this.addTriggerDataCleanUp(e.sceneData.triggers);for(var f=0;f<
e.prompts.length;f++){var h=e.prompts[f];h.sceneData&&this.addTriggerDataCleanUp(h.sceneData.triggers)}}},addTriggerDataCleanUp:function(b){b=b||[];for(var d=0;d<b.length;d++){var e=b[d];!e.cleanUpWith&&(e.requiredFor&&"now"!=e.requiredFor)&&(e.cleanUpWith=e.requiredFor)}},setDefaultPromptVals:function(b){for(var d=0;d<b.length;d++)for(var e=b[d],f=0;f<e.prompts.length;f++){var h=e.prompts[f];h.finished=!1;h.title=defaultTo("",h.title);h.text=defaultTo("",h.text)}},addUF298:function(b){for(var d=
0;d<b.length;d++)b[d].uF298=b[d].hF298-298.15*R/1E3},addCp:function(b){for(var d=0;d<b.length;d++)b[d].cp=b[d].cv+R},addSpcs:function(b,d,e){for(var f=0;f<b.length;f++){var h=b[f],k=new Species(h.spcName,h.m,h.r,h.col,f,h.cv,h.hF298,h.hVap298,h.sF298,h.antoineCoeffs,h.cpLiq,h.spcVolLiq,e);d[h.spcName]=k}},move:function(){var b=this.spcs,d;for(d in b)for(var e=b[d].dots,f=0;f<e.length;f++)e[f].x+=e[f].v.dx,e[f].y+=e[f].v.dy},cutSceneStart:function(b,d,e){this.inCutScene=!0;$("#intText").html("");b=
defaultTo("",b);this.pause();$("#dashRunWrapper").hide();$("#buttonManager").hide();!0===d?($("#dashCutScene").show(),this.cutSceneText(b),$("#prompt").html("")):"intro"==d?($("#dashIntro").show(),$("#base").hide(),this.cutSceneText(b)):"outro"==d&&($("#dashOutro").show(),$("#base").hide(),this.cutSceneText(b));$("#canvasDiv").hide();$("#display").show();this.cutSceneDivShow()},cutSceneDivShow:function(){$("#intText").show()},cutSceneText:function(b){$("#intText").html(b)},showRunDivs:function(){$("#intText").html("");
$("#dashRunWrapper").show();$("#buttonManager").show();$("#dashRun").show();$("#dashOutro").hide();$("#dashIntro").hide();$("#dashCutScene").hide();$("#nextPrevDiv").show();$("#base").show();$("#canvasDiv").show();$("#display").hide();$("#intText").hide()},cutSceneEnd:function(){this.inCutScene=!1;this.resume();this.showRunDivs();$("#intText").html("")},pause:function(){this.updateStore=this.update;this.updateDataStore=this.updateData;this.update=function(){};this.updateData=function(){}},resume:function(){this.updateStore&&
(this.update=this.updateStore);this.updateDataStore&&(this.updateData=this.updateDataStore)},hideDash:function(){$("#dashIntro").hide();$("#dashRunWrapper").hide();$("#dashOutro").hide();$("#dashCutScene").hide()},update:function(){this.numUpdates++;turn++;this.updateRun();canvasManager.draw();for(var b in this.updateListeners){var d=this.updateListeners[b];d.func.apply(d.obj)}for(var e in this.wallMoveListeners)d=this.wallMoveListeners[e],d.func.apply(d.obj)},updateData:function(){for(var b in this.dataListeners){var d=
this.dataListeners[b];d.func.apply(d.obj)}this.numUpdates=0},delayGraphs:function(){var b=this;window.setTimeout(function(){b.dataRunNoGraphs();addListener(curLevel,"data","run",b.dataRun,b)},50)},dataRunNoGraphs:function(){for(var b in this.recordListeners){var d=this.recordListeners[b];d.func.apply(d.obj)}},dataRun:function(){for(var b in this.recordListeners){var d=this.recordListeners[b];d.func.apply(d.obj)}for(var e in this.graphs)this.graphs[e].active&&this.graphs[e].addLast()},setUpdateRunListener:function(){this.updateRun=
this.attracting&&this.gravitying?this.updateRunAttractAndGravity:this.attracting?this.updateRunAttract:this.gravitying?this.updateRunGravity:this.updateRunBasic},gravity:function(b){this.gravitying=!0;for(b=0;b<walls.length;b++)walls[b].setHitMode("Gravity");this.setUpdateRunListener()},gravityStop:function(){this.gravitying=!1;this.setUpdateRunListener()},doGravity:function(){for(var b in spcs)for(var d=spcs[b].dots,e=0;e<d.length;e++)d[e].v.dy+=gInternal,d[e].y+=0.5*gInternal},attract:function(b){this.attracting=
!0;attractor.setup();attractor.assignELastAll();this.setUpdateRunListener()},attractStop:function(){this.attracting=!1;attractor.zeroAllEnergies();this.setUpdateRunListener()},updateRunBasic:function(){this.move();collide.check();walls.check()},updateRunGravity:function(){this.move();collide.check();this.doGravity();walls.check()},updateRunAttract:function(){this.move();collide.check();attractor.attract();walls.check()},updateRunAttractAndGravity:function(){this.move();collide.check();attractor.attract();
this.doGravity();walls.check()},drawRun:function(b){draw.dots(b);draw.walls(walls,b)},resetGraphs:function(){for(var b in this.graphs)this.graphs[b].reset()},removeGraph:function(b){this.graphs[b].remove();this.graphs[b]=void 0},removeAllGraphs:function(){for(var b in this.graphs)this.removeGraph(b),delete this.graphs[b]},saveAllGraphs:function(){for(var b in this.graphs)this.graphs[b].save(b+"section"+sectionIdx+"prompt"+promptIdx)},disableAllGraphs:function(){for(var b in this.graphs)this.graphs[b].disable()},
selectObj:function(b,d){return/^wall$/i.test(b)?walls[d]||console.log("Bad command wall handle "+d):this[this.key(b,d)]||console.log("Bad command data: Type "+b+" and handle "+d)},key:function(b,d){return b.toCamelCase()+d.toCapitalCamelCase()},makeListenerHolders:function(){makeListenerHolder(this,"update");makeListenerHolder(this,"wallMove");makeListenerHolder(this,"data");makeListenerHolder(this,"mousedown");makeListenerHolder(this,"mouseup");makeListenerHolder(this,"mousemove");makeListenerHolder(this,
"init");makeListenerHolder(this,"record");makeListenerHolder(this,"sectionCondition");makeListenerHolder(this,"promptCondition");makeListenerHolder(this,"setup")}};function LevelInstance(){this.readouts={};this.setStds()}_.extend(LevelInstance.prototype,LevelTools);function Timeline(b,d,e,f){this.parent=b;this.buttonManagerBlank=d||document.getElementById("buttonManager").outerHTML;this.isSectionsBranch=e||!1;this.isPromptsBranch=f||!1;this.sections=[];this.sectionIdx=void 0;this.curId=0;this.elems=[];this.suspended=!1}
Timeline.prototype={curSection:function(){return this.sections[this.sectionIdx]},curPrompt:function(){return this.sections[this.sectionIdx].curPrompt()},pushSection:function(b,d,e){this.sections.push(new Timeline.Section(this,b,this.buttonManagerBlank,void 0,d,e))},clearCurrentSection:function(){void 0!==this.sectionIdx&&this.sections[this.sectionIdx].clear()},now:function(){return{sectionIdx:this.sectionIdx,promptIdx:this.sections[this.sectionIdx].promptIdx}},nowTime:function(){return{sectionIdx:this.sectionIdx,
promptIdx:Math.floor(this.sections[this.sectionIdx].time)}},surface:function(b){var d=!1;b=defaultTo(!0,b);this.parent&&(this.isSectionsBranch?(d=this.curSection().cleanUpPrompt(b))||this.clearCurrentSection():this.isPromptsBranch&&(d=this.curSection().cleanUpPrompt(b)),d?this.curSection().promptIdx+=0.5:this.parent.catchSurface(this,b))},catchSurface:function(b,d){window.timeline=this;timeline.suspended=!1;this.curSection().pushToGlobal();d||(this.curSection().time-=1E-4);b.isSectionsBranch&&this.curSection().restoreHTML();
d?sceneNavigator.nextPrompt(!0,!1):sceneNavigator.prevPrompt()},findElemBoundsByHandle:function(b){var d=[],e,f,h,k,l,m;f=0;a:for(;f<this.sections.length;f++){k=this.sections[f].moments;for(h=0;h<k.length;h++){l=k[h].events;for(m=0;m<l.walls.length;m++)if(b==l.walls[m].elemDatum.handle&&(d.push(k[h].timestamp),e=f,2==d.length))break a;for(m=0;m<l.objs.length;m++)if(l.objs[m].elemDatum.handle){if(l.objs[m].elemDatum.handle==b&&(d.push(k[h].timestamp),e=f,2==d.length))break a}else if(l.objs[m].elemDatum.attrs&&
l.objs[m].elemDatum.attrs.handle==b&&(d.push(k[h].timestamp),e=f,2==d.length))break a;for(m=0;m<l.cmmds.length;m++)if(b==l.cmmds[m].elemDatum.handle&&(d.push(k[h].timestamp),e=f,2==d.length))break a}}d.push(e);return d},show:function(b,d,e,f){var h=this.sectionIdx!=b;f=h||d!=this.sections[b].promptIdx||f;h&&void 0!==this.sectionIdx&&this.sections[this.sectionIdx].cleanUpPrompt(b>this.sectionIdx);if(h||e)this.clearCurrentSection(),this.sectionIdx=b,this.sections[b].showSection();(f||e)&&this.sections[b].showPrompt(d)},
addOnce:function(b,d,e,f,h){b="now"==b?this.sectionIdx:b;this.sections[b].addOnce(d,e,f,h)},refresh:function(){this.sendRefreshToCW();var b=this.sections[this.sectionIdx],d=b.sectionData.prompts[b.promptIdx],e=b.motherSection,f=b.motherTimeline,b=new Timeline.Section(b.motherTimeline,e.sectionData,this.buttonManagerBlank,e.conditionManager);e.clear();b.copyBranchCmmds(e.moments);var h=f.sections.indexOf(e);f.sections.splice(h,1,b);b.showSection();b.deepStepTo(d,e.branches)},sendRefreshToCW:function(){var b=
this.curPrompt().resetId;void 0!==b&&sendToCW("Section was refreshed",b)},takeNumber:function(){return this.curId++}};
Timeline.Section=function(b,d,e,f,h,k){this.timeline=b;this.inited=!1;this.promptIdx=-1;this.time=-2;this.branches=[];this.sectionData=d;this.moments=[];this.populateMoments(b,b.elems,this.moments,this.sectionData);this.sortMoments();this.level=new LevelInstance;this.mainReadout=new Readout("mainReadout",30,myCanvas.width-125,25,"11pt calibri",Col(255,255,255),"left",this.level);this.dotManager=new DotManager;this.collide=new CollideHandler(this.dotManager);this.walls=WallHandler();this.dataHandler=
new DataHandler;this.dataDisplayer=new DataDisplayer;this.conditionManager=f?f.stripForInheritance():new ConditionManager;this.activationEnergySpcChanger=new ActivationEnergySpcChanger(this.collide);this.buttonManager=new ButtonManager("buttonManager");this.spcs={};LevelTools.addSpcs(LevelData.spcDefs,this.spcs,this.dotManager);this.sliderList=[];this.dataDisplayer.setReadouts(this.level.readouts);this.canvasManager=new CanvasManager;this.canvasManager.addCanvas("main",myCanvas,c,LevelSettings.bgCol);
this.canvasManager.addListener("main","drawRun",LevelTools.drawRun,void 0,0);this.collide.setSpcs(this.spcs);this.level.spcs=this.spcs;this.level.dataHandler=this.dataHandler;this.buttonMangerClone;this.buttonManagerBlank=e;this.dashRunId="dashRun"+window.dashRunId++;this.dashRun=$("#dashRunBlank").clone(!0).attr("id",this.dashRunId);$("#dashRunWrapper").append(this.dashRun);this.sliderManager=new SliderManager(this.dashRunId);this.motherTimeline=h||this.timeline;this.motherSection=k||this};
Timeline.Section.prototype={showSection:function(){this.dashRun.show();this.dashRun.addClass("active");this.replaceDiv($("#buttonManagerWrapper"),$("#buttonManager"),this.buttonManagerClone||this.buttonManagerBlank);this.pushToGlobal();this.inited?(this.restoreAuxs(),this.restoreGraphs()):(this.stepTo(-1),this.promptIdx=-1,this.inited=!0)},restoreHTML:function(){this.dashRun.show();this.dashRun.addClass("active");this.replaceDiv($("#buttonManagerWrapper"),$("#buttonManager"),this.buttonManagerClone||
this.buttonManagerBlank);this.restoreGraphs();this.restoreAuxs()},showPrompt:function(b){var d=this.getTimestamp(b,"headHTML");this.stepTo(d)?(this.timeline.suspended=!0,this.promptIdx=Math.floor(this.time)+0.5):this.promptIdx=b},stepTo:function(b){var d=!1,e=!1,f=this.time;if(b>this.time||b<this.time&&!/headhtml/i.test(this.getTimestampType(b))){var h=this.momentAt(this.time);h&&h.fire(this.time,b);h&&(this.time+=b>this.time?1E-4:-1E-4);for(;b!=this.time;){h=this.nextTowardsDest(this.time,b);if(!h)break;
var k=this.getTimestamp(Math.floor(h.timestamp),"branchPreClean"),l=this.getTimestamp(Math.floor(h.timestamp),"branchPostClean");this.time=h.timestamp;h.fire(f,b);if(1E-5>Math.abs(h.timestamp-k)||1E-5>Math.abs(h.timestamp-l)){d=this.branches[Math.floor(this.time)].timeline;d=d.isSectionsBranch?"sections":d.isPromptsBranch?"prompts":void 0;break}}}else if(b<this.time){(h=this.momentAt(this.time))&&h.fire(this.time,b);h&&(this.time-=1E-4);for(var m=this.getTimestamp(Math.floor(b),"branchPreClean");m!=
this.time;){h=this.nextTowardsDest(this.time,m);if(!h)break;k=this.getTimestamp(Math.floor(h.timestamp),"branchPreClean");l=this.getTimestamp(Math.floor(h.timestamp),"branchPostClean");this.time=h.timestamp;h.fire(f,b);if(1E-5>Math.abs(h.timestamp-k)||1E-5>Math.abs(h.timestamp-l)){d=this.branches[Math.floor(this.time)].timeline;d=d.isSectionsBranch?"sections":d.isPromptsBranch?"prompts":void 0;e=!0;break}}if(!e)for(this.time=this.getTimestamp(Math.floor(b+1E-4),"setup")-1E-4;b!=this.time;){h=this.nextMoment(this.time);
if(!h)break;f=this.time;this.time=h.timestamp;h.fire(f,b)}}return d},deepStepTo:function(b,d){for(var e=-1,f=this.moments.indexOf(this.nextMoment(e));f<this.moments.length-1;f++){var h=this.moments[f],k;h.events.branchCmmd&&(k=h.events.branchCmmd,h.events.branchCmmd=void 0);var l=this.moments[f].timestamp;if(this.sectionData.prompts[Math.floor(h.timestamp)]==b)return this.stepTo(this.getTimestamp(h.timestamp,"headhtml")),this.promptIdx=Math.floor(h.timestamp),!0;this.promptIdx=Math.floor(this.time);
h.fire(e,l);if(k){h.events.branchCmmd=k;var m=Math.floor(this.time),e=d[m];if(e.timeline.isSectionsBranch)this.branches[m]=e;else if(e.timeline.isPromptsBranch){var n=e.timeline.sections[0].branches,p=new Timeline.Moment(h.timestamp);p.events.branchCmmd=k;p.fire(this.time,l);m=this.branches[m];m.timeline.sections[0].copyBranchCmmds(e.timeline.sections[0].moments);e=m.timeline.sections[0].deepStepTo(b,n);this.promptIdx=Math.floor(this.time)+0.5;this.time=h.timestamp;if(e)return!0}}this.time=e=l}return!1},
copyBranchCmmds:function(b){for(var d=0;d<b.length;d++){var e=b[d],f=e.events.branchCmmd;if(f){f.section=this;var h=this.momentAt(e.timestamp);h?h.events.branchCmmd=f:(h=new Timeline.Moment(e.timestamp),h.events.branchCmmd=f,this.spliceInMoment(h))}}},nextTowardsDest:function(b,d){var e=this.momentAt(b);if(e){e=this.moments.indexOf(e);d<b?e--:e++;var f=this.moments[e];if(f&&Math.abs(f.timestamp-b)<=Math.abs(d-b))return this.moments[e]}else if(b<d)for(e=0;e<this.moments.length;e++){if(f=this.moments[e],
f.timestamp>b){if(f.timestamp<=d)return f;break}}else if(d<b)for(e=this.moments.length-1;0<=e;e--)if(f=this.moments[e],f.timestamp<b){if(f.timestamp>=d)return f;break}},nextMoment:function(b){for(var d=0;d<this.moments.length;d++)if(this.moments[d].timestamp>b)return this.moments[d]},momentAt:function(b){for(var d=0;d<this.moments.length;d++)if(1E-5>Math.abs(this.moments[d].timestamp-b))return this.moments[d]},cleanUpPrompt:function(b){b=b?this.getTimestamp(this.sectionData.prompts.length-1,"branchPostClean")+
1E-4:this.getTimestamp(0,"head")-1E-4;var d=this.stepTo(b);this.time=b;return d},spliceInMoment:function(b){for(var d=0;d<this.moments.length;d++)if(this.moments[d].timestamp>b.timestamp){this.moments.splice(d,0,b);break}},branchPromptsPreClean:function(b){var d=this.getTimestamp(Math.floor(this.time),"branchPreClean");this.branchPrompts(b,d)},branchPromptsPostClean:function(b){var d=this.getTimestamp(Math.floor(this.time),"branchPostClean");this.branchPrompts(b,d)},branchPrompts:function(b,d){this.killBranchMoments();
var e=new Timeline.Moment(d),f=new Timeline.Command("point",function(e,f){var l=Math.floor(d);if(f.branches[l]&&f.branches[l].id==b.id)window.timeline=f.branches[l].timeline,timeline.sections[0].pushToGlobal(),l=timeline.now(),timeline.show(l.sectionIdx,l.promptIdx,!1,!0);else{var m=new Timeline(e,f.buttonManagerBlank,!1,!0);f.branches[l]=new Timeline.Branch(m,b.id);m.pushSection({prompts:b},f.motherTimeline,f.motherSection);m.sections[0].inheritState(f);m.sectionIdx=0;m.inited=!0;window.timeline=
m;m.sections[0].pushToGlobal();m.show(0,0)}},void 0,!1,!1,void 0);e.events.branchCmmd=new Timeline.Event.BranchCmmd(this,this.timeline.elems,f,Timeline.stateFuncs.cmmds.spawn,this.timeline.takeNumber(),e,!1);this.spliceInMoment(e)},branchSections:function(b){this.killBranchMoments();var d=this.getTimestamp(Math.floor(this.time),"branchPostClean"),d=new Timeline.Moment(d),e=new Timeline.Command("point",function(d,e){var k=Math.floor(e.time);if(e.branches[k]&&e.branches[k].id==b.id)d.clearCurrentSection(),
window.timeline=e.branches[k].timeline,timeline.sections[timeline.sectionIdx].pushToGlobal(),timeline.sections[timeline.sectionIdx].showSection(),k=timeline.now(),timeline.show(k.sectionIdx,k.promptIdx,!1,!0);else{for(var k=new Timeline(d,d.buttonManagerBlank,!0,!1),l=0;l<b.length;l++)k.pushSection(b[l]);e.branches[e.promptIdx]=new Timeline.Branch(k,b.id);e.timeline.clearCurrentSection();window.timeline=k;k.show(0,0)}},void 0,!1,!1,void 0);d.events.branchCmmd=new Timeline.Event.BranchCmmd(this,this.timeline.elems,
e,Timeline.stateFuncs.cmmds.spawn,this.timeline.takeNumber(),d,!0);this.spliceInMoment(d)},killBranches:function(){this.killBranchMoments();this.branches[this.promptIdx]=void 0},killBranchMoments:function(){var b=this.getTimestamp(Math.floor(this.time),"branchPreClean"),d=this.getTimestamp(Math.floor(this.time),"branchPostClean"),b=this.momentAt(b),d=this.momentAt(d);b&&this.moments.splice(this.moments.indexOf(b),1);d&&this.moments.splice(this.moments.indexOf(d),1)},curPrompt:function(){return this.sectionData.prompts[this.promptIdx]},
replaceDiv:function(b,d,e){d.length&&d.remove();b.append(e)},inheritState:function(b){this.level=b.level;this.collide=b.collide;this.walls=b.walls;this.dotManager=b.dotManager;this.spcs=b.spcs;this.dataDisplayer=b.dataDisplayer;this.sliderList=b.sliderList;this.buttonManager=b.buttonManager;this.dataHandler=b.dataHandler;this.activationEnergySpcChanger=b.activationEnergySpcChanger},pushToGlobal:function(){window.curLevel=this.level;window.collide=this.collide;window.walls=this.walls;window.dotManager=
this.dotManager;window.spcs=this.spcs;window.dataDisplayer=this.dataDisplayer;window.canvasManager=this.canvasManager;window.sliderList=this.sliderList;window.buttonManager=this.buttonManager;window.sliderManager=this.sliderManager;window.dataHandler=this.dataHandler;window.activationEnergySpcChanger=this.activationEnergySpcChanger;window.conditionManager=this.conditionManager},restoreAuxs:function(){for(var b in this.level.auxs)this.level.auxs[b].restoreHTML()},restoreGraphs:function(){for(var b in this.level.graphs){var d=
this.level.graphs[b];d.setDataValid();d.restoreHTML();d.drawAllData()}},clear:function(){if(this.inited){$("#prompt").html("");this.buttonManagerClone=$("#buttonManager").clone(!0);$("#buttonManager").html("");$("#baseHeader").html("");this.dashRun.removeClass("active");this.dashRun.hide();for(var b in this.level.graphs)this.level.graphs[b].clearHTML();for(var d in this.level.auxs)this.level.auxs[d].clearHTML()}},addCmmdSpan:function(b,d){promptIdx="now"==b?this.promptIdx:b;var e=this.getTimestamp(promptIdx,
"setup"),f=this.timeline.takeNumber();cmmd="string"==typeof d||"function"==typeof d?new Timeline.Command("span",d,void 0,!0,!1):new Timeline.Command("span",d.spawn,d.remove,!1,d.once,d.cleanUpWith);this.timeline.elems[f]=cmmd;this.applyCmmdSpan(this.timeline,this.moments,this.timeline.elems,cmmd,"cmmds",cmmd.once,e,f);this.sortMoments()},addCmmdPoint:function(b,d,e,f,h){promptIdx="now"==b?this.promptIdx:b;b=this.timeline.takeNumber();d=this.getTimestamp(promptIdx,d||"setup");e=new Timeline.Command("point",
e,void 0,f,h);this.timeline.elems[b]=e;this.applyCmmdPoint(this.timeline,this.moments,this.timeline.elems,e,"cmmds",h,d,b);this.sortMoments()},populateMoments:function(b,d,e,f){e.push(new Timeline.Moment(-2));this.addSceneDataToMoments(b,d,e,f.sceneData,-1,void 0);for(var h=f.prompts,k=0;k<h.length;k++)h[k].sceneData&&this.addSceneDataToMoments(b,d,e,h[k].sceneData,k);this.populateHTMLMoments(b,d,e,f)},populateHTMLMoments:function(b,d,e,f){f=f.prompts;for(var h=0;h<f.length;h++){var k=f[h],l=this.getTimestamp(h,
"headHTML");this.populatePromptHTML(k,l,b,d,e,h)}},populatePromptHTML:function(b,d,e,f,h,k){var l=this,m,n,p;b.cutScene?(n=e.takeNumber(),m=function(){var d=interpreter.interp(b.text);l.level.cutSceneStart(d,b.cutScene)},p=function(){l.level.cutSceneEnd()},b.quiz&&(m=extend(m,function(){$("#base").hide();l.level.quiz=quizRenderer.render(b.quiz,$("#intText"))}),p=extend(p,function(){$("#base").show();l.level.quiz=void 0}))):(n=e.takeNumber(),m=function(){var d=interpreter.interp(b.text);$("#prompt").html(defaultTo("",
templater.div({innerHTML:d})));b.quiz&&(l.level.quiz=quizRenderer.render(b.quiz,$("#prompt")))},p=function(){$("#prompt").html("");l.level.quiz=void 0});p=new Timeline.Command("span",m,p);m=this.getTimestamp(k,"tailHTML");this.pushSpan(f,p,Timeline.stateFuncs.cmmds.spawn,Timeline.stateFuncs.cmmds.remove,n,h,d,m,!1,"cmmds");b.quiz&&(n=e.takeNumber(),p=new Timeline.Command("span",function(){$("#nextPrevDiv").hide()},function(){$("#nextPrevDiv").show()}),m=this.getTimestamp(k,"tailHTML"),this.pushSpan(f,
p,Timeline.stateFuncs.cmmds.spawn,Timeline.stateFuncs.cmmds.remove,n,h,d,m,!1,"cmmds"));b.title&&(n=e.takeNumber(),p=new Timeline.Command("span",function(){$("#baseHeader").html(b.title)},function(){$("#baseHeader").html("")}),m=this.getTimestamp(k,"tailHTML"),this.pushSpan(f,p,Timeline.stateFuncs.cmmds.spawn,Timeline.stateFuncs.cmmds.remove,n,h,d,m,!1,"cmmds"));if(!0===b.noReset||!0===b.noRefresh)n=e.takeNumber(),p=new Timeline.Command("span",function(){$("#resetExp").hide()},function(){$("#resetExp").show()}),
m=this.getTimestamp(k,"tailHTML"),this.pushSpan(f,p,Timeline.stateFuncs.cmmds.spawn,Timeline.stateFuncs.cmmds.remove,n,h,d,m,!1,"cmmds");k=new Timeline.Command("point",function(){interpreter.renderMath();l.buttonManager.arrangeGroupWrappers();l.buttonManager.arrangeAllGroups();l.buttonManager.setButtonWidth()},void 0,!0);this.pushPoint(h,f,e.takeNumber(),k,Timeline.stateFuncs.cmmds.spawn,!1,"cmmds",!1,d)},addSceneDataToMoments:function(b,d,e,f,h){this.getOrCreateMoment(e,h);f&&(this.applySpanToMoments(b,
e,d,f.walls,"walls",h,Timeline.stateFuncs.walls.spawn,Timeline.stateFuncs.walls.remove),this.applySpanToMoments(b,e,d,f.dots,"dots",h,Timeline.stateFuncs.dots.spawn,Timeline.stateFuncs.dots.remove),this.applySpanToMoments(b,e,d,f.objs,"objs",h,Timeline.stateFuncs.objs.spawn,Timeline.stateFuncs.objs.remove),this.applySpanToMoments(b,e,d,f.dataRecord,"objs",h,Timeline.stateFuncs.dataRecord.spawn,Timeline.stateFuncs.dataRecord.remove),this.applySpanToMoments(b,e,d,f.dataReadouts,"objs",h,Timeline.stateFuncs.dataReadouts.spawn,
Timeline.stateFuncs.dataReadouts.remove),this.applySpanToMoments(b,e,d,f.triggers,"objs",h,Timeline.stateFuncs.triggers.spawn,Timeline.stateFuncs.triggers.remove),this.applySpanToMoments(b,e,d,f.graphs,"objs",h,Timeline.stateFuncs.graphs.spawn,Timeline.stateFuncs.graphs.remove),this.applySpanToMoments(b,e,d,f.rxnsEmergent,"objs",h,Timeline.stateFuncs.rxnsEmergent.spawn,Timeline.stateFuncs.rxnsEmergent.remove),this.applySpanToMoments(b,e,d,f.rxnsNonEmergent,"objs",h,Timeline.stateFuncs.rxnsNonEmergent.spawn,
Timeline.stateFuncs.rxnsNonEmergent.remove),this.applySpanToMoments(b,e,d,f.buttonGroups,"objs",h,Timeline.stateFuncs.buttonGrps.spawn,Timeline.stateFuncs.buttonGrps.remove),this.applyCmmdsToMoments(b,e,d,f.cmmds,"cmmds",h))},applySpanToMoments:function(b,d,e,f,h,k,l,m){f=f?f:[];for(var n=0;n<f.length;n++){var p=b.takeNumber(),r=f[n],s=this.getTimestamp(r.cleanUpWith||k,"tail");this.pushSpan(e,r,l,m,p,d,k,s,!1,h)}},applyCmmdsToMoments:function(b,d,e,f,h,k){var l;f=f?f:[];for(var m=0;m<f.length;m++)l=
f[m],l="string"==typeof l||"function"==typeof l?new Timeline.Command("point",l,void 0,!0,!1):new Timeline.Command(l.type,l.spawn,l.remove,defaultTo(!0,l.oneWay),l.once),/span/i.test(l.type)?this.applyCmmdSpan(b,d,e,l,h,l.once,k):/point/i.test(l.type)?this.applyCmmdPoint(b,d,e,l,h,l.once,k):(console.log("Bad command"),console.log(l),console.log('Must be string or have type of "span" or "point"'))},applyCmmdSpan:function(b,d,e,f,h,k,l,m){m=void 0===m?b.takeNumber():m;b=Timeline.stateFuncs.cmmds.spawn;
h=Timeline.stateFuncs.cmmds.remove;var n=this.getTimestamp(f.cleanUpWith||l,"tail");this.pushSpan(e,f,b,h,m,d,l,n,k,"cmmds")},applyCmmdPoint:function(b,d,e,f,h,k,l,m){m=void 0===m?b.takeNumber():m;b=Timeline.stateFuncs.cmmds.spawn;var n=defaultTo(!0,f.oneWay);this.pushPoint(d,e,m,f,b,n,h,k,l)},pushSpan:function(b,d,e,f,h,k,l,m,n,p){l=this.getOrCreateMoment(k,l);k=this.getOrCreateMoment(k,m);m=new Timeline.Event.Span(this,b,d,e,f,h,"head",n,l);b=new Timeline.Event.Span(this,b,d,e,f,h,"tail",n,k);m.partner=
b;b.partner=m;l.events[p].push(m);k.events[p].push(b)},pushPoint:function(b,d,e,f,h,k,l,m,n){b=this.getOrCreateMoment(b,n);d=new Timeline.Event.Point(this,d,f,h,e,k,m,b);b.events[l].push(d)},getTimestamp:function(b,d){var e;/tailhtml/i.test(d)?e=0.8:/tail/i.test(d)?e=0.9:/setup/i.test(d)?e=0.1:/headhtml/i.test(d)?e=0.2:/head/i.test(d)?e=0:/branchPreClean/i.test(d)?e=0.85:/branchPostClean/i.test(d)&&(e=0.95);var f=this.parseIntegerTimeIdx(b);return-1==f&&"tail"==d?Infinity:f+e},getTimestampType:function(b){if(this.atDecimal(b,
0.8))return"tailhtml";if(this.atDecimal(b,0.9))return"tail";if(this.atDecimal(b,0.1))return"setup";if(this.atDecimal(b,0.2))return"headhtml";if(this.atDecimal(b,0))return"head";this.atDecimal(b,0.85)?"branchPreClean":this.atDecimal(b,0.95)&&"branchPostClean"},atDecimal:function(b,d){b=Math.abs(b);return 1E-5>Math.abs(b-Math.floor(b)-d)},parseIntegerTimeIdx:function(b){if("string"==typeof b){if(/section/i.test(b))return-1;var d=/[0-9]+/.exec(b);if(""!==d)return Number(d);console.log("Bad time code: "+
b)}else return Math.floor(b)},sortMoments:function(){this.moments=_.sortBy(this.moments,function(b){return b.timestamp})},getOrCreateMoment:function(b,d){for(var e=0;e<b.length;e++)if(b[e].timestamp==d)return b[e];b.push(new Timeline.Moment(d));return b[b.length-1]}};
Timeline.stateFuncs={walls:{spawn:function(b,d,e,f){d[e]=b.walls.addWall(f)},remove:function(b,d,e){var f=d[e];f&&b.walls.removeWall(f.handle);d[e]=void 0}},dots:{spawn:function(b,d,e,f){b.spcs[f.spcName].populate(f.pos,f.dims,f.count,f.temp,f.tag,e,f.returnTo);d[e]="dots"},remove:function(b,d,e){b.dotManager.removeByAttr("elemId",e);d[e]=void 0}},objs:{spawn:function(b,d,e,f){(b=window[f.type])||console.log("Bad object type "+f.type);d[e]=new b(f.attrs)},remove:function(b,d,e){(b=d[e])&&b.remove();
d[e]=void 0}},dataRecord:{spawn:function(b,d,e,f){if(/collisions/i.test(f.data))b.collide.recordCollisions();else b.walls[f.wallInfo]["record"+f.data.toCapitalCamelCase()](f.attrs);d[e]=f},remove:function(b,d,e){var f=d[e];if(/collisions/i.test(f.data))b.collide.recordCollisionsStop();else b.walls[f.wallInfo]["record"+f.data.toCapitalCamelCase()+"Stop"](f.attrs);d[e]=void 0}},dataReadouts:{spawn:function(b,d,e,f){b=b.dataDisplayer.addEntry(f);d[e]=b},remove:function(b,d,e){d[e].remove();d[e]=void 0}},
triggers:{spawn:function(b,d,e,f){d[e]=new window.Trigger(f)},remove:function(b,d,e){d[e].remove();d[e]=void 0}},graphs:{spawn:function(b,d,e,f){var h;/^load$/i.test(f.type)?((h=window.storedGraphs[f.handle])?(h.initDrawLayers(),h.restoreHTML()):console.log("Tried to load graph with bad handle "+f.handle),h.setDataValid()):h=new window.Graphs[f.type](f);h.drawAllData();if(f.sets)for(var k=0;k<f.sets.length;k++)h.addSet(f.sets[k]);b.level.graphs[f.handle]=h;d[e]=h},remove:function(b,d,e){var f=d[e],
h;for(h in f.data)f.data[h].recording=!1;delete b.level.graphs[f.handle];f.remove();d[e]=void 0}},rxnsEmergent:{spawn:function(b,d,e,f){b=b.collide.rxnHandlerEmergent.addReaction(f);d[e]=b},remove:function(b,d,e){d[e].remove();d[e]=void 0}},rxnsNonEmergent:{spawn:function(b,d,e,f){b=b.collide.rxnHandlerNonEmergent.addReaction(f);d[e]=b},remove:function(b,d,e){d[e].remove();d[e]=void 0}},buttonGrps:{spawn:function(b,d,e,f){b.buttonManager.addGroup(f.handle,f.label,f.prefIdx,f.isRadio,f.isToggle);if(f.buttons)for(var h=
0;h<f.buttons.length;h++){var k=f.buttons[h];b.buttonManager.addButton(f.handle,k.handle,k.label,k.exprs,k.prefIdx,k.isDown)}else console.log("Button group "+f.handle+" has no buttons.  Just thought you should know.  This object is logged below."),console.log(f);d[e]=f},remove:function(b,d,e){b.buttonManager.removeGroup(d[e].handle);d[e]=void 0}},cmmds:{spawn:function(b,d,e,f){var h=f.spawn;d[e]=f;if(h)with(DataGetFuncs)"function"==typeof h?h(b.timeline,b):"string"==typeof h?eval("("+h+")"):h instanceof
Array&&(b=h.join(";")+";",eval("("+b+")"))},remove:function(b,d,e){b=d[e];d[e]=void 0;if(d=b.remove)with(DataGetFuncs)"function"==typeof d?d():"string"==typeof d?eval("("+d+")"):d instanceof Array&&(d=d.join(";")+";",eval("("+d+")"))}}};Timeline.Moment=function(b){this.timestamp=b;this.events=new Timeline.EventClassHolder};
Timeline.Moment.prototype={fire:function(b,d){this.fireSpans(this.events.dots,b,d);this.fireSpans(this.events.walls,b,d);this.fireSpans(this.events.objs,b,d);this.fireCmmds(this.events.cmmds,b,d);this.fireCmmds([this.events.branchCmmd],b,d)},fireSpans:function(b,d,e){for(var f=0;f<b.length;f++)this.fireSpan(b[f],d,e)},fireSpan:function(b,d,e){if(b.active){var f=getAndEval(b.elemDatum);"head"==b.boundType?d<e&&d<this.timestamp&&e<b.partner.moment.timestamp?b.spawn(b.section,b.timelineElems,b.id,f):
e<d&&(e<this.timestamp&&d<=b.partner.moment.timestamp)&&(b.remove(b.section,b.timelineElems,b.id),b.once&&(b.active=!1,b.partner.active=!1)):"tail"==b.boundType&&(e>d&&d>=b.partner.moment.timestamp&&d<this.timestamp?(b.remove(b.section,b.timelineElems,b.id),b.once&&(b.active=!1)):e<d&&e>=b.partner.moment.timestamp&&b.spawn(b.section,b.timelineElems,b.id,f))}},fireCmmds:function(b,d,e){for(var f,h=0;h<b.length;h++){var k=b[h];if(k instanceof Timeline.Event.Span)this.fireSpans([k],d,e);else if(k instanceof
Timeline.Event.Point||k instanceof Timeline.Event.BranchCmmd)if((d<this.timestamp&&this.timestamp<=e||e<=this.timestamp&&this.timestamp<d)&&(k.elemDatum.oneWay?d<e:1)&&k.active)f=getAndEval(k.elemDatum),k.spawn(k.section,k.timelineElems,k.id,f),k.once&&(k.active=!1)}}};Timeline.Command=function(b,d,e,f,h,k){this.type=b;this.spawn=d;this.remove=e;this.oneWay=f;this.once=h;this.cleanUpWith=k};
Timeline.EventClassHolder=function(){this.walls=[];this.dots=[];this.objs=[];this.cmmds=[];this.branchCmmd=void 0};
Timeline.Event={Span:function(b,d,e,f,h,k,l,m,n){this.section=b;this.timelineElems=d;this.elemDatum=e;this.spawn=f;this.remove=h;this.id=k;this.boundType=l;this.moment=n;this.once=m;this.active=!0;this.parnter},Point:function(b,d,e,f,h,k,l,m){this.section=b;this.timelineElems=d;this.elemDatum=e;this.spawn=f;this.id=h;this.oneWay=k;this.moment=m;this.once=l;this.active=!0},BranchCmmd:function(b,d,e,f,h,k,l){this.section=this.section=b;this.timelineElems=d;this.elemDatum=e;this.spawn=f;this.id=h;this.oneWay=
!1;this.moment=k;this.once=!1;this.active=!0;this.isSectionsBranch=l;this.isPromptsBranch=!l}};Timeline.Branch=function(b,d){this.timeline=b;this.id=d};window.R=8.314;
$(function(){window.IMGPATHPREFIX="";window.simHost=window.simHost||"";"CW"==window.simHost&&(window.IMGPATHPREFIX="content/sims/levels/");$("#resetExp").append("<img src='"+IMGPATHPREFIX+"img/refresh.gif'></img>");MathJax.Hub.Config({tex2jax:{inlineMath:[["##","##"],["\\(","\\)"]],displayMath:[["$$","$$"]]}});_.extend(Array.prototype,toInherit.ArrayExtenders);_.extend(Math,toInherit.MathExtenders);_.extend(String.prototype,toInherit.StringExtenders);templater=new Templater;globalHTMLClass="sim";
dotManager=new DotManager;turn=0;window.Graphs={Scatter:GraphScatter,Hist:GraphHist,PhaseTwoComp:GraphPhaseTwoComp,PhaseOneComp:GraphPhaseOneComp};$("#mainHeader").html(LevelData.levelTitle);$("#canvasDiv").hide();$("#base").hide();$("#dashIntro").hide();$("#dashOutro").hide();$("#dashCutScene").hide();$("#display").hide();$("#intText").hide();canvas=document.getElementById("myCanvas");c=canvas.getContext("2d");N=1E3;R=8.314;KB=R/N;extraIntervals={};vConst=1E-4;pConst=16.3562;tConst=20;LtoM3=0.0010;
ATMtoPA=101325;PUNITTOPA=BARTOPA=1E5;MMHGTOBAR=0.0013332237;JtoKJ=0.0010;pxToE=Math.sqrt(tConst);ACTUALN=6.022E23;g=1.75;gInternal=0.01;updateInterval=30;dataInterval=1250;borderCol=Col(155,155,155);pxToMS=19.33821;auxHolderDivs=["aux1","aux2"];stored={};storedGraphs={};addJQueryElems($("button"),"button");draw=new DrawingTools;turnUpdater=setInterval("curLevel.update()",updateInterval);dataUpdater=setInterval("curLevel.updateData()",dataInterval);attractor=new Attractor;animText=new AnimText(c);
phaseEquilGenerator=new PhaseEquilGenerator;dotMigrator=new DotMigrator;quizRenderer=new QuizRenderer;sceneNavigator=new SceneNavigator;interpreter=new ExpressionInterpreter;$("#resetExp").click(function(){sceneNavigator.refresh()});$("#toSim").click(function(){sceneNavigator.nextPrompt()});$("#toLastStep").click(function(){sceneNavigator.prevPrompt()});$("#previous").click(function(){sceneNavigator.prevPrompt()});$("#next").click(function(){sceneNavigator.nextPrompt()});window.dashRunId=0;timeline=
new Timeline;canvasHeight=450;myCanvas.width=$("#main").width();myCanvas.height=canvasHeight;var b=0;LevelTools.addUF298(LevelData.spcDefs);LevelTools.addCp(LevelData.spcDefs);b=LevelTools.addImgsAndQuestionIds(LevelData.mainSequence,b);LevelTools.assumeDefaultRxnType(LevelData.mainSequence);LevelTools.setDefaultPromptVals(LevelData.mainSequence);LevelTools.addTriggerCleanUp(LevelData.mainSequence);LevelTools.addStoreAs(LevelData.mainSequence);LevelTools.transferObjCleanUp(LevelData.mainSequence);
LevelTools.showRunDivs();var d=0,e;for(e in LevelData.auxSections){var f=LevelData.auxSections[e],f=f instanceof Array?f:[f],b=LevelTools.addImgsAndQuestionIds(f,b);f.id=d;d++;LevelTools.assumeDefaultRxnType(f);LevelTools.setDefaultPromptVals(f);LevelTools.addTriggerCleanUp(f);LevelTools.addStoreAs(f);LevelTools.transferObjCleanUp(f)}for(var h in LevelData.auxPrompts)e=LevelData.auxPrompts[h],e=e instanceof Array?e:[e],f=[{prompts:e}],b=LevelTools.addImgsAndQuestionIds(f,b),e.id=d,d++,LevelTools.assumeDefaultRxnType(f),
LevelTools.setDefaultPromptVals(f),LevelTools.addTriggerCleanUp(f),LevelTools.addStoreAs(f),LevelTools.transferObjCleanUp(f);for(b=0;b<LevelData.mainSequence.length;b++)timeline.pushSection(LevelData.mainSequence[b]);timeline.show(0,0)});
