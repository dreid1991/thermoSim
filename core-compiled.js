(function(){function d(e,f,h){if(e===f)return 0!==e||1/e==1/f;if(null==e||null==f)return e===f;e._chain&&(e=e._wrapped);f._chain&&(f=f._wrapped);if(e.isEqual&&w.isFunction(e.isEqual))return e.isEqual(f);if(f.isEqual&&w.isFunction(f.isEqual))return f.isEqual(e);var k=p.call(e);if(k!=p.call(f))return!1;switch(k){case "[object String]":return e==""+f;case "[object Number]":return e!=+e?f!=+f:0==e?1/e==1/f:e==+f;case "[object Date]":case "[object Boolean]":return+e==+f;case "[object RegExp]":return e.source==
f.source&&e.global==f.global&&e.multiline==f.multiline&&e.ignoreCase==f.ignoreCase}if("object"!=typeof e||"object"!=typeof f)return!1;for(var m=h.length;m--;)if(h[m]==e)return!0;h.push(e);var m=0,l=!0;if("[object Array]"==k){if(m=e.length,l=m==f.length)for(;m--&&(l=m in e==m in f&&d(e[m],f[m],h)););}else{if("constructor"in e!="constructor"in f||e.constructor!=f.constructor)return!1;for(var n in e)if(w.has(e,n)&&(m++,!(l=w.has(f,n)&&d(e[n],f[n],h))))break;if(l){for(n in f)if(w.has(f,n)&&!m--)break;
l=!m}}h.pop();return l}var e=this,f=e._,h={},k=Array.prototype,l=Object.prototype,m=k.slice,n=k.unshift,p=l.toString,q=l.hasOwnProperty,s=k.forEach,t=k.map,u=k.reduce,v=k.reduceRight,x=k.filter,y=k.every,z=k.some,A=k.indexOf,G=k.lastIndexOf,l=Array.isArray,E=Object.keys,B=Function.prototype.bind,w=function(d){return new ba(d)};"undefined"!==typeof exports?("undefined"!==typeof module&&module.exports&&(exports=module.exports=w),exports._=w):e._=w;w.VERSION="1.3.3";var C=w.each=w.forEach=function(d,
e,f){if(null!=d)if(s&&d.forEach===s)d.forEach(e,f);else if(d.length===+d.length)for(var k=0,m=d.length;k<m&&!(k in d&&e.call(f,d[k],k,d)===h);k++);else for(k in d)if(w.has(d,k)&&e.call(f,d[k],k,d)===h)break};w.map=w.collect=function(d,e,f){var h=[];if(null==d)return h;if(t&&d.map===t)return d.map(e,f);C(d,function(d,k,m){h[h.length]=e.call(f,d,k,m)});d.length===+d.length&&(h.length=d.length);return h};w.reduce=w.foldl=w.inject=function(d,e,f,h){var k=2<arguments.length;null==d&&(d=[]);if(u&&d.reduce===
u)return h&&(e=w.bind(e,h)),k?d.reduce(e,f):d.reduce(e);C(d,function(d,m,l){k?f=e.call(h,f,d,m,l):(f=d,k=!0)});if(!k)throw new TypeError("Reduce of empty array with no initial value");return f};w.reduceRight=w.foldr=function(d,e,f,h){var k=2<arguments.length;null==d&&(d=[]);if(v&&d.reduceRight===v)return h&&(e=w.bind(e,h)),k?d.reduceRight(e,f):d.reduceRight(e);var m=w.toArray(d).reverse();h&&!k&&(e=w.bind(e,h));return k?w.reduce(m,e,f,h):w.reduce(m,e)};w.find=w.detect=function(d,e,f){var h;U(d,function(d,
k,m){if(e.call(f,d,k,m))return h=d,!0});return h};w.filter=w.select=function(d,e,f){var h=[];if(null==d)return h;if(x&&d.filter===x)return d.filter(e,f);C(d,function(d,k,m){e.call(f,d,k,m)&&(h[h.length]=d)});return h};w.reject=function(d,e,f){var h=[];if(null==d)return h;C(d,function(d,k,m){e.call(f,d,k,m)||(h[h.length]=d)});return h};w.every=w.all=function(d,e,f){var k=!0;if(null==d)return k;if(y&&d.every===y)return d.every(e,f);C(d,function(d,m,l){if(!(k=k&&e.call(f,d,m,l)))return h});return!!k};
var U=w.some=w.any=function(d,e,f){e||(e=w.identity);var k=!1;if(null==d)return k;if(z&&d.some===z)return d.some(e,f);C(d,function(d,m,l){if(k||(k=e.call(f,d,m,l)))return h});return!!k};w.include=w.contains=function(d,e){return null==d?!1:A&&d.indexOf===A?-1!=d.indexOf(e):U(d,function(d){return d===e})};w.invoke=function(d,e){var f=m.call(arguments,2);return w.map(d,function(d){return(w.isFunction(e)?e||d:d[e]).apply(d,f)})};w.pluck=function(d,e){return w.map(d,function(d){return d[e]})};w.max=function(d,
e,f){if(!e&&w.isArray(d)&&d[0]===+d[0])return Math.max.apply(Math,d);if(!e&&w.isEmpty(d))return-Infinity;var h={computed:-Infinity};C(d,function(d,k,m){k=e?e.call(f,d,k,m):d;k>=h.computed&&(h={value:d,computed:k})});return h.value};w.min=function(d,e,f){if(!e&&w.isArray(d)&&d[0]===+d[0])return Math.min.apply(Math,d);if(!e&&w.isEmpty(d))return Infinity;var h={computed:Infinity};C(d,function(d,k,m){k=e?e.call(f,d,k,m):d;k<h.computed&&(h={value:d,computed:k})});return h.value};w.shuffle=function(d){var e=
[],f;C(d,function(d,h){f=Math.floor(Math.random()*(h+1));e[h]=e[f];e[f]=d});return e};w.sortBy=function(d,e,f){var h=w.isFunction(e)?e:function(d){return d[e]};return w.pluck(w.map(d,function(d,e,k){return{value:d,criteria:h.call(f,d,e,k)}}).sort(function(d,e){var f=d.criteria,h=e.criteria;return void 0===f?1:void 0===h?-1:f<h?-1:f>h?1:0}),"value")};w.groupBy=function(d,e){var f={},h=w.isFunction(e)?e:function(d){return d[e]};C(d,function(d,e){var k=h(d,e);(f[k]||(f[k]=[])).push(d)});return f};w.sortedIndex=
function(d,e,f){f||(f=w.identity);for(var h=0,k=d.length;h<k;){var m=h+k>>1;f(d[m])<f(e)?h=m+1:k=m}return h};w.toArray=function(d){return!d?[]:w.isArray(d)||w.isArguments(d)?m.call(d):d.toArray&&w.isFunction(d.toArray)?d.toArray():w.values(d)};w.size=function(d){return w.isArray(d)?d.length:w.keys(d).length};w.first=w.head=w.take=function(d,e,f){return null!=e&&!f?m.call(d,0,e):d[0]};w.initial=function(d,e,f){return m.call(d,0,d.length-(null==e||f?1:e))};w.last=function(d,e,f){return null!=e&&!f?
m.call(d,Math.max(d.length-e,0)):d[d.length-1]};w.rest=w.tail=function(d,e,f){return m.call(d,null==e||f?1:e)};w.compact=function(d){return w.filter(d,function(d){return!!d})};w.flatten=function(d,e){return w.reduce(d,function(d,f){if(w.isArray(f))return d.concat(e?f:w.flatten(f));d[d.length]=f;return d},[])};w.without=function(d){return w.difference(d,m.call(arguments,1))};w.uniq=w.unique=function(d,e,f){f=f?w.map(d,f):d;var h=[];3>d.length&&(e=!0);w.reduce(f,function(f,k,m){if(e?w.last(f)!==k||
!f.length:!w.include(f,k))f.push(k),h.push(d[m]);return f},[]);return h};w.union=function(){return w.uniq(w.flatten(arguments,!0))};w.intersection=w.intersect=function(d){var e=m.call(arguments,1);return w.filter(w.uniq(d),function(d){return w.every(e,function(e){return 0<=w.indexOf(e,d)})})};w.difference=function(d){var e=w.flatten(m.call(arguments,1),!0);return w.filter(d,function(d){return!w.include(e,d)})};w.zip=function(){for(var d=m.call(arguments),e=w.max(w.pluck(d,"length")),f=Array(e),h=
0;h<e;h++)f[h]=w.pluck(d,""+h);return f};w.indexOf=function(d,e,f){if(null==d)return-1;var h;if(f)return f=w.sortedIndex(d,e),d[f]===e?f:-1;if(A&&d.indexOf===A)return d.indexOf(e);f=0;for(h=d.length;f<h;f++)if(f in d&&d[f]===e)return f;return-1};w.lastIndexOf=function(d,e){if(null==d)return-1;if(G&&d.lastIndexOf===G)return d.lastIndexOf(e);for(var f=d.length;f--;)if(f in d&&d[f]===e)return f;return-1};w.range=function(d,e,f){1>=arguments.length&&(e=d||0,d=0);f=arguments[2]||1;for(var h=Math.max(Math.ceil((e-
d)/f),0),k=0,m=Array(h);k<h;)m[k++]=d,d+=f;return m};var F=function(){};w.bind=function(d,e){var f,h;if(d.bind===B&&B)return B.apply(d,m.call(arguments,1));if(!w.isFunction(d))throw new TypeError;h=m.call(arguments,2);return f=function(){if(!(this instanceof f))return d.apply(e,h.concat(m.call(arguments)));F.prototype=d.prototype;var k=new F,l=d.apply(k,h.concat(m.call(arguments)));return Object(l)===l?l:k}};w.bindAll=function(d){var e=m.call(arguments,1);0==e.length&&(e=w.functions(d));C(e,function(e){d[e]=
w.bind(d[e],d)});return d};w.memoize=function(d,e){var f={};e||(e=w.identity);return function(){var h=e.apply(this,arguments);return w.has(f,h)?f[h]:f[h]=d.apply(this,arguments)}};w.delay=function(d,e){var f=m.call(arguments,2);return setTimeout(function(){return d.apply(null,f)},e)};w.defer=function(d){return w.delay.apply(w,[d,1].concat(m.call(arguments,1)))};w.throttle=function(d,e){var f,h,k,m,l,n,p=w.debounce(function(){l=m=!1},e);return function(){f=this;h=arguments;k||(k=setTimeout(function(){k=
null;l&&d.apply(f,h);p()},e));m?l=!0:n=d.apply(f,h);p();m=!0;return n}};w.debounce=function(d,e,f){var h;return function(){var k=this,m=arguments;f&&!h&&d.apply(k,m);clearTimeout(h);h=setTimeout(function(){h=null;f||d.apply(k,m)},e)}};w.once=function(d){var e=!1,f;return function(){if(e)return f;e=!0;return f=d.apply(this,arguments)}};w.wrap=function(d,e){return function(){var f=[d].concat(m.call(arguments,0));return e.apply(this,f)}};w.compose=function(){var d=arguments;return function(){for(var e=
arguments,f=d.length-1;0<=f;f--)e=[d[f].apply(this,e)];return e[0]}};w.after=function(d,e){return 0>=d?e():function(){if(1>--d)return e.apply(this,arguments)}};w.keys=E||function(d){if(d!==Object(d))throw new TypeError("Invalid object");var e=[],f;for(f in d)w.has(d,f)&&(e[e.length]=f);return e};w.values=function(d){return w.map(d,w.identity)};w.functions=w.methods=function(d){var e=[],f;for(f in d)w.isFunction(d[f])&&e.push(f);return e.sort()};w.extend=function(d){C(m.call(arguments,1),function(e){for(var f in e)d[f]=
e[f]});return d};w.pick=function(d){var e={};C(w.flatten(m.call(arguments,1)),function(f){f in d&&(e[f]=d[f])});return e};w.defaults=function(d){C(m.call(arguments,1),function(e){for(var f in e)null==d[f]&&(d[f]=e[f])});return d};w.clone=function(d){return!w.isObject(d)?d:w.isArray(d)?d.slice():w.extend({},d)};w.tap=function(d,e){e(d);return d};w.isEqual=function(e,f){return d(e,f,[])};w.isEmpty=function(d){if(null==d)return!0;if(w.isArray(d)||w.isString(d))return 0===d.length;for(var e in d)if(w.has(d,
e))return!1;return!0};w.isElement=function(d){return!!(d&&1==d.nodeType)};w.isArray=l||function(d){return"[object Array]"==p.call(d)};w.isObject=function(d){return d===Object(d)};w.isArguments=function(d){return"[object Arguments]"==p.call(d)};w.isArguments(arguments)||(w.isArguments=function(d){return!(!d||!w.has(d,"callee"))});w.isFunction=function(d){return"[object Function]"==p.call(d)};w.isString=function(d){return"[object String]"==p.call(d)};w.isNumber=function(d){return"[object Number]"==
p.call(d)};w.isFinite=function(d){return w.isNumber(d)&&isFinite(d)};w.isNaN=function(d){return d!==d};w.isBoolean=function(d){return!0===d||!1===d||"[object Boolean]"==p.call(d)};w.isDate=function(d){return"[object Date]"==p.call(d)};w.isRegExp=function(d){return"[object RegExp]"==p.call(d)};w.isNull=function(d){return null===d};w.isUndefined=function(d){return void 0===d};w.has=function(d,e){return q.call(d,e)};w.noConflict=function(){e._=f;return this};w.identity=function(d){return d};w.times=
function(d,e,f){for(var h=0;h<d;h++)e.call(f,h)};w.escape=function(d){return(""+d).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")};w.result=function(d,e){if(null==d)return null;var f=d[e];return w.isFunction(f)?f.call(d):f};w.mixin=function(d){C(w.functions(d),function(e){ga(e,w[e]=d[e])})};var T=0;w.uniqueId=function(d){var e=T++;return d?d+e:e};w.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,
escape:/<%-([\s\S]+?)%>/g};var O=/.^/,M={"\\":"\\","'":"'",r:"\r",n:"\n",t:"\t",u2028:"\u2028",u2029:"\u2029"},L;for(L in M)M[M[L]]=L;var aa=/\\|'|\r|\n|\t|\u2028|\u2029/g,da=/\\(\\|'|r|n|t|u2028|u2029)/g,ja=function(d){return d.replace(da,function(d,e){return M[e]})};w.template=function(d,e,f){f=w.defaults(f||{},w.templateSettings);d="__p+='"+d.replace(aa,function(d){return"\\"+M[d]}).replace(f.escape||O,function(d,e){return"'+\n_.escape("+ja(e)+")+\n'"}).replace(f.interpolate||O,function(d,e){return"'+\n("+
ja(e)+")+\n'"}).replace(f.evaluate||O,function(d,e){return"';\n"+ja(e)+"\n;__p+='"})+"';\n";f.variable||(d="with(obj||{}){\n"+d+"}\n");d="var __p='';var print=function(){__p+=Array.prototype.join.call(arguments, '')};\n"+d+"return __p;\n";var h=new Function(f.variable||"obj","_",d);if(e)return h(e,w);e=function(d){return h.call(this,d,w)};e.source="function("+(f.variable||"obj")+"){\n"+d+"}";return e};w.chain=function(d){return w(d).chain()};var ba=function(d){this._wrapped=d};w.prototype=ba.prototype;
var W=function(d,e){return e?w(d).chain():d},ga=function(d,e){ba.prototype[d]=function(){var d=m.call(arguments);n.call(d,this._wrapped);return W(e.apply(w,d),this._chain)}};w.mixin(w);C("pop push reverse shift sort splice unshift".split(" "),function(d){var e=k[d];ba.prototype[d]=function(){var f=this._wrapped;e.apply(f,arguments);var h=f.length;("shift"==d||"splice"==d)&&0===h&&delete f[0];return W(f,this._chain)}});C(["concat","join","slice"],function(d){var e=k[d];ba.prototype[d]=function(){return W(e.apply(this._wrapped,
arguments),this._chain)}});ba.prototype.chain=function(){this._chain=!0;return this};ba.prototype.value=function(){return this._wrapped}}).call(this);(function(d,e){function f(d){var e=d.length,f=r.type(d);return r.isWindow(d)?!1:1===d.nodeType&&e?!0:"array"===f||"function"!==f&&(0===e||"number"==typeof e&&0<e&&e-1 in d)}function h(d){var e=Ua[d]={};return r.each(d.match(oa)||[],function(d,f){e[f]=!0}),e}function k(){Object.defineProperty(this.cache={},0,{get:function(){return{}}});this.expando=r.expando+Math.random()}function l(d,f,h){var k;if(h===e&&1===d.nodeType)if(k="data-"+f.replace(qb,"-$1").toLowerCase(),h=d.getAttribute(k),"string"==typeof h){try{h=
"true"===h?!0:"false"===h?!1:"null"===h?null:+h+""===h?+h:rb.test(h)?JSON.parse(h):h}catch(m){}ca.set(d,f,h)}else h=e;return h}function m(){return!0}function n(){return!1}function p(){try{return J.activeElement}catch(d){}}function q(d,e){for(;(d=d[e])&&1!==d.nodeType;);return d}function s(d,e,f){if(r.isFunction(e))return r.grep(d,function(d,h){return!!e.call(d,h,d)!==f});if(e.nodeType)return r.grep(d,function(d){return d===e!==f});if("string"==typeof e){if(sb.test(e))return r.filter(e,d,f);e=r.filter(e,
d)}return r.grep(d,function(d){return 0<=Ha.call(e,d)!==f})}function t(d,e){return r.nodeName(d,"table")&&r.nodeName(1===e.nodeType?e:e.firstChild,"tr")?d.getElementsByTagName("tbody")[0]||d.appendChild(d.ownerDocument.createElement("tbody")):d}function u(d){return d.type=(null!==d.getAttribute("type"))+"/"+d.type,d}function v(d){var e=tb.exec(d.type);return e?d.type=e[1]:d.removeAttribute("type"),d}function x(d,e){for(var f=d.length,h=0;f>h;h++)H.set(d[h],"globalEval",!e||H.get(e[h],"globalEval"))}
function y(d,e){var f,h,k,m,l,n;if(1===e.nodeType){if(H.hasData(d)&&(f=H.access(d),h=H.set(e,f),n=f.events))for(k in delete h.handle,h.events={},n){f=0;for(h=n[k].length;h>f;f++)r.event.add(e,k,n[k][f])}ca.hasData(d)&&(m=ca.access(d),l=r.extend({},m),ca.set(e,l))}}function z(d,f){var h=d.getElementsByTagName?d.getElementsByTagName(f||"*"):d.querySelectorAll?d.querySelectorAll(f||"*"):[];return f===e||f&&r.nodeName(d,f)?r.merge([d],h):h}function A(d,e){if(e in d)return e;for(var f=e.charAt(0).toUpperCase()+
e.slice(1),h=e,k=Va.length;k--;)if(e=Va[k]+f,e in d)return e;return h}function G(d,e){return d=e||d,"none"===r.css(d,"display")||!r.contains(d.ownerDocument,d)}function E(d,e){for(var f,h,k,m=[],l=0,n=d.length;n>l;l++)h=d[l],h.style&&(m[l]=H.get(h,"olddisplay"),f=h.style.display,e?(m[l]||"none"!==f||(h.style.display=""),""===h.style.display&&G(h)&&(m[l]=H.access(h,"olddisplay",U(h.nodeName)))):m[l]||(k=G(h),(f&&"none"!==f||!k)&&H.set(h,"olddisplay",k?f:r.css(h,"display"))));for(l=0;n>l;l++)h=d[l],
h.style&&(e&&"none"!==h.style.display&&""!==h.style.display||(h.style.display=e?m[l]||"":"none"));return d}function B(d,e,f){return(d=ub.exec(e))?Math.max(0,d[1]-(f||0))+(d[2]||"px"):e}function w(d,e,f,h,k){e=f===(h?"border":"content")?4:"width"===e?1:0;for(var m=0;4>e;e+=2)"margin"===f&&(m+=r.css(d,f+sa[e],!0,k)),h?("content"===f&&(m-=r.css(d,"padding"+sa[e],!0,k)),"margin"!==f&&(m-=r.css(d,"border"+sa[e]+"Width",!0,k))):(m+=r.css(d,"padding"+sa[e],!0,k),"padding"!==f&&(m+=r.css(d,"border"+sa[e]+
"Width",!0,k)));return m}function C(e,f,h){var k=!0,m="width"===f?e.offsetWidth:e.offsetHeight,l=d.getComputedStyle(e,null),n=r.support.boxSizing&&"border-box"===r.css(e,"boxSizing",!1,l);if(0>=m||null==m){if(m=ta(e,f,l),(0>m||null==m)&&(m=e.style[f]),La.test(m))return m;k=n&&(r.support.boxSizingReliable||m===e.style[f]);m=parseFloat(m)||0}return m+w(e,f,h||(n?"border":"content"),k,l)+"px"}function U(d){var e=J,f=Wa[d];return f||(f=F(d,e),"none"!==f&&f||(ua=(ua||r("<iframe frameborder='0' width='0' height='0'/>").css("cssText",
"display:block !important")).appendTo(e.documentElement),e=(ua[0].contentWindow||ua[0].contentDocument).document,e.write("<!doctype html><html><body>"),e.close(),f=F(d,e),ua.detach()),Wa[d]=f),f}function F(d,e){var f=r(e.createElement(d)).appendTo(e.body),h=r.css(f[0],"display");return f.remove(),h}function T(d,e,f,h){var k;if(r.isArray(e))r.each(e,function(e,k){f||vb.test(d)?h(d,k):T(d+"["+("object"==typeof k?e:"")+"]",k,f,h)});else if(f||"object"!==r.type(e))h(d,e);else for(k in e)T(d+"["+k+"]",
e[k],f,h)}function O(d){return function(e,f){"string"!=typeof e&&(f=e,e="*");var h,k=0,m=e.toLowerCase().match(oa)||[];if(r.isFunction(f))for(;h=m[k++];)"+"===h[0]?(h=h.slice(1)||"*",(d[h]=d[h]||[]).unshift(f)):(d[h]=d[h]||[]).push(f)}}function M(d,f,h,k){function m(p){var q;return l[p]=!0,r.each(d[p]||[],function(d,p){var I=p(f,h,k);return"string"!=typeof I||n||l[I]?n?!(q=I):e:(f.dataTypes.unshift(I),m(I),!1)}),q}var l={},n=d===Ma;return m(f.dataTypes[0])||!l["*"]&&m("*")}function L(d,f){var h,k,
m=r.ajaxSettings.flatOptions||{};for(h in f)f[h]!==e&&((m[h]?d:k||(k={}))[h]=f[h]);return k&&r.extend(!0,d,k),d}function aa(){return setTimeout(function(){va=e}),va=r.now()}function da(d,e,f){for(var h,k=(qa[e]||[]).concat(qa["*"]),m=0,l=k.length;l>m;m++)if(h=k[m].call(f,e,d))return h}function ja(d,e,f){var h,k=0,m=Ia.length,l=r.Deferred().always(function(){delete n.elem}),n=function(){if(h)return!1;for(var e=va||aa(),e=Math.max(0,p.startTime+p.duration-e),f=1-(e/p.duration||0),k=0,m=p.tweens.length;m>
k;k++)p.tweens[k].run(f);return l.notifyWith(d,[p,f,e]),1>f&&m?e:(l.resolveWith(d,[p]),!1)},p=l.promise({elem:d,props:r.extend({},e),opts:r.extend(!0,{specialEasing:{}},f),originalProperties:e,originalOptions:f,startTime:va||aa(),duration:f.duration,tweens:[],createTween:function(e,f){var h=r.Tween(d,p.opts,e,f,p.opts.specialEasing[e]||p.opts.easing);return p.tweens.push(h),h},stop:function(e){var f=0,k=e?p.tweens.length:0;if(h)return this;for(h=!0;k>f;f++)p.tweens[f].run(1);return e?l.resolveWith(d,
[p,e]):l.rejectWith(d,[p,e]),this}});f=p.props;for(ba(f,p.opts.specialEasing);m>k;k++)if(e=Ia[k].call(p,d,f,p.opts))return e;return r.map(f,da,p),r.isFunction(p.opts.start)&&p.opts.start.call(d,p),r.fx.timer(r.extend(n,{elem:d,anim:p,queue:p.opts.queue})),p.progress(p.opts.progress).done(p.opts.done,p.opts.complete).fail(p.opts.fail).always(p.opts.always)}function ba(d,e){var f,h,k,m,l;for(f in d)if(h=r.camelCase(f),k=e[h],m=d[f],r.isArray(m)&&(k=m[1],m=d[f]=m[0]),f!==h&&(d[h]=m,delete d[f]),l=r.cssHooks[h],
l&&"expand"in l)for(f in m=l.expand(m),delete d[h],m)f in d||(d[f]=m[f],e[f]=k);else e[h]=k}function W(d,e,f,h,k){return new W.prototype.init(d,e,f,h,k)}function ga(d,e){var f,h={height:d},k=0;for(e=e?1:0;4>k;k+=2-e)f=sa[k],h["margin"+f]=h["padding"+f]=d;return e&&(h.opacity=h.width=d),h}var K,Z,Q=typeof e,pa=d.location,J=d.document,ia=J.documentElement,la=d.jQuery,X=d.$,ya={},Ja=[],Xa=Ja.concat,Na=Ja.push,wa=Ja.slice,Ha=Ja.indexOf,wb=ya.toString,Pa=ya.hasOwnProperty,xb="2.0.3".trim,r=function(d,
e){return new r.fn.init(d,e,K)},xa=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,oa=/\S+/g,yb=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,Ya=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,zb=/^-ms-/,Ab=/-([\da-z])/gi,Bb=function(d,e){return e.toUpperCase()},za=function(){J.removeEventListener("DOMContentLoaded",za,!1);d.removeEventListener("load",za,!1);r.ready()};r.fn=r.prototype={jquery:"2.0.3",constructor:r,init:function(d,f,h){var k,m;if(!d)return this;if("string"==typeof d){if(k="<"===d.charAt(0)&&">"===d.charAt(d.length-
1)&&3<=d.length?[null,d,null]:yb.exec(d),!k||!k[1]&&f)return!f||f.jquery?(f||h).find(d):this.constructor(f).find(d);if(k[1]){if(f=f instanceof r?f[0]:f,r.merge(this,r.parseHTML(k[1],f&&f.nodeType?f.ownerDocument||f:J,!0)),Ya.test(k[1])&&r.isPlainObject(f))for(k in f)r.isFunction(this[k])?this[k](f[k]):this.attr(k,f[k]);return this}return m=J.getElementById(k[2]),m&&m.parentNode&&(this.length=1,this[0]=m),this.context=J,this.selector=d,this}return d.nodeType?(this.context=this[0]=d,this.length=1,this):
r.isFunction(d)?h.ready(d):(d.selector!==e&&(this.selector=d.selector,this.context=d.context),r.makeArray(d,this))},selector:"",length:0,toArray:function(){return wa.call(this)},get:function(d){return null==d?this.toArray():0>d?this[this.length+d]:this[d]},pushStack:function(d){d=r.merge(this.constructor(),d);return d.prevObject=this,d.context=this.context,d},each:function(d,e){return r.each(this,d,e)},ready:function(d){return r.ready.promise().done(d),this},slice:function(){return this.pushStack(wa.apply(this,
arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(d){var e=this.length;d=+d+(0>d?e:0);return this.pushStack(0<=d&&e>d?[this[d]]:[])},map:function(d){return this.pushStack(r.map(this,function(e,f){return d.call(e,f,e)}))},end:function(){return this.prevObject||this.constructor(null)},push:Na,sort:[].sort,splice:[].splice};r.fn.init.prototype=r.fn;r.extend=r.fn.extend=function(){var d,f,h,k,m,l,n=arguments[0]||{},p=1,q=arguments.length,s=!1;"boolean"==
typeof n&&(s=n,n=arguments[1]||{},p=2);"object"==typeof n||r.isFunction(n)||(n={});for(q===p&&(n=this,--p);q>p;p++)if(null!=(d=arguments[p]))for(f in d)h=n[f],k=d[f],n!==k&&(s&&k&&(r.isPlainObject(k)||(m=r.isArray(k)))?(m?(m=!1,l=h&&r.isArray(h)?h:[]):l=h&&r.isPlainObject(h)?h:{},n[f]=r.extend(s,l,k)):k!==e&&(n[f]=k));return n};r.extend({expando:"jQuery"+("2.0.3"+Math.random()).replace(/\D/g,""),noConflict:function(e){return d.$===r&&(d.$=X),e&&d.jQuery===r&&(d.jQuery=la),r},isReady:!1,readyWait:1,
holdReady:function(d){d?r.readyWait++:r.ready(!0)},ready:function(d){(!0===d?--r.readyWait:r.isReady)||(r.isReady=!0,!0!==d&&0<--r.readyWait||(Z.resolveWith(J,[r]),r.fn.trigger&&r(J).trigger("ready").off("ready")))},isFunction:function(d){return"function"===r.type(d)},isArray:Array.isArray,isWindow:function(d){return null!=d&&d===d.window},isNumeric:function(d){return!isNaN(parseFloat(d))&&isFinite(d)},type:function(d){return null==d?d+"":"object"==typeof d||"function"==typeof d?ya[wb.call(d)]||"object":
typeof d},isPlainObject:function(d){if("object"!==r.type(d)||d.nodeType||r.isWindow(d))return!1;try{if(d.constructor&&!Pa.call(d.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}return!0},isEmptyObject:function(d){for(var e in d)return!1;return!0},error:function(d){throw Error(d);},parseHTML:function(d,e,f){if(!d||"string"!=typeof d)return null;"boolean"==typeof e&&(f=e,e=!1);e=e||J;var h=Ya.exec(d);f=!f&&[];return h?[e.createElement(h[1])]:(h=r.buildFragment([d],e,f),f&&r(f).remove(),
r.merge([],h.childNodes))},parseJSON:JSON.parse,parseXML:function(d){var f,h;if(!d||"string"!=typeof d)return null;try{h=new DOMParser,f=h.parseFromString(d,"text/xml")}catch(k){f=e}return(!f||f.getElementsByTagName("parsererror").length)&&r.error("Invalid XML: "+d),f},noop:function(){},globalEval:function(d){var e,f=eval;(d=r.trim(d))&&(1===d.indexOf("use strict")?(e=J.createElement("script"),e.text=d,J.head.appendChild(e).parentNode.removeChild(e)):f(d))},camelCase:function(d){return d.replace(zb,
"ms-").replace(Ab,Bb)},nodeName:function(d,e){return d.nodeName&&d.nodeName.toLowerCase()===e.toLowerCase()},each:function(d,e,h){var k,m=0,l=d.length,n=f(d);if(h)if(n)for(;l>m&&!(k=e.apply(d[m],h),!1===k);m++);else for(m in d){if(k=e.apply(d[m],h),!1===k)break}else if(n)for(;l>m&&!(k=e.call(d[m],m,d[m]),!1===k);m++);else for(m in d)if(k=e.call(d[m],m,d[m]),!1===k)break;return d},trim:function(d){return null==d?"":xb.call(d)},makeArray:function(d,e){var h=e||[];return null!=d&&(f(Object(d))?r.merge(h,
"string"==typeof d?[d]:d):Na.call(h,d)),h},inArray:function(d,e,f){return null==e?-1:Ha.call(e,d,f)},merge:function(d,f){var h=f.length,k=d.length,m=0;if("number"==typeof h)for(;h>m;m++)d[k++]=f[m];else for(;f[m]!==e;)d[k++]=f[m++];return d.length=k,d},grep:function(d,e,f){var h,k=[],m=0,l=d.length;for(f=!!f;l>m;m++)h=!!e(d[m],m),f!==h&&k.push(d[m]);return k},map:function(d,e,h){var k,m=0,l=d.length,n=[];if(f(d))for(;l>m;m++)k=e(d[m],m,h),null!=k&&(n[n.length]=k);else for(m in d)k=e(d[m],m,h),null!=
k&&(n[n.length]=k);return Xa.apply([],n)},guid:1,proxy:function(d,f){var h,k,m;return"string"==typeof f&&(h=d[f],f=d,d=h),r.isFunction(d)?(k=wa.call(arguments,2),m=function(){return d.apply(f||this,k.concat(wa.call(arguments)))},m.guid=d.guid=d.guid||r.guid++,m):e},access:function(d,f,h,k,m,l,n){var p=0,q=d.length,s=null==h;if("object"===r.type(h))for(p in m=!0,h)r.access(d,f,p,h[p],!0,l,n);else if(k!==e&&(m=!0,r.isFunction(k)||(n=!0),s&&(n?(f.call(d,k),f=null):(s=f,f=function(d,e,f){return s.call(r(d),
f)})),f))for(;q>p;p++)f(d[p],h,n?k:k.call(d[p],p,f(d[p],h)));return m?d:s?f.call(d):q?f(d[0],h):l},now:Date.now,swap:function(d,e,f,h){var k,m={};for(k in e)m[k]=d.style[k],d.style[k]=e[k];f=f.apply(d,h||[]);for(k in e)d.style[k]=m[k];return f}});r.ready.promise=function(e){return Z||(Z=r.Deferred(),"complete"===J.readyState?setTimeout(r.ready):(J.addEventListener("DOMContentLoaded",za,!1),d.addEventListener("load",za,!1))),Z.promise(e)};r.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),
function(d,e){ya["[object "+e+"]"]=e.toLowerCase()});K=r(J);(function(d,e){function f(d,e,h,k){var m,l,n,p,q;if((e?e.ownerDocument||e:X)!==H&&J(e),e=e||H,h=h||[],!d||"string"!=typeof d)return h;if(1!==(p=e.nodeType)&&9!==p)return[];if(Q&&!k){if(m=Ka.exec(d))if(n=m[1])if(9===p){if(l=e.getElementById(n),!l||!l.parentNode)return h;if(l.id===n)return h.push(l),h}else{if(e.ownerDocument&&(l=e.ownerDocument.getElementById(n))&&Oa(e,l)&&l.id===n)return h.push(l),h}else{if(m[2])return Aa.apply(h,e.getElementsByTagName(d)),
h;if((n=m[3])&&C.getElementsByClassName&&e.getElementsByClassName)return Aa.apply(h,e.getElementsByClassName(n)),h}if(C.qsa&&(!aa||!aa.test(d))){if(l=m=fa,n=e,q=9===p&&d,1===p&&"object"!==e.nodeName.toLowerCase()){p=u(d);(m=e.getAttribute("id"))?l=m.replace(Na,"\\$&"):e.setAttribute("id",l);l="[id='"+l+"'] ";for(n=p.length;n--;)p[n]=l+v(p[n]);n=ya.test(d)&&e.parentNode||e;q=p.join(",")}if(q)try{return Aa.apply(h,n.querySelectorAll(q)),h}catch(I){}finally{m||e.removeAttribute("id")}}}var s;a:{d=d.replace(qa,
"$1");var r,Y;l=u(d);if(!k&&1===l.length){if(s=l[0]=l[0].slice(0),2<s.length&&"ID"===(r=s[0]).type&&C.getById&&9===e.nodeType&&Q&&F.relative[s[1].type]){if(e=(F.find.ID(r.matches[0].replace(Ba,Ca),e)||[])[0],!e){s=h;break a}d=d.slice(s.shift().value.length)}for(p=xa.needsContext.test(d)?0:s.length;p--&&!(r=s[p],F.relative[m=r.type]);)if((Y=F.find[m])&&(k=Y(r.matches[0].replace(Ba,Ca),ya.test(s[0].type)&&e.parentNode||e))){if(s.splice(p,1),d=k.length&&v(s),!d){s=(Aa.apply(h,k),h);break a}break}}s=
(U(d,l)(k,e,!Q,h,ya.test(d)),h)}return s}function h(){function d(f,h){return e.push(f+=" ")>F.cacheLength&&delete d[e.shift()],d[f]=h}var e=[];return d}function k(d){return d[fa]=!0,d}function m(d){var e=H.createElement("div");try{return!!d(e)}catch(f){return!1}finally{e.parentNode&&e.parentNode.removeChild(e)}}function l(d,e){for(var f=d.split("|"),h=d.length;h--;)F.attrHandle[f[h]]=e}function n(d,e){var f=e&&d,h=f&&1===d.nodeType&&1===e.nodeType&&(~e.sourceIndex||ka)-(~d.sourceIndex||ka);if(h)return h;
if(f)for(;f=f.nextSibling;)if(f===e)return-1;return d?1:-1}function p(d){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===d}}function q(d){return function(e){var f=e.nodeName.toLowerCase();return("input"===f||"button"===f)&&e.type===d}}function s(d){return k(function(e){return e=+e,k(function(f,h){for(var k,m=d([],f.length,e),l=m.length;l--;)f[k=m[l]]&&(f[k]=!(h[k]=f[k]))})})}function t(){}function u(d,e){var h,k,m,l,n,p,q;if(n=ca[d+" "])return e?0:n.slice(0);n=d;p=[];for(q=F.preFilter;n;){(!h||
(k=Ea.exec(n)))&&(k&&(n=n.slice(k[0].length)||n),p.push(m=[]));h=!1;(k=Fa.exec(n))&&(h=k.shift(),m.push({value:h,type:k[0].replace(qa," ")}),n=n.slice(h.length));for(l in F.filter)!(k=xa[l].exec(n))||q[l]&&!(k=q[l](k))||(h=k.shift(),m.push({value:h,type:l,matches:k}),n=n.slice(h.length));if(!h)break}return e?n.length:n?f.error(d):ca(d,p).slice(0)}function v(d){for(var e=0,f=d.length,h="";f>e;e++)h+=d[e].value;return h}function x(d,e,f){var h=e.dir,k=f&&"parentNode"===h,m=Z++;return e.first?function(e,
f,m){for(;e=e[h];)if(1===e.nodeType||k)return d(e,f,m)}:function(e,f,l){var n,p,q,I=da+" "+m;if(l)for(;e=e[h];){if((1===e.nodeType||k)&&d(e,f,l))return!0}else for(;e=e[h];)if(1===e.nodeType||k)if(q=e[fa]||(e[fa]={}),(p=q[h])&&p[0]===I){if(!0===(n=p[1])||n===B)return!0===n}else if(p=q[h]=[I],p[1]=d(e,f,l)||B,!0===p[1])return!0}}function z(d){return 1<d.length?function(e,f,h){for(var k=d.length;k--;)if(!d[k](e,f,h))return!1;return!0}:d[0]}function w(d,e,f,h,k){for(var m,l=[],n=0,p=d.length,q=null!=
e;p>n;n++)(m=d[n])&&(!f||f(m,h,k))&&(l.push(m),q&&e.push(n));return l}function y(d,e,h,m,l,n){return m&&!m[fa]&&(m=y(m)),l&&!l[fa]&&(l=y(l,n)),k(function(k,n,p,q){var I,s,r=[],Y=[],t=n.length,ea;if(!(ea=k)){ea=e||"*";for(var u=p.nodeType?[p]:p,v=[],Ga=0,x=u.length;x>Ga;Ga++)f(ea,u[Ga],v);ea=v}ea=!d||!k&&e?ea:w(ea,r,d,p,q);u=h?l||(k?d:t||m)?[]:n:ea;if(h&&h(ea,u,p,q),m){I=w(u,Y);m(I,[],p,q);for(p=I.length;p--;)(s=I[p])&&(u[Y[p]]=!(ea[Y[p]]=s))}if(k){if(l||d){if(l){I=[];for(p=u.length;p--;)(s=u[p])&&
I.push(ea[p]=s);l(null,u=[],I,q)}for(p=u.length;p--;)(s=u[p])&&-1<(I=l?Da.call(k,s):r[p])&&(k[I]=!(n[I]=s))}}else u=w(u===n?u.splice(t,u.length):u),l?l(null,n,u,q):Aa.apply(n,u)})}function A(d){var e,f,h,k=d.length,m=F.relative[d[0].type];f=m||F.relative[" "];for(var l=m?1:0,n=x(function(d){return d===e},f,!0),p=x(function(d){return-1<Da.call(e,d)},f,!0),q=[function(d,f,h){return!m&&(h||f!==O)||((e=f).nodeType?n(d,f,h):p(d,f,h))}];k>l;l++)if(f=F.relative[d[l].type])q=[x(z(q),f)];else{if(f=F.filter[d[l].type].apply(null,
d[l].matches),f[fa]){for(h=++l;k>h&&!F.relative[d[h].type];h++);return y(1<l&&z(q),1<l&&v(d.slice(0,l-1).concat({value:" "===d[l-2].type?"*":""})).replace(qa,"$1"),f,h>l&&A(d.slice(l,h)),k>h&&A(d=d.slice(h)),k>h&&v(d))}q.push(f)}return z(q)}function G(d,e){var h=0,m=0<e.length,l=0<d.length,n=function(k,n,p,q,I){var s,r,Y=[],t=0,ea="0",u=k&&[],v=null!=I,Ga=O,x=k||l&&F.find.TAG("*",I&&n.parentNode||n),z=da+=null==Ga?1:Math.random()||0.1;for(v&&(O=n!==H&&n,B=h);null!=(I=x[ea]);ea++){if(l&&I){for(s=0;r=
d[s++];)if(r(I,n,p)){q.push(I);break}v&&(da=z,B=++h)}m&&((I=!r&&I)&&t--,k&&u.push(I))}if(t+=ea,m&&ea!==t){for(s=0;r=e[s++];)r(u,Y,n,p);if(k){if(0<t)for(;ea--;)u[ea]||Y[ea]||(Y[ea]=sa.call(q));Y=w(Y)}Aa.apply(q,Y);v&&!k&&0<Y.length&&1<t+e.length&&f.uniqueSort(q)}return v&&(da=z,O=Ga),u};return m?k(n):n}var E,C,B,F,L,M,U,O,T,J,H,K,Q,aa,W,ba,Oa,fa="sizzle"+-new Date,X=d.document,da=0,Z=0,ja=h(),ca=h(),ga=h(),ia=!1,la=function(d,e){return d===e?(ia=!0,0):0},pa=typeof e,ka=-2147483648,oa={}.hasOwnProperty,
ha=[],sa=ha.pop,wa=ha.push,Aa=ha.push,ra=ha.slice,Da=ha.indexOf||function(d){for(var e=0,f=this.length;f>e;e++)if(this[e]===d)return e;return-1},ta="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+".replace("w","w#"),va="\\[[\\x20\\t\\r\\n\\f]*((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)[\\x20\\t\\r\\n\\f]*(?:([*^$|!~]?=)[\\x20\\t\\r\\n\\f]*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+ta+")|)|)[\\x20\\t\\r\\n\\f]*\\]",ua=":((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+va.replace(3,
8)+")*)|.*)\\)|)",qa=/^[\x20\t\r\n\f]+|((?:^|[^\\])(?:\\.)*)[\x20\t\r\n\f]+$/g,Ea=/^[\x20\t\r\n\f]*,[\x20\t\r\n\f]*/,Fa=/^[\x20\t\r\n\f]*([>+~]|[\x20\t\r\n\f])[\x20\t\r\n\f]*/,ya=/[\x20\t\r\n\f]*[+~]/,Ha=/=[\x20\t\r\n\f]*([^\]'"]*)[\x20\t\r\n\f]*\]/g,Ia=RegExp(ua),Ja=RegExp("^"+ta+"$"),xa={ID:/^#((?:\\.|[\w-]|[^\x00-\xa0])+)/,CLASS:/^\.((?:\\.|[\w-]|[^\x00-\xa0])+)/,TAG:RegExp("^("+"(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+".replace("w","w*")+")"),ATTR:RegExp("^"+va),PSEUDO:RegExp("^"+ua),CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\([\\x20\\t\\r\\n\\f]*(even|odd|(([+-]|)(\\d*)n|)[\\x20\\t\\r\\n\\f]*(?:([+-]|)[\\x20\\t\\r\\n\\f]*(\\d+)|))[\\x20\\t\\r\\n\\f]*\\)|)",
"i"),bool:RegExp("^(?:checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)$","i"),needsContext:RegExp("^[\\x20\\t\\r\\n\\f]*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\([\\x20\\t\\r\\n\\f]*((?:-\\d)?\\d*)[\\x20\\t\\r\\n\\f]*\\)|)(?=[^-]|$)","i")},za=/^[^{]+\{\s*\[native \w/,Ka=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,La=/^(?:input|select|textarea|button)$/i,Ma=/^h\d$/i,Na=/'|\\/g,Ba=/\\([\da-f]{1,6}[\x20\t\r\n\f]?|([\x20\t\r\n\f])|.)/ig,
Ca=function(d,e,f){d="0x"+e-65536;return d!==d||f?e:0>d?String.fromCharCode(d+65536):String.fromCharCode(55296|d>>10,56320|1023&d)};try{Aa.apply(ha=ra.call(X.childNodes),X.childNodes),ha[X.childNodes.length].nodeType}catch(Pa){Aa={apply:ha.length?function(d,e){wa.apply(d,ra.call(e))}:function(d,e){for(var f=d.length,h=0;d[f++]=e[h++];);d.length=f-1}}}M=f.isXML=function(d){return(d=d&&(d.ownerDocument||d).documentElement)?"HTML"!==d.nodeName:!1};C=f.support={};J=f.setDocument=function(d){var f=d?d.ownerDocument||
d:X;d=f.defaultView;return f!==H&&9===f.nodeType&&f.documentElement?(H=f,K=f.documentElement,Q=!M(f),d&&d.attachEvent&&d!==d.top&&d.attachEvent("onbeforeunload",function(){J()}),C.attributes=m(function(d){return d.className="i",!d.getAttribute("className")}),C.getElementsByTagName=m(function(d){return d.appendChild(f.createComment("")),!d.getElementsByTagName("*").length}),C.getElementsByClassName=m(function(d){return d.innerHTML="<div class='a'></div><div class='a i'></div>",d.firstChild.className=
"i",2===d.getElementsByClassName("i").length}),C.getById=m(function(d){return K.appendChild(d).id=fa,!f.getElementsByName||!f.getElementsByName(fa).length}),C.getById?(F.find.ID=function(d,e){if(typeof e.getElementById!==pa&&Q){var f=e.getElementById(d);return f&&f.parentNode?[f]:[]}},F.filter.ID=function(d){var e=d.replace(Ba,Ca);return function(d){return d.getAttribute("id")===e}}):(delete F.find.ID,F.filter.ID=function(d){var e=d.replace(Ba,Ca);return function(d){return(d=typeof d.getAttributeNode!==
pa&&d.getAttributeNode("id"))&&d.value===e}}),F.find.TAG=C.getElementsByTagName?function(d,f){return typeof f.getElementsByTagName!==pa?f.getElementsByTagName(d):e}:function(d,e){var f,h=[],k=0,m=e.getElementsByTagName(d);if("*"===d){for(;f=m[k++];)1===f.nodeType&&h.push(f);return h}return m},F.find.CLASS=C.getElementsByClassName&&function(d,f){return typeof f.getElementsByClassName!==pa&&Q?f.getElementsByClassName(d):e},W=[],aa=[],(C.qsa=za.test(f.querySelectorAll))&&(m(function(d){d.innerHTML="<select><option selected=''></option></select>";
d.querySelectorAll("[selected]").length||aa.push("\\[[\\x20\\t\\r\\n\\f]*(?:value|checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)");d.querySelectorAll(":checked").length||aa.push(":checked")}),m(function(d){var e=f.createElement("input");e.setAttribute("type","hidden");d.appendChild(e).setAttribute("t","");d.querySelectorAll("[t^='']").length&&aa.push("[*^$]=[\\x20\\t\\r\\n\\f]*(?:''|\"\")");d.querySelectorAll(":enabled").length||
aa.push(":enabled",":disabled");d.querySelectorAll("*,:x");aa.push(",.*:")})),(C.matchesSelector=za.test(ba=K.webkitMatchesSelector||K.mozMatchesSelector||K.oMatchesSelector||K.msMatchesSelector))&&m(function(d){C.disconnectedMatch=ba.call(d,"div");ba.call(d,"[s!='']:x");W.push("!=",ua)}),aa=aa.length&&RegExp(aa.join("|")),W=W.length&&RegExp(W.join("|")),Oa=za.test(K.contains)||K.compareDocumentPosition?function(d,e){var f=9===d.nodeType?d.documentElement:d,h=e&&e.parentNode;return d===h||!(!h||1!==
h.nodeType||!(f.contains?f.contains(h):d.compareDocumentPosition&&16&d.compareDocumentPosition(h)))}:function(d,e){if(e)for(;e=e.parentNode;)if(e===d)return!0;return!1},la=K.compareDocumentPosition?function(d,e){if(d===e)return ia=!0,0;var h=e.compareDocumentPosition&&d.compareDocumentPosition&&d.compareDocumentPosition(e);return h?1&h||!C.sortDetached&&e.compareDocumentPosition(d)===h?d===f||Oa(X,d)?-1:e===f||Oa(X,e)?1:T?Da.call(T,d)-Da.call(T,e):0:4&h?-1:1:d.compareDocumentPosition?-1:1}:function(d,
e){var h,k=0;h=d.parentNode;var m=e.parentNode,l=[d],p=[e];if(d===e)return ia=!0,0;if(!h||!m)return d===f?-1:e===f?1:h?-1:m?1:T?Da.call(T,d)-Da.call(T,e):0;if(h===m)return n(d,e);for(h=d;h=h.parentNode;)l.unshift(h);for(h=e;h=h.parentNode;)p.unshift(h);for(;l[k]===p[k];)k++;return k?n(l[k],p[k]):l[k]===X?-1:p[k]===X?1:0},f):H};f.matches=function(d,e){return f(d,null,null,e)};f.matchesSelector=function(d,e){if((d.ownerDocument||d)!==H&&J(d),e=e.replace(Ha,"='$1']"),!(!C.matchesSelector||!Q||W&&W.test(e)||
aa&&aa.test(e)))try{var h=ba.call(d,e);if(h||C.disconnectedMatch||d.document&&11!==d.document.nodeType)return h}catch(k){}return 0<f(e,H,null,[d]).length};f.contains=function(d,e){return(d.ownerDocument||d)!==H&&J(d),Oa(d,e)};f.attr=function(d,f){(d.ownerDocument||d)!==H&&J(d);var h=F.attrHandle[f.toLowerCase()],h=h&&oa.call(F.attrHandle,f.toLowerCase())?h(d,f,!Q):e;return h===e?C.attributes||!Q?d.getAttribute(f):(h=d.getAttributeNode(f))&&h.specified?h.value:null:h};f.error=function(d){throw Error("Syntax error, unrecognized expression: "+
d);};f.uniqueSort=function(d){var e,f=[],h=0,k=0;if(ia=!C.detectDuplicates,T=!C.sortStable&&d.slice(0),d.sort(la),ia){for(;e=d[k++];)e===d[k]&&(h=f.push(k));for(;h--;)d.splice(f[h],1)}return d};L=f.getText=function(d){var e,f="",h=0;if(e=d.nodeType)if(1===e||9===e||11===e){if("string"==typeof d.textContent)return d.textContent;for(d=d.firstChild;d;d=d.nextSibling)f+=L(d)}else{if(3===e||4===e)return d.nodeValue}else for(;e=d[h];h++)f+=L(e);return f};F=f.selectors={cacheLength:50,createPseudo:k,match:xa,
attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(d){return d[1]=d[1].replace(Ba,Ca),d[3]=(d[4]||d[5]||"").replace(Ba,Ca),"~="===d[2]&&(d[3]=" "+d[3]+" "),d.slice(0,4)},CHILD:function(d){return d[1]=d[1].toLowerCase(),"nth"===d[1].slice(0,3)?(d[3]||f.error(d[0]),d[4]=+(d[4]?d[5]+(d[6]||1):2*("even"===d[3]||"odd"===d[3])),d[5]=+(d[7]+d[8]||"odd"===d[3])):d[3]&&f.error(d[0]),
d},PSEUDO:function(d){var f,h=!d[5]&&d[2];return xa.CHILD.test(d[0])?null:(d[3]&&d[4]!==e?d[2]=d[4]:h&&Ia.test(h)&&(f=u(h,!0))&&(f=h.indexOf(")",h.length-f)-h.length)&&(d[0]=d[0].slice(0,f),d[2]=h.slice(0,f)),d.slice(0,3))}},filter:{TAG:function(d){var e=d.replace(Ba,Ca).toLowerCase();return"*"===d?function(){return!0}:function(d){return d.nodeName&&d.nodeName.toLowerCase()===e}},CLASS:function(d){var e=ja[d+" "];return e||(e=RegExp("(^|[\\x20\\t\\r\\n\\f])"+d+"([\\x20\\t\\r\\n\\f]|$)"))&&ja(d,function(d){return e.test("string"==
typeof d.className&&d.className||typeof d.getAttribute!==pa&&d.getAttribute("class")||"")})},ATTR:function(d,e,h){return function(k){k=f.attr(k,d);return null==k?"!="===e:e?(k+="","="===e?k===h:"!="===e?k!==h:"^="===e?h&&0===k.indexOf(h):"*="===e?h&&-1<k.indexOf(h):"$="===e?h&&k.slice(-h.length)===h:"~="===e?-1<(" "+k+" ").indexOf(h):"|="===e?k===h||k.slice(0,h.length+1)===h+"-":!1):!0}},CHILD:function(d,e,f,h,k){var m="nth"!==d.slice(0,3),l="last"!==d.slice(-4),n="of-type"===e;return 1===h&&0===
k?function(d){return!!d.parentNode}:function(e,f,p){var q,I,s,r,Y;f=m!==l?"nextSibling":"previousSibling";var t=e.parentNode,ma=n&&e.nodeName.toLowerCase();p=!p&&!n;if(t){if(m){for(;f;){for(I=e;I=I[f];)if(n?I.nodeName.toLowerCase()===ma:1===I.nodeType)return!1;Y=f="only"===d&&!Y&&"nextSibling"}return!0}if(Y=[l?t.firstChild:t.lastChild],l&&p){p=t[fa]||(t[fa]={});q=p[d]||[];r=q[0]===da&&q[1];s=q[0]===da&&q[2];for(I=r&&t.childNodes[r];I=++r&&I&&I[f]||(s=r=0)||Y.pop();)if(1===I.nodeType&&++s&&I===e){p[d]=
[da,r,s];break}}else if(p&&(q=(e[fa]||(e[fa]={}))[d])&&q[0]===da)s=q[1];else for(;(I=++r&&I&&I[f]||(s=r=0)||Y.pop())&&(!(n?I.nodeName.toLowerCase()===ma:1===I.nodeType)||!++s||!(p&&((I[fa]||(I[fa]={}))[d]=[da,s]),I===e)););return s-=k,s===h||0===s%h&&0<=s/h}}},PSEUDO:function(d,e){var h,m=F.pseudos[d]||F.setFilters[d.toLowerCase()]||f.error("unsupported pseudo: "+d);return m[fa]?m(e):1<m.length?(h=[d,d,"",e],F.setFilters.hasOwnProperty(d.toLowerCase())?k(function(d,f){for(var h,k=m(d,e),l=k.length;l--;)h=
Da.call(d,k[l]),d[h]=!(f[h]=k[l])}):function(d){return m(d,0,h)}):m}},pseudos:{not:k(function(d){var e=[],f=[],h=U(d.replace(qa,"$1"));return h[fa]?k(function(d,e,f,k){var m;f=h(d,null,k,[]);for(k=d.length;k--;)(m=f[k])&&(d[k]=!(e[k]=m))}):function(d,k,m){return e[0]=d,h(e,null,m,f),!f.pop()}}),has:k(function(d){return function(e){return 0<f(d,e).length}}),contains:k(function(d){return function(e){return-1<(e.textContent||e.innerText||L(e)).indexOf(d)}}),lang:k(function(d){return Ja.test(d||"")||
f.error("unsupported lang: "+d),d=d.replace(Ba,Ca).toLowerCase(),function(e){var f;do if(f=Q?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return f=f.toLowerCase(),f===d||0===f.indexOf(d+"-");while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var f=d.location&&d.location.hash;return f&&f.slice(1)===e.id},root:function(d){return d===K},focus:function(d){return d===H.activeElement&&(!H.hasFocus||H.hasFocus())&&!(!d.type&&!d.href&&!~d.tabIndex)},enabled:function(d){return!1===
d.disabled},disabled:function(d){return!0===d.disabled},checked:function(d){var e=d.nodeName.toLowerCase();return"input"===e&&!!d.checked||"option"===e&&!!d.selected},selected:function(d){return d.parentNode&&d.parentNode.selectedIndex,!0===d.selected},empty:function(d){for(d=d.firstChild;d;d=d.nextSibling)if("@"<d.nodeName||3===d.nodeType||4===d.nodeType)return!1;return!0},parent:function(d){return!F.pseudos.empty(d)},header:function(d){return Ma.test(d.nodeName)},input:function(d){return La.test(d.nodeName)},
button:function(d){var e=d.nodeName.toLowerCase();return"input"===e&&"button"===d.type||"button"===e},text:function(d){var e;return"input"===d.nodeName.toLowerCase()&&"text"===d.type&&(null==(e=d.getAttribute("type"))||e.toLowerCase()===d.type)},first:s(function(){return[0]}),last:s(function(d,e){return[e-1]}),eq:s(function(d,e,f){return[0>f?f+e:f]}),even:s(function(d,e){for(var f=0;e>f;f+=2)d.push(f);return d}),odd:s(function(d,e){for(var f=1;e>f;f+=2)d.push(f);return d}),lt:s(function(d,e,f){for(e=
0>f?f+e:f;0<=--e;)d.push(e);return d}),gt:s(function(d,e,f){for(f=0>f?f+e:f;e>++f;)d.push(f);return d})}};F.pseudos.nth=F.pseudos.eq;for(E in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})F.pseudos[E]=p(E);for(E in{submit:!0,reset:!0})F.pseudos[E]=q(E);t.prototype=F.filters=F.pseudos;F.setFilters=new t;U=f.compile=function(d,e){var f,h=[],k=[],m=ga[d+" "];if(!m){e||(e=u(d));for(f=e.length;f--;)m=A(e[f]),m[fa]?h.push(m):k.push(m);m=ga(d,G(k,h))}return m};C.sortStable=fa.split("").sort(la).join("")===
fa;C.detectDuplicates=ia;J();C.sortDetached=m(function(d){return 1&d.compareDocumentPosition(H.createElement("div"))});m(function(d){return d.innerHTML="<a href='#'></a>","#"===d.firstChild.getAttribute("href")})||l("type|href|height|width",function(d,f,h){return h?e:d.getAttribute(f,"type"===f.toLowerCase()?1:2)});C.attributes&&m(function(d){return d.innerHTML="<input/>",d.firstChild.setAttribute("value",""),""===d.firstChild.getAttribute("value")})||l("value",function(d,f,h){return h||"input"!==
d.nodeName.toLowerCase()?e:d.defaultValue});m(function(d){return null==d.getAttribute("disabled")})||l("checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",function(d,f,h){var k;return h?e:(k=d.getAttributeNode(f))&&k.specified?k.value:!0===d[f]?f.toLowerCase():null});r.find=f;r.expr=f.selectors;r.expr[":"]=r.expr.pseudos;r.unique=f.uniqueSort;r.text=f.getText;r.isXMLDoc=f.isXML;r.contains=f.contains})(d);var Ua={};r.Callbacks=
function(d){d="string"==typeof d?Ua[d]||h(d):r.extend({},d);var f,k,m,l,n,p,q=[],s=!d.once&&[],t=function(e){f=d.memory&&e;k=!0;p=l||0;l=0;n=q.length;for(m=!0;q&&n>p;p++)if(!1===q[p].apply(e[0],e[1])&&d.stopOnFalse){f=!1;break}m=!1;q&&(s?s.length&&t(s.shift()):f?q=[]:u.disable())},u={add:function(){if(q){var e=q.length;(function Cb(e){r.each(e,function(e,f){var h=r.type(f);"function"===h?d.unique&&u.has(f)||q.push(f):f&&f.length&&"string"!==h&&Cb(f)})})(arguments);m?n=q.length:f&&(l=e,t(f))}return this},
remove:function(){return q&&r.each(arguments,function(d,e){for(var f;-1<(f=r.inArray(e,q,f));)q.splice(f,1),m&&(n>=f&&n--,p>=f&&p--)}),this},has:function(d){return d?-1<r.inArray(d,q):!(!q||!q.length)},empty:function(){return q=[],n=0,this},disable:function(){return q=s=f=e,this},disabled:function(){return!q},lock:function(){return s=e,f||u.disable(),this},locked:function(){return!s},fireWith:function(d,e){return!q||k&&!s||(e=e||[],e=[d,e.slice?e.slice():e],m?s.push(e):t(e)),this},fire:function(){return u.fireWith(this,
arguments),this},fired:function(){return!!k}};return u};r.extend({Deferred:function(d){var e=[["resolve","done",r.Callbacks("once memory"),"resolved"],["reject","fail",r.Callbacks("once memory"),"rejected"],["notify","progress",r.Callbacks("memory")]],f="pending",h={state:function(){return f},always:function(){return k.done(arguments).fail(arguments),this},then:function(){var d=arguments;return r.Deferred(function(f){r.each(e,function(e,m){var l=m[0],n=r.isFunction(d[e])&&d[e];k[m[1]](function(){var d=
n&&n.apply(this,arguments);d&&r.isFunction(d.promise)?d.promise().done(f.resolve).fail(f.reject).progress(f.notify):f[l+"With"](this===h?f.promise():this,n?[d]:arguments)})});d=null}).promise()},promise:function(d){return null!=d?r.extend(d,h):h}},k={};return h.pipe=h.then,r.each(e,function(d,m){var l=m[2],n=m[3];h[m[1]]=l.add;n&&l.add(function(){f=n},e[1^d][2].disable,e[2][2].lock);k[m[0]]=function(){return k[m[0]+"With"](this===k?h:this,arguments),this};k[m[0]+"With"]=l.fireWith}),h.promise(k),
d&&d.call(k,k),k},when:function(d){var e=0,f=wa.call(arguments),h=f.length,k=1!==h||d&&r.isFunction(d.promise)?h:0,m=1===k?d:r.Deferred(),l=function(d,e,f){return function(h){e[d]=this;f[d]=1<arguments.length?wa.call(arguments):h;f===n?m.notifyWith(e,f):--k||m.resolveWith(e,f)}},n,p,q;if(1<h){n=Array(h);p=Array(h);for(q=Array(h);h>e;e++)f[e]&&r.isFunction(f[e].promise)?f[e].promise().done(l(e,q,f)).fail(m.reject).progress(l(e,p,n)):--k}return k||m.resolveWith(q,f),m.promise()}});r.support=function(e){var f=
J.createElement("input"),h=J.createDocumentFragment(),k=J.createElement("div"),m=J.createElement("select"),l=m.appendChild(J.createElement("option"));return f.type?(f.type="checkbox",e.checkOn=""!==f.value,e.optSelected=l.selected,e.reliableMarginRight=!0,e.boxSizingReliable=!0,e.pixelPosition=!1,f.checked=!0,e.noCloneChecked=f.cloneNode(!0).checked,m.disabled=!0,e.optDisabled=!l.disabled,f=J.createElement("input"),f.value="t",f.type="radio",e.radioValue="t"===f.value,f.setAttribute("checked","t"),
f.setAttribute("name","t"),h.appendChild(f),e.checkClone=h.cloneNode(!0).cloneNode(!0).lastChild.checked,e.focusinBubbles="onfocusin"in d,k.style.backgroundClip="content-box",k.cloneNode(!0).style.backgroundClip="",e.clearCloneStyle="content-box"===k.style.backgroundClip,r(function(){var f,h,m=J.getElementsByTagName("body")[0];m&&(f=J.createElement("div"),f.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",m.appendChild(f).appendChild(k),k.innerHTML="",
k.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%",r.swap(m,null!=m.style.zoom?{zoom:1}:{},function(){e.boxSizing=4===k.offsetWidth}),d.getComputedStyle&&(e.pixelPosition="1%"!==(d.getComputedStyle(k,null)||{}).top,e.boxSizingReliable="4px"===(d.getComputedStyle(k,null)||{width:"4px"}).width,h=k.appendChild(J.createElement("div")),h.style.cssText=k.style.cssText="padding:0;margin:0;border:0;display:block;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box",
h.style.marginRight=h.style.width="0",k.style.width="1px",e.reliableMarginRight=!parseFloat((d.getComputedStyle(h,null)||{}).marginRight)),m.removeChild(f))}),e):e}({});var ca,H,rb=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,qb=/([A-Z])/g;k.uid=1;k.accepts=function(d){return d.nodeType?1===d.nodeType||9===d.nodeType:!0};k.prototype={key:function(d){if(!k.accepts(d))return 0;var e={},f=d[this.expando];if(!f){f=k.uid++;try{e[this.expando]={value:f},Object.defineProperties(d,e)}catch(h){e[this.expando]=f,r.extend(d,
e)}}return this.cache[f]||(this.cache[f]={}),f},set:function(d,e,f){var h;d=this.key(d);var k=this.cache[d];if("string"==typeof e)k[e]=f;else if(r.isEmptyObject(k))r.extend(this.cache[d],e);else for(h in e)k[h]=e[h];return k},get:function(d,f){var h=this.cache[this.key(d)];return f===e?h:h[f]},access:function(d,f,h){var k;return f===e||f&&"string"==typeof f&&h===e?(k=this.get(d,f),k!==e?k:this.get(d,r.camelCase(f))):(this.set(d,f,h),h!==e?h:f)},remove:function(d,f){var h,k,m=this.key(d),l=this.cache[m];
if(f===e)this.cache[m]={};else{r.isArray(f)?k=f.concat(f.map(r.camelCase)):(h=r.camelCase(f),f in l?k=[f,h]:(k=h,k=k in l?[k]:k.match(oa)||[]));for(h=k.length;h--;)delete l[k[h]]}},hasData:function(d){return!r.isEmptyObject(this.cache[d[this.expando]]||{})},discard:function(d){d[this.expando]&&delete this.cache[d[this.expando]]}};ca=new k;H=new k;r.extend({acceptData:k.accepts,hasData:function(d){return ca.hasData(d)||H.hasData(d)},data:function(d,e,f){return ca.access(d,e,f)},removeData:function(d,
e){ca.remove(d,e)},_data:function(d,e,f){return H.access(d,e,f)},_removeData:function(d,e){H.remove(d,e)}});r.fn.extend({data:function(d,f){var h,k,m=this[0],n=0,p=null;if(d===e){if(this.length&&(p=ca.get(m),1===m.nodeType&&!H.get(m,"hasDataAttrs"))){for(h=m.attributes;h.length>n;n++)k=h[n].name,0===k.indexOf("data-")&&(k=r.camelCase(k.slice(5)),l(m,k,p[k]));H.set(m,"hasDataAttrs",!0)}return p}return"object"==typeof d?this.each(function(){ca.set(this,d)}):r.access(this,function(f){var h,k=r.camelCase(d);
if(m&&f===e){if((h=ca.get(m,d),h!==e)||(h=ca.get(m,k),h!==e)||(h=l(m,k,e),h!==e))return h}else this.each(function(){var h=ca.get(this,k);ca.set(this,k,f);-1!==d.indexOf("-")&&h!==e&&ca.set(this,d,f)})},null,f,1<arguments.length,null,!0)},removeData:function(d){return this.each(function(){ca.remove(this,d)})}});r.extend({queue:function(d,f,h){var k;return d?(f=(f||"fx")+"queue",k=H.get(d,f),h&&(!k||r.isArray(h)?k=H.access(d,f,r.makeArray(h)):k.push(h)),k||[]):e},dequeue:function(d,e){e=e||"fx";var f=
r.queue(d,e),h=f.length,k=f.shift(),m=r._queueHooks(d,e),l=function(){r.dequeue(d,e)};"inprogress"===k&&(k=f.shift(),h--);k&&("fx"===e&&f.unshift("inprogress"),delete m.stop,k.call(d,l,m));!h&&m&&m.empty.fire()},_queueHooks:function(d,e){var f=e+"queueHooks";return H.get(d,f)||H.access(d,f,{empty:r.Callbacks("once memory").add(function(){H.remove(d,[e+"queue",f])})})}});r.fn.extend({queue:function(d,f){var h=2;return"string"!=typeof d&&(f=d,d="fx",h--),h>arguments.length?r.queue(this[0],d):f===e?
this:this.each(function(){var e=r.queue(this,d,f);r._queueHooks(this,d);"fx"===d&&"inprogress"!==e[0]&&r.dequeue(this,d)})},dequeue:function(d){return this.each(function(){r.dequeue(this,d)})},delay:function(d,e){return d=r.fx?r.fx.speeds[d]||d:d,e=e||"fx",this.queue(e,function(e,f){var h=setTimeout(e,d);f.stop=function(){clearTimeout(h)}})},clearQueue:function(d){return this.queue(d||"fx",[])},promise:function(d,f){var h,k=1,m=r.Deferred(),l=this,n=this.length,p=function(){--k||m.resolveWith(l,[l])};
"string"!=typeof d&&(f=d,d=e);for(d=d||"fx";n--;)(h=H.get(l[n],d+"queueHooks"))&&h.empty&&(k++,h.empty.add(p));return p(),m.promise(f)}});var Za,Qa=/[\t\r\n\f]/g,Db=/\r/g,Eb=/^(?:input|select|textarea|button)$/i;r.fn.extend({attr:function(d,e){return r.access(this,r.attr,d,e,1<arguments.length)},removeAttr:function(d){return this.each(function(){r.removeAttr(this,d)})},prop:function(d,e){return r.access(this,r.prop,d,e,1<arguments.length)},removeProp:function(d){return this.each(function(){delete this[r.propFix[d]||
d]})},addClass:function(d){var e,f,h,k,m,l=0,n=this.length;e="string"==typeof d&&d;if(r.isFunction(d))return this.each(function(e){r(this).addClass(d.call(this,e,this.className))});if(e)for(e=(d||"").match(oa)||[];n>l;l++)if(f=this[l],h=1===f.nodeType&&(f.className?(" "+f.className+" ").replace(Qa," "):" ")){for(m=0;k=e[m++];)0>h.indexOf(" "+k+" ")&&(h+=k+" ");f.className=r.trim(h)}return this},removeClass:function(d){var e,f,h,k,m,l=0,n=this.length;e=0===arguments.length||"string"==typeof d&&d;if(r.isFunction(d))return this.each(function(e){r(this).removeClass(d.call(this,
e,this.className))});if(e)for(e=(d||"").match(oa)||[];n>l;l++)if(f=this[l],h=1===f.nodeType&&(f.className?(" "+f.className+" ").replace(Qa," "):"")){for(m=0;k=e[m++];)for(;0<=h.indexOf(" "+k+" ");)h=h.replace(" "+k+" "," ");f.className=d?r.trim(h):""}return this},toggleClass:function(d,e){var f=typeof d;return"boolean"==typeof e&&"string"===f?e?this.addClass(d):this.removeClass(d):r.isFunction(d)?this.each(function(f){r(this).toggleClass(d.call(this,f,this.className,e),e)}):this.each(function(){if("string"===
f)for(var e,h=0,k=r(this),m=d.match(oa)||[];e=m[h++];)k.hasClass(e)?k.removeClass(e):k.addClass(e);else(f===Q||"boolean"===f)&&(this.className&&H.set(this,"__className__",this.className),this.className=this.className||!1===d?"":H.get(this,"__className__")||"")})},hasClass:function(d){d=" "+d+" ";for(var e=0,f=this.length;f>e;e++)if(1===this[e].nodeType&&0<=(" "+this[e].className+" ").replace(Qa," ").indexOf(d))return!0;return!1},val:function(d){var f,h,k,m=this[0];if(arguments.length)return k=r.isFunction(d),
this.each(function(h){var m;1===this.nodeType&&(m=k?d.call(this,h,r(this).val()):d,null==m?m="":"number"==typeof m?m+="":r.isArray(m)&&(m=r.map(m,function(d){return null==d?"":d+""})),f=r.valHooks[this.type]||r.valHooks[this.nodeName.toLowerCase()],f&&"set"in f&&f.set(this,m,"value")!==e||(this.value=m))});if(m)return f=r.valHooks[m.type]||r.valHooks[m.nodeName.toLowerCase()],f&&"get"in f&&(h=f.get(m,"value"))!==e?h:(h=m.value,"string"==typeof h?h.replace(Db,""):null==h?"":h)}});r.extend({valHooks:{option:{get:function(d){var e=
d.attributes.value;return!e||e.specified?d.value:d.text}},select:{get:function(d){for(var e,f=d.options,h=d.selectedIndex,k="select-one"===d.type||0>h,m=k?null:[],l=k?h+1:f.length,n=0>h?l:k?h:0;l>n;n++)if(e=f[n],!(!e.selected&&n!==h||(r.support.optDisabled?e.disabled:null!==e.getAttribute("disabled"))||e.parentNode.disabled&&r.nodeName(e.parentNode,"optgroup"))){if(d=r(e).val(),k)return d;m.push(d)}return m},set:function(d,e){for(var f,h,k=d.options,m=r.makeArray(e),l=k.length;l--;)h=k[l],(h.selected=
0<=r.inArray(r(h).val(),m))&&(f=!0);return f||(d.selectedIndex=-1),m}}},attr:function(d,f,h){var k,m,l=d.nodeType;if(d&&3!==l&&8!==l&&2!==l)return typeof d.getAttribute===Q?r.prop(d,f,h):(1===l&&r.isXMLDoc(d)||(f=f.toLowerCase(),k=r.attrHooks[f]||(r.expr.match.bool.test(f)?Za:void 0)),h===e?k&&"get"in k&&null!==(m=k.get(d,f))?m:(m=r.find.attr(d,f),null==m?e:m):null!==h?k&&"set"in k&&(m=k.set(d,h,f))!==e?m:(d.setAttribute(f,h+""),h):(r.removeAttr(d,f),e))},removeAttr:function(d,e){var f,h,k=0,m=e&&
e.match(oa);if(m&&1===d.nodeType)for(;f=m[k++];)h=r.propFix[f]||f,r.expr.match.bool.test(f)&&(d[h]=!1),d.removeAttribute(f)},attrHooks:{type:{set:function(d,e){if(!r.support.radioValue&&"radio"===e&&r.nodeName(d,"input")){var f=d.value;return d.setAttribute("type",e),f&&(d.value=f),e}}}},propFix:{"for":"htmlFor","class":"className"},prop:function(d,f,h){var k,m,l,n=d.nodeType;if(d&&3!==n&&8!==n&&2!==n)return l=1!==n||!r.isXMLDoc(d),l&&(f=r.propFix[f]||f,m=r.propHooks[f]),h!==e?m&&"set"in m&&(k=m.set(d,
h,f))!==e?k:d[f]=h:m&&"get"in m&&null!==(k=m.get(d,f))?k:d[f]},propHooks:{tabIndex:{get:function(d){return d.hasAttribute("tabindex")||Eb.test(d.nodeName)||d.href?d.tabIndex:-1}}}});Za={set:function(d,e,f){return!1===e?r.removeAttr(d,f):d.setAttribute(f,f),f}};r.each(r.expr.match.bool.source.match(/\w+/g),function(d,f){var h=r.expr.attrHandle[f]||r.find.attr;r.expr.attrHandle[f]=function(d,f,k){var m=r.expr.attrHandle[f];d=k?e:(r.expr.attrHandle[f]=e)!=h(d,f,k)?f.toLowerCase():null;return r.expr.attrHandle[f]=
m,d}});r.support.optSelected||(r.propHooks.selected={get:function(d){d=d.parentNode;return d&&d.parentNode&&d.parentNode.selectedIndex,null}});r.each("tabIndex readOnly maxLength cellSpacing cellPadding rowSpan colSpan useMap frameBorder contentEditable".split(" "),function(){r.propFix[this.toLowerCase()]=this});r.each(["radio","checkbox"],function(){r.valHooks[this]={set:function(d,f){return r.isArray(f)?d.checked=0<=r.inArray(r(d).val(),f):e}};r.support.checkOn||(r.valHooks[this].get=function(d){return null===
d.getAttribute("value")?"on":d.value})});var Fb=/^key/,Gb=/^(?:mouse|contextmenu)|click/,$a=/^(?:focusinfocus|focusoutblur)$/,ab=/^([^.]*)(?:\.(.+)|)$/;r.event={global:{},add:function(d,f,h,k,m){var l,n,p,q,s,t,u,v,x,z;if(s=H.get(d)){h.handler&&(l=h,h=l.handler,m=l.selector);h.guid||(h.guid=r.guid++);(q=s.events)||(q=s.events={});(n=s.handle)||(n=s.handle=function(d){return typeof r===Q||d&&r.event.triggered===d.type?e:r.event.dispatch.apply(n.elem,arguments)},n.elem=d);f=(f||"").match(oa)||[""];
for(s=f.length;s--;)p=ab.exec(f[s])||[],x=z=p[1],p=(p[2]||"").split(".").sort(),x&&(u=r.event.special[x]||{},x=(m?u.delegateType:u.bindType)||x,u=r.event.special[x]||{},t=r.extend({type:x,origType:z,data:k,handler:h,guid:h.guid,selector:m,needsContext:m&&r.expr.match.needsContext.test(m),namespace:p.join(".")},l),(v=q[x])||(v=q[x]=[],v.delegateCount=0,u.setup&&!1!==u.setup.call(d,k,p,n)||d.addEventListener&&d.addEventListener(x,n,!1)),u.add&&(u.add.call(d,t),t.handler.guid||(t.handler.guid=h.guid)),
m?v.splice(v.delegateCount++,0,t):v.push(t),r.event.global[x]=!0);d=null}},remove:function(d,e,f,h,k){var m,l,n,p,q,s,t,u,v,x,z,w=H.hasData(d)&&H.get(d);if(w&&(p=w.events)){e=(e||"").match(oa)||[""];for(q=e.length;q--;)if(n=ab.exec(e[q])||[],v=z=n[1],x=(n[2]||"").split(".").sort(),v){t=r.event.special[v]||{};v=(h?t.delegateType:t.bindType)||v;u=p[v]||[];n=n[2]&&RegExp("(^|\\.)"+x.join("\\.(?:.*\\.|)")+"(\\.|$)");for(l=m=u.length;m--;)s=u[m],!k&&z!==s.origType||f&&f.guid!==s.guid||n&&!n.test(s.namespace)||
h&&h!==s.selector&&("**"!==h||!s.selector)||(u.splice(m,1),s.selector&&u.delegateCount--,t.remove&&t.remove.call(d,s));l&&!u.length&&(t.teardown&&!1!==t.teardown.call(d,x,w.handle)||r.removeEvent(d,v,w.handle),delete p[v])}else for(v in p)r.event.remove(d,v+e[q],f,h,!0);r.isEmptyObject(p)&&(delete w.handle,H.remove(d,"events"))}},trigger:function(f,h,k,m){var l,n,p,q,s,t,u,v=[k||J],x=Pa.call(f,"type")?f.type:f;l=Pa.call(f,"namespace")?f.namespace.split("."):[];if(n=p=k=k||J,3!==k.nodeType&&8!==k.nodeType&&
!$a.test(x+r.event.triggered)&&(0<=x.indexOf(".")&&(l=x.split("."),x=l.shift(),l.sort()),s=0>x.indexOf(":")&&"on"+x,f=f[r.expando]?f:new r.Event(x,"object"==typeof f&&f),f.isTrigger=m?2:3,f.namespace=l.join("."),f.namespace_re=f.namespace?RegExp("(^|\\.)"+l.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,f.result=e,f.target||(f.target=k),h=null==h?[f]:r.makeArray(h,[f]),u=r.event.special[x]||{},m||!u.trigger||!1!==u.trigger.apply(k,h))){if(!m&&!u.noBubble&&!r.isWindow(k)){q=u.delegateType||x;for($a.test(q+
x)||(n=n.parentNode);n;n=n.parentNode)v.push(n),p=n;p===(k.ownerDocument||J)&&v.push(p.defaultView||p.parentWindow||d)}for(l=0;(n=v[l++])&&!f.isPropagationStopped();)f.type=1<l?q:u.bindType||x,(t=(H.get(n,"events")||{})[f.type]&&H.get(n,"handle"))&&t.apply(n,h),(t=s&&n[s])&&r.acceptData(n)&&t.apply&&!1===t.apply(n,h)&&f.preventDefault();return f.type=x,m||f.isDefaultPrevented()||u._default&&!1!==u._default.apply(v.pop(),h)||!r.acceptData(k)||s&&r.isFunction(k[x])&&!r.isWindow(k)&&(p=k[s],p&&(k[s]=
null),r.event.triggered=x,k[x](),r.event.triggered=e,p&&(k[s]=p)),f.result}},dispatch:function(d){d=r.event.fix(d);var f,h,k,m,l,n=[],p=wa.call(arguments);f=(H.get(this,"events")||{})[d.type]||[];var q=r.event.special[d.type]||{};if(p[0]=d,d.delegateTarget=this,!q.preDispatch||!1!==q.preDispatch.call(this,d)){n=r.event.handlers.call(this,d,f);for(f=0;(m=n[f++])&&!d.isPropagationStopped();){d.currentTarget=m.elem;for(h=0;(l=m.handlers[h++])&&!d.isImmediatePropagationStopped();)(!d.namespace_re||d.namespace_re.test(l.namespace))&&
(d.handleObj=l,d.data=l.data,k=((r.event.special[l.origType]||{}).handle||l.handler).apply(m.elem,p),k!==e&&!1===(d.result=k)&&(d.preventDefault(),d.stopPropagation()))}return q.postDispatch&&q.postDispatch.call(this,d),d.result}},handlers:function(d,f){var h,k,m,l,n=[],p=f.delegateCount,q=d.target;if(p&&q.nodeType&&(!d.button||"click"!==d.type))for(;q!==this;q=q.parentNode||this)if(!0!==q.disabled||"click"!==d.type){k=[];for(h=0;p>h;h++)l=f[h],m=l.selector+" ",k[m]===e&&(k[m]=l.needsContext?0<=r(m,
this).index(q):r.find(m,this,null,[q]).length),k[m]&&k.push(l);k.length&&n.push({elem:q,handlers:k})}return f.length>p&&n.push({elem:this,handlers:f.slice(p)}),n},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:["char","charCode","key","keyCode"],filter:function(d,e){return null==d.which&&(d.which=null!=e.charCode?e.charCode:e.keyCode),d}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),
filter:function(d,f){var h,k,m,l=f.button;return null==d.pageX&&null!=f.clientX&&(h=d.target.ownerDocument||J,k=h.documentElement,m=h.body,d.pageX=f.clientX+(k&&k.scrollLeft||m&&m.scrollLeft||0)-(k&&k.clientLeft||m&&m.clientLeft||0),d.pageY=f.clientY+(k&&k.scrollTop||m&&m.scrollTop||0)-(k&&k.clientTop||m&&m.clientTop||0)),d.which||l===e||(d.which=1&l?1:2&l?3:4&l?2:0),d}},fix:function(d){if(d[r.expando])return d;var e,f,h;e=d.type;var k=d,m=this.fixHooks[e];m||(this.fixHooks[e]=m=Gb.test(e)?this.mouseHooks:
Fb.test(e)?this.keyHooks:{});h=m.props?this.props.concat(m.props):this.props;d=new r.Event(k);for(e=h.length;e--;)f=h[e],d[f]=k[f];return d.target||(d.target=J),3===d.target.nodeType&&(d.target=d.target.parentNode),m.filter?m.filter(d,k):d},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==p()&&this.focus?(this.focus(),!1):e},delegateType:"focusin"},blur:{trigger:function(){return this===p()&&this.blur?(this.blur(),!1):e},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===
this.type&&this.click&&r.nodeName(this,"input")?(this.click(),!1):e},_default:function(d){return r.nodeName(d.target,"a")}},beforeunload:{postDispatch:function(d){d.result!==e&&(d.originalEvent.returnValue=d.result)}}},simulate:function(d,e,f,h){d=r.extend(new r.Event,f,{type:d,isSimulated:!0,originalEvent:{}});h?r.event.trigger(d,null,e):r.event.dispatch.call(e,d);d.isDefaultPrevented()&&f.preventDefault()}};r.removeEvent=function(d,e,f){d.removeEventListener&&d.removeEventListener(e,f,!1)};r.Event=
function(d,f){return this instanceof r.Event?(d&&d.type?(this.originalEvent=d,this.type=d.type,this.isDefaultPrevented=d.defaultPrevented||d.getPreventDefault&&d.getPreventDefault()?m:n):this.type=d,f&&r.extend(this,f),this.timeStamp=d&&d.timeStamp||r.now(),this[r.expando]=!0,e):new r.Event(d,f)};r.Event.prototype={isDefaultPrevented:n,isPropagationStopped:n,isImmediatePropagationStopped:n,preventDefault:function(){var d=this.originalEvent;this.isDefaultPrevented=m;d&&d.preventDefault&&d.preventDefault()},
stopPropagation:function(){var d=this.originalEvent;this.isPropagationStopped=m;d&&d.stopPropagation&&d.stopPropagation()},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=m;this.stopPropagation()}};r.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(d,e){r.event.special[d]={delegateType:e,bindType:e,handle:function(d){var f,h=d.relatedTarget,k=d.handleObj;return(!h||h!==this&&!r.contains(this,h))&&(d.type=k.origType,f=k.handler.apply(this,arguments),d.type=e),f}}});
r.support.focusinBubbles||r.each({focus:"focusin",blur:"focusout"},function(d,e){var f=0,h=function(d){r.event.simulate(e,d.target,r.event.fix(d),!0)};r.event.special[e]={setup:function(){0===f++&&J.addEventListener(d,h,!0)},teardown:function(){0===--f&&J.removeEventListener(d,h,!0)}}});r.fn.extend({on:function(d,f,h,k,m){var l,p;if("object"==typeof d){"string"!=typeof f&&(h=h||f,f=e);for(p in d)this.on(p,f,h,d[p],m);return this}if(null==h&&null==k?(k=f,h=f=e):null==k&&("string"==typeof f?(k=h,h=
e):(k=h,h=f,f=e)),!1===k)k=n;else if(!k)return this;return 1===m&&(l=k,k=function(d){return r().off(d),l.apply(this,arguments)},k.guid=l.guid||(l.guid=r.guid++)),this.each(function(){r.event.add(this,d,k,h,f)})},one:function(d,e,f,h){return this.on(d,e,f,h,1)},off:function(d,f,h){var k,m;if(d&&d.preventDefault&&d.handleObj)return k=d.handleObj,r(d.delegateTarget).off(k.namespace?k.origType+"."+k.namespace:k.origType,k.selector,k.handler),this;if("object"==typeof d){for(m in d)this.off(m,f,d[m]);return this}return(!1===
f||"function"==typeof f)&&(h=f,f=e),!1===h&&(h=n),this.each(function(){r.event.remove(this,d,h,f)})},trigger:function(d,e){return this.each(function(){r.event.trigger(d,e,this)})},triggerHandler:function(d,f){var h=this[0];return h?r.event.trigger(d,f,h,!0):e}});var sb=/^.[^:#\[\.,]*$/,Hb=/^(?:parents|prev(?:Until|All))/,bb=r.expr.match.needsContext,Ib={children:!0,contents:!0,next:!0,prev:!0};r.fn.extend({find:function(d){var e,f=[],h=this,k=h.length;if("string"!=typeof d)return this.pushStack(r(d).filter(function(){for(e=
0;k>e;e++)if(r.contains(h[e],this))return!0}));for(e=0;k>e;e++)r.find(d,h[e],f);return f=this.pushStack(1<k?r.unique(f):f),f.selector=this.selector?this.selector+" "+d:d,f},has:function(d){var e=r(d,this),f=e.length;return this.filter(function(){for(var d=0;f>d;d++)if(r.contains(this,e[d]))return!0})},not:function(d){return this.pushStack(s(this,d||[],!0))},filter:function(d){return this.pushStack(s(this,d||[],!1))},is:function(d){return!!s(this,"string"==typeof d&&bb.test(d)?r(d):d||[],!1).length},
closest:function(d,e){for(var f,h=0,k=this.length,m=[],l=bb.test(d)||"string"!=typeof d?r(d,e||this.context):0;k>h;h++)for(f=this[h];f&&f!==e;f=f.parentNode)if(11>f.nodeType&&(l?-1<l.index(f):1===f.nodeType&&r.find.matchesSelector(f,d))){m.push(f);break}return this.pushStack(1<m.length?r.unique(m):m)},index:function(d){return d?"string"==typeof d?Ha.call(r(d),this[0]):Ha.call(this,d.jquery?d[0]:d):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(d,e){var f="string"==typeof d?
r(d,e):r.makeArray(d&&d.nodeType?[d]:d),f=r.merge(this.get(),f);return this.pushStack(r.unique(f))},addBack:function(d){return this.add(null==d?this.prevObject:this.prevObject.filter(d))}});r.each({parent:function(d){return(d=d.parentNode)&&11!==d.nodeType?d:null},parents:function(d){return r.dir(d,"parentNode")},parentsUntil:function(d,e,f){return r.dir(d,"parentNode",f)},next:function(d){return q(d,"nextSibling")},prev:function(d){return q(d,"previousSibling")},nextAll:function(d){return r.dir(d,
"nextSibling")},prevAll:function(d){return r.dir(d,"previousSibling")},nextUntil:function(d,e,f){return r.dir(d,"nextSibling",f)},prevUntil:function(d,e,f){return r.dir(d,"previousSibling",f)},siblings:function(d){return r.sibling((d.parentNode||{}).firstChild,d)},children:function(d){return r.sibling(d.firstChild)},contents:function(d){return d.contentDocument||r.merge([],d.childNodes)}},function(d,e){r.fn[d]=function(f,h){var k=r.map(this,e,f);return"Until"!==d.slice(-5)&&(h=f),h&&"string"==typeof h&&
(k=r.filter(h,k)),1<this.length&&(Ib[d]||r.unique(k),Hb.test(d)&&k.reverse()),this.pushStack(k)}});r.extend({filter:function(d,e,f){var h=e[0];return f&&(d=":not("+d+")"),1===e.length&&1===h.nodeType?r.find.matchesSelector(h,d)?[h]:[]:r.find.matches(d,r.grep(e,function(d){return 1===d.nodeType}))},dir:function(d,f,h){for(var k=[],m=h!==e;(d=d[f])&&9!==d.nodeType;)if(1===d.nodeType){if(m&&r(d).is(h))break;k.push(d)}return k},sibling:function(d,e){for(var f=[];d;d=d.nextSibling)1===d.nodeType&&d!==
e&&f.push(d);return f}});var cb=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,db=/<([\w:]+)/,Jb=/<|&#?\w+;/,Kb=/<(?:script|style|link)/i,eb=/^(?:checkbox|radio)$/i,Lb=/checked\s*(?:[^=]|=\s*.checked.)/i,fb=/^$|\/(?:java|ecma)script/i,tb=/^true\/(.*)/,Mb=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,ka={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],
td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};ka.optgroup=ka.option;ka.tbody=ka.tfoot=ka.colgroup=ka.caption=ka.thead;ka.th=ka.td;r.fn.extend({text:function(d){return r.access(this,function(d){return d===e?r.text(this):this.empty().append((this[0]&&this[0].ownerDocument||J).createTextNode(d))},null,d,arguments.length)},append:function(){return this.domManip(arguments,function(d){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&t(this,d).appendChild(d)})},prepend:function(){return this.domManip(arguments,
function(d){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=t(this,d);e.insertBefore(d,e.firstChild)}})},before:function(){return this.domManip(arguments,function(d){this.parentNode&&this.parentNode.insertBefore(d,this)})},after:function(){return this.domManip(arguments,function(d){this.parentNode&&this.parentNode.insertBefore(d,this.nextSibling)})},remove:function(d,e){for(var f,h=d?r.filter(d,this):this,k=0;null!=(f=h[k]);k++)e||1!==f.nodeType||r.cleanData(z(f)),f.parentNode&&
(e&&r.contains(f.ownerDocument,f)&&x(z(f,"script")),f.parentNode.removeChild(f));return this},empty:function(){for(var d,e=0;null!=(d=this[e]);e++)1===d.nodeType&&(r.cleanData(z(d,!1)),d.textContent="");return this},clone:function(d,e){return d=null==d?!1:d,e=null==e?d:e,this.map(function(){return r.clone(this,d,e)})},html:function(d){return r.access(this,function(d){var f=this[0]||{},h=0,k=this.length;if(d===e&&1===f.nodeType)return f.innerHTML;if("string"==typeof d&&!Kb.test(d)&&!ka[(db.exec(d)||
["",""])[1].toLowerCase()]){d=d.replace(cb,"<$1></$2>");try{for(;k>h;h++)f=this[h]||{},1===f.nodeType&&(r.cleanData(z(f,!1)),f.innerHTML=d);f=0}catch(m){}}f&&this.empty().append(d)},null,d,arguments.length)},replaceWith:function(){var d=r.map(this,function(d){return[d.nextSibling,d.parentNode]}),e=0;return this.domManip(arguments,function(f){var h=d[e++],k=d[e++];k&&(h&&h.parentNode!==k&&(h=this.nextSibling),r(this).remove(),k.insertBefore(f,h))},!0),e?this:this.remove()},detach:function(d){return this.remove(d,
!0)},domManip:function(d,e,f){d=Xa.apply([],d);var h,k,m,l,n=0,p=this.length,q=this,s=p-1,t=d[0],x=r.isFunction(t);if(x||!(1>=p||"string"!=typeof t||r.support.checkClone)&&Lb.test(t))return this.each(function(h){var k=q.eq(h);x&&(d[0]=t.call(this,h,k.html()));k.domManip(d,e,f)});if(p&&(h=r.buildFragment(d,this[0].ownerDocument,!1,!f&&this),k=h.firstChild,1===h.childNodes.length&&(h=k),k)){k=r.map(z(h,"script"),u);for(m=k.length;p>n;n++)l=h,n!==s&&(l=r.clone(l,!0,!0),m&&r.merge(k,z(l,"script"))),e.call(this[n],
l,n);if(m){h=k[k.length-1].ownerDocument;r.map(k,v);for(n=0;m>n;n++)l=k[n],fb.test(l.type||"")&&!H.access(l,"globalEval")&&r.contains(h,l)&&(l.src?r._evalUrl(l.src):r.globalEval(l.textContent.replace(Mb,"")))}}return this}});r.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(d,e){r.fn[d]=function(d){for(var f=[],h=r(d),k=h.length-1,m=0;k>=m;m++)d=m===k?this:this.clone(!0),r(h[m])[e](d),Na.apply(f,d.get());return this.pushStack(f)}});
r.extend({clone:function(d,e,f){var h,k,m,l,n=d.cloneNode(!0),p=r.contains(d.ownerDocument,d);if(!r.support.noCloneChecked&&!(1!==d.nodeType&&11!==d.nodeType||r.isXMLDoc(d))){l=z(n);m=z(d);h=0;for(k=m.length;k>h;h++){var q=m[h],s=l[h],t=s.nodeName.toLowerCase();"input"===t&&eb.test(q.type)?s.checked=q.checked:("input"===t||"textarea"===t)&&(s.defaultValue=q.defaultValue)}}if(e)if(f){m=m||z(d);l=l||z(n);h=0;for(k=m.length;k>h;h++)y(m[h],l[h])}else y(d,n);return l=z(n,"script"),0<l.length&&x(l,!p&&
z(d,"script")),n},buildFragment:function(d,e,f,h){for(var k,m,l,n,p=0,q=d.length,s=e.createDocumentFragment(),t=[];q>p;p++)if(k=d[p],k||0===k)if("object"===r.type(k))r.merge(t,k.nodeType?[k]:k);else if(Jb.test(k)){m=m||s.appendChild(e.createElement("div"));l=(db.exec(k)||["",""])[1].toLowerCase();l=ka[l]||ka._default;m.innerHTML=l[1]+k.replace(cb,"<$1></$2>")+l[2];for(l=l[0];l--;)m=m.lastChild;r.merge(t,m.childNodes);m=s.firstChild;m.textContent=""}else t.push(e.createTextNode(k));s.textContent="";
for(p=0;k=t[p++];)if((!h||-1===r.inArray(k,h))&&(n=r.contains(k.ownerDocument,k),m=z(s.appendChild(k),"script"),n&&x(m),f))for(l=0;k=m[l++];)fb.test(k.type||"")&&f.push(k);return s},cleanData:function(d){for(var f,h,m,l,n,p,q=r.event.special,s=0;(h=d[s])!==e;s++){if(k.accepts(h)&&(n=h[H.expando],n&&(f=H.cache[n]))){if(m=Object.keys(f.events||{}),m.length)for(p=0;(l=m[p])!==e;p++)q[l]?r.event.remove(h,l):r.removeEvent(h,l,f.handle);H.cache[n]&&delete H.cache[n]}delete ca.cache[h[ca.expando]]}},_evalUrl:function(d){return r.ajax({url:d,
type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})}});r.fn.extend({wrapAll:function(d){var e;return r.isFunction(d)?this.each(function(e){r(this).wrapAll(d.call(this,e))}):(this[0]&&(e=r(d,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var d=this;d.firstElementChild;)d=d.firstElementChild;return d}).append(this)),this)},wrapInner:function(d){return r.isFunction(d)?this.each(function(e){r(this).wrapInner(d.call(this,e))}):this.each(function(){var e=
r(this),f=e.contents();f.length?f.wrapAll(d):e.append(d)})},wrap:function(d){var e=r.isFunction(d);return this.each(function(f){r(this).wrapAll(e?d.call(this,f):d)})},unwrap:function(){return this.parent().each(function(){r.nodeName(this,"body")||r(this).replaceWith(this.childNodes)}).end()}});var ta,ua,Nb=/^(none|table(?!-c[ea]).+)/,gb=/^margin/,ub=RegExp("^("+xa+")(.*)$","i"),La=RegExp("^("+xa+")(?!px)[a-z%]+$","i"),Ob=RegExp("^([+-])=("+xa+")","i"),Wa={BODY:"block"},Pb={position:"absolute",visibility:"hidden",
display:"block"},hb={letterSpacing:0,fontWeight:400},sa=["Top","Right","Bottom","Left"],Va=["Webkit","O","Moz","ms"];r.fn.extend({css:function(f,h){return r.access(this,function(f,h,k){var m,l={},n=0;if(r.isArray(h)){k=d.getComputedStyle(f,null);for(m=h.length;m>n;n++)l[h[n]]=r.css(f,h[n],!1,k);return l}return k!==e?r.style(f,h,k):r.css(f,h)},f,h,1<arguments.length)},show:function(){return E(this,!0)},hide:function(){return E(this)},toggle:function(d){return"boolean"==typeof d?d?this.show():this.hide():
this.each(function(){G(this)?r(this).show():r(this).hide()})}});r.extend({cssHooks:{opacity:{get:function(d,e){if(e){var f=ta(d,"opacity");return""===f?"1":f}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(d,f,h,k){if(d&&3!==d.nodeType&&8!==d.nodeType&&d.style){var m,l,n,p=r.camelCase(f),q=d.style;return f=r.cssProps[p]||(r.cssProps[p]=A(q,p)),n=r.cssHooks[f]||r.cssHooks[p],
h===e?n&&"get"in n&&(m=n.get(d,!1,k))!==e?m:q[f]:(l=typeof h,"string"===l&&(m=Ob.exec(h))&&(h=(m[1]+1)*m[2]+parseFloat(r.css(d,f)),l="number"),null==h||"number"===l&&isNaN(h)||("number"!==l||r.cssNumber[p]||(h+="px"),r.support.clearCloneStyle||""!==h||0!==f.indexOf("background")||(q[f]="inherit"),n&&"set"in n&&(h=n.set(d,h,k))===e||(q[f]=h)),e)}},css:function(d,f,h,k){var m,l,n,p=r.camelCase(f);return f=r.cssProps[p]||(r.cssProps[p]=A(d.style,p)),n=r.cssHooks[f]||r.cssHooks[p],n&&"get"in n&&(m=n.get(d,
!0,h)),m===e&&(m=ta(d,f,k)),"normal"===m&&f in hb&&(m=hb[f]),""===h||h?(l=parseFloat(m),!0===h||r.isNumeric(l)?l||0:m):m}});ta=function(f,h,k){var m,l,n,p=(k=k||d.getComputedStyle(f,null))?k.getPropertyValue(h)||k[h]:e,q=f.style;return k&&(""!==p||r.contains(f.ownerDocument,f)||(p=r.style(f,h)),La.test(p)&&gb.test(h)&&(m=q.width,l=q.minWidth,n=q.maxWidth,q.minWidth=q.maxWidth=q.width=p,p=k.width,q.width=m,q.minWidth=l,q.maxWidth=n)),p};r.each(["height","width"],function(f,h){r.cssHooks[h]={get:function(d,
f,k){return f?0===d.offsetWidth&&Nb.test(r.css(d,"display"))?r.swap(d,Pb,function(){return C(d,h,k)}):C(d,h,k):e},set:function(e,f,k){var m=k&&d.getComputedStyle(e,null);return B(e,f,k?w(e,h,k,r.support.boxSizing&&"border-box"===r.css(e,"boxSizing",!1,m),m):0)}}});r(function(){r.support.reliableMarginRight||(r.cssHooks.marginRight={get:function(d,f){return f?r.swap(d,{display:"inline-block"},ta,[d,"marginRight"]):e}});!r.support.pixelPosition&&r.fn.position&&r.each(["top","left"],function(d,f){r.cssHooks[f]=
{get:function(d,h){return h?(h=ta(d,f),La.test(h)?r(d).position()[f]+"px":h):e}}})});r.expr&&r.expr.filters&&(r.expr.filters.hidden=function(d){return 0>=d.offsetWidth&&0>=d.offsetHeight},r.expr.filters.visible=function(d){return!r.expr.filters.hidden(d)});r.each({margin:"",padding:"",border:"Width"},function(d,e){r.cssHooks[d+e]={expand:function(f){var h=0,k={};for(f="string"==typeof f?f.split(" "):[f];4>h;h++)k[d+sa[h]+e]=f[h]||f[h-2]||f[0];return k}};gb.test(d)||(r.cssHooks[d+e].set=B)});var Qb=
/%20/g,vb=/\[\]$/,ib=/\r?\n/g,Rb=/^(?:submit|button|image|reset|file)$/i,Sb=/^(?:input|select|textarea|keygen)/i;r.fn.extend({serialize:function(){return r.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var d=r.prop(this,"elements");return d?r.makeArray(d):this}).filter(function(){var d=this.type;return this.name&&!r(this).is(":disabled")&&Sb.test(this.nodeName)&&!Rb.test(d)&&(this.checked||!eb.test(d))}).map(function(d,e){var f=r(this).val();return null==f?null:
r.isArray(f)?r.map(f,function(d){return{name:e.name,value:d.replace(ib,"\r\n")}}):{name:e.name,value:f.replace(ib,"\r\n")}}).get()}});r.param=function(d,f){var h,k=[],m=function(d,e){e=r.isFunction(e)?e():null==e?"":e;k[k.length]=encodeURIComponent(d)+"="+encodeURIComponent(e)};if(f===e&&(f=r.ajaxSettings&&r.ajaxSettings.traditional),r.isArray(d)||d.jquery&&!r.isPlainObject(d))r.each(d,function(){m(this.name,this.value)});else for(h in d)T(h,d[h],f,m);return k.join("&").replace(Qb,"+")};r.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),
function(d,e){r.fn[e]=function(d,f){return 0<arguments.length?this.on(e,null,d,f):this.trigger(e)}});r.fn.extend({hover:function(d,e){return this.mouseenter(d).mouseleave(e||d)},bind:function(d,e,f){return this.on(d,null,e,f)},unbind:function(d,e){return this.off(d,null,e)},delegate:function(d,e,f,h){return this.on(e,d,f,h)},undelegate:function(d,e,f){return 1===arguments.length?this.off(d,"**"):this.off(e,d||"**",f)}});var ra,ha,Ra=r.now(),Sa=/\?/,Tb=/#.*$/,jb=/([?&])_=[^&]*/,Ub=/^(.*?):[ \t]*([^\r\n]*)$/gm,
Vb=/^(?:GET|HEAD)$/,Wb=/^\/\//,kb=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,lb=r.fn.load,mb={},Ma={},nb="*/".concat("*");try{ha=pa.href}catch(ac){ha=J.createElement("a"),ha.href="",ha=ha.href}ra=kb.exec(ha.toLowerCase())||[];r.fn.load=function(d,f,h){if("string"!=typeof d&&lb)return lb.apply(this,arguments);var k,m,l,n=this,p=d.indexOf(" ");return 0<=p&&(k=d.slice(p),d=d.slice(0,p)),r.isFunction(f)?(h=f,f=e):f&&"object"==typeof f&&(m="POST"),0<n.length&&r.ajax({url:d,type:m,dataType:"html",data:f}).done(function(d){l=
arguments;n.html(k?r("<div>").append(r.parseHTML(d)).find(k):d)}).complete(h&&function(d,e){n.each(h,l||[d.responseText,e,d])}),this};r.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(d,e){r.fn[e]=function(d){return this.on(e,d)}});r.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ha,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(ra[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",
accepts:{"*":nb,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":r.parseJSON,"text xml":r.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(d,e){return e?L(L(d,r.ajaxSettings),e):L(r.ajaxSettings,d)},ajaxPrefilter:O(mb),ajaxTransport:O(Ma),ajax:function(d,
f){function h(d,f,n,q){var t,I,A,G,C=f;if(2!==E){E=2;p&&clearTimeout(p);k=e;l=q||"";B.readyState=0<d?4:0;q=200<=d&&300>d||304===d;if(n){A=u;for(var Y=B,F,ma,L,M,O=A.contents,U=A.dataTypes;"*"===U[0];)U.shift(),F===e&&(F=A.mimeType||Y.getResponseHeader("Content-Type"));if(F)for(ma in O)if(O[ma]&&O[ma].test(F)){U.unshift(ma);break}if(U[0]in n)L=U[0];else{for(ma in n){if(!U[0]||A.converters[ma+" "+U[0]]){L=ma;break}M||(M=ma)}L=L||M}A=L?(L!==U[0]&&U.unshift(L),n[L]):e}var T;a:{n=u;F=A;ma=B;L=q;var na,
H,J;A={};Y=n.dataTypes.slice();if(Y[1])for(na in n.converters)A[na.toLowerCase()]=n.converters[na];for(M=Y.shift();M;)if(n.responseFields[M]&&(ma[n.responseFields[M]]=F),!J&&L&&n.dataFilter&&(F=n.dataFilter(F,n.dataType)),J=M,M=Y.shift())if("*"===M)M=J;else if("*"!==J&&J!==M){if(na=A[J+" "+M]||A["* "+M],!na)for(T in A)if(H=T.split(" "),H[1]===M&&(na=A[J+" "+H[0]]||A["* "+H[0]])){!0===na?na=A[T]:!0!==A[T]&&(M=H[0],Y.unshift(H[1]));break}if(!0!==na)if(na&&n["throws"])F=na(F);else try{F=na(F)}catch(K){T=
{state:"parsererror",error:na?K:"No conversion from "+J+" to "+M};break a}}T={state:"success",data:F}}A=T;q?(u.ifModified&&(G=B.getResponseHeader("Last-Modified"),G&&(r.lastModified[m]=G),G=B.getResponseHeader("etag"),G&&(r.etag[m]=G)),204===d||"HEAD"===u.type?C="nocontent":304===d?C="notmodified":(C=A.state,t=A.data,I=A.error,q=!I)):(I=C,(d||!C)&&(C="error",0>d&&(d=0)));B.status=d;B.statusText=(f||C)+"";q?z.resolveWith(v,[t,C,B]):z.rejectWith(v,[B,C,I]);B.statusCode(y);y=e;s&&x.trigger(q?"ajaxSuccess":
"ajaxError",[B,u,q?t:I]);w.fireWith(v,[B,C]);s&&(x.trigger("ajaxComplete",[B,u]),--r.active||r.event.trigger("ajaxStop"))}}"object"==typeof d&&(f=d,d=e);f=f||{};var k,m,l,n,p,q,s,t,u=r.ajaxSetup({},f),v=u.context||u,x=u.context&&(v.nodeType||v.jquery)?r(v):r.event,z=r.Deferred(),w=r.Callbacks("once memory"),y=u.statusCode||{},A={},G={},E=0,C="canceled",B={readyState:0,getResponseHeader:function(d){var e;if(2===E){if(!n)for(n={};e=Ub.exec(l);)n[e[1].toLowerCase()]=e[2];e=n[d.toLowerCase()]}return null==
e?null:e},getAllResponseHeaders:function(){return 2===E?l:null},setRequestHeader:function(d,e){var f=d.toLowerCase();return E||(d=G[f]=G[f]||d,A[d]=e),this},overrideMimeType:function(d){return E||(u.mimeType=d),this},statusCode:function(d){var e;if(d)if(2>E)for(e in d)y[e]=[y[e],d[e]];else B.always(d[B.status]);return this},abort:function(d){d=d||C;return k&&k.abort(d),h(0,d),this}};if(z.promise(B).complete=w.add,B.success=B.done,B.error=B.fail,u.url=((d||u.url||ha)+"").replace(Tb,"").replace(Wb,
ra[1]+"//"),u.type=f.method||f.type||u.method||u.type,u.dataTypes=r.trim(u.dataType||"*").toLowerCase().match(oa)||[""],null==u.crossDomain&&(q=kb.exec(u.url.toLowerCase()),u.crossDomain=!(!q||q[1]===ra[1]&&q[2]===ra[2]&&(q[3]||("http:"===q[1]?"80":"443"))===(ra[3]||("http:"===ra[1]?"80":"443")))),u.data&&u.processData&&"string"!=typeof u.data&&(u.data=r.param(u.data,u.traditional)),M(mb,u,f,B),2===E)return B;(s=u.global)&&0===r.active++&&r.event.trigger("ajaxStart");u.type=u.type.toUpperCase();u.hasContent=
!Vb.test(u.type);m=u.url;u.hasContent||(u.data&&(m=u.url+=(Sa.test(m)?"&":"?")+u.data,delete u.data),!1===u.cache&&(u.url=jb.test(m)?m.replace(jb,"$1_="+Ra++):m+(Sa.test(m)?"&":"?")+"_="+Ra++));u.ifModified&&(r.lastModified[m]&&B.setRequestHeader("If-Modified-Since",r.lastModified[m]),r.etag[m]&&B.setRequestHeader("If-None-Match",r.etag[m]));(u.data&&u.hasContent&&!1!==u.contentType||f.contentType)&&B.setRequestHeader("Content-Type",u.contentType);B.setRequestHeader("Accept",u.dataTypes[0]&&u.accepts[u.dataTypes[0]]?
u.accepts[u.dataTypes[0]]+("*"!==u.dataTypes[0]?", "+nb+"; q=0.01":""):u.accepts["*"]);for(t in u.headers)B.setRequestHeader(t,u.headers[t]);if(u.beforeSend&&(!1===u.beforeSend.call(v,B,u)||2===E))return B.abort();C="abort";for(t in{success:1,error:1,complete:1})B[t](u[t]);if(k=M(Ma,u,f,B)){B.readyState=1;s&&x.trigger("ajaxSend",[B,u]);u.async&&0<u.timeout&&(p=setTimeout(function(){B.abort("timeout")},u.timeout));try{E=1,k.send(A,h)}catch(F){if(!(2>E))throw F;h(-1,F)}}else h(-1,"No Transport");return B},
getJSON:function(d,e,f){return r.get(d,e,f,"json")},getScript:function(d,f){return r.get(d,e,f,"script")}});r.each(["get","post"],function(d,f){r[f]=function(d,h,k,m){return r.isFunction(h)&&(m=m||k,k=h,h=e),r.ajax({url:d,type:f,dataType:m,data:h,success:k})}});r.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(d){return r.globalEval(d),d}}});r.ajaxPrefilter("script",
function(d){d.cache===e&&(d.cache=!1);d.crossDomain&&(d.type="GET")});r.ajaxTransport("script",function(d){if(d.crossDomain){var e,f;return{send:function(h,k){e=r("<script>").prop({async:!0,charset:d.scriptCharset,src:d.url}).on("load error",f=function(d){e.remove();f=null;d&&k("error"===d.type?404:200,d.type)});J.head.appendChild(e[0])},abort:function(){f&&f()}}}});var ob=[],Ta=/(=)\?(?=&|$)|\?\?/;r.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var d=ob.pop()||r.expando+"_"+Ra++;return this[d]=
!0,d}});r.ajaxPrefilter("json jsonp",function(f,h,k){var m,l,n,p=!1!==f.jsonp&&(Ta.test(f.url)?"url":"string"==typeof f.data&&!(f.contentType||"").indexOf("application/x-www-form-urlencoded")&&Ta.test(f.data)&&"data");return p||"jsonp"===f.dataTypes[0]?(m=f.jsonpCallback=r.isFunction(f.jsonpCallback)?f.jsonpCallback():f.jsonpCallback,p?f[p]=f[p].replace(Ta,"$1"+m):!1!==f.jsonp&&(f.url+=(Sa.test(f.url)?"&":"?")+f.jsonp+"="+m),f.converters["script json"]=function(){return n||r.error(m+" was not called"),
n[0]},f.dataTypes[0]="json",l=d[m],d[m]=function(){n=arguments},k.always(function(){d[m]=l;f[m]&&(f.jsonpCallback=h.jsonpCallback,ob.push(m));n&&r.isFunction(l)&&l(n[0]);n=l=e}),"script"):e});r.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(d){}};var Ea=r.ajaxSettings.xhr(),Xb={0:200,1223:204},Yb=0,Fa={};d.ActiveXObject&&r(d).on("unload",function(){for(var d in Fa)Fa[d]();Fa=e});r.support.cors=!!Ea&&"withCredentials"in Ea;r.support.ajax=Ea=!!Ea;r.ajaxTransport(function(d){var f;return r.support.cors||
Ea&&!d.crossDomain?{send:function(h,k){var m,l,n=d.xhr();if(n.open(d.type,d.url,d.async,d.username,d.password),d.xhrFields)for(m in d.xhrFields)n[m]=d.xhrFields[m];d.mimeType&&n.overrideMimeType&&n.overrideMimeType(d.mimeType);d.crossDomain||h["X-Requested-With"]||(h["X-Requested-With"]="XMLHttpRequest");for(m in h)n.setRequestHeader(m,h[m]);f=function(d){return function(){f&&(delete Fa[l],f=n.onload=n.onerror=null,"abort"===d?n.abort():"error"===d?k(n.status||404,n.statusText):k(Xb[n.status]||n.status,
n.statusText,"string"==typeof n.responseText?{text:n.responseText}:e,n.getAllResponseHeaders()))}};n.onload=f();n.onerror=f("error");f=Fa[l=Yb++]=f("abort");n.send(d.hasContent&&d.data||null)},abort:function(){f&&f()}}:e});var va,Ka,Zb=/^(?:toggle|show|hide)$/,pb=RegExp("^(?:([+-])=|)("+xa+")([a-z%]*)$","i"),$b=/queueHooks$/,Ia=[function(d,f,h){var k,m,l,n,p,q=this,s={},t=d.style,u=d.nodeType&&G(d),v=H.get(d,"fxshow");h.queue||(n=r._queueHooks(d,"fx"),null==n.unqueued&&(n.unqueued=0,p=n.empty.fire,
n.empty.fire=function(){n.unqueued||p()}),n.unqueued++,q.always(function(){q.always(function(){n.unqueued--;r.queue(d,"fx").length||n.empty.fire()})}));1===d.nodeType&&("height"in f||"width"in f)&&(h.overflow=[t.overflow,t.overflowX,t.overflowY],"inline"===r.css(d,"display")&&"none"===r.css(d,"float")&&(t.display="inline-block"));h.overflow&&(t.overflow="hidden",q.always(function(){t.overflow=h.overflow[0];t.overflowX=h.overflow[1];t.overflowY=h.overflow[2]}));for(k in f)if(m=f[k],Zb.exec(m)){if(delete f[k],
l=l||"toggle"===m,m===(u?"hide":"show")){if("show"!==m||!v||v[k]===e)continue;u=!0}s[k]=v&&v[k]||r.style(d,k)}if(!r.isEmptyObject(s))for(k in v?"hidden"in v&&(u=v.hidden):v=H.access(d,"fxshow",{}),l&&(v.hidden=!u),u?r(d).show():q.done(function(){r(d).hide()}),q.done(function(){var e;H.remove(d,"fxshow");for(e in s)r.style(d,e,s[e])}),s)f=da(u?v[k]:0,k,q),k in v||(v[k]=f.start,u&&(f.end=f.start,f.start="width"===k||"height"===k?1:0))}],qa={"*":[function(d,e){var f=this.createTween(d,e),h=f.cur(),k=
pb.exec(e),m=k&&k[3]||(r.cssNumber[d]?"":"px"),l=(r.cssNumber[d]||"px"!==m&&+h)&&pb.exec(r.css(f.elem,d)),n=1,p=20;if(l&&l[3]!==m){m=m||l[3];k=k||[];l=+h||1;do n=n||".5",l/=n,r.style(f.elem,d,l+m);while(n!==(n=f.cur()/h)&&1!==n&&--p)}return k&&(l=f.start=+l||+h||0,f.unit=m,f.end=k[1]?l+(k[1]+1)*k[2]:+k[2]),f}]};r.Animation=r.extend(ja,{tweener:function(d,e){r.isFunction(d)?(e=d,d=["*"]):d=d.split(" ");for(var f,h=0,k=d.length;k>h;h++)f=d[h],qa[f]=qa[f]||[],qa[f].unshift(e)},prefilter:function(d,e){e?
Ia.unshift(d):Ia.push(d)}});r.Tween=W;W.prototype={constructor:W,init:function(d,e,f,h,k,m){this.elem=d;this.prop=f;this.easing=k||"swing";this.options=e;this.start=this.now=this.cur();this.end=h;this.unit=m||(r.cssNumber[f]?"":"px")},cur:function(){var d=W.propHooks[this.prop];return d&&d.get?d.get(this):W.propHooks._default.get(this)},run:function(d){var e,f=W.propHooks[this.prop];return this.pos=e=this.options.duration?r.easing[this.easing](d,this.options.duration*d,0,1,this.options.duration):
d,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),f&&f.set?f.set(this):W.propHooks._default.set(this),this}};W.prototype.init.prototype=W.prototype;W.propHooks={_default:{get:function(d){var e;return null==d.elem[d.prop]||d.elem.style&&null!=d.elem.style[d.prop]?(e=r.css(d.elem,d.prop,""),e&&"auto"!==e?e:0):d.elem[d.prop]},set:function(d){r.fx.step[d.prop]?r.fx.step[d.prop](d):d.elem.style&&(null!=d.elem.style[r.cssProps[d.prop]]||r.cssHooks[d.prop])?
r.style(d.elem,d.prop,d.now+d.unit):d.elem[d.prop]=d.now}}};W.propHooks.scrollTop=W.propHooks.scrollLeft={set:function(d){d.elem.nodeType&&d.elem.parentNode&&(d.elem[d.prop]=d.now)}};r.each(["toggle","show","hide"],function(d,e){var f=r.fn[e];r.fn[e]=function(d,h,k){return null==d||"boolean"==typeof d?f.apply(this,arguments):this.animate(ga(e,!0),d,h,k)}});r.fn.extend({fadeTo:function(d,e,f,h){return this.filter(G).css("opacity",0).show().end().animate({opacity:e},d,f,h)},animate:function(d,e,f,h){var k=
r.isEmptyObject(d),m=r.speed(e,f,h);e=function(){var e=ja(this,r.extend({},d),m);(k||H.get(this,"finish"))&&e.stop(!0)};return e.finish=e,k||!1===m.queue?this.each(e):this.queue(m.queue,e)},stop:function(d,f,h){var k=function(d){var e=d.stop;delete d.stop;e(h)};return"string"!=typeof d&&(h=f,f=d,d=e),f&&!1!==d&&this.queue(d||"fx",[]),this.each(function(){var e=!0,f=null!=d&&d+"queueHooks",m=r.timers,l=H.get(this);if(f)l[f]&&l[f].stop&&k(l[f]);else for(f in l)l[f]&&l[f].stop&&$b.test(f)&&k(l[f]);for(f=
m.length;f--;)m[f].elem!==this||null!=d&&m[f].queue!==d||(m[f].anim.stop(h),e=!1,m.splice(f,1));(e||!h)&&r.dequeue(this,d)})},finish:function(d){return!1!==d&&(d=d||"fx"),this.each(function(){var e,f=H.get(this),h=f[d+"queue"];e=f[d+"queueHooks"];var k=r.timers,m=h?h.length:0;f.finish=!0;r.queue(this,d,[]);e&&e.stop&&e.stop.call(this,!0);for(e=k.length;e--;)k[e].elem===this&&k[e].queue===d&&(k[e].anim.stop(!0),k.splice(e,1));for(e=0;m>e;e++)h[e]&&h[e].finish&&h[e].finish.call(this);delete f.finish})}});
r.each({slideDown:ga("show"),slideUp:ga("hide"),slideToggle:ga("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(d,e){r.fn[d]=function(d,f,h){return this.animate(e,d,f,h)}});r.speed=function(d,e,f){var h=d&&"object"==typeof d?r.extend({},d):{complete:f||!f&&e||r.isFunction(d)&&d,duration:d,easing:f&&e||e&&!r.isFunction(e)&&e};return h.duration=r.fx.off?0:"number"==typeof h.duration?h.duration:h.duration in r.fx.speeds?r.fx.speeds[h.duration]:r.fx.speeds._default,
(null==h.queue||!0===h.queue)&&(h.queue="fx"),h.old=h.complete,h.complete=function(){r.isFunction(h.old)&&h.old.call(this);h.queue&&r.dequeue(this,h.queue)},h};r.easing={linear:function(d){return d},swing:function(d){return 0.5-Math.cos(d*Math.PI)/2}};r.timers=[];r.fx=W.prototype.init;r.fx.tick=function(){var d,f=r.timers,h=0;for(va=r.now();f.length>h;h++)d=f[h],d()||f[h]!==d||f.splice(h--,1);f.length||r.fx.stop();va=e};r.fx.timer=function(d){d()&&r.timers.push(d)&&r.fx.start()};r.fx.interval=13;
r.fx.start=function(){Ka||(Ka=setInterval(r.fx.tick,r.fx.interval))};r.fx.stop=function(){clearInterval(Ka);Ka=null};r.fx.speeds={slow:600,fast:200,_default:400};r.fx.step={};r.expr&&r.expr.filters&&(r.expr.filters.animated=function(d){return r.grep(r.timers,function(e){return d===e.elem}).length});r.fn.offset=function(d){if(arguments.length)return d===e?this:this.each(function(e){r.offset.setOffset(this,d,e)});var f,h,k=this[0],m={top:0,left:0},l=k&&k.ownerDocument;if(l)return f=l.documentElement,
r.contains(f,k)?(typeof k.getBoundingClientRect!==Q&&(m=k.getBoundingClientRect()),h=r.isWindow(l)?l:9===l.nodeType&&l.defaultView,{top:m.top+h.pageYOffset-f.clientTop,left:m.left+h.pageXOffset-f.clientLeft}):m};r.offset={setOffset:function(d,e,f){var h,k,m,l,n,p,q=r.css(d,"position"),s=r(d),t={};"static"===q&&(d.style.position="relative");n=s.offset();m=r.css(d,"top");p=r.css(d,"left");("absolute"===q||"fixed"===q)&&-1<(m+p).indexOf("auto")?(h=s.position(),l=h.top,k=h.left):(l=parseFloat(m)||0,k=
parseFloat(p)||0);r.isFunction(e)&&(e=e.call(d,f,n));null!=e.top&&(t.top=e.top-n.top+l);null!=e.left&&(t.left=e.left-n.left+k);"using"in e?e.using.call(d,t):s.css(t)}};r.fn.extend({position:function(){if(this[0]){var d,e,f=this[0],h={top:0,left:0};return"fixed"===r.css(f,"position")?e=f.getBoundingClientRect():(d=this.offsetParent(),e=this.offset(),r.nodeName(d[0],"html")||(h=d.offset()),h.top+=r.css(d[0],"borderTopWidth",!0),h.left+=r.css(d[0],"borderLeftWidth",!0)),{top:e.top-h.top-r.css(f,"marginTop",
!0),left:e.left-h.left-r.css(f,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var d=this.offsetParent||ia;d&&!r.nodeName(d,"html")&&"static"===r.css(d,"position");)d=d.offsetParent;return d||ia})}});r.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(f,h){var k="pageYOffset"===h;r.fn[f]=function(m){return r.access(this,function(f,m,l){var n=r.isWindow(f)?f:9===f.nodeType&&f.defaultView;return l===e?n?n[h]:f[m]:(n?n.scrollTo(k?d.pageXOffset:l,k?l:d.pageYOffset):
f[m]=l,e)},f,m,arguments.length,null)}});r.each({Height:"height",Width:"width"},function(d,f){r.each({padding:"inner"+d,content:f,"":"outer"+d},function(h,k){r.fn[k]=function(k,m){var l=arguments.length&&(h||"boolean"!=typeof k),n=h||(!0===k||!0===m?"margin":"border");return r.access(this,function(f,h,k){var m;return r.isWindow(f)?f.document.documentElement["client"+d]:9===f.nodeType?(m=f.documentElement,Math.max(f.body["scroll"+d],m["scroll"+d],f.body["offset"+d],m["offset"+d],m["client"+d])):k===
e?r.css(f,h,n):r.style(f,h,k,n)},f,l?k:e,l,null)}})});r.fn.size=function(){return this.length};r.fn.andSelf=r.fn.addBack;"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=r:"function"==typeof define&&define.amd&&define("jquery",[],function(){return r});"object"==typeof d&&"object"==typeof d.document&&(d.jQuery=d.$=r)})(window);(function(d,e){function f(e,f){var k,l,s,t=e.nodeName.toLowerCase();return"area"===t?(k=e.parentNode,l=k.name,e.href&&l&&"map"===k.nodeName.toLowerCase()?(s=d("img[usemap=#"+l+"]")[0],!!s&&h(s)):!1):(/input|select|textarea|button|object/.test(t)?!e.disabled:"a"===t?e.href||f:f)&&h(e)}function h(e){return d.expr.filters.visible(e)&&!d(e).parents().addBack().filter(function(){return"hidden"===d.css(this,"visibility")}).length}var k=0,l=/^ui-id-\d+$/;d.ui=d.ui||{};d.extend(d.ui,{version:"1.10.3",keyCode:{BACKSPACE:8,
COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}});d.fn.extend({focus:function(e){return function(f,h){return"number"==typeof f?this.each(function(){var e=this;setTimeout(function(){d(e).focus();h&&h.call(e)},f)}):e.apply(this,arguments)}}(d.fn.focus),scrollParent:function(){var e;return e=d.ui.ie&&/(static|relative)/.test(this.css("position"))||
/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(d.css(this,"position"))&&/(auto|scroll)/.test(d.css(this,"overflow")+d.css(this,"overflow-y")+d.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(d.css(this,"overflow")+d.css(this,"overflow-y")+d.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!e.length?d(document):e},zIndex:function(f){if(f!==e)return this.css("zIndex",f);if(this.length){var h,
k;for(f=d(this[0]);f.length&&f[0]!==document;){if(h=f.css("position"),("absolute"===h||"relative"===h||"fixed"===h)&&(k=parseInt(f.css("zIndex"),10),!isNaN(k)&&0!==k))return k;f=f.parent()}}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++k)})},removeUniqueId:function(){return this.each(function(){l.test(this.id)&&d(this).removeAttr("id")})}});d.extend(d.expr[":"],{data:d.expr.createPseudo?d.expr.createPseudo(function(e){return function(f){return!!d.data(f,e)}}):
function(e,f,h){return!!d.data(e,h[3])},focusable:function(e){return f(e,!isNaN(d.attr(e,"tabindex")))},tabbable:function(e){var h=d.attr(e,"tabindex"),k=isNaN(h);return(k||0<=h)&&f(e,!k)}});d("<a>").outerWidth(1).jquery||d.each(["Width","Height"],function(f,h){function k(e,f,h,m){return d.each(l,function(){f-=parseFloat(d.css(e,"padding"+this))||0;h&&(f-=parseFloat(d.css(e,"border"+this+"Width"))||0);m&&(f-=parseFloat(d.css(e,"margin"+this))||0)}),f}var l="Width"===h?["Left","Right"]:["Top","Bottom"],
s=h.toLowerCase(),t={innerWidth:d.fn.innerWidth,innerHeight:d.fn.innerHeight,outerWidth:d.fn.outerWidth,outerHeight:d.fn.outerHeight};d.fn["inner"+h]=function(f){return f===e?t["inner"+h].call(this):this.each(function(){d(this).css(s,k(this,f)+"px")})};d.fn["outer"+h]=function(e,f){return"number"!=typeof e?t["outer"+h].call(this,e):this.each(function(){d(this).css(s,k(this,e,!0,f)+"px")})}});d.fn.addBack||(d.fn.addBack=function(d){return this.add(null==d?this.prevObject:this.prevObject.filter(d))});
d("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(d.fn.removeData=function(e){return function(f){return arguments.length?e.call(this,d.camelCase(f)):e.call(this)}}(d.fn.removeData));d.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase());d.support.selectstart="onselectstart"in document.createElement("div");d.fn.extend({disableSelection:function(){return this.bind((d.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(d){d.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}});
d.extend(d.ui,{plugin:{add:function(e,f,h){var k;e=d.ui[e].prototype;for(k in h)e.plugins[k]=e.plugins[k]||[],e.plugins[k].push([f,h[k]])},call:function(d,e,f){var h=d.plugins[e];if(h&&d.element[0].parentNode&&11!==d.element[0].parentNode.nodeType)for(e=0;h.length>e;e++)d.options[h[e][0]]&&h[e][1].apply(d.element,f)}},hasScroll:function(e,f){if("hidden"===d(e).css("overflow"))return!1;var h=f&&"left"===f?"scrollLeft":"scrollTop";return 0<e[h]?!0:(e[h]=1,e[h]=0,!1)}})})(jQuery);
(function(d,e){var f=0,h=Array.prototype.slice,k=d.cleanData;d.cleanData=function(e){for(var f,h=0;null!=(f=e[h]);h++)try{d(f).triggerHandler("remove")}catch(p){}k(e)};d.widget=function(f,h,k){var p,q,s,t,u={},v=f.split(".")[0];f=f.split(".")[1];p=v+"-"+f;k||(k=h,h=d.Widget);d.expr[":"][p.toLowerCase()]=function(e){return!!d.data(e,p)};d[v]=d[v]||{};q=d[v][f];s=d[v][f]=function(d,f){return this._createWidget?(arguments.length&&this._createWidget(d,f),e):new s(d,f)};d.extend(s,q,{version:k.version,
_proto:d.extend({},k),_childConstructors:[]});t=new h;t.options=d.widget.extend({},t.options);d.each(k,function(f,k){return d.isFunction(k)?(u[f]=function(){var d=function(){return h.prototype[f].apply(this,arguments)},e=function(d){return h.prototype[f].apply(this,d)};return function(){var f,h=this._super,m=this._superApply;return this._super=d,this._superApply=e,f=k.apply(this,arguments),this._super=h,this._superApply=m,f}}(),e):(u[f]=k,e)});s.prototype=d.widget.extend(t,{widgetEventPrefix:q?t.widgetEventPrefix:
f},u,{constructor:s,namespace:v,widgetName:f,widgetFullName:p});q?(d.each(q._childConstructors,function(e,f){var h=f.prototype;d.widget(h.namespace+"."+h.widgetName,s,f._proto)}),delete q._childConstructors):h._childConstructors.push(s);d.widget.bridge(f,s)};d.widget.extend=function(f){for(var k,n,p=h.call(arguments,1),q=0,s=p.length;s>q;q++)for(k in p[q])n=p[q][k],p[q].hasOwnProperty(k)&&n!==e&&(f[k]=d.isPlainObject(n)?d.isPlainObject(f[k])?d.widget.extend({},f[k],n):d.widget.extend({},n):n);return f};
d.widget.bridge=function(f,k){var n=k.prototype.widgetFullName||f;d.fn[f]=function(p){var q="string"==typeof p,s=h.call(arguments,1),t=this;return p=!q&&s.length?d.widget.extend.apply(null,[p].concat(s)):p,q?this.each(function(){var h,k=d.data(this,n);return k?d.isFunction(k[p])&&"_"!==p.charAt(0)?(h=k[p].apply(k,s),h!==k&&h!==e?(t=h&&h.jquery?t.pushStack(h.get()):h,!1):e):d.error("no such method '"+p+"' for "+f+" widget instance"):d.error("cannot call methods on "+f+" prior to initialization; attempted to call method '"+
p+"'")}):this.each(function(){var e=d.data(this,n);e?e.option(p||{})._init():d.data(this,n,new k(p,this))}),t}};d.Widget=function(){};d.Widget._childConstructors=[];d.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(e,h){h=d(h||this.defaultElement||this)[0];this.element=d(h);this.uuid=f++;this.eventNamespace="."+this.widgetName+this.uuid;this.options=d.widget.extend({},this.options,this._getCreateOptions(),e);
this.bindings=d();this.hoverable=d();this.focusable=d();h!==this&&(d.data(h,this.widgetFullName,this),this._on(!0,this.element,{remove:function(d){d.target===h&&this.destroy()}}),this.document=d(h.style?h.ownerDocument:h.document||h),this.window=d(this.document[0].defaultView||this.document[0].parentWindow));this._create();this._trigger("create",null,this._getCreateEventData());this._init()},_getCreateOptions:d.noop,_getCreateEventData:d.noop,_create:d.noop,_init:d.noop,destroy:function(){this._destroy();
this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(d.camelCase(this.widgetFullName));this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled");this.bindings.unbind(this.eventNamespace);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus")},_destroy:d.noop,widget:function(){return this.element},option:function(f,h){var k,p,q,s=f;
if(0===arguments.length)return d.widget.extend({},this.options);if("string"==typeof f)if(s={},k=f.split("."),f=k.shift(),k.length){p=s[f]=d.widget.extend({},this.options[f]);for(q=0;k.length-1>q;q++)p[k[q]]=p[k[q]]||{},p=p[k[q]];if(f=k.pop(),h===e)return p[f]===e?null:p[f];p[f]=h}else{if(h===e)return this.options[f]===e?null:this.options[f];s[f]=h}return this._setOptions(s),this},_setOptions:function(d){for(var e in d)this._setOption(e,d[e]);return this},_setOption:function(d,e){return this.options[d]=
e,"disabled"===d&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!e).attr("aria-disabled",e),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(f,h,k){var p,q=this;"boolean"!=typeof f&&(k=h,h=f,f=!1);k?(h=p=d(h),this.bindings=this.bindings.add(h)):(k=h,h=this.element,p=this.widget());d.each(k,function(k,
n){function u(){return f||!0!==q.options.disabled&&!d(this).hasClass("ui-state-disabled")?("string"==typeof n?q[n]:n).apply(q,arguments):e}"string"!=typeof n&&(u.guid=n.guid=n.guid||u.guid||d.guid++);var v=k.match(/^(\w+)\s*(.*)$/),x=v[1]+q.eventNamespace;(v=v[2])?p.delegate(v,x,u):h.bind(x,u)})},_off:function(d,e){e=(e||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace;d.unbind(e).undelegate(e)},_delay:function(d,e){var f=this;return setTimeout(function(){return("string"==typeof d?
f[d]:d).apply(f,arguments)},e||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e);this._on(e,{mouseenter:function(e){d(e.currentTarget).addClass("ui-state-hover")},mouseleave:function(e){d(e.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e);this._on(e,{focusin:function(e){d(e.currentTarget).addClass("ui-state-focus")},focusout:function(e){d(e.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(e,f,h){var k,q=this.options[e];
if(h=h||{},f=d.Event(f),f.type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase(),f.target=this.element[0],e=f.originalEvent)for(k in e)k in f||(f[k]=e[k]);return this.element.trigger(f,h),!(d.isFunction(q)&&!1===q.apply(this.element[0],[f].concat(h))||f.isDefaultPrevented())}};d.each({show:"fadeIn",hide:"fadeOut"},function(e,f){d.Widget.prototype["_"+e]=function(h,k,q){"string"==typeof k&&(k={effect:k});var s,t=k?!0===k||"number"==typeof k?f:k.effect||f:e;k=k||{};"number"==typeof k&&
(k={duration:k});s=!d.isEmptyObject(k);k.complete=q;k.delay&&h.delay(k.delay);s&&d.effects&&d.effects.effect[t]?h[e](k):t!==e&&h[t]?h[t](k.duration,k.easing,q):h.queue(function(f){d(this)[e]();q&&q.call(h[0]);f()})}})})(jQuery);
(function(d){var e=!1;d(document).mouseup(function(){e=!1});d.widget("ui.mouse",{version:"1.10.3",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var e=this;this.element.bind("mousedown."+this.widgetName,function(d){return e._mouseDown(d)}).bind("click."+this.widgetName,function(h){return!0===d.data(h.target,e.widgetName+".preventClickEvent")?(d.removeData(h.target,e.widgetName+".preventClickEvent"),h.stopImmediatePropagation(),!1):void 0});this.started=
!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName);this._mouseMoveDelegate&&d(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(f){if(!e){this._mouseStarted&&this._mouseUp(f);this._mouseDownEvent=f;var h=this,k=1===f.which,l="string"==typeof this.options.cancel&&f.target.nodeName?d(f.target).closest(this.options.cancel).length:!1;return k&&!l&&this._mouseCapture(f)?(this.mouseDelayMet=
!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){h.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(f)&&this._mouseDelayMet(f)&&(this._mouseStarted=!1!==this._mouseStart(f),!this._mouseStarted)?(f.preventDefault(),!0):(!0===d.data(f.target,this.widgetName+".preventClickEvent")&&d.removeData(f.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(d){return h._mouseMove(d)},this._mouseUpDelegate=function(d){return h._mouseUp(d)},
d(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),f.preventDefault(),e=!0,!0)):!0}},_mouseMove:function(e){return d.ui.ie&&(!document.documentMode||9>document.documentMode)&&!e.button?this._mouseUp(e):this._mouseStarted?(this._mouseDrag(e),e.preventDefault()):(this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,e),this._mouseStarted?this._mouseDrag(e):this._mouseUp(e)),
!this._mouseStarted)},_mouseUp:function(e){return d(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,e.target===this._mouseDownEvent.target&&d.data(e.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(e)),!1},_mouseDistanceMet:function(d){return Math.max(Math.abs(this._mouseDownEvent.pageX-d.pageX),Math.abs(this._mouseDownEvent.pageY-d.pageY))>=this.options.distance},
_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})})(jQuery);
(function(d,e){function f(d,e,f){return[parseFloat(d[0])*(u.test(d[0])?e/100:1),parseFloat(d[1])*(u.test(d[1])?f/100:1)]}function h(e){var f=e[0];return 9===f.nodeType?{width:e.width(),height:e.height(),offset:{top:0,left:0}}:d.isWindow(f)?{width:e.width(),height:e.height(),offset:{top:e.scrollTop(),left:e.scrollLeft()}}:f.preventDefault?{width:0,height:0,offset:{top:f.pageY,left:f.pageX}}:{width:e.outerWidth(),height:e.outerHeight(),offset:e.offset()}}d.ui=d.ui||{};var k,l=Math.max,m=Math.abs,n=
Math.round,p=/left|center|right/,q=/top|center|bottom/,s=/[\+\-]\d+(\.[\d]+)?%?/,t=/^\w+/,u=/%$/,v=d.fn.position;d.position={scrollbarWidth:function(){if(k!==e)return k;var f,h,m=d("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),l=m.children()[0];return d("body").append(m),f=l.offsetWidth,m.css("overflow","scroll"),h=l.offsetWidth,f===h&&(h=m[0].clientWidth),m.remove(),k=f-h},getScrollInfo:function(e){var f=e.isWindow?"":e.element.css("overflow-x"),
h=e.isWindow?"":e.element.css("overflow-y"),f="scroll"===f||"auto"===f&&e.width<e.element[0].scrollWidth;return{width:"scroll"===h||"auto"===h&&e.height<e.element[0].scrollHeight?d.position.scrollbarWidth():0,height:f?d.position.scrollbarWidth():0}},getWithinInfo:function(e){e=d(e||window);var f=d.isWindow(e[0]);return{element:e,isWindow:f,offset:e.offset()||{left:0,top:0},scrollLeft:e.scrollLeft(),scrollTop:e.scrollTop(),width:f?e.width():e.outerWidth(),height:f?e.height():e.outerHeight()}}};d.fn.position=
function(e){if(!e||!e.of)return v.apply(this,arguments);e=d.extend({},e);var k,u,A,G,E,B,w=d(e.of),C=d.position.getWithinInfo(e.within),U=d.position.getScrollInfo(C),F=(e.collision||"flip").split(" "),T={};return B=h(w),w[0].preventDefault&&(e.at="left top"),u=B.width,A=B.height,G=B.offset,E=d.extend({},G),d.each(["my","at"],function(){var d,f,h=(e[this]||"").split(" ");1===h.length&&(h=p.test(h[0])?h.concat(["center"]):q.test(h[0])?["center"].concat(h):["center","center"]);h[0]=p.test(h[0])?h[0]:
"center";h[1]=q.test(h[1])?h[1]:"center";d=s.exec(h[0]);f=s.exec(h[1]);T[this]=[d?d[0]:0,f?f[0]:0];e[this]=[t.exec(h[0])[0],t.exec(h[1])[0]]}),1===F.length&&(F[1]=F[0]),"right"===e.at[0]?E.left+=u:"center"===e.at[0]&&(E.left+=u/2),"bottom"===e.at[1]?E.top+=A:"center"===e.at[1]&&(E.top+=A/2),k=f(T.at,u,A),E.left+=k[0],E.top+=k[1],this.each(function(){var h,p,q=d(this),s=q.outerWidth(),t=q.outerHeight(),v=parseInt(d.css(this,"marginLeft"),10)||0,B=parseInt(d.css(this,"marginTop"),10)||0,W=s+v+(parseInt(d.css(this,
"marginRight"),10)||0)+U.width,ga=t+B+(parseInt(d.css(this,"marginBottom"),10)||0)+U.height,K=d.extend({},E),Z=f(T.my,q.outerWidth(),q.outerHeight());"right"===e.my[0]?K.left-=s:"center"===e.my[0]&&(K.left-=s/2);"bottom"===e.my[1]?K.top-=t:"center"===e.my[1]&&(K.top-=t/2);K.left+=Z[0];K.top+=Z[1];d.support.offsetFractions||(K.left=n(K.left),K.top=n(K.top));h={marginLeft:v,marginTop:B};d.each(["left","top"],function(f,m){d.ui.position[F[f]]&&d.ui.position[F[f]][m](K,{targetWidth:u,targetHeight:A,elemWidth:s,
elemHeight:t,collisionPosition:h,collisionWidth:W,collisionHeight:ga,offset:[k[0]+Z[0],k[1]+Z[1]],my:e.my,at:e.at,within:C,elem:q})});e.using&&(p=function(d){var f=G.left-K.left,h=f+u-s,k=G.top-K.top,n=k+A-t,p={target:{element:w,left:G.left,top:G.top,width:u,height:A},element:{element:q,left:K.left,top:K.top,width:s,height:t},horizontal:0>h?"left":0<f?"right":"center",vertical:0>n?"top":0<k?"bottom":"middle"};s>u&&u>m(f+h)&&(p.horizontal="center");t>A&&A>m(k+n)&&(p.vertical="middle");p.important=
l(m(f),m(h))>l(m(k),m(n))?"horizontal":"vertical";e.using.call(this,d,p)});q.offset(d.extend(K,{using:p}))})};d.ui.position={fit:{left:function(d,e){var f,h=e.within,k=h.isWindow?h.scrollLeft:h.offset.left,h=h.width,m=d.left-e.collisionPosition.marginLeft,n=k-m,p=m+e.collisionWidth-h-k;e.collisionWidth>h?0<n&&0>=p?(f=d.left+n+e.collisionWidth-h-k,d.left+=n-f):d.left=0<p&&0>=n?k:n>p?k+h-e.collisionWidth:k:0<n?d.left+=n:0<p?d.left-=p:d.left=l(d.left-m,d.left)},top:function(d,e){var f,h=e.within,h=h.isWindow?
h.scrollTop:h.offset.top,k=e.within.height,m=d.top-e.collisionPosition.marginTop,n=h-m,p=m+e.collisionHeight-k-h;e.collisionHeight>k?0<n&&0>=p?(f=d.top+n+e.collisionHeight-k-h,d.top+=n-f):d.top=0<p&&0>=n?h:n>p?h+k-e.collisionHeight:h:0<n?d.top+=n:0<p?d.top-=p:d.top=l(d.top-m,d.top)}},flip:{left:function(d,e){var f,h,k=e.within,l=k.offset.left+k.scrollLeft,n=k.width,k=k.isWindow?k.scrollLeft:k.offset.left,p=d.left-e.collisionPosition.marginLeft,q=p-k,p=p+e.collisionWidth-n-k,s="left"===e.my[0]?-e.elemWidth:
"right"===e.my[0]?e.elemWidth:0,t="left"===e.at[0]?e.targetWidth:"right"===e.at[0]?-e.targetWidth:0,u=-2*e.offset[0];0>q?(f=d.left+s+t+u+e.collisionWidth-n-l,(0>f||m(q)>f)&&(d.left+=s+t+u)):0<p&&(h=d.left-e.collisionPosition.marginLeft+s+t+u-k,(0<h||p>m(h))&&(d.left+=s+t+u))},top:function(d,e){var f,h,k=e.within,l=k.offset.top+k.scrollTop,n=k.height,k=k.isWindow?k.scrollTop:k.offset.top,p=d.top-e.collisionPosition.marginTop,q=p-k,p=p+e.collisionHeight-n-k,s="top"===e.my[1]?-e.elemHeight:"bottom"===
e.my[1]?e.elemHeight:0,t="top"===e.at[1]?e.targetHeight:"bottom"===e.at[1]?-e.targetHeight:0,u=-2*e.offset[1];0>q?(h=d.top+s+t+u+e.collisionHeight-n-l,d.top+s+t+u>q&&(0>h||m(q)>h)&&(d.top+=s+t+u)):0<p&&(f=d.top-e.collisionPosition.marginTop+s+t+u-k,d.top+s+t+u>p&&(0<f||p>m(f))&&(d.top+=s+t+u))}},flipfit:{left:function(){d.ui.position.flip.left.apply(this,arguments);d.ui.position.fit.left.apply(this,arguments)},top:function(){d.ui.position.flip.top.apply(this,arguments);d.ui.position.fit.top.apply(this,
arguments)}}};(function(){var e,f,h,k,m=document.getElementsByTagName("body")[0];h=document.createElement("div");e=document.createElement(m?"div":"body");f={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"};m&&d.extend(f,{position:"absolute",left:"-1000px",top:"-1000px"});for(k in f)e.style[k]=f[k];e.appendChild(h);f=m||document.documentElement;f.insertBefore(e,f.firstChild);h.style.cssText="position: absolute; left: 10.7432222px;";h=d(h).offset().left;d.support.offsetFractions=
10<h&&11>h;e.innerHTML="";f.removeChild(e)})()})(jQuery);
(function(d){d.widget("ui.draggable",d.ui.mouse,{version:"1.10.3",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"!==this.options.helper||
/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative");this.options.addClasses&&this.element.addClass("ui-draggable");this.options.disabled&&this.element.addClass("ui-draggable-disabled");this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled");this._mouseDestroy()},_mouseCapture:function(e){var f=this.options;return this.helper||f.disabled||0<d(e.target).closest(".ui-resizable-handle").length?
!1:(this.handle=this._getHandle(e),this.handle?(d(!0===f.iframeFix?"iframe":f.iframeFix).each(function(){d("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1E3}).css(d(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(e){var f=this.options;return this.helper=this._createHelper(e),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),
d.ui.ddmanager&&(d.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offsetParent=this.helper.offsetParent(),this.offsetParentCssPosition=this.offsetParent.css("position"),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},this.offset.scroll=!1,d.extend(this.offset,{click:{left:e.pageX-this.offset.left,top:e.pageY-this.offset.top},
parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(e),this.originalPageX=e.pageX,this.originalPageY=e.pageY,f.cursorAt&&this._adjustOffsetFromHelper(f.cursorAt),this._setContainment(),!1===this._trigger("start",e)?(this._clear(),!1):(this._cacheHelperProportions(),d.ui.ddmanager&&!f.dropBehaviour&&d.ui.ddmanager.prepareOffsets(this,e),this._mouseDrag(e,!0),d.ui.ddmanager&&d.ui.ddmanager.dragStart(this,e),!0)},_mouseDrag:function(e,
f){if("fixed"===this.offsetParentCssPosition&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(e),this.positionAbs=this._convertPositionTo("absolute"),!f){var h=this._uiHash();if(!1===this._trigger("drag",e,h))return this._mouseUp({}),!1;this.position=h.position}return this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),d.ui.ddmanager&&
d.ui.ddmanager.drag(this,e),!1},_mouseStop:function(e){var f=this,h=!1;return d.ui.ddmanager&&!this.options.dropBehaviour&&(h=d.ui.ddmanager.drop(this,e)),this.dropped&&(h=this.dropped,this.dropped=!1),"original"!==this.options.helper||d.contains(this.element[0].ownerDocument,this.element[0])?("invalid"===this.options.revert&&!h||"valid"===this.options.revert&&h||!0===this.options.revert||d.isFunction(this.options.revert)&&this.options.revert.call(this.element,h)?d(this.helper).animate(this.originalPosition,
parseInt(this.options.revertDuration,10),function(){!1!==f._trigger("stop",e)&&f._clear()}):!1!==this._trigger("stop",e)&&this._clear(),!1):!1},_mouseUp:function(e){return d("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),d.ui.ddmanager&&d.ui.ddmanager.dragStop(this,e),d.ui.mouse.prototype._mouseUp.call(this,e)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(e){return this.options.handle?
!!d(e.target).closest(this.element.find(this.options.handle)).length:!0},_createHelper:function(e){var f=this.options;e=d.isFunction(f.helper)?d(f.helper.apply(this.element[0],[e])):"clone"===f.helper?this.element.clone().removeAttr("id"):this.element;return e.parents("body").length||e.appendTo("parent"===f.appendTo?this.element[0].parentNode:f.appendTo),e[0]===this.element[0]||/(fixed|absolute)/.test(e.css("position"))||e.css("position","absolute"),e},_adjustOffsetFromHelper:function(e){"string"==
typeof e&&(e=e.split(" "));d.isArray(e)&&(e={left:+e[0],top:+e[1]||0});"left"in e&&(this.offset.click.left=e.left+this.margins.left);"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left);"top"in e&&(this.offset.click.top=e.top+this.margins.top);"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_getParentOffset:function(){var e=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&
d.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&d.ui.ie)&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var d=this.element.position();
return{top:d.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:d.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions=
{width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,f,h,k=this.options;return k.containment?"window"===k.containment?(this.containment=[d(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,d(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,d(window).scrollLeft()+d(window).width()-this.helperProportions.width-this.margins.left,d(window).scrollTop()+(d(window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-
this.margins.top],void 0):"document"===k.containment?(this.containment=[0,0,d(document).width()-this.helperProportions.width-this.margins.left,(d(document).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top],void 0):k.containment.constructor===Array?(this.containment=k.containment,void 0):("parent"===k.containment&&(k.containment=this.helper[0].parentNode),f=d(k.containment),h=f[0],h&&(e="hidden"!==f.css("overflow"),this.containment=[(parseInt(f.css("borderLeftWidth"),
10)||0)+(parseInt(f.css("paddingLeft"),10)||0),(parseInt(f.css("borderTopWidth"),10)||0)+(parseInt(f.css("paddingTop"),10)||0),(e?Math.max(h.scrollWidth,h.offsetWidth):h.offsetWidth)-(parseInt(f.css("borderRightWidth"),10)||0)-(parseInt(f.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(e?Math.max(h.scrollHeight,h.offsetHeight):h.offsetHeight)-(parseInt(f.css("borderBottomWidth"),10)||0)-(parseInt(f.css("paddingBottom"),10)||0)-this.helperProportions.height-
this.margins.top-this.margins.bottom],this.relative_container=f),void 0):(this.containment=null,void 0)},_convertPositionTo:function(e,f){f||(f=this.position);var h="absolute"===e?1:-1,k="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&d.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent;return this.offset.scroll||(this.offset.scroll={top:k.scrollTop(),left:k.scrollLeft()}),{top:f.top+this.offset.relative.top*h+this.offset.parent.top*h-("fixed"===
this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top)*h,left:f.left+this.offset.relative.left*h+this.offset.parent.left*h-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)*h}},_generatePosition:function(e){var f,h,k,l,m=this.options,n="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&d.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,p=e.pageX,q=e.pageY;return this.offset.scroll||(this.offset.scroll=
{top:n.scrollTop(),left:n.scrollLeft()}),this.originalPosition&&(this.containment&&(this.relative_container?(h=this.relative_container.offset(),f=[this.containment[0]+h.left,this.containment[1]+h.top,this.containment[2]+h.left,this.containment[3]+h.top]):f=this.containment,e.pageX-this.offset.click.left<f[0]&&(p=f[0]+this.offset.click.left),e.pageY-this.offset.click.top<f[1]&&(q=f[1]+this.offset.click.top),e.pageX-this.offset.click.left>f[2]&&(p=f[2]+this.offset.click.left),e.pageY-this.offset.click.top>
f[3]&&(q=f[3]+this.offset.click.top)),m.grid&&(k=m.grid[1]?this.originalPageY+Math.round((q-this.originalPageY)/m.grid[1])*m.grid[1]:this.originalPageY,q=f?k-this.offset.click.top>=f[1]||k-this.offset.click.top>f[3]?k:k-this.offset.click.top>=f[1]?k-m.grid[1]:k+m.grid[1]:k,l=m.grid[0]?this.originalPageX+Math.round((p-this.originalPageX)/m.grid[0])*m.grid[0]:this.originalPageX,p=f?l-this.offset.click.left>=f[0]||l-this.offset.click.left>f[2]?l:l-this.offset.click.left>=f[0]?l-m.grid[0]:l+m.grid[0]:
l)),{top:q-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top),left:p-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging");this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove();this.helper=null;this.cancelHelperRemoval=
!1},_trigger:function(e,f,h){return h=h||this._uiHash(),d.ui.plugin.call(this,e,[f,h]),"drag"===e&&(this.positionAbs=this._convertPositionTo("absolute")),d.Widget.prototype._trigger.call(this,e,f,h)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}});d.ui.plugin.add("draggable","connectToSortable",{start:function(e,f){var h=d(this).data("ui-draggable"),k=h.options,l=d.extend({},f,{item:h.element});h.sortables=
[];d(k.connectToSortable).each(function(){var f=d.data(this,"ui-sortable");f&&!f.options.disabled&&(h.sortables.push({instance:f,shouldRevert:f.options.revert}),f.refreshPositions(),f._trigger("activate",e,l))})},stop:function(e,f){var h=d(this).data("ui-draggable"),k=d.extend({},f,{item:h.element});d.each(h.sortables,function(){this.instance.isOver?(this.instance.isOver=0,h.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=this.shouldRevert),
this.instance._mouseStop(e),this.instance.options.helper=this.instance.options._helper,"original"===h.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",e,k))})},drag:function(e,f){var h=d(this).data("ui-draggable"),k=this;d.each(h.sortables,function(){var l=!1,m=this;this.instance.positionAbs=h.positionAbs;this.instance.helperProportions=h.helperProportions;this.instance.offset.click=h.offset.click;this.instance._intersectsWith(this.instance.containerCache)&&
(l=!0,d.each(h.sortables,function(){return this.instance.positionAbs=h.positionAbs,this.instance.helperProportions=h.helperProportions,this.instance.offset.click=h.offset.click,this!==m&&this.instance._intersectsWith(this.instance.containerCache)&&d.contains(m.instance.element[0],this.instance.element[0])&&(l=!1),l}));l?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=d(k).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item",!0),this.instance.options._helper=
this.instance.options.helper,this.instance.options.helper=function(){return f.helper[0]},e.target=this.instance.currentItem[0],this.instance._mouseCapture(e,!0),this.instance._mouseStart(e,!0,!0),this.instance.offset.click.top=h.offset.click.top,this.instance.offset.click.left=h.offset.click.left,this.instance.offset.parent.left-=h.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=h.offset.parent.top-this.instance.offset.parent.top,h._trigger("toSortable",e),h.dropped=
this.instance.element,h.currentItem=h.element,this.instance.fromOutside=h),this.instance.currentItem&&this.instance._mouseDrag(e)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",e,this.instance._uiHash(this.instance)),this.instance._mouseStop(e,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),
h._trigger("fromSortable",e),h.dropped=!1)})}});d.ui.plugin.add("draggable","cursor",{start:function(){var e=d("body"),f=d(this).data("ui-draggable").options;e.css("cursor")&&(f._cursor=e.css("cursor"));e.css("cursor",f.cursor)},stop:function(){var e=d(this).data("ui-draggable").options;e._cursor&&d("body").css("cursor",e._cursor)}});d.ui.plugin.add("draggable","opacity",{start:function(e,f){var h=d(f.helper),k=d(this).data("ui-draggable").options;h.css("opacity")&&(k._opacity=h.css("opacity"));h.css("opacity",
k.opacity)},stop:function(e,f){var h=d(this).data("ui-draggable").options;h._opacity&&d(f.helper).css("opacity",h._opacity)}});d.ui.plugin.add("draggable","scroll",{start:function(){var e=d(this).data("ui-draggable");e.scrollParent[0]!==document&&"HTML"!==e.scrollParent[0].tagName&&(e.overflowOffset=e.scrollParent.offset())},drag:function(e){var f=d(this).data("ui-draggable"),h=f.options,k=!1;f.scrollParent[0]!==document&&"HTML"!==f.scrollParent[0].tagName?(h.axis&&"x"===h.axis||(f.overflowOffset.top+
f.scrollParent[0].offsetHeight-e.pageY<h.scrollSensitivity?f.scrollParent[0].scrollTop=k=f.scrollParent[0].scrollTop+h.scrollSpeed:e.pageY-f.overflowOffset.top<h.scrollSensitivity&&(f.scrollParent[0].scrollTop=k=f.scrollParent[0].scrollTop-h.scrollSpeed)),h.axis&&"y"===h.axis||(f.overflowOffset.left+f.scrollParent[0].offsetWidth-e.pageX<h.scrollSensitivity?f.scrollParent[0].scrollLeft=k=f.scrollParent[0].scrollLeft+h.scrollSpeed:e.pageX-f.overflowOffset.left<h.scrollSensitivity&&(f.scrollParent[0].scrollLeft=
k=f.scrollParent[0].scrollLeft-h.scrollSpeed))):(h.axis&&"x"===h.axis||(e.pageY-d(document).scrollTop()<h.scrollSensitivity?k=d(document).scrollTop(d(document).scrollTop()-h.scrollSpeed):d(window).height()-(e.pageY-d(document).scrollTop())<h.scrollSensitivity&&(k=d(document).scrollTop(d(document).scrollTop()+h.scrollSpeed))),h.axis&&"y"===h.axis||(e.pageX-d(document).scrollLeft()<h.scrollSensitivity?k=d(document).scrollLeft(d(document).scrollLeft()-h.scrollSpeed):d(window).width()-(e.pageX-d(document).scrollLeft())<
h.scrollSensitivity&&(k=d(document).scrollLeft(d(document).scrollLeft()+h.scrollSpeed))));!1!==k&&d.ui.ddmanager&&!h.dropBehaviour&&d.ui.ddmanager.prepareOffsets(f,e)}});d.ui.plugin.add("draggable","snap",{start:function(){var e=d(this).data("ui-draggable"),f=e.options;e.snapElements=[];d(f.snap.constructor!==String?f.snap.items||":data(ui-draggable)":f.snap).each(function(){var f=d(this),k=f.offset();this!==e.element[0]&&e.snapElements.push({item:this,width:f.outerWidth(),height:f.outerHeight(),
top:k.top,left:k.left})})},drag:function(e,f){var h,k,l,m,n,p,q,s,t,u,v=d(this).data("ui-draggable"),x=v.options,y=x.snapTolerance,z=f.offset.left,A=z+v.helperProportions.width,G=f.offset.top,E=G+v.helperProportions.height;for(t=v.snapElements.length-1;0<=t;t--)n=v.snapElements[t].left,p=n+v.snapElements[t].width,q=v.snapElements[t].top,s=q+v.snapElements[t].height,n-y>A||z>p+y||q-y>E||G>s+y||!d.contains(v.snapElements[t].item.ownerDocument,v.snapElements[t].item)?(v.snapElements[t].snapping&&v.options.snap.release&&
v.options.snap.release.call(v.element,e,d.extend(v._uiHash(),{snapItem:v.snapElements[t].item})),v.snapElements[t].snapping=!1):("inner"!==x.snapMode&&(h=y>=Math.abs(q-E),k=y>=Math.abs(s-G),l=y>=Math.abs(n-A),m=y>=Math.abs(p-z),h&&(f.position.top=v._convertPositionTo("relative",{top:q-v.helperProportions.height,left:0}).top-v.margins.top),k&&(f.position.top=v._convertPositionTo("relative",{top:s,left:0}).top-v.margins.top),l&&(f.position.left=v._convertPositionTo("relative",{top:0,left:n-v.helperProportions.width}).left-
v.margins.left),m&&(f.position.left=v._convertPositionTo("relative",{top:0,left:p}).left-v.margins.left)),u=h||k||l||m,"outer"!==x.snapMode&&(h=y>=Math.abs(q-G),k=y>=Math.abs(s-E),l=y>=Math.abs(n-z),m=y>=Math.abs(p-A),h&&(f.position.top=v._convertPositionTo("relative",{top:q,left:0}).top-v.margins.top),k&&(f.position.top=v._convertPositionTo("relative",{top:s-v.helperProportions.height,left:0}).top-v.margins.top),l&&(f.position.left=v._convertPositionTo("relative",{top:0,left:n}).left-v.margins.left),
m&&(f.position.left=v._convertPositionTo("relative",{top:0,left:p-v.helperProportions.width}).left-v.margins.left)),!v.snapElements[t].snapping&&(h||k||l||m||u)&&v.options.snap.snap&&v.options.snap.snap.call(v.element,e,d.extend(v._uiHash(),{snapItem:v.snapElements[t].item})),v.snapElements[t].snapping=h||k||l||m||u)}});d.ui.plugin.add("draggable","stack",{start:function(){var e,f=this.data("ui-draggable").options,f=d.makeArray(d(f.stack)).sort(function(e,f){return(parseInt(d(e).css("zIndex"),10)||
0)-(parseInt(d(f).css("zIndex"),10)||0)});f.length&&(e=parseInt(d(f[0]).css("zIndex"),10)||0,d(f).each(function(f){d(this).css("zIndex",e+f)}),this.css("zIndex",e+f.length))}});d.ui.plugin.add("draggable","zIndex",{start:function(e,f){var h=d(f.helper),k=d(this).data("ui-draggable").options;h.css("zIndex")&&(k._zIndex=h.css("zIndex"));h.css("zIndex",k.zIndex)},stop:function(e,f){var h=d(this).data("ui-draggable").options;h._zIndex&&d(f.helper).css("zIndex",h._zIndex)}})})(jQuery);
(function(d){d.widget("ui.droppable",{version:"1.10.3",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var e=this.options,f=e.accept;this.isover=!1;this.isout=!0;this.accept=d.isFunction(f)?f:function(d){return d.is(f)};this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight};d.ui.ddmanager.droppables[e.scope]=
d.ui.ddmanager.droppables[e.scope]||[];d.ui.ddmanager.droppables[e.scope].push(this);e.addClasses&&this.element.addClass("ui-droppable")},_destroy:function(){for(var e=0,f=d.ui.ddmanager.droppables[this.options.scope];f.length>e;e++)f[e]===this&&f.splice(e,1);this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(e,f){"accept"===e&&(this.accept=d.isFunction(f)?f:function(d){return d.is(f)});d.Widget.prototype._setOption.apply(this,arguments)},_activate:function(e){var f=
d.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass);f&&this._trigger("activate",e,this.ui(f))},_deactivate:function(e){var f=d.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass);f&&this._trigger("deactivate",e,this.ui(f))},_over:function(e){var f=d.ui.ddmanager.current;f&&(f.currentItem||f.element)[0]!==this.element[0]&&this.accept.call(this.element[0],f.currentItem||f.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),
this._trigger("over",e,this.ui(f)))},_out:function(e){var f=d.ui.ddmanager.current;f&&(f.currentItem||f.element)[0]!==this.element[0]&&this.accept.call(this.element[0],f.currentItem||f.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",e,this.ui(f)))},_drop:function(e,f){var h=f||d.ui.ddmanager.current,k=!1;return h&&(h.currentItem||h.element)[0]!==this.element[0]?(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var e=
d.data(this,"ui-droppable");return e.options.greedy&&!e.options.disabled&&e.options.scope===h.options.scope&&e.accept.call(e.element[0],h.currentItem||h.element)&&d.ui.intersect(h,d.extend(e,{offset:e.element.offset()}),e.options.tolerance)?(k=!0,!1):void 0}),k?!1:this.accept.call(this.element[0],h.currentItem||h.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",e,this.ui(h)),
this.element):!1):!1},ui:function(d){return{draggable:d.currentItem||d.element,helper:d.helper,position:d.position,offset:d.positionAbs}}});d.ui.intersect=function(d,f,h){if(!f.offset)return!1;var k,l,m=(d.positionAbs||d.position.absolute).left,n=m+d.helperProportions.width,p=(d.positionAbs||d.position.absolute).top,q=p+d.helperProportions.height,s=f.offset.left,t=s+f.proportions.width,u=f.offset.top,v=u+f.proportions.height;switch(h){case "fit":return m>=s&&t>=n&&p>=u&&v>=q;case "intersect":return m+
d.helperProportions.width/2>s&&t>n-d.helperProportions.width/2&&p+d.helperProportions.height/2>u&&v>q-d.helperProportions.height/2;case "pointer":return k=(d.positionAbs||d.position.absolute).left+(d.clickOffset||d.offset.click).left,l=(d.positionAbs||d.position.absolute).top+(d.clickOffset||d.offset.click).top,l>u&&u+f.proportions.height>l&&k>s&&s+f.proportions.width>k;case "touch":return(p>=u&&v>=p||q>=u&&v>=q||u>p&&q>v)&&(m>=s&&t>=m||n>=s&&t>=n||s>m&&n>t);default:return!1}};d.ui.ddmanager={current:null,
droppables:{"default":[]},prepareOffsets:function(e,f){var h,k,l=d.ui.ddmanager.droppables[e.options.scope]||[],m=f?f.type:null,n=(e.currentItem||e.element).find(":data(ui-droppable)").addBack();h=0;a:for(;l.length>h;h++)if(!(l[h].options.disabled||e&&!l[h].accept.call(l[h].element[0],e.currentItem||e.element))){for(k=0;n.length>k;k++)if(n[k]===l[h].element[0]){l[h].proportions.height=0;continue a}l[h].visible="none"!==l[h].element.css("display");l[h].visible&&("mousedown"===m&&l[h]._activate.call(l[h],
f),l[h].offset=l[h].element.offset(),l[h].proportions={width:l[h].element[0].offsetWidth,height:l[h].element[0].offsetHeight})}},drop:function(e,f){var h=!1;return d.each((d.ui.ddmanager.droppables[e.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&d.ui.intersect(e,this,this.options.tolerance)&&(h=this._drop.call(this,f)||h),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],e.currentItem||e.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,
f)))}),h},dragStart:function(e,f){e.element.parentsUntil("body").bind("scroll.droppable",function(){e.options.refreshPositions||d.ui.ddmanager.prepareOffsets(e,f)})},drag:function(e,f){e.options.refreshPositions&&d.ui.ddmanager.prepareOffsets(e,f);d.each(d.ui.ddmanager.droppables[e.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var h,k,l,m=d.ui.intersect(e,this,this.options.tolerance);(m=!m&&this.isover?"isout":m&&!this.isover?"isover":null)&&(this.options.greedy&&
(k=this.options.scope,l=this.element.parents(":data(ui-droppable)").filter(function(){return d.data(this,"ui-droppable").options.scope===k}),l.length&&(h=d.data(l[0],"ui-droppable"),h.greedyChild="isover"===m)),h&&"isover"===m&&(h.isover=!1,h.isout=!0,h._out.call(h,f)),this[m]=!0,this["isout"===m?"isover":"isout"]=!1,this["isover"===m?"_over":"_out"].call(this,f),h&&"isout"===m&&(h.isout=!1,h.isover=!0,h._over.call(h,f)))}})},dragStop:function(e,f){e.element.parentsUntil("body").unbind("scroll.droppable");
e.options.refreshPositions||d.ui.ddmanager.prepareOffsets(e,f)}}})(jQuery);
(function(d){function e(d){return parseInt(d,10)||0}function f(d){return!isNaN(parseInt(d,10))}d.widget("ui.resizable",d.ui.mouse,{version:"1.10.3",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_create:function(){var e,f,l,m,n,p=this,q=this.options;if(this.element.addClass("ui-resizable"),
d.extend(this,{_aspectRatio:!!q.aspectRatio,aspectRatio:q.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:q.helper||q.ghost||q.animate?q.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(this.element.wrap(d("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),
left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.data("ui-resizable")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),
this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=q.handles||(d(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),
this.handles.constructor===String){"all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw");e=this.handles.split(",");this.handles={};for(f=0;e.length>f;f++)l=d.trim(e[f]),n="ui-resizable-"+l,m=d("<div class='ui-resizable-handle "+n+"'></div>"),m.css({zIndex:q.zIndex}),"se"===l&&m.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[l]=".ui-resizable-"+l,this.element.append(m)}this._renderAxis=function(e){var f,h,k,m;e=e||this.element;for(f in this.handles)this.handles[f].constructor===
String&&(this.handles[f]=d(this.handles[f],this.element).show()),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)&&(h=d(this.handles[f],this.element),m=/sw|ne|nw|se|n|s/.test(f)?h.outerHeight():h.outerWidth(),k=["padding",/ne|nw|n/.test(f)?"Top":/se|sw|s/.test(f)?"Bottom":/^e$/.test(f)?"Right":"Left"].join(""),e.css(k,m),this._proportionallyResize()),d(this.handles[f]).length};this._renderAxis(this.element);this._handles=d(".ui-resizable-handle",this.element).disableSelection();
this._handles.mouseover(function(){p.resizing||(this.className&&(m=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),p.axis=m&&m[1]?m[1]:"se")});q.autoHide&&(this._handles.hide(),d(this.element).addClass("ui-resizable-autohide").mouseenter(function(){q.disabled||(d(this).removeClass("ui-resizable-autohide"),p._handles.show())}).mouseleave(function(){q.disabled||p.resizing||(d(this).addClass("ui-resizable-autohide"),p._handles.hide())}));this._mouseInit()},_destroy:function(){this._mouseDestroy();
var e,f=function(e){d(e).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(f(this.element),e=this.element,this.originalElement.css({position:e.css("position"),width:e.outerWidth(),height:e.outerHeight(),top:e.css("top"),left:e.css("left")}).insertAfter(e),e.remove()),this.originalElement.css("resize",this.originalResizeStyle),f(this.originalElement),
this},_mouseCapture:function(e){var f,l,m=!1;for(f in this.handles)l=d(this.handles[f])[0],(l===e.target||d.contains(l,e.target))&&(m=!0);return!this.options.disabled&&m},_mouseStart:function(f){var k,l,m,n=this.options,p=this.element.position(),q=this.element;return this.resizing=!0,/absolute/.test(q.css("position"))?q.css({position:"absolute",top:q.css("top"),left:q.css("left")}):q.is(".ui-draggable")&&q.css({position:"absolute",top:p.top,left:p.left}),this._renderProxy(),k=e(this.helper.css("left")),
l=e(this.helper.css("top")),n.containment&&(k+=d(n.containment).scrollLeft()||0,l+=d(n.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:k,top:l},this.size=this._helper?{width:q.outerWidth(),height:q.outerHeight()}:{width:q.width(),height:q.height()},this.originalSize=this._helper?{width:q.outerWidth(),height:q.outerHeight()}:{width:q.width(),height:q.height()},this.originalPosition={left:k,top:l},this.sizeDiff={width:q.outerWidth()-q.width(),height:q.outerHeight()-
q.height()},this.originalMousePosition={left:f.pageX,top:f.pageY},this.aspectRatio="number"==typeof n.aspectRatio?n.aspectRatio:this.originalSize.width/this.originalSize.height||1,m=d(".ui-resizable-"+this.axis).css("cursor"),d("body").css("cursor","auto"===m?this.axis+"-resize":m),q.addClass("ui-resizable-resizing"),this._propagate("start",f),!0},_mouseDrag:function(e){var f,l=this.helper,m={},n=this.originalMousePosition,p=this.position.top,q=this.position.left,s=this.size.width,t=this.size.height,
u=e.pageX-n.left||0,n=e.pageY-n.top||0,v=this._change[this.axis];return v?(f=v.apply(this,[e,u,n]),this._updateVirtualBoundaries(e.shiftKey),(this._aspectRatio||e.shiftKey)&&(f=this._updateRatio(f,e)),f=this._respectSize(f,e),this._updateCache(f),this._propagate("resize",e),this.position.top!==p&&(m.top=this.position.top+"px"),this.position.left!==q&&(m.left=this.position.left+"px"),this.size.width!==s&&(m.width=this.size.width+"px"),this.size.height!==t&&(m.height=this.size.height+"px"),l.css(m),
!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),d.isEmptyObject(m)||this._trigger("resize",e,this.ui()),!1):!1},_mouseStop:function(e){this.resizing=!1;var f,l,m,n,p,q,s,t=this.options;return this._helper&&(f=this._proportionallyResizeElements,l=f.length&&/textarea/i.test(f[0].nodeName),m=l&&d.ui.hasScroll(f[0],"left")?0:this.sizeDiff.height,n=l?0:this.sizeDiff.width,p={width:this.helper.width()-n,height:this.helper.height()-m},q=parseInt(this.element.css("left"),
10)+(this.position.left-this.originalPosition.left)||null,s=parseInt(this.element.css("top"),10)+(this.position.top-this.originalPosition.top)||null,t.animate||this.element.css(d.extend(p,{top:s,left:q})),this.helper.height(this.size.height),this.helper.width(this.size.width),this._helper&&!t.animate&&this._proportionallyResize()),d("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",e),this._helper&&this.helper.remove(),!1},_updateVirtualBoundaries:function(d){var e,
l,m,n,p;p=this.options;p={minWidth:f(p.minWidth)?p.minWidth:0,maxWidth:f(p.maxWidth)?p.maxWidth:1/0,minHeight:f(p.minHeight)?p.minHeight:0,maxHeight:f(p.maxHeight)?p.maxHeight:1/0};(this._aspectRatio||d)&&(e=p.minHeight*this.aspectRatio,m=p.minWidth/this.aspectRatio,l=p.maxHeight*this.aspectRatio,n=p.maxWidth/this.aspectRatio,e>p.minWidth&&(p.minWidth=e),m>p.minHeight&&(p.minHeight=m),p.maxWidth>l&&(p.maxWidth=l),p.maxHeight>n&&(p.maxHeight=n));this._vBoundaries=p},_updateCache:function(d){this.offset=
this.helper.offset();f(d.left)&&(this.position.left=d.left);f(d.top)&&(this.position.top=d.top);f(d.height)&&(this.size.height=d.height);f(d.width)&&(this.size.width=d.width)},_updateRatio:function(d){var e=this.position,l=this.size,m=this.axis;return f(d.height)?d.width=d.height*this.aspectRatio:f(d.width)&&(d.height=d.width/this.aspectRatio),"sw"===m&&(d.left=e.left+(l.width-d.width),d.top=null),"nw"===m&&(d.top=e.top+(l.height-d.height),d.left=e.left+(l.width-d.width)),d},_respectSize:function(d){var e=
this._vBoundaries,l=this.axis,m=f(d.width)&&e.maxWidth&&e.maxWidth<d.width,n=f(d.height)&&e.maxHeight&&e.maxHeight<d.height,p=f(d.width)&&e.minWidth&&e.minWidth>d.width,q=f(d.height)&&e.minHeight&&e.minHeight>d.height,s=this.originalPosition.left+this.originalSize.width,t=this.position.top+this.size.height,u=/sw|nw|w/.test(l),l=/nw|ne|n/.test(l);return p&&(d.width=e.minWidth),q&&(d.height=e.minHeight),m&&(d.width=e.maxWidth),n&&(d.height=e.maxHeight),p&&u&&(d.left=s-e.minWidth),m&&u&&(d.left=s-e.maxWidth),
q&&l&&(d.top=t-e.minHeight),n&&l&&(d.top=t-e.maxHeight),d.width||d.height||d.left||!d.top?d.width||d.height||d.top||!d.left||(d.left=null):d.top=null,d},_proportionallyResize:function(){if(this._proportionallyResizeElements.length){var d,e,f,m,n,p=this.helper||this.element;for(d=0;this._proportionallyResizeElements.length>d;d++){if(n=this._proportionallyResizeElements[d],!this.borderDif){this.borderDif=[];f=[n.css("borderTopWidth"),n.css("borderRightWidth"),n.css("borderBottomWidth"),n.css("borderLeftWidth")];
m=[n.css("paddingTop"),n.css("paddingRight"),n.css("paddingBottom"),n.css("paddingLeft")];for(e=0;f.length>e;e++)this.borderDif[e]=(parseInt(f[e],10)||0)+(parseInt(m[e],10)||0)}n.css({height:p.height()-this.borderDif[0]-this.borderDif[2]||0,width:p.width()-this.borderDif[1]-this.borderDif[3]||0})}}},_renderProxy:function(){var e=this.options;this.elementOffset=this.element.offset();this._helper?(this.helper=this.helper||d("<div style='overflow:hidden;'></div>"),this.helper.addClass(this._helper).css({width:this.element.outerWidth()-
1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++e.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(d,e){return{width:this.originalSize.width+e}},w:function(d,e){return{left:this.originalPosition.left+e,width:this.originalSize.width-e}},n:function(d,e,f){return{top:this.originalPosition.top+f,height:this.originalSize.height-f}},s:function(d,e,f){return{height:this.originalSize.height+
f}},se:function(e,f,l){return d.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[e,f,l]))},sw:function(e,f,l){return d.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[e,f,l]))},ne:function(e,f,l){return d.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[e,f,l]))},nw:function(e,f,l){return d.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[e,f,l]))}},_propagate:function(e,f){d.ui.plugin.call(this,e,[f,this.ui()]);
"resize"!==e&&this._trigger(e,f,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}});d.ui.plugin.add("resizable","animate",{stop:function(e){var f=d(this).data("ui-resizable"),l=f.options,m=f._proportionallyResizeElements,n=m.length&&/textarea/i.test(m[0].nodeName),p=n&&d.ui.hasScroll(m[0],"left")?0:f.sizeDiff.height,n=
{width:f.size.width-(n?0:f.sizeDiff.width),height:f.size.height-p},p=parseInt(f.element.css("left"),10)+(f.position.left-f.originalPosition.left)||null,q=parseInt(f.element.css("top"),10)+(f.position.top-f.originalPosition.top)||null;f.element.animate(d.extend(n,q&&p?{top:q,left:p}:{}),{duration:l.animateDuration,easing:l.animateEasing,step:function(){var l={width:parseInt(f.element.css("width"),10),height:parseInt(f.element.css("height"),10),top:parseInt(f.element.css("top"),10),left:parseInt(f.element.css("left"),
10)};m&&m.length&&d(m[0]).css({width:l.width,height:l.height});f._updateCache(l);f._propagate("resize",e)}})}});d.ui.plugin.add("resizable","containment",{start:function(){var f,k,l,m,n,p,q,s=d(this).data("ui-resizable"),t=s.element,u=s.options.containment;(t=u instanceof d?u.get(0):/parent/.test(u)?t.parent().get(0):u)&&(s.containerElement=d(t),/document/.test(u)||u===document?(s.containerOffset={left:0,top:0},s.containerPosition={left:0,top:0},s.parentData={element:d(document),left:0,top:0,width:d(document).width(),
height:d(document).height()||document.body.parentNode.scrollHeight}):(f=d(t),k=[],d(["Top","Right","Left","Bottom"]).each(function(d,m){k[d]=e(f.css("padding"+m))}),s.containerOffset=f.offset(),s.containerPosition=f.position(),s.containerSize={height:f.innerHeight()-k[3],width:f.innerWidth()-k[1]},l=s.containerOffset,m=s.containerSize.height,n=s.containerSize.width,p=d.ui.hasScroll(t,"left")?t.scrollWidth:n,q=d.ui.hasScroll(t)?t.scrollHeight:m,s.parentData={element:t,left:l.left,top:l.top,width:p,
height:q}))},resize:function(e){var f,l,m,n,p=d(this).data("ui-resizable");f=p.options;l=p.containerOffset;m=p.position;e=p._aspectRatio||e.shiftKey;n={top:0,left:0};var q=p.containerElement;q[0]!==document&&/static/.test(q.css("position"))&&(n=l);m.left<(p._helper?l.left:0)&&(p.size.width+=p._helper?p.position.left-l.left:p.position.left-n.left,e&&(p.size.height=p.size.width/p.aspectRatio),p.position.left=f.helper?l.left:0);m.top<(p._helper?l.top:0)&&(p.size.height+=p._helper?p.position.top-l.top:
p.position.top,e&&(p.size.width=p.size.height*p.aspectRatio),p.position.top=p._helper?l.top:0);p.offset.left=p.parentData.left+p.position.left;p.offset.top=p.parentData.top+p.position.top;f=Math.abs(p.offset.left-n.left+p.sizeDiff.width);l=Math.abs((p._helper?p.offset.top-n.top:p.offset.top-l.top)+p.sizeDiff.height);m=p.containerElement.get(0)===p.element.parent().get(0);n=/relative|absolute/.test(p.containerElement.css("position"));m&&n&&(f-=p.parentData.left);f+p.size.width>=p.parentData.width&&
(p.size.width=p.parentData.width-f,e&&(p.size.height=p.size.width/p.aspectRatio));l+p.size.height>=p.parentData.height&&(p.size.height=p.parentData.height-l,e&&(p.size.width=p.size.height*p.aspectRatio))},stop:function(){var e=d(this).data("ui-resizable"),f=e.options,l=e.containerOffset,m=e.containerPosition,n=e.containerElement,p=d(e.helper),q=p.offset(),s=p.outerWidth()-e.sizeDiff.width,p=p.outerHeight()-e.sizeDiff.height;e._helper&&!f.animate&&/relative/.test(n.css("position"))&&d(this).css({left:q.left-
m.left-l.left,width:s,height:p});e._helper&&!f.animate&&/static/.test(n.css("position"))&&d(this).css({left:q.left-m.left-l.left,width:s,height:p})}});d.ui.plugin.add("resizable","alsoResize",{start:function(){var e=d(this).data("ui-resizable").options,f=function(e){d(e).each(function(){var e=d(this);e.data("ui-resizable-alsoresize",{width:parseInt(e.width(),10),height:parseInt(e.height(),10),left:parseInt(e.css("left"),10),top:parseInt(e.css("top"),10)})})};"object"!=typeof e.alsoResize||e.alsoResize.parentNode?
f(e.alsoResize):e.alsoResize.length?(e.alsoResize=e.alsoResize[0],f(e.alsoResize)):d.each(e.alsoResize,function(d){f(d)})},resize:function(e,f){var l=d(this).data("ui-resizable"),m=l.options,n=l.originalSize,p=l.originalPosition,q={height:l.size.height-n.height||0,width:l.size.width-n.width||0,top:l.position.top-p.top||0,left:l.position.left-p.left||0},s=function(e,h){d(e).each(function(){var e=d(this),m=d(this).data("ui-resizable-alsoresize"),l={},n=h&&h.length?h:e.parents(f.originalElement[0]).length?
["width","height"]:["width","height","top","left"];d.each(n,function(d,e){var f=(m[e]||0)+(q[e]||0);f&&0<=f&&(l[e]=f||null)});e.css(l)})};"object"!=typeof m.alsoResize||m.alsoResize.nodeType?s(m.alsoResize):d.each(m.alsoResize,function(d,e){s(d,e)})},stop:function(){d(this).removeData("resizable-alsoresize")}});d.ui.plugin.add("resizable","ghost",{start:function(){var e=d(this).data("ui-resizable"),f=e.options,l=e.size;e.ghost=e.originalElement.clone();e.ghost.css({opacity:0.25,display:"block",position:"relative",
height:l.height,width:l.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof f.ghost?f.ghost:"");e.ghost.appendTo(e.helper)},resize:function(){var e=d(this).data("ui-resizable");e.ghost&&e.ghost.css({position:"relative",height:e.size.height,width:e.size.width})},stop:function(){var e=d(this).data("ui-resizable");e.ghost&&e.helper&&e.helper.get(0).removeChild(e.ghost.get(0))}});d.ui.plugin.add("resizable","grid",{resize:function(){var e=d(this).data("ui-resizable"),
f=e.options,l=e.size,m=e.originalSize,n=e.originalPosition,p=e.axis,q="number"==typeof f.grid?[f.grid,f.grid]:f.grid,s=q[0]||1,t=q[1]||1,u=Math.round((l.width-m.width)/s)*s,l=Math.round((l.height-m.height)/t)*t,v=m.width+u,m=m.height+l,x=f.maxWidth&&v>f.maxWidth,y=f.maxHeight&&m>f.maxHeight,z=f.minWidth&&f.minWidth>v,A=f.minHeight&&f.minHeight>m;f.grid=q;z&&(v+=s);A&&(m+=t);x&&(v-=s);y&&(m-=t);/^(se|s|e)$/.test(p)?(e.size.width=v,e.size.height=m):/^(ne)$/.test(p)?(e.size.width=v,e.size.height=m,e.position.top=
n.top-l):/^(sw)$/.test(p)?(e.size.width=v,e.size.height=m,e.position.left=n.left-u):(e.size.width=v,e.size.height=m,e.position.top=n.top-l,e.position.left=n.left-u)}})})(jQuery);
(function(d){d.widget("ui.selectable",d.ui.mouse,{version:"1.10.3",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var e,f=this;this.element.addClass("ui-selectable");this.dragged=!1;this.refresh=function(){e=d(f.options.filter,f.element[0]);e.addClass("ui-selectee");e.each(function(){var e=d(this),f=e.offset();d.data(this,"selectable-item",{element:this,$element:e,
left:f.left,top:f.top,right:f.left+e.outerWidth(),bottom:f.top+e.outerHeight(),startselected:!1,selected:e.hasClass("ui-selected"),selecting:e.hasClass("ui-selecting"),unselecting:e.hasClass("ui-unselecting")})})};this.refresh();this.selectees=e.addClass("ui-selectee");this._mouseInit();this.helper=d("<div class='ui-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item");this.element.removeClass("ui-selectable ui-selectable-disabled");
this._mouseDestroy()},_mouseStart:function(e){var f=this,h=this.options;this.opos=[e.pageX,e.pageY];this.options.disabled||(this.selectees=d(h.filter,this.element[0]),this._trigger("start",e),d(h.appendTo).append(this.helper),this.helper.css({left:e.pageX,top:e.pageY,width:0,height:0}),h.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var h=d.data(this,"selectable-item");h.startselected=!0;e.metaKey||e.ctrlKey||(h.$element.removeClass("ui-selected"),h.selected=!1,
h.$element.addClass("ui-unselecting"),h.unselecting=!0,f._trigger("unselecting",e,{unselecting:h.element}))}),d(e.target).parents().addBack().each(function(){var h,l=d.data(this,"selectable-item");return l?(h=!e.metaKey&&!e.ctrlKey||!l.$element.hasClass("ui-selected"),l.$element.removeClass(h?"ui-unselecting":"ui-selected").addClass(h?"ui-selecting":"ui-unselecting"),l.unselecting=!h,l.selecting=h,l.selected=h,h?f._trigger("selecting",e,{selecting:l.element}):f._trigger("unselecting",e,{unselecting:l.element}),
!1):void 0}))},_mouseDrag:function(e){if(this.dragged=!0,!this.options.disabled){var f,h=this,k=this.options,l=this.opos[0],m=this.opos[1],n=e.pageX,p=e.pageY;return l>n&&(f=n,n=l,l=f),m>p&&(f=p,p=m,m=f),this.helper.css({left:l,top:m,width:n-l,height:p-m}),this.selectees.each(function(){var f=d.data(this,"selectable-item");f&&f.element!==h.element[0]&&(f.selecting&&((e.metaKey||e.ctrlKey)&&f.startselected?(f.$element.removeClass("ui-selecting"),f.selecting=!1,f.$element.addClass("ui-selected"),f.selected=
!0):(f.$element.removeClass("ui-selecting"),f.selecting=!1,f.startselected&&(f.$element.addClass("ui-unselecting"),f.unselecting=!0),h._trigger("unselecting",e,{unselecting:f.element}))),f.selected&&(e.metaKey||e.ctrlKey||f.startselected||(f.$element.removeClass("ui-selected"),f.selected=!1,f.$element.addClass("ui-unselecting"),f.unselecting=!0,h._trigger("unselecting",e,{unselecting:f.element}))))}),!1}},_mouseStop:function(e){var f=this;return this.dragged=!1,d(".ui-unselecting",this.element[0]).each(function(){var h=
d.data(this,"selectable-item");h.$element.removeClass("ui-unselecting");h.unselecting=!1;h.startselected=!1;f._trigger("unselected",e,{unselected:h.element})}),d(".ui-selecting",this.element[0]).each(function(){var h=d.data(this,"selectable-item");h.$element.removeClass("ui-selecting").addClass("ui-selected");h.selecting=!1;h.selected=!0;h.startselected=!0;f._trigger("selected",e,{selected:h.element})}),this._trigger("stop",e),this.helper.remove(),!1}})})(jQuery);
(function(d){function e(d){return/left|right/.test(d.css("float"))||/inline|table-cell/.test(d.css("display"))}d.widget("ui.sortable",d.ui.mouse,{version:"1.10.3",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",
zIndex:1E3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_create:function(){var d=this.options;this.containerCache={};this.element.addClass("ui-sortable");this.refresh();this.floating=this.items.length?"x"===d.axis||e(this.items[0].item):!1;this.offset=this.element.offset();this._mouseInit();this.ready=!0},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled");this._mouseDestroy();
for(var d=this.items.length-1;0<=d;d--)this.items[d].item.removeData(this.widgetName+"-item");return this},_setOption:function(e,h){"disabled"===e?(this.options[e]=h,this.widget().toggleClass("ui-sortable-disabled",!!h)):d.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(e,h){var k=null,l=!1,m=this;return this.reverting?!1:this.options.disabled||"static"===this.options.type?!1:(this._refreshItems(e),d(e.target).parents().each(function(){return d.data(this,m.widgetName+"-item")===
m?(k=d(this),!1):void 0}),d.data(e.target,m.widgetName+"-item")===m&&(k=d(e.target)),k?!this.options.handle||h||(d(this.options.handle,k).find("*").addBack().each(function(){this===e.target&&(l=!0)}),l)?(this.currentItem=k,this._removeCurrentsFromItems(),!0):!1:!1)},_mouseStart:function(e,h,k){var l;h=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(e),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),
this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},d.extend(this.offset,{click:{left:e.pageX-this.offset.left,top:e.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(e),this.originalPageX=e.pageX,this.originalPageY=e.pageY,h.cursorAt&&this._adjustOffsetFromHelper(h.cursorAt),
this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),h.containment&&this._setContainment(),h.cursor&&"auto"!==h.cursor&&(l=this.document.find("body"),this.storedCursor=l.css("cursor"),l.css("cursor",h.cursor),this.storedStylesheet=d("<style>*{ cursor: "+h.cursor+" !important; }</style>").appendTo(l)),h.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),
this.helper.css("opacity",h.opacity)),h.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",h.zIndex)),this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",e,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!k)for(k=this.containers.length-1;0<=k;k--)this.containers[k]._trigger("activate",e,this._uiHash(this));return d.ui.ddmanager&&
(d.ui.ddmanager.current=this),d.ui.ddmanager&&!h.dropBehaviour&&d.ui.ddmanager.prepareOffsets(this,e),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(e),!0},_mouseDrag:function(e){var h,k,l,m;h=this.options;var n=!1;this.position=this._generatePosition(e);this.positionAbs=this._convertPositionTo("absolute");this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs);this.options.scroll&&(this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+
this.scrollParent[0].offsetHeight-e.pageY<h.scrollSensitivity?this.scrollParent[0].scrollTop=n=this.scrollParent[0].scrollTop+h.scrollSpeed:e.pageY-this.overflowOffset.top<h.scrollSensitivity&&(this.scrollParent[0].scrollTop=n=this.scrollParent[0].scrollTop-h.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-e.pageX<h.scrollSensitivity?this.scrollParent[0].scrollLeft=n=this.scrollParent[0].scrollLeft+h.scrollSpeed:e.pageX-this.overflowOffset.left<h.scrollSensitivity&&(this.scrollParent[0].scrollLeft=
n=this.scrollParent[0].scrollLeft-h.scrollSpeed)):(e.pageY-d(document).scrollTop()<h.scrollSensitivity?n=d(document).scrollTop(d(document).scrollTop()-h.scrollSpeed):d(window).height()-(e.pageY-d(document).scrollTop())<h.scrollSensitivity&&(n=d(document).scrollTop(d(document).scrollTop()+h.scrollSpeed)),e.pageX-d(document).scrollLeft()<h.scrollSensitivity?n=d(document).scrollLeft(d(document).scrollLeft()-h.scrollSpeed):d(window).width()-(e.pageX-d(document).scrollLeft())<h.scrollSensitivity&&(n=d(document).scrollLeft(d(document).scrollLeft()+
h.scrollSpeed))),!1!==n&&d.ui.ddmanager&&!h.dropBehaviour&&d.ui.ddmanager.prepareOffsets(this,e));this.positionAbs=this._convertPositionTo("absolute");this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px");this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px");for(h=this.items.length-1;0<=h;h--)if(k=this.items[h],l=k.item[0],m=this._intersectsWithPointer(k),m&&k.instance===this.currentContainer&&l!==this.currentItem[0]&&
this.placeholder[1===m?"next":"prev"]()[0]!==l&&!d.contains(this.placeholder[0],l)&&("semi-dynamic"===this.options.type?!d.contains(this.element[0],l):!0)){if(this.direction=1===m?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(k))break;this._rearrange(e,k);this._trigger("change",e,this._uiHash());break}return this._contactContainers(e),d.ui.ddmanager&&d.ui.ddmanager.drag(this,e),this._trigger("sort",e,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(e,
h){if(e){if(d.ui.ddmanager&&!this.options.dropBehaviour&&d.ui.ddmanager.drop(this,e),this.options.revert){var k=this,l=this.placeholder.offset(),m=this.options.axis,n={};m&&"x"!==m||(n.left=l.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft));m&&"y"!==m||(n.top=l.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop));this.reverting=!0;d(this.helper).animate(n,parseInt(this.options.revert,
10)||500,function(){k._clear(e)})}else this._clear(e,h);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null});"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var e=this.containers.length-1;0<=e;e--)this.containers[e]._trigger("deactivate",null,this._uiHash(this)),this.containers[e].containerCache.over&&(this.containers[e]._trigger("out",null,this._uiHash(this)),this.containers[e].containerCache.over=
0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),d.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?d(this.domPosition.prev).after(this.currentItem):d(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(e){var h=this._getItemsAsjQuery(e&&e.connected),k=[];return e=
e||{},d(h).each(function(){var h=(d(e.item||this).attr(e.attribute||"id")||"").match(e.expression||/(.+)[\-=_](.+)/);h&&k.push((e.key||h[1]+"[]")+"="+(e.key&&e.expression?h[1]:h[2]))}),!k.length&&e.key&&k.push(e.key+"="),k.join("&")},toArray:function(e){var h=this._getItemsAsjQuery(e&&e.connected),k=[];return e=e||{},h.each(function(){k.push(d(e.item||this).attr(e.attribute||"id")||"")}),k},_intersectsWith:function(d){var e=this.positionAbs.left,k=e+this.helperProportions.width,l=this.positionAbs.top,
m=l+this.helperProportions.height,n=d.left,p=n+d.width,q=d.top,s=q+d.height,t=this.offset.click.top,u=this.offset.click.left,u="y"===this.options.axis||e+u>n&&p>e+u,t=("x"===this.options.axis||l+t>q&&s>l+t)&&u;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>d[this.floating?"width":"height"]?t:e+this.helperProportions.width/2>n&&p>k-this.helperProportions.width/2&&l+this.helperProportions.height/
2>q&&s>m-this.helperProportions.height/2},_intersectsWithPointer:function(d){var e="y"===this.options.axis||this.positionAbs.left+this.offset.click.left>d.left&&d.left+d.width>this.positionAbs.left+this.offset.click.left;d=("x"===this.options.axis||this.positionAbs.top+this.offset.click.top>d.top&&d.top+d.height>this.positionAbs.top+this.offset.click.top)&&e;var e=this._getDragVerticalDirection(),k=this._getDragHorizontalDirection();return d?this.floating?k&&"right"===k||"down"===e?2:1:e&&("down"===
e?2:1):!1},_intersectsWithSides:function(d){var e=this.positionAbs.top+this.offset.click.top>d.top+d.height/2&&d.top+d.height/2+d.height>this.positionAbs.top+this.offset.click.top;d=this.positionAbs.left+this.offset.click.left>d.left+d.width/2&&d.left+d.width/2+d.width>this.positionAbs.left+this.offset.click.left;var k=this._getDragVerticalDirection(),l=this._getDragHorizontalDirection();return this.floating&&l?"right"===l&&d||"left"===l&&!d:k&&("down"===k&&e||"up"===k&&!e)},_getDragVerticalDirection:function(){var d=
this.positionAbs.top-this.lastPositionAbs.top;return 0!==d&&(0<d?"down":"up")},_getDragHorizontalDirection:function(){var d=this.positionAbs.left-this.lastPositionAbs.left;return 0!==d&&(0<d?"right":"left")},refresh:function(d){return this._refreshItems(d),this.refreshPositions(),this},_connectWith:function(){var d=this.options;return d.connectWith.constructor===String?[d.connectWith]:d.connectWith},_getItemsAsjQuery:function(e){var h,k,l,m=[],n=[],p=this._connectWith();if(p&&e)for(e=p.length-1;0<=
e;e--){k=d(p[e]);for(h=k.length-1;0<=h;h--)(l=d.data(k[h],this.widgetFullName))&&l!==this&&!l.options.disabled&&n.push([d.isFunction(l.options.items)?l.options.items.call(l.element):d(l.options.items,l.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),l])}n.push([d.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):d(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);
for(e=n.length-1;0<=e;e--)n[e][0].each(function(){m.push(this)});return d(m)},_removeCurrentsFromItems:function(){var e=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=d.grep(this.items,function(d){for(var k=0;e.length>k;k++)if(e[k]===d.item[0])return!1;return!0})},_refreshItems:function(e){this.items=[];this.containers=[this];var h,k,l,m,n,p=this.items,q=[[d.isFunction(this.options.items)?this.options.items.call(this.element[0],e,{item:this.currentItem}):d(this.options.items,
this.element),this]];if((n=this._connectWith())&&this.ready)for(h=n.length-1;0<=h;h--){l=d(n[h]);for(k=l.length-1;0<=k;k--)(m=d.data(l[k],this.widgetFullName))&&m!==this&&!m.options.disabled&&(q.push([d.isFunction(m.options.items)?m.options.items.call(m.element[0],e,{item:this.currentItem}):d(m.options.items,m.element),m]),this.containers.push(m))}for(h=q.length-1;0<=h;h--){e=q[h][1];l=q[h][0];k=0;for(n=l.length;n>k;k++)m=d(l[k]),m.data(this.widgetName+"-item",e),p.push({item:m,instance:e,width:0,
height:0,left:0,top:0})}},refreshPositions:function(e){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var h,k,l,m;for(h=this.items.length-1;0<=h;h--)k=this.items[h],k.instance!==this.currentContainer&&this.currentContainer&&k.item[0]!==this.currentItem[0]||(l=this.options.toleranceElement?d(this.options.toleranceElement,k.item):k.item,e||(k.width=l.outerWidth(),k.height=l.outerHeight()),m=l.offset(),k.left=m.left,k.top=m.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);
else for(h=this.containers.length-1;0<=h;h--)m=this.containers[h].element.offset(),this.containers[h].containerCache.left=m.left,this.containers[h].containerCache.top=m.top,this.containers[h].containerCache.width=this.containers[h].element.outerWidth(),this.containers[h].containerCache.height=this.containers[h].element.outerHeight();return this},_createPlaceholder:function(e){e=e||this;var h,k=e.options;k.placeholder&&k.placeholder.constructor!==String||(h=k.placeholder,k.placeholder={element:function(){var k=
e.currentItem[0].nodeName.toLowerCase(),m=d("<"+k+">",e.document[0]).addClass(h||e.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return"tr"===k?e.currentItem.children().each(function(){d("<td>&#160;</td>",e.document[0]).attr("colspan",d(this).attr("colspan")||1).appendTo(m)}):"img"===k&&m.attr("src",e.currentItem.attr("src")),h||m.css("visibility","hidden"),m},update:function(d,m){(!h||k.forcePlaceholderSize)&&(m.height()||m.height(e.currentItem.innerHeight()-
parseInt(e.currentItem.css("paddingTop")||0,10)-parseInt(e.currentItem.css("paddingBottom")||0,10)),m.width()||m.width(e.currentItem.innerWidth()-parseInt(e.currentItem.css("paddingLeft")||0,10)-parseInt(e.currentItem.css("paddingRight")||0,10)))}});e.placeholder=d(k.placeholder.element.call(e.element,e.currentItem));e.currentItem.after(e.placeholder);k.placeholder.update(e,e.placeholder)},_contactContainers:function(f){var h,k,l,m,n,p,q,s,t,u=k=null;for(h=this.containers.length-1;0<=h;h--)if(!d.contains(this.currentItem[0],
this.containers[h].element[0]))if(this._intersectsWith(this.containers[h].containerCache)){if(!k||!d.contains(this.containers[h].element[0],k.element[0]))k=this.containers[h],u=h}else this.containers[h].containerCache.over&&(this.containers[h]._trigger("out",f,this._uiHash(this)),this.containers[h].containerCache.over=0);if(k)if(1===this.containers.length)this.containers[u].containerCache.over||(this.containers[u]._trigger("over",f,this._uiHash(this)),this.containers[u].containerCache.over=1);else{h=
1E4;l=null;m=(t=k.floating||e(this.currentItem))?"left":"top";n=t?"width":"height";p=this.positionAbs[m]+this.offset.click[m];for(k=this.items.length-1;0<=k;k--)d.contains(this.containers[u].element[0],this.items[k].item[0])&&this.items[k].item[0]!==this.currentItem[0]&&(!t||this.positionAbs.top+this.offset.click.top>this.items[k].top&&this.items[k].top+this.items[k].height>this.positionAbs.top+this.offset.click.top)&&(q=this.items[k].item.offset()[m],s=!1,Math.abs(q-p)>Math.abs(q+this.items[k][n]-
p)&&(s=!0,q+=this.items[k][n]),h>Math.abs(q-p)&&(h=Math.abs(q-p),l=this.items[k],this.direction=s?"up":"down"));if((l||this.options.dropOnEmpty)&&this.currentContainer!==this.containers[u])l?this._rearrange(f,l,null,!0):this._rearrange(f,null,this.containers[u].element,!0),this._trigger("change",f,this._uiHash()),this.containers[u]._trigger("change",f,this._uiHash(this)),this.currentContainer=this.containers[u],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[u]._trigger("over",
f,this._uiHash(this)),this.containers[u].containerCache.over=1}},_createHelper:function(e){var h=this.options;e=d.isFunction(h.helper)?d(h.helper.apply(this.element[0],[e,this.currentItem])):"clone"===h.helper?this.currentItem.clone():this.currentItem;return e.parents("body").length||d("parent"!==h.appendTo?h.appendTo:this.currentItem[0].parentNode)[0].appendChild(e[0]),e[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),
top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!e[0].style.width||h.forceHelperSize)&&e.width(this.currentItem.width()),(!e[0].style.height||h.forceHelperSize)&&e.height(this.currentItem.height()),e},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" "));d.isArray(e)&&(e={left:+e[0],top:+e[1]||0});"left"in e&&(this.offset.click.left=e.left+this.margins.left);"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left);"top"in
e&&(this.offset.click.top=e.top+this.margins.top);"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var e=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&d.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&
"html"===this.offsetParent[0].tagName.toLowerCase()&&d.ui.ie)&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var d=this.currentItem.position();return{top:d.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:d.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,
left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,h,k,l=this.options;"parent"===l.containment&&(l.containment=this.helper[0].parentNode);("document"===l.containment||"window"===l.containment)&&(this.containment=[0-this.offset.relative.left-
this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,d("document"===l.containment?document:window).width()-this.helperProportions.width-this.margins.left,(d("document"===l.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]);/^(document|window|parent)$/.test(l.containment)||(e=d(l.containment)[0],h=d(l.containment).offset(),k="hidden"!==d(e).css("overflow"),this.containment=[h.left+(parseInt(d(e).css("borderLeftWidth"),
10)||0)+(parseInt(d(e).css("paddingLeft"),10)||0)-this.margins.left,h.top+(parseInt(d(e).css("borderTopWidth"),10)||0)+(parseInt(d(e).css("paddingTop"),10)||0)-this.margins.top,h.left+(k?Math.max(e.scrollWidth,e.offsetWidth):e.offsetWidth)-(parseInt(d(e).css("borderLeftWidth"),10)||0)-(parseInt(d(e).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,h.top+(k?Math.max(e.scrollHeight,e.offsetHeight):e.offsetHeight)-(parseInt(d(e).css("borderTopWidth"),10)||0)-(parseInt(d(e).css("paddingBottom"),
10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(e,h){h||(h=this.position);var k="absolute"===e?1:-1,l="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&d.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,m=/(html|body)/i.test(l[0].tagName);return{top:h.top+this.offset.relative.top*k+this.offset.parent.top*k-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():m?0:l.scrollTop())*k,left:h.left+this.offset.relative.left*
k+this.offset.parent.left*k-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():m?0:l.scrollLeft())*k}},_generatePosition:function(e){var h,k,l=this.options,m=e.pageX,n=e.pageY,p="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&d.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,q=/(html|body)/i.test(p[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==document&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=
this._getRelativeOffset()),this.originalPosition&&(this.containment&&(e.pageX-this.offset.click.left<this.containment[0]&&(m=this.containment[0]+this.offset.click.left),e.pageY-this.offset.click.top<this.containment[1]&&(n=this.containment[1]+this.offset.click.top),e.pageX-this.offset.click.left>this.containment[2]&&(m=this.containment[2]+this.offset.click.left),e.pageY-this.offset.click.top>this.containment[3]&&(n=this.containment[3]+this.offset.click.top)),l.grid&&(h=this.originalPageY+Math.round((n-
this.originalPageY)/l.grid[1])*l.grid[1],n=this.containment?h-this.offset.click.top>=this.containment[1]&&h-this.offset.click.top<=this.containment[3]?h:h-this.offset.click.top>=this.containment[1]?h-l.grid[1]:h+l.grid[1]:h,k=this.originalPageX+Math.round((m-this.originalPageX)/l.grid[0])*l.grid[0],m=this.containment?k-this.offset.click.left>=this.containment[0]&&k-this.offset.click.left<=this.containment[2]?k:k-this.offset.click.left>=this.containment[0]?k-l.grid[0]:k+l.grid[0]:k)),{top:n-this.offset.click.top-
this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():q?0:p.scrollTop()),left:m-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():q?0:p.scrollLeft())}},_rearrange:function(d,e,k,l){k?k[0].appendChild(this.placeholder[0]):e.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?e.item[0]:e.item[0].nextSibling);var m=this.counter=this.counter?++this.counter:
1;this._delay(function(){m===this.counter&&this.refreshPositions(!l)})},_clear:function(d,e){this.reverting=!1;var k,l=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(k in this._storedCSS)("auto"===this._storedCSS[k]||"static"===this._storedCSS[k])&&(this._storedCSS[k]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();this.fromOutside&&
!e&&l.push(function(d){this._trigger("receive",d,this._uiHash(this.fromOutside))});!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||e||l.push(function(d){this._trigger("update",d,this._uiHash())});this!==this.currentContainer&&(e||(l.push(function(d){this._trigger("remove",d,this._uiHash())}),l.push(function(d){return function(e){d._trigger("receive",e,this._uiHash(this))}}.call(this,this.currentContainer)),
l.push(function(d){return function(e){d._trigger("update",e,this._uiHash(this))}}.call(this,this.currentContainer))));for(k=this.containers.length-1;0<=k;k--)e||l.push(function(d){return function(e){d._trigger("deactivate",e,this._uiHash(this))}}.call(this,this.containers[k])),this.containers[k].containerCache.over&&(l.push(function(d){return function(e){d._trigger("out",e,this._uiHash(this))}}.call(this,this.containers[k])),this.containers[k].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",
this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,this.cancelHelperRemoval){if(!e){this._trigger("beforeStop",d,this._uiHash());for(k=0;l.length>k;k++)l[k].call(this,d);this._trigger("stop",d,this._uiHash())}return this.fromOutside=!1,!1}if(e||this._trigger("beforeStop",d,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),
this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null,!e){for(k=0;l.length>k;k++)l[k].call(this,d);this._trigger("stop",d,this._uiHash())}return this.fromOutside=!1,!0},_trigger:function(){!1===d.Widget.prototype._trigger.apply(this,arguments)&&this.cancel()},_uiHash:function(e){var h=e||this;return{helper:h.helper,placeholder:h.placeholder||d([]),position:h.position,originalPosition:h.originalPosition,offset:h.positionAbs,item:h.currentItem,sender:e?e.element:null}}})})(jQuery);
(function(d){var e=0,f={},h={};f.height=f.paddingTop=f.paddingBottom=f.borderTopWidth=f.borderBottomWidth="hide";h.height=h.paddingTop=h.paddingBottom=h.borderTopWidth=h.borderBottomWidth="show";d.widget("ui.accordion",{version:"1.10.3",options:{active:0,animate:{},collapsible:!1,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},_create:function(){var e=this.options;
this.prevShow=this.prevHide=d();this.element.addClass("ui-accordion ui-widget ui-helper-reset").attr("role","tablist");e.collapsible||!1!==e.active&&null!=e.active||(e.active=0);this._processPanels();0>e.active&&(e.active+=this.headers.length);this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:this.active.length?this.active.next():d(),content:this.active.length?this.active.next():d()}},_createIcons:function(){var e=this.options.icons;e&&(d("<span>").addClass("ui-accordion-header-icon ui-icon "+
e.header).prependTo(this.headers),this.active.children(".ui-accordion-header-icon").removeClass(e.header).addClass(e.activeHeader),this.headers.addClass("ui-accordion-icons"))},_destroyIcons:function(){this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove()},_destroy:function(){var d;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role");this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-helper-reset ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").each(function(){/^ui-accordion/.test(this.id)&&
this.removeAttribute("id")});this._destroyIcons();d=this.headers.next().css("display","").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled").each(function(){/^ui-accordion/.test(this.id)&&this.removeAttribute("id")});"content"!==this.options.heightStyle&&d.css("height","")},_setOption:function(d,e){return"active"===
d?(this._activate(e),void 0):("event"===d&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(e)),this._super(d,e),"collapsible"!==d||e||!1!==this.options.active||this._activate(0),"icons"===d&&(this._destroyIcons(),e&&this._createIcons()),"disabled"===d&&this.headers.add(this.headers.next()).toggleClass("ui-state-disabled",!!e),void 0)},_keydown:function(e){if(!e.altKey&&!e.ctrlKey){var f=d.ui.keyCode,h=this.headers.length,n=this.headers.index(e.target),p=!1;switch(e.keyCode){case f.RIGHT:case f.DOWN:p=
this.headers[(n+1)%h];break;case f.LEFT:case f.UP:p=this.headers[(n-1+h)%h];break;case f.SPACE:case f.ENTER:this._eventHandler(e);break;case f.HOME:p=this.headers[0];break;case f.END:p=this.headers[h-1]}p&&(d(e.target).attr("tabIndex",-1),d(p).attr("tabIndex",0),p.focus(),e.preventDefault())}},_panelKeyDown:function(e){e.keyCode===d.ui.keyCode.UP&&e.ctrlKey&&d(e.currentTarget).prev().focus()},refresh:function(){var e=this.options;this._processPanels();!1===e.active&&!0===e.collapsible||!this.headers.length?
(e.active=!1,this.active=d()):!1===e.active?this._activate(0):this.active.length&&!d.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(".ui-state-disabled").length?(e.active=!1,this.active=d()):this._activate(Math.max(0,e.active-1)):e.active=this.headers.index(this.active);this._destroyIcons();this._refresh()},_processPanels:function(){this.headers=this.element.find(this.options.header).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all");this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").filter(":not(.ui-accordion-content-active)").hide()},
_refresh:function(){var f,h=this.options,m=h.heightStyle,n=this.element.parent(),p=this.accordionId="ui-accordion-"+(this.element.attr("id")||++e);this.active=this._findActive(h.active).addClass("ui-accordion-header-active ui-state-active ui-corner-top").removeClass("ui-corner-all");this.active.next().addClass("ui-accordion-content-active").show();this.headers.attr("role","tab").each(function(e){var f=d(this),h=f.attr("id"),k=f.next(),m=k.attr("id");h||(h=p+"-header-"+e,f.attr("id",h));m||(m=p+"-panel-"+
e,k.attr("id",m));f.attr("aria-controls",m);k.attr("aria-labelledby",h)}).next().attr("role","tabpanel");this.headers.not(this.active).attr({"aria-selected":"false",tabIndex:-1}).next().attr({"aria-expanded":"false","aria-hidden":"true"}).hide();this.active.length?this.active.attr({"aria-selected":"true",tabIndex:0}).next().attr({"aria-expanded":"true","aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0);this._createIcons();this._setupEvents(h.event);"fill"===m?(f=n.height(),this.element.siblings(":visible").each(function(){var e=
d(this),h=e.css("position");"absolute"!==h&&"fixed"!==h&&(f-=e.outerHeight(!0))}),this.headers.each(function(){f-=d(this).outerHeight(!0)}),this.headers.next().each(function(){d(this).height(Math.max(0,f-d(this).innerHeight()+d(this).height()))}).css("overflow","auto")):"auto"===m&&(f=0,this.headers.next().each(function(){f=Math.max(f,d(this).css("height","").height())}).height(f))},_activate:function(e){e=this._findActive(e)[0];e!==this.active[0]&&(e=e||this.active[0],this._eventHandler({target:e,
currentTarget:e,preventDefault:d.noop}))},_findActive:function(e){return"number"==typeof e?this.headers.eq(e):d()},_setupEvents:function(e){var f={keydown:"_keydown"};e&&d.each(e.split(" "),function(d,e){f[e]="_eventHandler"});this._off(this.headers.add(this.headers.next()));this._on(this.headers,f);this._on(this.headers.next(),{keydown:"_panelKeyDown"});this._hoverable(this.headers);this._focusable(this.headers)},_eventHandler:function(e){var f=this.options,h=this.active,n=d(e.currentTarget),p=n[0]===
h[0],q=p&&f.collapsible,s=q?d():n.next(),t=h.next(),s={oldHeader:h,oldPanel:t,newHeader:q?d():n,newPanel:s};e.preventDefault();p&&!f.collapsible||!1===this._trigger("beforeActivate",e,s)||(f.active=q?!1:this.headers.index(n),this.active=p?d():n,this._toggle(s),h.removeClass("ui-accordion-header-active ui-state-active"),f.icons&&h.children(".ui-accordion-header-icon").removeClass(f.icons.activeHeader).addClass(f.icons.header),p||(n.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top"),
f.icons&&n.children(".ui-accordion-header-icon").removeClass(f.icons.header).addClass(f.icons.activeHeader),n.next().addClass("ui-accordion-content-active")))},_toggle:function(e){var f=e.newPanel,h=this.prevShow.length?this.prevShow:e.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0);this.prevShow=f;this.prevHide=h;this.options.animate?this._animate(f,h,e):(h.hide(),f.show(),this._toggleComplete(e));h.attr({"aria-expanded":"false","aria-hidden":"true"});h.prev().attr("aria-selected","false");
f.length&&h.length?h.prev().attr("tabIndex",-1):f.length&&this.headers.filter(function(){return 0===d(this).attr("tabIndex")}).attr("tabIndex",-1);f.attr({"aria-expanded":"true","aria-hidden":"false"}).prev().attr({"aria-selected":"true",tabIndex:0})},_animate:function(d,e,m){var n,p,q,s=this,t=0,u=d.length&&(!e.length||d.index()<e.index()),v=this.options.animate||{},u=u&&v.down||v,x=function(){s._toggleComplete(m)};return"number"==typeof u&&(q=u),"string"==typeof u&&(p=u),p=p||u.easing||v.easing,
q=q||u.duration||v.duration,e.length?d.length?(n=d.show().outerHeight(),e.animate(f,{duration:q,easing:p,step:function(d,e){e.now=Math.round(d)}}),d.hide().animate(h,{duration:q,easing:p,complete:x,step:function(d,f){f.now=Math.round(d);"height"!==f.prop?t+=f.now:"content"!==s.options.heightStyle&&(f.now=Math.round(n-e.outerHeight()-t),t=0)}}),void 0):e.animate(f,q,p,x):d.animate(h,q,p,x)},_toggleComplete:function(d){var e=d.oldPanel;e.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all");
e.length&&(e.parent()[0].className=e.parent()[0].className);this._trigger("activate",null,d)}})})(jQuery);
(function(d){var e=0;d.widget("ui.autocomplete",{version:"1.10.3",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},pending:0,_create:function(){var e,h,k,l=this.element[0].nodeName.toLowerCase(),m="textarea"===l,l="input"===l;this.isMultiLine=m?!0:l?!1:this.element.prop("isContentEditable");this.valueMethod=this.element[m||
l?"val":"text"];this.isNewMenu=!0;this.element.addClass("ui-autocomplete-input").attr("autocomplete","off");this._on(this.element,{keydown:function(m){if(this.element.prop("readOnly"))return e=!0,k=!0,h=!0,void 0;h=k=e=!1;var l=d.ui.keyCode;switch(m.keyCode){case l.PAGE_UP:e=!0;this._move("previousPage",m);break;case l.PAGE_DOWN:e=!0;this._move("nextPage",m);break;case l.UP:e=!0;this._keyEvent("previous",m);break;case l.DOWN:e=!0;this._keyEvent("next",m);break;case l.ENTER:case l.NUMPAD_ENTER:this.menu.active&&
(e=!0,m.preventDefault(),this.menu.select(m));break;case l.TAB:this.menu.active&&this.menu.select(m);break;case l.ESCAPE:this.menu.element.is(":visible")&&(this._value(this.term),this.close(m),m.preventDefault());break;default:h=!0,this._searchTimeout(m)}},keypress:function(k){if(e)return e=!1,(!this.isMultiLine||this.menu.element.is(":visible"))&&k.preventDefault(),void 0;if(!h){var m=d.ui.keyCode;switch(k.keyCode){case m.PAGE_UP:this._move("previousPage",k);break;case m.PAGE_DOWN:this._move("nextPage",
k);break;case m.UP:this._keyEvent("previous",k);break;case m.DOWN:this._keyEvent("next",k)}}},input:function(d){return k?(k=!1,d.preventDefault(),void 0):(this._searchTimeout(d),void 0)},focus:function(){this.selectedItem=null;this.previous=this._value()},blur:function(d){return this.cancelBlur?(delete this.cancelBlur,void 0):(clearTimeout(this.searching),this.close(d),this._change(d),void 0)}});this._initSource();this.menu=d("<ul>").addClass("ui-autocomplete ui-front").appendTo(this._appendTo()).menu({role:null}).hide().data("ui-menu");
this._on(this.menu.element,{mousedown:function(e){e.preventDefault();this.cancelBlur=!0;this._delay(function(){delete this.cancelBlur});var f=this.menu.element[0];d(e.target).closest(".ui-menu-item").length||this._delay(function(){var e=this;this.document.one("mousedown",function(h){h.target===e.element[0]||h.target===f||d.contains(f,h.target)||e.close()})})},menufocus:function(e,f){if(this.isNewMenu&&(this.isNewMenu=!1,e.originalEvent&&/^mouse/.test(e.originalEvent.type)))return this.menu.blur(),
this.document.one("mousemove",function(){d(e.target).trigger(e.originalEvent)}),void 0;var h=f.item.data("ui-autocomplete-item");!1!==this._trigger("focus",e,{item:h})?e.originalEvent&&/^key/.test(e.originalEvent.type)&&this._value(h.value):this.liveRegion.text(h.value)},menuselect:function(d,e){var f=e.item.data("ui-autocomplete-item"),h=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=h,this._delay(function(){this.previous=h;this.selectedItem=f}));
!1!==this._trigger("select",d,{item:f})&&this._value(f.value);this.term=this._value();this.close(d);this.selectedItem=f}});this.liveRegion=d("<span>",{role:"status","aria-live":"polite"}).addClass("ui-helper-hidden-accessible").insertBefore(this.element);this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching);this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete");this.menu.element.remove();this.liveRegion.remove()},
_setOption:function(d,e){this._super(d,e);"source"===d&&this._initSource();"appendTo"===d&&this.menu.element.appendTo(this._appendTo());"disabled"===d&&e&&this.xhr&&this.xhr.abort()},_appendTo:function(){var e=this.options.appendTo;return e&&(e=e.jquery||e.nodeType?d(e):this.document.find(e).eq(0)),e||(e=this.element.closest(".ui-front")),e.length||(e=this.document[0].body),e},_initSource:function(){var e,h,k=this;d.isArray(this.options.source)?(e=this.options.source,this.source=function(h,k){k(d.ui.autocomplete.filter(e,
h.term))}):"string"==typeof this.options.source?(h=this.options.source,this.source=function(e,f){k.xhr&&k.xhr.abort();k.xhr=d.ajax({url:h,data:e,dataType:"json",success:function(d){f(d)},error:function(){f([])}})}):this.source=this.options.source},_searchTimeout:function(d){clearTimeout(this.searching);this.searching=this._delay(function(){this.term!==this._value()&&(this.selectedItem=null,this.search(null,d))},this.options.delay)},search:function(d,e){return d=null!=d?d:this._value(),this.term=this._value(),
d.length<this.options.minLength?this.close(e):!1!==this._trigger("search",e)?this._search(d):void 0},_search:function(d){this.pending++;this.element.addClass("ui-autocomplete-loading");this.cancelSearch=!1;this.source({term:d},this._response())},_response:function(){var d=this,h=++e;return function(k){h===e&&d.__response(k);d.pending--;d.pending||d.element.removeClass("ui-autocomplete-loading")}},__response:function(d){d&&(d=this._normalize(d));this._trigger("response",null,{content:d});!this.options.disabled&&
d&&d.length&&!this.cancelSearch?(this._suggest(d),this._trigger("open")):this._close()},close:function(d){this.cancelSearch=!0;this._close(d)},_close:function(d){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",d))},_change:function(d){this.previous!==this._value()&&this._trigger("change",d,{item:this.selectedItem})},_normalize:function(e){return e.length&&e[0].label&&e[0].value?e:d.map(e,function(e){return"string"==typeof e?{label:e,
value:e}:d.extend({label:e.label||e.value,value:e.value||e.label},e)})},_suggest:function(e){var h=this.menu.element.empty();this._renderMenu(h,e);this.isNewMenu=!0;this.menu.refresh();h.show();this._resizeMenu();h.position(d.extend({of:this.element},this.options.position));this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var d=this.menu.element;d.outerWidth(Math.max(d.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(e,h){var k=this;d.each(h,function(d,h){k._renderItemData(e,
h)})},_renderItemData:function(d,e){return this._renderItem(d,e).data("ui-autocomplete-item",e)},_renderItem:function(e,h){return d("<li>").append(d("<a>").text(h.label)).appendTo(e)},_move:function(d,e){return this.menu.element.is(":visible")?this.menu.isFirstItem()&&/^previous/.test(d)||this.menu.isLastItem()&&/^next/.test(d)?(this._value(this.term),this.menu.blur(),void 0):(this.menu[d](e),void 0):(this.search(null,e),void 0)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,
arguments)},_keyEvent:function(d,e){(!this.isMultiLine||this.menu.element.is(":visible"))&&(this._move(d,e),e.preventDefault())}});d.extend(d.ui.autocomplete,{escapeRegex:function(d){return d.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(e,h){var k=RegExp(d.ui.autocomplete.escapeRegex(h),"i");return d.grep(e,function(d){return k.test(d.label||d.value||d)})}});d.widget("ui.autocomplete",d.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(d){return d+
(1<d?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(d){var e;this._superApply(arguments);this.options.disabled||this.cancelSearch||(e=d&&d.length?this.options.messages.results(d.length):this.options.messages.noResults,this.liveRegion.text(e))}})})(jQuery);
(function(d){var e,f,h,k,l=function(){var e=d(this);setTimeout(function(){e.find(":ui-button").button("refresh")},1)},m=function(e){var f=e.name,h=e.form,k=d([]);return f&&(f=f.replace(/'/g,"\\'"),k=h?d(h).find("[name='"+f+"']"):d("[name='"+f+"']",e.ownerDocument).filter(function(){return!this.form})),k};d.widget("ui.button",{version:"1.10.3",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+
this.eventNamespace).bind("reset"+this.eventNamespace,l);"boolean"!=typeof this.options.disabled?this.options.disabled=!!this.element.prop("disabled"):this.element.prop("disabled",this.options.disabled);this._determineButtonType();this.hasTitle=!!this.buttonElement.attr("title");var n=this,p=this.options,q="checkbox"===this.type||"radio"===this.type,s=q?"":"ui-state-active";null===p.label&&(p.label="input"===this.type?this.buttonElement.val():this.buttonElement.html());this._hoverable(this.buttonElement);
this.buttonElement.addClass("ui-button ui-widget ui-state-default ui-corner-all").attr("role","button").bind("mouseenter"+this.eventNamespace,function(){p.disabled||this===e&&d(this).addClass("ui-state-active")}).bind("mouseleave"+this.eventNamespace,function(){p.disabled||d(this).removeClass(s)}).bind("click"+this.eventNamespace,function(d){p.disabled&&(d.preventDefault(),d.stopImmediatePropagation())});this.element.bind("focus"+this.eventNamespace,function(){n.buttonElement.addClass("ui-state-focus")}).bind("blur"+
this.eventNamespace,function(){n.buttonElement.removeClass("ui-state-focus")});q&&(this.element.bind("change"+this.eventNamespace,function(){k||n.refresh()}),this.buttonElement.bind("mousedown"+this.eventNamespace,function(d){p.disabled||(k=!1,f=d.pageX,h=d.pageY)}).bind("mouseup"+this.eventNamespace,function(d){p.disabled||(f!==d.pageX||h!==d.pageY)&&(k=!0)}));"checkbox"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){return p.disabled||k?!1:void 0}):"radio"===this.type?
this.buttonElement.bind("click"+this.eventNamespace,function(){if(p.disabled||k)return!1;d(this).addClass("ui-state-active");n.buttonElement.attr("aria-pressed","true");var e=n.element[0];m(e).not(e).map(function(){return d(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown"+this.eventNamespace,function(){return p.disabled?!1:(d(this).addClass("ui-state-active"),e=this,n.document.one("mouseup",function(){e=null}),void 0)}).bind("mouseup"+
this.eventNamespace,function(){return p.disabled?!1:(d(this).removeClass("ui-state-active"),void 0)}).bind("keydown"+this.eventNamespace,function(e){return p.disabled?!1:((e.keyCode===d.ui.keyCode.SPACE||e.keyCode===d.ui.keyCode.ENTER)&&d(this).addClass("ui-state-active"),void 0)}).bind("keyup"+this.eventNamespace+" blur"+this.eventNamespace,function(){d(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(e){e.keyCode===d.ui.keyCode.SPACE&&d(this).click()}));
this._setOption("disabled",p.disabled);this._resetButton()},_determineButtonType:function(){var d,e,f;this.type=this.element.is("[type=checkbox]")?"checkbox":this.element.is("[type=radio]")?"radio":this.element.is("input")?"input":"button";"checkbox"===this.type||"radio"===this.type?(d=this.element.parents().last(),e="label[for='"+this.element.attr("id")+"']",this.buttonElement=d.find(e),this.buttonElement.length||(d=d.length?d.siblings():this.element.siblings(),this.buttonElement=d.filter(e),this.buttonElement.length||
(this.buttonElement=d.find(e))),this.element.addClass("ui-helper-hidden-accessible"),f=this.element.is(":checked"),f&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.prop("aria-pressed",f)):this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible");this.buttonElement.removeClass("ui-button ui-widget ui-state-default ui-corner-all ui-state-hover ui-state-active  ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only").removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html());
this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(d,e){return this._super(d,e),"disabled"===d?(e?this.element.prop("disabled",!0):this.element.prop("disabled",!1),void 0):(this._resetButton(),void 0)},refresh:function(){var e=this.element.is("input, button")?this.element.is(":disabled"):this.element.hasClass("ui-button-disabled");e!==this.options.disabled&&this._setOption("disabled",e);"radio"===this.type?m(this.element[0]).each(function(){d(this).is(":checked")?d(this).button("widget").addClass("ui-state-active").attr("aria-pressed",
"true"):d(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}):"checkbox"===this.type&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if("input"===this.type)return this.options.label&&this.element.val(this.options.label),void 0;var e=this.buttonElement.removeClass("ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only"),
f=d("<span></span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(e.empty()).text(),h=this.options.icons,k=h.primary&&h.secondary,m=[];h.primary||h.secondary?(this.options.text&&m.push("ui-button-text-icon"+(k?"s":h.primary?"-primary":"-secondary")),h.primary&&e.prepend("<span class='ui-button-icon-primary ui-icon "+h.primary+"'></span>"),h.secondary&&e.append("<span class='ui-button-icon-secondary ui-icon "+h.secondary+"'></span>"),this.options.text||(m.push(k?"ui-button-icons-only":
"ui-button-icon-only"),this.hasTitle||e.attr("title",d.trim(f)))):m.push("ui-button-text-only");e.addClass(m.join(" "))}});d.widget("ui.buttonset",{version:"1.10.3",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(ui-button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(d,e){"disabled"===d&&this.buttons.button("option",d,e);this._super(d,e)},refresh:function(){var e=
"rtl"===this.element.css("direction");this.buttons=this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function(){return d(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(e?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(e?"ui-corner-left":"ui-corner-right").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset");this.buttons.map(function(){return d(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}})})(jQuery);
(function(d,e){function f(){this._curInst=null;this._keyEvent=!1;this._disabledInputs=[];this._inDialog=this._datepickerShowing=!1;this._mainDivId="ui-datepicker-div";this._inlineClass="ui-datepicker-inline";this._appendClass="ui-datepicker-append";this._triggerClass="ui-datepicker-trigger";this._dialogClass="ui-datepicker-dialog";this._disableClass="ui-datepicker-disabled";this._unselectableClass="ui-datepicker-unselectable";this._currentClass="ui-datepicker-current-day";this._dayOverClass="ui-datepicker-days-cell-over";
this.regional=[];this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:"January February March April May June July August September October November December".split(" "),monthNamesShort:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),dayNames:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),dayNamesShort:"Sun Mon Tue Wed Thu Fri Sat".split(" "),dayNamesMin:"Su Mo Tu We Th Fr Sa".split(" "),weekHeader:"Wk",dateFormat:"mm/dd/yy",
firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""};this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,
onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1};d.extend(this._defaults,this.regional[""]);this.dpDiv=h(d("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function h(e){return e.delegate("button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a","mouseout",function(){d(this).removeClass("ui-state-hover");
-1!==this.className.indexOf("ui-datepicker-prev")&&d(this).removeClass("ui-datepicker-prev-hover");-1!==this.className.indexOf("ui-datepicker-next")&&d(this).removeClass("ui-datepicker-next-hover")}).delegate("button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a","mouseover",function(){d.datepicker._isDisabledDatepicker(l.inline?e.parent()[0]:l.input[0])||(d(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),d(this).addClass("ui-state-hover"),
-1!==this.className.indexOf("ui-datepicker-prev")&&d(this).addClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&d(this).addClass("ui-datepicker-next-hover"))})}function k(e,f){d.extend(e,f);for(var h in f)null==f[h]&&(e[h]=f[h]);return e}d.extend(d.ui,{datepicker:{version:"1.10.3"}});var l;d.extend(f.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(d){return k(this._defaults,d||{}),this},_attachDatepicker:function(e,
f){var h,k,l;h=e.nodeName.toLowerCase();k="div"===h||"span"===h;e.id||(this.uuid+=1,e.id="dp"+this.uuid);l=this._newInst(d(e),k);l.settings=d.extend({},f||{});"input"===h?this._connectDatepicker(e,l):k&&this._inlineDatepicker(e,l)},_newInst:function(e,f){return{id:e[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1"),input:e,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:f,dpDiv:f?h(d("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):
this.dpDiv}},_connectDatepicker:function(e,f){var h=d(e);f.append=d([]);f.trigger=d([]);h.hasClass(this.markerClassName)||(this._attachments(h,f),h.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp),this._autoSize(f),d.data(e,"datepicker",f),f.settings.disabled&&this._disableDatepicker(e))},_attachments:function(e,f){var h,k,l;h=this._get(f,"appendText");var t=this._get(f,"isRTL");f.append&&f.append.remove();h&&(f.append=d("<span class='"+this._appendClass+
"'>"+h+"</span>"),e[t?"before":"after"](f.append));e.unbind("focus",this._showDatepicker);f.trigger&&f.trigger.remove();h=this._get(f,"showOn");("focus"===h||"both"===h)&&e.focus(this._showDatepicker);("button"===h||"both"===h)&&(k=this._get(f,"buttonText"),l=this._get(f,"buttonImage"),f.trigger=d(this._get(f,"buttonImageOnly")?d("<img/>").addClass(this._triggerClass).attr({src:l,alt:k,title:k}):d("<button type='button'></button>").addClass(this._triggerClass).html(l?d("<img/>").attr({src:l,alt:k,
title:k}):k)),e[t?"before":"after"](f.trigger),f.trigger.click(function(){return d.datepicker._datepickerShowing&&d.datepicker._lastInput===e[0]?d.datepicker._hideDatepicker():d.datepicker._datepickerShowing&&d.datepicker._lastInput!==e[0]?(d.datepicker._hideDatepicker(),d.datepicker._showDatepicker(e[0])):d.datepicker._showDatepicker(e[0]),!1}))},_autoSize:function(d){if(this._get(d,"autoSize")&&!d.inline){var e,f,h,k,l=new Date(2009,11,20),u=this._get(d,"dateFormat");u.match(/[DM]/)&&(e=function(d){for(k=
h=f=0;d.length>k;k++)d[k].length>f&&(f=d[k].length,h=k);return h},l.setMonth(e(this._get(d,u.match(/MM/)?"monthNames":"monthNamesShort"))),l.setDate(e(this._get(d,u.match(/DD/)?"dayNames":"dayNamesShort"))+20-l.getDay()));d.input.attr("size",this._formatDate(d,l).length)}},_inlineDatepicker:function(e,f){var h=d(e);h.hasClass(this.markerClassName)||(h.addClass(this.markerClassName).append(f.dpDiv),d.data(e,"datepicker",f),this._setDate(f,this._getDefaultDate(f),!0),this._updateDatepicker(f),this._updateAlternate(f),
f.settings.disabled&&this._disableDatepicker(e),f.dpDiv.css("display","block"))},_dialogDatepicker:function(e,f,h,l,s){var t,u,v,x,y;e=this._dialogInst;return e||(this.uuid+=1,t="dp"+this.uuid,this._dialogInput=d("<input type='text' id='"+t+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.keydown(this._doKeyDown),d("body").append(this._dialogInput),e=this._dialogInst=this._newInst(this._dialogInput,!1),e.settings={},d.data(this._dialogInput[0],"datepicker",e)),k(e.settings,
l||{}),f=f&&f.constructor===Date?this._formatDate(e,f):f,this._dialogInput.val(f),this._pos=s?s.length?s:[s.pageX,s.pageY]:null,this._pos||(u=document.documentElement.clientWidth,v=document.documentElement.clientHeight,x=document.documentElement.scrollLeft||document.body.scrollLeft,y=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[u/2-100+x,v/2-150+y]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),e.settings.onSelect=h,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),
this._showDatepicker(this._dialogInput[0]),d.blockUI&&d.blockUI(this.dpDiv),d.data(this._dialogInput[0],"datepicker",e),this},_destroyDatepicker:function(e){var f,h=d(e),k=d.data(e,"datepicker");h.hasClass(this.markerClassName)&&(f=e.nodeName.toLowerCase(),d.removeData(e,"datepicker"),"input"===f?(k.append.remove(),k.trigger.remove(),h.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):
("div"===f||"span"===f)&&h.removeClass(this.markerClassName).empty())},_enableDatepicker:function(e){var f,h,k=d(e),l=d.data(e,"datepicker");k.hasClass(this.markerClassName)&&(f=e.nodeName.toLowerCase(),"input"===f?(e.disabled=!1,l.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})):("div"===f||"span"===f)&&(h=k.children("."+this._inlineClass),h.children().removeClass("ui-state-disabled"),h.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",
!1)),this._disabledInputs=d.map(this._disabledInputs,function(d){return d===e?null:d}))},_disableDatepicker:function(e){var f,h,k=d(e),l=d.data(e,"datepicker");k.hasClass(this.markerClassName)&&(f=e.nodeName.toLowerCase(),"input"===f?(e.disabled=!0,l.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})):("div"===f||"span"===f)&&(h=k.children("."+this._inlineClass),h.children().addClass("ui-state-disabled"),h.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",
!0)),this._disabledInputs=d.map(this._disabledInputs,function(d){return d===e?null:d}),this._disabledInputs[this._disabledInputs.length]=e)},_isDisabledDatepicker:function(d){if(!d)return!1;for(var e=0;this._disabledInputs.length>e;e++)if(this._disabledInputs[e]===d)return!0;return!1},_getInst:function(e){try{return d.data(e,"datepicker")}catch(f){throw"Missing instance data for this datepicker";}},_optionDatepicker:function(f,h,l){var q,s,t,u,v=this._getInst(f);return 2===arguments.length&&"string"==
typeof h?"defaults"===h?d.extend({},d.datepicker._defaults):v?"all"===h?d.extend({},v.settings):this._get(v,h):null:(q=h||{},"string"==typeof h&&(q={},q[h]=l),v&&(this._curInst===v&&this._hideDatepicker(),s=this._getDateDatepicker(f,!0),t=this._getMinMaxDate(v,"min"),u=this._getMinMaxDate(v,"max"),k(v.settings,q),null!==t&&q.dateFormat!==e&&q.minDate===e&&(v.settings.minDate=this._formatDate(v,t)),null!==u&&q.dateFormat!==e&&q.maxDate===e&&(v.settings.maxDate=this._formatDate(v,u)),"disabled"in q&&
(q.disabled?this._disableDatepicker(f):this._enableDatepicker(f)),this._attachments(d(f),v),this._autoSize(v),this._setDate(v,s),this._updateAlternate(v),this._updateDatepicker(v)),e)},_changeDatepicker:function(d,e,f){this._optionDatepicker(d,e,f)},_refreshDatepicker:function(d){(d=this._getInst(d))&&this._updateDatepicker(d)},_setDateDatepicker:function(d,e){var f=this._getInst(d);f&&(this._setDate(f,e),this._updateDatepicker(f),this._updateAlternate(f))},_getDateDatepicker:function(d,e){var f=
this._getInst(d);return f&&!f.inline&&this._setDateFromField(f,e),f?this._getDate(f):null},_doKeyDown:function(e){var f,h,k,l=d.datepicker._getInst(e.target),t=!0,u=l.dpDiv.is(".ui-datepicker-rtl");if(l._keyEvent=!0,d.datepicker._datepickerShowing)switch(e.keyCode){case 9:d.datepicker._hideDatepicker();t=!1;break;case 13:return k=d("td."+d.datepicker._dayOverClass+":not(."+d.datepicker._currentClass+")",l.dpDiv),k[0]&&d.datepicker._selectDay(e.target,l.selectedMonth,l.selectedYear,k[0]),f=d.datepicker._get(l,
"onSelect"),f?(h=d.datepicker._formatDate(l),f.apply(l.input?l.input[0]:null,[h,l])):d.datepicker._hideDatepicker(),!1;case 27:d.datepicker._hideDatepicker();break;case 33:d.datepicker._adjustDate(e.target,e.ctrlKey?-d.datepicker._get(l,"stepBigMonths"):-d.datepicker._get(l,"stepMonths"),"M");break;case 34:d.datepicker._adjustDate(e.target,e.ctrlKey?+d.datepicker._get(l,"stepBigMonths"):+d.datepicker._get(l,"stepMonths"),"M");break;case 35:(e.ctrlKey||e.metaKey)&&d.datepicker._clearDate(e.target);
t=e.ctrlKey||e.metaKey;break;case 36:(e.ctrlKey||e.metaKey)&&d.datepicker._gotoToday(e.target);t=e.ctrlKey||e.metaKey;break;case 37:(e.ctrlKey||e.metaKey)&&d.datepicker._adjustDate(e.target,u?1:-1,"D");t=e.ctrlKey||e.metaKey;e.originalEvent.altKey&&d.datepicker._adjustDate(e.target,e.ctrlKey?-d.datepicker._get(l,"stepBigMonths"):-d.datepicker._get(l,"stepMonths"),"M");break;case 38:(e.ctrlKey||e.metaKey)&&d.datepicker._adjustDate(e.target,-7,"D");t=e.ctrlKey||e.metaKey;break;case 39:(e.ctrlKey||e.metaKey)&&
d.datepicker._adjustDate(e.target,u?-1:1,"D");t=e.ctrlKey||e.metaKey;e.originalEvent.altKey&&d.datepicker._adjustDate(e.target,e.ctrlKey?+d.datepicker._get(l,"stepBigMonths"):+d.datepicker._get(l,"stepMonths"),"M");break;case 40:(e.ctrlKey||e.metaKey)&&d.datepicker._adjustDate(e.target,7,"D");t=e.ctrlKey||e.metaKey;break;default:t=!1}else 36===e.keyCode&&e.ctrlKey?d.datepicker._showDatepicker(this):t=!1;t&&(e.preventDefault(),e.stopPropagation())},_doKeyPress:function(f){var h,k,l=d.datepicker._getInst(f.target);
return d.datepicker._get(l,"constrainInput")?(h=d.datepicker._possibleChars(d.datepicker._get(l,"dateFormat")),k=String.fromCharCode(null==f.charCode?f.keyCode:f.charCode),f.ctrlKey||f.metaKey||" ">k||!h||-1<h.indexOf(k)):e},_doKeyUp:function(e){var f;e=d.datepicker._getInst(e.target);if(e.input.val()!==e.lastVal)try{(f=d.datepicker.parseDate(d.datepicker._get(e,"dateFormat"),e.input?e.input.val():null,d.datepicker._getFormatConfig(e)))&&(d.datepicker._setDateFromField(e),d.datepicker._updateAlternate(e),
d.datepicker._updateDatepicker(e))}catch(h){}return!0},_showDatepicker:function(e){if(e=e.target||e,"input"!==e.nodeName.toLowerCase()&&(e=d("input",e.parentNode)[0]),!d.datepicker._isDisabledDatepicker(e)&&d.datepicker._lastInput!==e){var f,h,l,s,t,u;f=d.datepicker._getInst(e);d.datepicker._curInst&&d.datepicker._curInst!==f&&(d.datepicker._curInst.dpDiv.stop(!0,!0),f&&d.datepicker._datepickerShowing&&d.datepicker._hideDatepicker(d.datepicker._curInst.input[0]));h=(h=d.datepicker._get(f,"beforeShow"))?
h.apply(e,[e,f]):{};!1!==h&&(k(f.settings,h),f.lastVal=null,d.datepicker._lastInput=e,d.datepicker._setDateFromField(f),d.datepicker._inDialog&&(e.value=""),d.datepicker._pos||(d.datepicker._pos=d.datepicker._findPos(e),d.datepicker._pos[1]+=e.offsetHeight),l=!1,d(e).parents().each(function(){return l|="fixed"===d(this).css("position"),!l}),s={left:d.datepicker._pos[0],top:d.datepicker._pos[1]},d.datepicker._pos=null,f.dpDiv.empty(),f.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),
d.datepicker._updateDatepicker(f),s=d.datepicker._checkOffset(f,s,l),f.dpDiv.css({position:d.datepicker._inDialog&&d.blockUI?"static":l?"fixed":"absolute",display:"none",left:s.left+"px",top:s.top+"px"}),f.inline||(t=d.datepicker._get(f,"showAnim"),u=d.datepicker._get(f,"duration"),f.dpDiv.zIndex(d(e).zIndex()+1),d.datepicker._datepickerShowing=!0,d.effects&&d.effects.effect[t]?f.dpDiv.show(t,d.datepicker._get(f,"showOptions"),u):f.dpDiv[t||"show"](t?u:null),d.datepicker._shouldFocusInput(f)&&f.input.focus(),
d.datepicker._curInst=f))}},_updateDatepicker:function(e){this.maxRows=4;l=e;e.dpDiv.empty().append(this._generateHTML(e));this._attachHandlers(e);e.dpDiv.find("."+this._dayOverClass+" a").mouseover();var f,h=this._getNumberOfMonths(e),k=h[1];e.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width("");1<k&&e.dpDiv.addClass("ui-datepicker-multi-"+k).css("width",17*k+"em");e.dpDiv[(1!==h[0]||1!==h[1]?"add":"remove")+"Class"]("ui-datepicker-multi");e.dpDiv[(this._get(e,
"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl");e===d.datepicker._curInst&&d.datepicker._datepickerShowing&&d.datepicker._shouldFocusInput(e)&&e.input.focus();e.yearshtml&&(f=e.yearshtml,setTimeout(function(){f===e.yearshtml&&e.yearshtml&&e.dpDiv.find("select.ui-datepicker-year:first").replaceWith(e.yearshtml);f=e.yearshtml=null},0))},_shouldFocusInput:function(d){return d.input&&d.input.is(":visible")&&!d.input.is(":disabled")&&!d.input.is(":focus")},_checkOffset:function(e,f,h){var k=e.dpDiv.outerWidth(),
l=e.dpDiv.outerHeight(),t=e.input?e.input.outerWidth():0,u=e.input?e.input.outerHeight():0,v=document.documentElement.clientWidth+(h?0:d(document).scrollLeft()),x=document.documentElement.clientHeight+(h?0:d(document).scrollTop());return f.left-=this._get(e,"isRTL")?k-t:0,f.left-=h&&f.left===e.input.offset().left?d(document).scrollLeft():0,f.top-=h&&f.top===e.input.offset().top+u?d(document).scrollTop():0,f.left-=Math.min(f.left,f.left+k>v&&v>k?Math.abs(f.left+k-v):0),f.top-=Math.min(f.top,f.top+
l>x&&x>l?Math.abs(l+u):0),f},_findPos:function(e){for(var f,h=this._getInst(e),h=this._get(h,"isRTL");e&&("hidden"===e.type||1!==e.nodeType||d.expr.filters.hidden(e));)e=e[h?"previousSibling":"nextSibling"];return f=d(e).offset(),[f.left,f.top]},_hideDatepicker:function(e){var f,h,k,l,t=this._curInst;!t||e&&t!==d.data(e,"datepicker")||this._datepickerShowing&&(f=this._get(t,"showAnim"),h=this._get(t,"duration"),k=function(){d.datepicker._tidyDialog(t)},d.effects&&(d.effects.effect[f]||d.effects[f])?
t.dpDiv.hide(f,d.datepicker._get(t,"showOptions"),h,k):t.dpDiv["slideDown"===f?"slideUp":"fadeIn"===f?"fadeOut":"hide"](f?h:null,k),f||k(),this._datepickerShowing=!1,l=this._get(t,"onClose"),l&&l.apply(t.input?t.input[0]:null,[t.input?t.input.val():"",t]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),d.blockUI&&(d.unblockUI(),d("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(d){d.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},
_checkExternalClick:function(e){if(d.datepicker._curInst){e=d(e.target);var f=d.datepicker._getInst(e[0]);(e[0].id!==d.datepicker._mainDivId&&0===e.parents("#"+d.datepicker._mainDivId).length&&!e.hasClass(d.datepicker.markerClassName)&&!e.closest("."+d.datepicker._triggerClass).length&&d.datepicker._datepickerShowing&&(!d.datepicker._inDialog||!d.blockUI)||e.hasClass(d.datepicker.markerClassName)&&d.datepicker._curInst!==f)&&d.datepicker._hideDatepicker()}},_adjustDate:function(e,f,h){e=d(e);var k=
this._getInst(e[0]);this._isDisabledDatepicker(e[0])||(this._adjustInstDate(k,f+("M"===h?this._get(k,"showCurrentAtPos"):0),h),this._updateDatepicker(k))},_gotoToday:function(e){var f;e=d(e);var h=this._getInst(e[0]);this._get(h,"gotoCurrent")&&h.currentDay?(h.selectedDay=h.currentDay,h.drawMonth=h.selectedMonth=h.currentMonth,h.drawYear=h.selectedYear=h.currentYear):(f=new Date,h.selectedDay=f.getDate(),h.drawMonth=h.selectedMonth=f.getMonth(),h.drawYear=h.selectedYear=f.getFullYear());this._notifyChange(h);
this._adjustDate(e)},_selectMonthYear:function(e,f,h){e=d(e);var k=this._getInst(e[0]);k["selected"+("M"===h?"Month":"Year")]=k["draw"+("M"===h?"Month":"Year")]=parseInt(f.options[f.selectedIndex].value,10);this._notifyChange(k);this._adjustDate(e)},_selectDay:function(e,f,h,k){var l,t=d(e);d(k).hasClass(this._unselectableClass)||this._isDisabledDatepicker(t[0])||(l=this._getInst(t[0]),l.selectedDay=l.currentDay=d("a",k).html(),l.selectedMonth=l.currentMonth=f,l.selectedYear=l.currentYear=h,this._selectDate(e,
this._formatDate(l,l.currentDay,l.currentMonth,l.currentYear)))},_clearDate:function(e){e=d(e);this._selectDate(e,"")},_selectDate:function(e,f){var h;h=d(e);var k=this._getInst(h[0]);f=null!=f?f:this._formatDate(k);k.input&&k.input.val(f);this._updateAlternate(k);(h=this._get(k,"onSelect"))?h.apply(k.input?k.input[0]:null,[f,k]):k.input&&k.input.trigger("change");k.inline?this._updateDatepicker(k):(this._hideDatepicker(),this._lastInput=k.input[0],"object"!=typeof k.input[0]&&k.input.focus(),this._lastInput=
null)},_updateAlternate:function(e){var f,h,k,l=this._get(e,"altField");l&&(f=this._get(e,"altFormat")||this._get(e,"dateFormat"),h=this._getDate(e),k=this.formatDate(f,h,this._getFormatConfig(e)),d(l).each(function(){d(this).val(k)}))},noWeekends:function(d){d=d.getDay();return[0<d&&6>d,""]},iso8601Week:function(d){var e;d=new Date(d.getTime());return d.setDate(d.getDate()+4-(d.getDay()||7)),e=d.getTime(),d.setMonth(0),d.setDate(1),Math.floor(Math.round((e-d)/864E5)/7)+1},parseDate:function(f,h,
k){if(null==f||null==h)throw"Invalid arguments";if(h="object"==typeof h?""+h:h+"",""===h)return null;var l,s,t,u,v=0,x=(k?k.shortYearCutoff:null)||this._defaults.shortYearCutoff,x="string"!=typeof x?x:(new Date).getFullYear()%100+parseInt(x,10),y=(k?k.dayNamesShort:null)||this._defaults.dayNamesShort,z=(k?k.dayNames:null)||this._defaults.dayNames,A=(k?k.monthNamesShort:null)||this._defaults.monthNamesShort;k=(k?k.monthNames:null)||this._defaults.monthNames;var G=-1,E=-1,B=-1,w=-1,C=!1,U=function(d){d=
f.length>l+1&&f.charAt(l+1)===d;return d&&l++,d},F=function(d){var e=U(d);d=RegExp("^\\d{1,"+("@"===d?14:"!"===d?20:"y"===d&&e?4:"o"===d?3:2)+"}");d=h.substring(v).match(d);if(!d)throw"Missing number at position "+v;return v+=d[0].length,parseInt(d[0],10)},T=function(f,k,l){var m=-1;f=d.map(U(f)?l:k,function(d,e){return[[e,d]]}).sort(function(d,e){return-(d[1].length-e[1].length)});if(d.each(f,function(d,f){var k=f[1];return h.substr(v,k.length).toLowerCase()===k.toLowerCase()?(m=f[0],v+=k.length,
!1):e}),-1!==m)return m+1;throw"Unknown name at position "+v;},O=function(){if(h.charAt(v)!==f.charAt(l))throw"Unexpected literal at position "+v;v++};for(l=0;f.length>l;l++)if(C)"'"!==f.charAt(l)||U("'")?O():C=!1;else switch(f.charAt(l)){case "d":B=F("d");break;case "D":T("D",y,z);break;case "o":w=F("o");break;case "m":E=F("m");break;case "M":E=T("M",A,k);break;case "y":G=F("y");break;case "@":u=new Date(F("@"));G=u.getFullYear();E=u.getMonth()+1;B=u.getDate();break;case "!":u=new Date((F("!")-this._ticksTo1970)/
1E4);G=u.getFullYear();E=u.getMonth()+1;B=u.getDate();break;case "'":U("'")?O():C=!0;break;default:O()}if(h.length>v&&(t=h.substr(v),!/^\s+/.test(t)))throw"Extra/unparsed characters found in date: "+t;if(-1===G?G=(new Date).getFullYear():100>G&&(G+=(new Date).getFullYear()-(new Date).getFullYear()%100+(x>=G?0:-100)),-1<w){E=1;for(B=w;!(s=this._getDaysInMonth(G,E-1),s>=B);)E++,B-=s}if(u=this._daylightSavingAdjust(new Date(G,E-1,B)),u.getFullYear()!==G||u.getMonth()+1!==E||u.getDate()!==B)throw"Invalid date";
return u},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:864E9*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925)),formatDate:function(d,e,f){if(!e)return"";var h,k=(f?f.dayNamesShort:null)||this._defaults.dayNamesShort,l=(f?f.dayNames:null)||this._defaults.dayNames,u=(f?f.monthNamesShort:null)||this._defaults.monthNamesShort;
f=(f?f.monthNames:null)||this._defaults.monthNames;var v=function(e){e=d.length>h+1&&d.charAt(h+1)===e;return e&&h++,e},x=function(d,e,f){e=""+e;if(v(d))for(;f>e.length;)e="0"+e;return e},y=function(d,e,f,h){return v(d)?h[e]:f[e]},z="",A=!1;if(e)for(h=0;d.length>h;h++)if(A)"'"!==d.charAt(h)||v("'")?z+=d.charAt(h):A=!1;else switch(d.charAt(h)){case "d":z+=x("d",e.getDate(),2);break;case "D":z+=y("D",e.getDay(),k,l);break;case "o":z+=x("o",Math.round(((new Date(e.getFullYear(),e.getMonth(),e.getDate())).getTime()-
(new Date(e.getFullYear(),0,0)).getTime())/864E5),3);break;case "m":z+=x("m",e.getMonth()+1,2);break;case "M":z+=y("M",e.getMonth(),u,f);break;case "y":z+=v("y")?e.getFullYear():(10>e.getYear()%100?"0":"")+e.getYear()%100;break;case "@":z+=e.getTime();break;case "!":z+=1E4*e.getTime()+this._ticksTo1970;break;case "'":v("'")?z+="'":A=!0;break;default:z+=d.charAt(h)}return z},_possibleChars:function(d){var e,f="",h=!1,k=function(f){f=d.length>e+1&&d.charAt(e+1)===f;return f&&e++,f};for(e=0;d.length>
e;e++)if(h)"'"!==d.charAt(e)||k("'")?f+=d.charAt(e):h=!1;else switch(d.charAt(e)){case "d":case "m":case "y":case "@":f+="0123456789";break;case "D":case "M":return null;case "'":k("'")?f+="'":h=!0;break;default:f+=d.charAt(e)}return f},_get:function(d,f){return d.settings[f]!==e?d.settings[f]:this._defaults[f]},_setDateFromField:function(d,e){if(d.input.val()!==d.lastVal){var f=this._get(d,"dateFormat"),h=d.lastVal=d.input?d.input.val():null,k=this._getDefaultDate(d),l=k,u=this._getFormatConfig(d);
try{l=this.parseDate(f,h,u)||k}catch(v){h=e?"":h}d.selectedDay=l.getDate();d.drawMonth=d.selectedMonth=l.getMonth();d.drawYear=d.selectedYear=l.getFullYear();d.currentDay=h?l.getDate():0;d.currentMonth=h?l.getMonth():0;d.currentYear=h?l.getFullYear():0;this._adjustInstDate(d)}},_getDefaultDate:function(d){return this._restrictMinMax(d,this._determineDate(d,this._get(d,"defaultDate"),new Date))},_determineDate:function(e,f,h){var k=function(d){var e=new Date;return e.setDate(e.getDate()+d),e},l=function(f){try{return d.datepicker.parseDate(d.datepicker._get(e,
"dateFormat"),f,d.datepicker._getFormatConfig(e))}catch(h){}for(var k=(f.toLowerCase().match(/^c/)?d.datepicker._getDate(e):null)||new Date,l=k.getFullYear(),n=k.getMonth(),k=k.getDate(),p=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,q=p.exec(f);q;){switch(q[2]||"d"){case "d":case "D":k+=parseInt(q[1],10);break;case "w":case "W":k+=7*parseInt(q[1],10);break;case "m":case "M":n+=parseInt(q[1],10);k=Math.min(k,d.datepicker._getDaysInMonth(l,n));break;case "y":case "Y":l+=parseInt(q[1],10),k=Math.min(k,d.datepicker._getDaysInMonth(l,
n))}q=p.exec(f)}return new Date(l,n,k)};f=null==f||""===f?h:"string"==typeof f?l(f):"number"==typeof f?isNaN(f)?h:k(f):new Date(f.getTime());return f=f&&"Invalid Date"==""+f?h:f,f&&(f.setHours(0),f.setMinutes(0),f.setSeconds(0),f.setMilliseconds(0)),this._daylightSavingAdjust(f)},_daylightSavingAdjust:function(d){return d?(d.setHours(12<d.getHours()?d.getHours()+2:0),d):null},_setDate:function(d,e,f){var h=!e,k=d.selectedMonth,l=d.selectedYear;e=this._restrictMinMax(d,this._determineDate(d,e,new Date));
d.selectedDay=d.currentDay=e.getDate();d.drawMonth=d.selectedMonth=d.currentMonth=e.getMonth();d.drawYear=d.selectedYear=d.currentYear=e.getFullYear();k===d.selectedMonth&&l===d.selectedYear||f||this._notifyChange(d);this._adjustInstDate(d);d.input&&d.input.val(h?"":this._formatDate(d))},_getDate:function(d){return!d.currentYear||d.input&&""===d.input.val()?null:this._daylightSavingAdjust(new Date(d.currentYear,d.currentMonth,d.currentDay))},_attachHandlers:function(e){var f=this._get(e,"stepMonths"),
h="#"+e.id.replace(/\\\\/g,"\\");e.dpDiv.find("[data-handler]").map(function(){d(this).bind(this.getAttribute("data-event"),{prev:function(){d.datepicker._adjustDate(h,-f,"M")},next:function(){d.datepicker._adjustDate(h,+f,"M")},hide:function(){d.datepicker._hideDatepicker()},today:function(){d.datepicker._gotoToday(h)},selectDay:function(){return d.datepicker._selectDay(h,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return d.datepicker._selectMonthYear(h,
this,"M"),!1},selectYear:function(){return d.datepicker._selectMonthYear(h,this,"Y"),!1}}[this.getAttribute("data-handler")])})},_generateHTML:function(d){var e,f,h,k,l,u,v,x,y,z,A,G,E,B,w,C,U,F,T,O,M,L,aa,da,ja,ba,W,ga=new Date,ga=this._daylightSavingAdjust(new Date(ga.getFullYear(),ga.getMonth(),ga.getDate())),K=this._get(d,"isRTL");u=this._get(d,"showButtonPanel");h=this._get(d,"hideIfNoPrevNext");l=this._get(d,"navigationAsDateFormat");var Z=this._getNumberOfMonths(d),Q=this._get(d,"showCurrentAtPos");
k=this._get(d,"stepMonths");var pa=1!==Z[0]||1!==Z[1],J=this._daylightSavingAdjust(d.currentDay?new Date(d.currentYear,d.currentMonth,d.currentDay):new Date(9999,9,9)),ia=this._getMinMaxDate(d,"min"),la=this._getMinMaxDate(d,"max"),Q=d.drawMonth-Q,X=d.drawYear;if(0>Q&&(Q+=12,X--),la){e=this._daylightSavingAdjust(new Date(la.getFullYear(),la.getMonth()-Z[0]*Z[1]+1,la.getDate()));for(e=ia&&ia>e?ia:e;this._daylightSavingAdjust(new Date(X,Q,1))>e;)Q--,0>Q&&(Q=11,X--)}d.drawMonth=Q;d.drawYear=X;e=this._get(d,
"prevText");e=l?this.formatDate(e,this._daylightSavingAdjust(new Date(X,Q-k,1)),this._getFormatConfig(d)):e;e=this._canAdjustMonth(d,-1,X,Q)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+e+"'><span class='ui-icon ui-icon-circle-triangle-"+(K?"e":"w")+"'>"+e+"</span></a>":h?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+e+"'><span class='ui-icon ui-icon-circle-triangle-"+(K?"e":"w")+"'>"+e+"</span></a>";f=this._get(d,"nextText");
f=l?this.formatDate(f,this._daylightSavingAdjust(new Date(X,Q+k,1)),this._getFormatConfig(d)):f;h=this._canAdjustMonth(d,1,X,Q)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+f+"'><span class='ui-icon ui-icon-circle-triangle-"+(K?"w":"e")+"'>"+f+"</span></a>":h?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+f+"'><span class='ui-icon ui-icon-circle-triangle-"+(K?"w":"e")+"'>"+f+"</span></a>";k=this._get(d,"currentText");f=this._get(d,
"gotoCurrent")&&d.currentDay?J:ga;k=l?this.formatDate(k,f,this._getFormatConfig(d)):k;l=d.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(d,"closeText")+"</button>";u=u?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(K?l:"")+(this._isInRange(d,f)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+
k+"</button>":"")+(K?"":l)+"</div>":"";l=parseInt(this._get(d,"firstDay"),10);l=isNaN(l)?0:l;k=this._get(d,"showWeek");f=this._get(d,"dayNames");v=this._get(d,"dayNamesMin");x=this._get(d,"monthNames");y=this._get(d,"monthNamesShort");z=this._get(d,"beforeShowDay");A=this._get(d,"showOtherMonths");G=this._get(d,"selectOtherMonths");E=this._getDefaultDate(d);B="";for(C=0;Z[0]>C;C++){U="";this.maxRows=4;for(F=0;Z[1]>F;F++){if(T=this._daylightSavingAdjust(new Date(X,Q,d.selectedDay)),w=" ui-corner-all",
O="",pa){if(O+="<div class='ui-datepicker-group",1<Z[1])switch(F){case 0:O+=" ui-datepicker-group-first";w=" ui-corner-"+(K?"right":"left");break;case Z[1]-1:O+=" ui-datepicker-group-last";w=" ui-corner-"+(K?"left":"right");break;default:O+=" ui-datepicker-group-middle",w=""}O+="'>"}O+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+w+"'>"+(/all|left/.test(w)&&0===C?K?h:e:"")+(/all|right/.test(w)&&0===C?K?e:h:"")+this._generateMonthYearHeader(d,Q,X,ia,la,0<C||0<F,x,y)+"</div><table class='ui-datepicker-calendar'><thead><tr>";
M=k?"<th class='ui-datepicker-week-col'>"+this._get(d,"weekHeader")+"</th>":"";for(w=0;7>w;w++)L=(w+l)%7,M+="<th"+(5<=(w+l+6)%7?" class='ui-datepicker-week-end'":"")+"><span title='"+f[L]+"'>"+v[L]+"</span></th>";O+=M+"</tr></thead><tbody>";M=this._getDaysInMonth(X,Q);X===d.selectedYear&&Q===d.selectedMonth&&(d.selectedDay=Math.min(d.selectedDay,M));w=(this._getFirstDayOfMonth(X,Q)-l+7)%7;M=Math.ceil((w+M)/7);this.maxRows=M=pa?this.maxRows>M?this.maxRows:M:M;L=this._daylightSavingAdjust(new Date(X,
Q,1-w));for(aa=0;M>aa;aa++){O+="<tr>";da=k?"<td class='ui-datepicker-week-col'>"+this._get(d,"calculateWeek")(L)+"</td>":"";for(w=0;7>w;w++)ja=z?z.apply(d.input?d.input[0]:null,[L]):[!0,""],W=(ba=L.getMonth()!==Q)&&!G||!ja[0]||ia&&ia>L||la&&L>la,da+="<td class='"+(5<=(w+l+6)%7?" ui-datepicker-week-end":"")+(ba?" ui-datepicker-other-month":"")+(L.getTime()===T.getTime()&&Q===d.selectedMonth&&d._keyEvent||E.getTime()===L.getTime()&&E.getTime()===T.getTime()?" "+this._dayOverClass:"")+(W?" "+this._unselectableClass+
" ui-state-disabled":"")+(ba&&!A?"":" "+ja[1]+(L.getTime()===J.getTime()?" "+this._currentClass:"")+(L.getTime()===ga.getTime()?" ui-datepicker-today":""))+"'"+(ba&&!A||!ja[2]?"":" title='"+ja[2].replace(/'/g,"&#39;")+"'")+(W?"":" data-handler='selectDay' data-event='click' data-month='"+L.getMonth()+"' data-year='"+L.getFullYear()+"'")+">"+(ba&&!A?"&#xa0;":W?"<span class='ui-state-default'>"+L.getDate()+"</span>":"<a class='ui-state-default"+(L.getTime()===ga.getTime()?" ui-state-highlight":"")+
(L.getTime()===J.getTime()?" ui-state-active":"")+(ba?" ui-priority-secondary":"")+"' href='#'>"+L.getDate()+"</a>")+"</td>",L.setDate(L.getDate()+1),L=this._daylightSavingAdjust(L);O+=da+"</tr>"}Q++;11<Q&&(Q=0,X++);O+="</tbody></table>"+(pa?"</div>"+(0<Z[0]&&F===Z[1]-1?"<div class='ui-datepicker-row-break'></div>":""):"");U+=O}B+=U}return B+=u,d._keyEvent=!1,B},_generateMonthYearHeader:function(d,e,f,h,k,l,u,v){var x,y,z,A=this._get(d,"changeMonth"),G=this._get(d,"changeYear"),E=this._get(d,"showMonthAfterYear"),
B="<div class='ui-datepicker-title'>",w="";if(l||!A)w+="<span class='ui-datepicker-month'>"+u[e]+"</span>";else{u=h&&h.getFullYear()===f;x=k&&k.getFullYear()===f;w+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>";for(y=0;12>y;y++)(!u||y>=h.getMonth())&&(!x||k.getMonth()>=y)&&(w+="<option value='"+y+"'"+(y===e?" selected='selected'":"")+">"+v[y]+"</option>");w+="</select>"}if(E||(B+=w+(!l&&A&&G?"":"&#xa0;")),!d.yearshtml)if(d.yearshtml="",l||!G)B+="<span class='ui-datepicker-year'>"+
f+"</span>";else{v=this._get(d,"yearRange").split(":");z=(new Date).getFullYear();u=function(d){d=d.match(/c[+\-].*/)?f+parseInt(d.substring(1),10):d.match(/[+\-].*/)?z+parseInt(d,10):parseInt(d,10);return isNaN(d)?z:d};e=u(v[0]);v=Math.max(e,u(v[1]||""));e=h?Math.max(e,h.getFullYear()):e;v=k?Math.min(v,k.getFullYear()):v;for(d.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";v>=e;e++)d.yearshtml+="<option value='"+e+"'"+(e===f?" selected='selected'":
"")+">"+e+"</option>";d.yearshtml+="</select>";B+=d.yearshtml;d.yearshtml=null}return B+=this._get(d,"yearSuffix"),E&&(B+=(!l&&A&&G?"":"&#xa0;")+w),B+="</div>"},_adjustInstDate:function(d,e,f){var h=d.drawYear+("Y"===f?e:0),k=d.drawMonth+("M"===f?e:0);e=Math.min(d.selectedDay,this._getDaysInMonth(h,k))+("D"===f?e:0);h=this._restrictMinMax(d,this._daylightSavingAdjust(new Date(h,k,e)));d.selectedDay=h.getDate();d.drawMonth=d.selectedMonth=h.getMonth();d.drawYear=d.selectedYear=h.getFullYear();("M"===
f||"Y"===f)&&this._notifyChange(d)},_restrictMinMax:function(d,e){var f=this._getMinMaxDate(d,"min"),h=this._getMinMaxDate(d,"max"),f=f&&f>e?f:e;return h&&f>h?h:f},_notifyChange:function(d){var e=this._get(d,"onChangeMonthYear");e&&e.apply(d.input?d.input[0]:null,[d.selectedYear,d.selectedMonth+1,d])},_getNumberOfMonths:function(d){d=this._get(d,"numberOfMonths");return null==d?[1,1]:"number"==typeof d?[1,d]:d},_getMinMaxDate:function(d,e){return this._determineDate(d,this._get(d,e+"Date"),null)},
_getDaysInMonth:function(d,e){return 32-this._daylightSavingAdjust(new Date(d,e,32)).getDate()},_getFirstDayOfMonth:function(d,e){return(new Date(d,e,1)).getDay()},_canAdjustMonth:function(d,e,f,h){var k=this._getNumberOfMonths(d);f=this._daylightSavingAdjust(new Date(f,h+(0>e?e:k[0]*k[1]),1));return 0>e&&f.setDate(this._getDaysInMonth(f.getFullYear(),f.getMonth())),this._isInRange(d,f)},_isInRange:function(d,e){var f,h,k=this._getMinMaxDate(d,"min"),l=this._getMinMaxDate(d,"max"),u=null,v=null,x=
this._get(d,"yearRange");return x&&(f=x.split(":"),h=(new Date).getFullYear(),u=parseInt(f[0],10),v=parseInt(f[1],10),f[0].match(/[+\-].*/)&&(u+=h),f[1].match(/[+\-].*/)&&(v+=h)),(!k||e.getTime()>=k.getTime())&&(!l||e.getTime()<=l.getTime())&&(!u||e.getFullYear()>=u)&&(!v||v>=e.getFullYear())},_getFormatConfig:function(d){var e=this._get(d,"shortYearCutoff");return e="string"!=typeof e?e:(new Date).getFullYear()%100+parseInt(e,10),{shortYearCutoff:e,dayNamesShort:this._get(d,"dayNamesShort"),dayNames:this._get(d,
"dayNames"),monthNamesShort:this._get(d,"monthNamesShort"),monthNames:this._get(d,"monthNames")}},_formatDate:function(d,e,f,h){e||(d.currentDay=d.selectedDay,d.currentMonth=d.selectedMonth,d.currentYear=d.selectedYear);e=e?"object"==typeof e?e:this._daylightSavingAdjust(new Date(h,f,e)):this._daylightSavingAdjust(new Date(d.currentYear,d.currentMonth,d.currentDay));return this.formatDate(this._get(d,"dateFormat"),e,this._getFormatConfig(d))}});d.fn.datepicker=function(e){if(!this.length)return this;
d.datepicker.initialized||(d(document).mousedown(d.datepicker._checkExternalClick),d.datepicker.initialized=!0);0===d("#"+d.datepicker._mainDivId).length&&d("body").append(d.datepicker.dpDiv);var f=Array.prototype.slice.call(arguments,1);return"string"!=typeof e||"isDisabled"!==e&&"getDate"!==e&&"widget"!==e?"option"===e&&2===arguments.length&&"string"==typeof arguments[1]?d.datepicker["_"+e+"Datepicker"].apply(d.datepicker,[this[0]].concat(f)):this.each(function(){"string"==typeof e?d.datepicker["_"+
e+"Datepicker"].apply(d.datepicker,[this].concat(f)):d.datepicker._attachDatepicker(this,e)}):d.datepicker["_"+e+"Datepicker"].apply(d.datepicker,[this[0]].concat(f))};d.datepicker=new f;d.datepicker.initialized=!1;d.datepicker.uuid=(new Date).getTime();d.datepicker.version="1.10.3"})(jQuery);
(function(d){var e={buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},f={maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0};d.widget("ui.dialog",{version:"1.10.3",options:{appendTo:"body",autoOpen:!0,buttons:[],closeOnEscape:!0,closeText:"close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(e){var f=d(this).css(e).offset().top;
0>f&&d(this).css("top",e.top-f)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height};this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)};
this.originalTitle=this.element.attr("title");this.options.title=this.options.title||this.originalTitle;this._createWrapper();this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(this.uiDialog);this._createTitlebar();this._createButtonPane();this.options.draggable&&d.fn.draggable&&this._makeDraggable();this.options.resizable&&d.fn.resizable&&this._makeResizable();this._isOpen=!1},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var e=
this.options.appendTo;return e&&(e.jquery||e.nodeType)?d(e):this.document.find(e||"body").eq(0)},_destroy:function(){var d,e=this.originalPosition;this._destroyOverlay();this.element.removeUniqueId().removeClass("ui-dialog-content ui-widget-content").css(this.originalCss).detach();this.uiDialog.stop(!0,!0).remove();this.originalTitle&&this.element.attr("title",this.originalTitle);d=e.parent.children().eq(e.index);d.length&&d[0]!==this.element[0]?d.before(this.element):e.parent.append(this.element)},
widget:function(){return this.uiDialog},disable:d.noop,enable:d.noop,close:function(e){var f=this;this._isOpen&&!1!==this._trigger("beforeClose",e)&&(this._isOpen=!1,this._destroyOverlay(),this.opener.filter(":focusable").focus().length||d(this.document[0].activeElement).blur(),this._hide(this.uiDialog,this.options.hide,function(){f._trigger("close",e)}))},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(d,e){var f=!!this.uiDialog.nextAll(":visible").insertBefore(this.uiDialog).length;
return f&&!e&&this._trigger("focus",d),f},open:function(){var e=this;return this._isOpen?(this._moveToTop()&&this._focusTabbable(),void 0):(this._isOpen=!0,this.opener=d(this.document[0].activeElement),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this._show(this.uiDialog,this.options.show,function(){e._focusTabbable();e._trigger("focus")}),this._trigger("open"),void 0)},_focusTabbable:function(){var d=this.element.find("[autofocus]");d.length||(d=this.element.find(":tabbable"));
d.length||(d=this.uiDialogButtonPane.find(":tabbable"));d.length||(d=this.uiDialogTitlebarClose.filter(":tabbable"));d.length||(d=this.uiDialog);d.eq(0).focus()},_keepFocus:function(e){function f(){var e=this.document[0].activeElement;this.uiDialog[0]===e||d.contains(this.uiDialog[0],e)||this._focusTabbable()}e.preventDefault();f.call(this);this._delay(f)},_createWrapper:function(){this.uiDialog=d("<div>").addClass("ui-dialog ui-widget ui-widget-content ui-corner-all ui-front "+this.options.dialogClass).hide().attr({tabIndex:-1,
role:"dialog"}).appendTo(this._appendTo());this._on(this.uiDialog,{keydown:function(e){if(this.options.closeOnEscape&&!e.isDefaultPrevented()&&e.keyCode&&e.keyCode===d.ui.keyCode.ESCAPE)return e.preventDefault(),this.close(e),void 0;if(e.keyCode===d.ui.keyCode.TAB){var f=this.uiDialog.find(":tabbable"),l=f.filter(":first"),f=f.filter(":last");e.target!==f[0]&&e.target!==this.uiDialog[0]||e.shiftKey?e.target!==l[0]&&e.target!==this.uiDialog[0]||!e.shiftKey||(f.focus(1),e.preventDefault()):(l.focus(1),
e.preventDefault())}},mousedown:function(d){this._moveToTop(d)&&this._focusTabbable()}});this.element.find("[aria-describedby]").length||this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){var e;this.uiDialogTitlebar=d("<div>").addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(this.uiDialog);this._on(this.uiDialogTitlebar,{mousedown:function(e){d(e.target).closest(".ui-dialog-titlebar-close")||this.uiDialog.focus()}});
this.uiDialogTitlebarClose=d("<button></button>").button({label:this.options.closeText,icons:{primary:"ui-icon-closethick"},text:!1}).addClass("ui-dialog-titlebar-close").appendTo(this.uiDialogTitlebar);this._on(this.uiDialogTitlebarClose,{click:function(d){d.preventDefault();this.close(d)}});e=d("<span>").uniqueId().addClass("ui-dialog-title").prependTo(this.uiDialogTitlebar);this._title(e);this.uiDialog.attr({"aria-labelledby":e.attr("id")})},_title:function(d){this.options.title||d.html("&#160;");
d.text(this.options.title)},_createButtonPane:function(){this.uiDialogButtonPane=d("<div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix");this.uiButtonSet=d("<div>").addClass("ui-dialog-buttonset").appendTo(this.uiDialogButtonPane);this._createButtons()},_createButtons:function(){var e=this,f=this.options.buttons;return this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),d.isEmptyObject(f)||d.isArray(f)&&!f.length?(this.uiDialog.removeClass("ui-dialog-buttons"),void 0):
(d.each(f,function(f,k){var n,p;k=d.isFunction(k)?{click:k,text:f}:k;k=d.extend({type:"button"},k);n=k.click;k.click=function(){n.apply(e.element[0],arguments)};p={icons:k.icons,text:k.showText};delete k.icons;delete k.showText;d("<button></button>",k).button(p).appendTo(e.uiButtonSet)}),this.uiDialog.addClass("ui-dialog-buttons"),this.uiDialogButtonPane.appendTo(this.uiDialog),void 0)},_makeDraggable:function(){function e(d){return{position:d.position,offset:d.offset}}var f=this,l=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",
handle:".ui-dialog-titlebar",containment:"document",start:function(l,n){d(this).addClass("ui-dialog-dragging");f._blockFrames();f._trigger("dragStart",l,e(n))},drag:function(d,l){f._trigger("drag",d,e(l))},stop:function(m,n){l.position=[n.position.left-f.document.scrollLeft(),n.position.top-f.document.scrollTop()];d(this).removeClass("ui-dialog-dragging");f._unblockFrames();f._trigger("dragStop",m,e(n))}})},_makeResizable:function(){function e(d){return{originalPosition:d.originalPosition,originalSize:d.originalSize,
position:d.position,size:d.size}}var f=this,l=this.options,m=l.resizable,n=this.uiDialog.css("position"),m="string"==typeof m?m:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:l.maxWidth,maxHeight:l.maxHeight,minWidth:l.minWidth,minHeight:this._minHeight(),handles:m,start:function(l,m){d(this).addClass("ui-dialog-resizing");f._blockFrames();f._trigger("resizeStart",l,e(m))},resize:function(d,l){f._trigger("resize",
d,e(l))},stop:function(m,n){l.height=d(this).height();l.width=d(this).width();d(this).removeClass("ui-dialog-resizing");f._unblockFrames();f._trigger("resizeStop",m,e(n))}}).css("position",n)},_minHeight:function(){var d=this.options;return"auto"===d.height?d.minHeight:Math.min(d.minHeight,d.height)},_position:function(){var d=this.uiDialog.is(":visible");d||this.uiDialog.show();this.uiDialog.position(this.options.position);d||this.uiDialog.hide()},_setOptions:function(h){var k=this,l=!1,m={};d.each(h,
function(d,h){k._setOption(d,h);d in e&&(l=!0);d in f&&(m[d]=h)});l&&(this._size(),this._position());this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option",m)},_setOption:function(d,e){var f,m,n=this.uiDialog;"dialogClass"===d&&n.removeClass(this.options.dialogClass).addClass(e);"disabled"!==d&&(this._super(d,e),"appendTo"===d&&this.uiDialog.appendTo(this._appendTo()),"buttons"===d&&this._createButtons(),"closeText"===d&&this.uiDialogTitlebarClose.button({label:""+e}),"draggable"===
d&&(f=n.is(":data(ui-draggable)"),f&&!e&&n.draggable("destroy"),!f&&e&&this._makeDraggable()),"position"===d&&this._position(),"resizable"===d&&(m=n.is(":data(ui-resizable)"),m&&!e&&n.resizable("destroy"),m&&"string"==typeof e&&n.resizable("option","handles",e),m||!1===e||this._makeResizable()),"title"===d&&this._title(this.uiDialogTitlebar.find(".ui-dialog-title")))},_size:function(){var d,e,f,m=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0});m.minWidth>
m.width&&(m.width=m.minWidth);d=this.uiDialog.css({height:"auto",width:m.width}).outerHeight();e=Math.max(0,m.minHeight-d);f="number"==typeof m.maxHeight?Math.max(0,m.maxHeight-d):"none";"auto"===m.height?this.element.css({minHeight:e,maxHeight:f,height:"auto"}):this.element.height(Math.max(0,m.height-d));this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var e=
d(this);return d("<div>").css({position:"absolute",width:e.outerWidth(),height:e.outerHeight()}).appendTo(e.parent()).offset(e.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_allowInteraction:function(e){return d(e.target).closest(".ui-dialog").length?!0:!!d(e.target).closest(".ui-datepicker").length},_createOverlay:function(){if(this.options.modal){var e=this,f=this.widgetFullName;d.ui.dialog.overlayInstances||this._delay(function(){d.ui.dialog.overlayInstances&&
this.document.bind("focusin.dialog",function(l){e._allowInteraction(l)||(l.preventDefault(),d(".ui-dialog:visible:last .ui-dialog-content").data(f)._focusTabbable())})});this.overlay=d("<div>").addClass("ui-widget-overlay ui-front").appendTo(this._appendTo());this._on(this.overlay,{mousedown:"_keepFocus"});d.ui.dialog.overlayInstances++}},_destroyOverlay:function(){this.options.modal&&this.overlay&&(d.ui.dialog.overlayInstances--,d.ui.dialog.overlayInstances||this.document.unbind("focusin.dialog"),
this.overlay.remove(),this.overlay=null)}});d.ui.dialog.overlayInstances=0;!1!==d.uiBackCompat&&d.widget("ui.dialog",d.ui.dialog,{_position:function(){var e,f=this.options.position,l=[],m=[0,0];f?(("string"==typeof f||"object"==typeof f&&"0"in f)&&(l=f.split?f.split(" "):[f[0],f[1]],1===l.length&&(l[1]=l[0]),d.each(["left","top"],function(d,e){+l[d]===l[d]&&(m[d]=l[d],l[d]=e)}),f={my:l[0]+(0>m[0]?m[0]:"+"+m[0])+" "+l[1]+(0>m[1]?m[1]:"+"+m[1]),at:l.join(" ")}),f=d.extend({},d.ui.dialog.prototype.options.position,
f)):f=d.ui.dialog.prototype.options.position;(e=this.uiDialog.is(":visible"))||this.uiDialog.show();this.uiDialog.position(f);e||this.uiDialog.hide()}})})(jQuery);
(function(d){d.widget("ui.menu",{version:"1.10.3",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element;this.mouseHandled=!1;this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content ui-corner-all").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}).bind("click"+
this.eventNamespace,d.proxy(function(d){this.options.disabled&&d.preventDefault()},this));this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true");this._on({"mousedown .ui-menu-item > a":function(d){d.preventDefault()},"click .ui-state-disabled > a":function(d){d.preventDefault()},"click .ui-menu-item:has(a)":function(e){var f=d(e.target).closest(".ui-menu-item");!this.mouseHandled&&f.not(".ui-state-disabled").length&&(this.mouseHandled=!0,this.select(e),f.has(".ui-menu").length?
this.expand(e):this.element.is(":focus")||(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(e){var f=d(e.currentTarget);f.siblings().children(".ui-state-active").removeClass("ui-state-active");this.focus(e,f)},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(d,f){var h=this.active||this.element.children(".ui-menu-item").eq(0);f||this.focus(d,h)},blur:function(e){this._delay(function(){d.contains(this.element[0],
this.document[0].activeElement)||this.collapseAll(e)})},keydown:"_keydown"});this.refresh();this._on(this.document,{click:function(e){d(e.target).closest(".ui-menu").length||this.collapseAll(e);this.mouseHandled=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-corner-all ui-menu-icons").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show();
this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").children("a").removeUniqueId().removeClass("ui-corner-all ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var e=d(this);e.data("ui-menu-submenu-carat")&&e.remove()});this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(e){function f(d){return d.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,
"\\$&")}var h,k,l,m,n=!0;switch(e.keyCode){case d.ui.keyCode.PAGE_UP:this.previousPage(e);break;case d.ui.keyCode.PAGE_DOWN:this.nextPage(e);break;case d.ui.keyCode.HOME:this._move("first","first",e);break;case d.ui.keyCode.END:this._move("last","last",e);break;case d.ui.keyCode.UP:this.previous(e);break;case d.ui.keyCode.DOWN:this.next(e);break;case d.ui.keyCode.LEFT:this.collapse(e);break;case d.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(e);break;case d.ui.keyCode.ENTER:case d.ui.keyCode.SPACE:this._activate(e);
break;case d.ui.keyCode.ESCAPE:this.collapse(e);break;default:n=!1,h=this.previousFilter||"",k=String.fromCharCode(e.keyCode),l=!1,clearTimeout(this.filterTimer),k===h?l=!0:k=h+k,m=RegExp("^"+f(k),"i"),h=this.activeMenu.children(".ui-menu-item").filter(function(){return m.test(d(this).children("a").text())}),h=l&&-1!==h.index(this.active.next())?this.active.nextAll(".ui-menu-item"):h,h.length||(k=String.fromCharCode(e.keyCode),m=RegExp("^"+f(k),"i"),h=this.activeMenu.children(".ui-menu-item").filter(function(){return m.test(d(this).children("a").text())})),
h.length?(this.focus(e,h),1<h.length?(this.previousFilter=k,this.filterTimer=this._delay(function(){delete this.previousFilter},1E3)):delete this.previousFilter):delete this.previousFilter}n&&e.preventDefault()},_activate:function(d){this.active.is(".ui-state-disabled")||(this.active.children("a[aria-haspopup='true']").length?this.expand(d):this.select(d))},refresh:function(){var e,f=this.options.icons.submenu;e=this.element.find(this.options.menus);e.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-corner-all").hide().attr({role:this.options.role,
"aria-hidden":"true","aria-expanded":"false"}).each(function(){var e=d(this),k=e.prev("a"),l=d("<span>").addClass("ui-menu-icon ui-icon "+f).data("ui-menu-submenu-carat",!0);k.attr("aria-haspopup","true").prepend(l);e.attr("aria-labelledby",k.attr("id"))});e=e.add(this.element);e.children(":not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","presentation").children("a").uniqueId().addClass("ui-corner-all").attr({tabIndex:-1,role:this._itemRole()});e.children(":not(.ui-menu-item)").each(function(){var e=
d(this);/[^\-\u2014\u2013\s]/.test(e.text())||e.addClass("ui-widget-content ui-menu-divider")});e.children(".ui-state-disabled").attr("aria-disabled","true");this.active&&!d.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(d,f){"icons"===d&&this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(f.submenu);this._super(d,f)},focus:function(d,f){var h;this.blur(d,d&&
"focus"===d.type);this._scrollIntoView(f);this.active=f.first();h=this.active.children("a").addClass("ui-state-focus");this.options.role&&this.element.attr("aria-activedescendant",h.attr("id"));this.active.parent().closest(".ui-menu-item").children("a:first").addClass("ui-state-active");d&&"keydown"===d.type?this._close():this.timer=this._delay(function(){this._close()},this.delay);h=f.children(".ui-menu");h.length&&/^mouse/.test(d.type)&&this._startOpening(h);this.activeMenu=f.parent();this._trigger("focus",
d,{item:f})},_scrollIntoView:function(e){var f,h,k,l,m,n;this._hasScroll()&&(f=parseFloat(d.css(this.activeMenu[0],"borderTopWidth"))||0,h=parseFloat(d.css(this.activeMenu[0],"paddingTop"))||0,k=e.offset().top-this.activeMenu.offset().top-f-h,l=this.activeMenu.scrollTop(),m=this.activeMenu.height(),n=e.height(),0>k?this.activeMenu.scrollTop(l+k):k+n>m&&this.activeMenu.scrollTop(l+k-m+n))},blur:function(d,f){f||clearTimeout(this.timer);this.active&&(this.active.children("a").removeClass("ui-state-focus"),
this.active=null,this._trigger("blur",d,{item:this.active}))},_startOpening:function(d){clearTimeout(this.timer);"true"===d.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close();this._open(d)},this.delay))},_open:function(e){var f=d.extend({of:this.active},this.options.position);clearTimeout(this.timer);this.element.find(".ui-menu").not(e.parents(".ui-menu")).hide().attr("aria-hidden","true");e.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(f)},collapseAll:function(e,
f){clearTimeout(this.timer);this.timer=this._delay(function(){var h=f?this.element:d(e&&e.target).closest(this.element.find(".ui-menu"));h.length||(h=this.element);this._close(h);this.blur(e);this.activeMenu=h},this.delay)},_close:function(d){d||(d=this.active?this.active.parent():this.element);d.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find("a.ui-state-active").removeClass("ui-state-active")},collapse:function(d){var f=this.active&&this.active.parent().closest(".ui-menu-item",
this.element);f&&f.length&&(this._close(),this.focus(d,f))},expand:function(d){var f=this.active&&this.active.children(".ui-menu ").children(".ui-menu-item").first();f&&f.length&&(this._open(f.parent()),this._delay(function(){this.focus(d,f)}))},next:function(d){this._move("next","first",d)},previous:function(d){this._move("prev","last",d)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},
_move:function(d,f,h){var k;this.active&&(k="first"===d||"last"===d?this.active["first"===d?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[d+"All"](".ui-menu-item").eq(0));k&&k.length&&this.active||(k=this.activeMenu.children(".ui-menu-item")[f]());this.focus(h,k)},nextPage:function(e){var f,h,k;return this.active?(this.isLastItem()||(this._hasScroll()?(h=this.active.offset().top,k=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return f=d(this),0>f.offset().top-
h-k}),this.focus(e,f)):this.focus(e,this.activeMenu.children(".ui-menu-item")[this.active?"last":"first"]())),void 0):(this.next(e),void 0)},previousPage:function(e){var f,h,k;return this.active?(this.isFirstItem()||(this._hasScroll()?(h=this.active.offset().top,k=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return f=d(this),0<f.offset().top-h+k}),this.focus(e,f)):this.focus(e,this.activeMenu.children(".ui-menu-item").first())),void 0):(this.next(e),void 0)},_hasScroll:function(){return this.element.outerHeight()<
this.element.prop("scrollHeight")},select:function(e){this.active=this.active||d(e.target).closest(".ui-menu-item");var f={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(e,!0);this._trigger("select",e,f)}})})(jQuery);
(function(d,e){d.widget("ui.progressbar",{version:"1.10.3",options:{max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue();this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min});this.valueDiv=d("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element);this._refreshValue()},_destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow");
this.valueDiv.remove()},value:function(d){return d===e?this.options.value:(this.options.value=this._constrainedValue(d),this._refreshValue(),e)},_constrainedValue:function(d){return d===e&&(d=this.options.value),this.indeterminate=!1===d,"number"!=typeof d&&(d=0),this.indeterminate?!1:Math.min(this.options.max,Math.max(this.min,d))},_setOptions:function(d){var e=d.value;delete d.value;this._super(d);this.options.value=this._constrainedValue(e);this._refreshValue()},_setOption:function(d,e){"max"===
d&&(e=Math.max(this.min,e));this._super(d,e)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var e=this.options.value,h=this._percentage();this.valueDiv.toggle(this.indeterminate||e>this.min).toggleClass("ui-corner-right",e===this.options.max).width(h.toFixed(0)+"%");this.element.toggleClass("ui-progressbar-indeterminate",this.indeterminate);this.indeterminate?(this.element.removeAttr("aria-valuenow"),this.overlayDiv||
(this.overlayDiv=d("<div class='ui-progressbar-overlay'></div>").appendTo(this.valueDiv))):(this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":e}),this.overlayDiv&&(this.overlayDiv.remove(),this.overlayDiv=null));this.oldValue!==e&&(this.oldValue=e,this._trigger("change"));e===this.options.max&&this._trigger("complete")}})})(jQuery);
(function(d){d.widget("ui.slider",d.ui.mouse,{version:"1.10.3",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},_create:function(){this._mouseSliding=this._keySliding=!1;this._animateOff=!0;this._handleIndex=null;this._detectOrientation();this._mouseInit();this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all");this._refresh();
this._setOption("disabled",this.options.disabled);this._animateOff=!1},_refresh:function(){this._createRange();this._createHandles();this._setupEvents();this._refreshValue()},_createHandles:function(){var e,f;e=this.options;var h=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),k=[];f=e.values&&e.values.length||1;h.length>f&&(h.slice(f).remove(),h=h.slice(0,f));for(e=h.length;f>e;e++)k.push("<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>");
this.handles=h.add(d(k.join("")).appendTo(this.element));this.handle=this.handles.eq(0);this.handles.each(function(e){d(this).data("ui-slider-handle-index",e)})},_createRange:function(){var e=this.options,f="";e.range?(!0===e.range&&(e.values?e.values.length&&2!==e.values.length?e.values=[e.values[0],e.values[0]]:d.isArray(e.values)&&(e.values=e.values.slice(0)):e.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",
bottom:""}):(this.range=d("<div></div>").appendTo(this.element),f="ui-slider-range ui-widget-header ui-corner-all"),this.range.addClass(f+("min"===e.range||"max"===e.range?" ui-slider-range-"+e.range:""))):this.range=d([])},_setupEvents:function(){var d=this.handles.add(this.range).filter("a");this._off(d);this._on(d,this._handleEvents);this._hoverable(d);this._focusable(d)},_destroy:function(){this.handles.remove();this.range.remove();this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all");
this._mouseDestroy()},_mouseCapture:function(e){var f,h,k,l,m,n,p,q,s=this,t=this.options;return t.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),f={x:e.pageX,y:e.pageY},h=this._normValueFromMouse(f),k=this._valueMax()-this._valueMin()+1,this.handles.each(function(e){var f=Math.abs(h-s.values(e));(k>f||k===f&&(e===s._lastChangedValue||s.values(e)===t.min))&&(k=f,l=d(this),m=e)}),n=this._start(e,m),!1===n?!1:
(this._mouseSliding=!0,this._handleIndex=m,l.addClass("ui-state-active").focus(),p=l.offset(),q=!d(e.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=q?{left:0,top:0}:{left:e.pageX-p.left-l.width()/2,top:e.pageY-p.top-l.height()/2-(parseInt(l.css("borderTopWidth"),10)||0)-(parseInt(l.css("borderBottomWidth"),10)||0)+(parseInt(l.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(e,m,h),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(d){var f=
this._normValueFromMouse({x:d.pageX,y:d.pageY});return this._slide(d,this._handleIndex,f),!1},_mouseStop:function(d){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(d,this._handleIndex),this._change(d,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(d){var f,h,k,l,m;return"horizontal"===
this.orientation?(f=this.elementSize.width,h=d.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(f=this.elementSize.height,h=d.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),k=h/f,1<k&&(k=1),0>k&&(k=0),"vertical"===this.orientation&&(k=1-k),l=this._valueMax()-this._valueMin(),m=this._valueMin()+k*l,this._trimAlignValue(m)},_start:function(d,f){var h={handle:this.handles[f],value:this.value()};return this.options.values&&this.options.values.length&&(h.value=
this.values(f),h.values=this.values()),this._trigger("start",d,h)},_slide:function(d,f,h){var k,l,m;this.options.values&&this.options.values.length?(k=this.values(f?0:1),2===this.options.values.length&&!0===this.options.range&&(0===f&&h>k||1===f&&k>h)&&(h=k),h!==this.values(f)&&(l=this.values(),l[f]=h,m=this._trigger("slide",d,{handle:this.handles[f],value:h,values:l}),this.values(f?0:1),!1!==m&&this.values(f,h,!0))):h!==this.value()&&(m=this._trigger("slide",d,{handle:this.handles[f],value:h}),!1!==
m&&this.value(h))},_stop:function(d,f){var h={handle:this.handles[f],value:this.value()};this.options.values&&this.options.values.length&&(h.value=this.values(f),h.values=this.values());this._trigger("stop",d,h)},_change:function(d,f){if(!this._keySliding&&!this._mouseSliding){var h={handle:this.handles[f],value:this.value()};this.options.values&&this.options.values.length&&(h.value=this.values(f),h.values=this.values());this._lastChangedValue=f;this._trigger("change",d,h)}},value:function(d){return arguments.length?
(this.options.value=this._trimAlignValue(d),this._refreshValue(),this._change(null,0),void 0):this._value()},values:function(e,f){var h,k,l;if(1<arguments.length)return this.options.values[e]=this._trimAlignValue(f),this._refreshValue(),this._change(null,e),void 0;if(!arguments.length)return this._values();if(!d.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(e):this.value();h=this.options.values;k=arguments[0];for(l=0;h.length>l;l+=1)h[l]=this._trimAlignValue(k[l]),
this._change(null,l);this._refreshValue()},_setOption:function(e,f){var h,k=0;switch("range"===e&&!0===this.options.range&&("min"===f?(this.options.value=this._values(0),this.options.values=null):"max"===f&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),d.isArray(this.options.values)&&(k=this.options.values.length),d.Widget.prototype._setOption.apply(this,arguments),e){case "orientation":this._detectOrientation();this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+
this.orientation);this._refreshValue();break;case "value":this._animateOff=!0;this._refreshValue();this._change(null,0);this._animateOff=!1;break;case "values":this._animateOff=!0;this._refreshValue();for(h=0;k>h;h+=1)this._change(null,h);this._animateOff=!1;break;case "min":case "max":this._animateOff=!0;this._refreshValue();this._animateOff=!1;break;case "range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_value:function(){return this._trimAlignValue(this.options.value)},_values:function(d){var f,
h;if(arguments.length)return f=this.options.values[d],this._trimAlignValue(f);if(this.options.values&&this.options.values.length){f=this.options.values.slice();for(h=0;f.length>h;h+=1)f[h]=this._trimAlignValue(f[h]);return f}return[]},_trimAlignValue:function(d){if(this._valueMin()>=d)return this._valueMin();if(d>=this._valueMax())return this._valueMax();var f=0<this.options.step?this.options.step:1,h=(d-this._valueMin())%f;d-=h;return 2*Math.abs(h)>=f&&(d+=0<h?f:-f),parseFloat(d.toFixed(5))},_valueMin:function(){return this.options.min},
_valueMax:function(){return this.options.max},_refreshValue:function(){var e,f,h,k,l,m=this.options.range,n=this.options,p=this,q=this._animateOff?!1:n.animate,s={};this.options.values&&this.options.values.length?this.handles.each(function(h){f=100*((p.values(h)-p._valueMin())/(p._valueMax()-p._valueMin()));s["horizontal"===p.orientation?"left":"bottom"]=f+"%";d(this).stop(1,1)[q?"animate":"css"](s,n.animate);!0===p.options.range&&("horizontal"===p.orientation?(0===h&&p.range.stop(1,1)[q?"animate":
"css"]({left:f+"%"},n.animate),1===h&&p.range[q?"animate":"css"]({width:f-e+"%"},{queue:!1,duration:n.animate})):(0===h&&p.range.stop(1,1)[q?"animate":"css"]({bottom:f+"%"},n.animate),1===h&&p.range[q?"animate":"css"]({height:f-e+"%"},{queue:!1,duration:n.animate})));e=f}):(h=this.value(),k=this._valueMin(),l=this._valueMax(),f=l!==k?100*((h-k)/(l-k)):0,s["horizontal"===this.orientation?"left":"bottom"]=f+"%",this.handle.stop(1,1)[q?"animate":"css"](s,n.animate),"min"===m&&"horizontal"===this.orientation&&
this.range.stop(1,1)[q?"animate":"css"]({width:f+"%"},n.animate),"max"===m&&"horizontal"===this.orientation&&this.range[q?"animate":"css"]({width:100-f+"%"},{queue:!1,duration:n.animate}),"min"===m&&"vertical"===this.orientation&&this.range.stop(1,1)[q?"animate":"css"]({height:f+"%"},n.animate),"max"===m&&"vertical"===this.orientation&&this.range[q?"animate":"css"]({height:100-f+"%"},{queue:!1,duration:n.animate}))},_handleEvents:{keydown:function(e){var f,h,k,l=d(e.target).data("ui-slider-handle-index");
switch(e.keyCode){case d.ui.keyCode.HOME:case d.ui.keyCode.END:case d.ui.keyCode.PAGE_UP:case d.ui.keyCode.PAGE_DOWN:case d.ui.keyCode.UP:case d.ui.keyCode.RIGHT:case d.ui.keyCode.DOWN:case d.ui.keyCode.LEFT:if(e.preventDefault(),!this._keySliding&&(this._keySliding=!0,d(e.target).addClass("ui-state-active"),f=this._start(e,l),!1===f))return}switch(k=this.options.step,f=h=this.options.values&&this.options.values.length?this.values(l):this.value(),e.keyCode){case d.ui.keyCode.HOME:h=this._valueMin();
break;case d.ui.keyCode.END:h=this._valueMax();break;case d.ui.keyCode.PAGE_UP:h=this._trimAlignValue(f+(this._valueMax()-this._valueMin())/5);break;case d.ui.keyCode.PAGE_DOWN:h=this._trimAlignValue(f-(this._valueMax()-this._valueMin())/5);break;case d.ui.keyCode.UP:case d.ui.keyCode.RIGHT:if(f===this._valueMax())return;h=this._trimAlignValue(f+k);break;case d.ui.keyCode.DOWN:case d.ui.keyCode.LEFT:if(f===this._valueMin())return;h=this._trimAlignValue(f-k)}this._slide(e,l,h)},click:function(d){d.preventDefault()},
keyup:function(e){var f=d(e.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(e,f),this._change(e,f),d(e.target).removeClass("ui-state-active"))}}})})(jQuery);
(function(d){function e(d){return function(){var e=this.element.val();d.apply(this,arguments);this._refresh();e!==this.element.val()&&this._trigger("change")}}d.widget("ui.spinner",{version:"1.10.3",defaultElement:"<input>",widgetEventPrefix:"spin",options:{culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max);
this._setOption("min",this.options.min);this._setOption("step",this.options.step);this._value(this.element.val(),!0);this._draw();this._on(this._events);this._refresh();this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var e={},h=this.element;return d.each(["min","max","step"],function(d,l){var m=h.attr(l);void 0!==m&&m.length&&(e[l]=m)}),e},_events:{keydown:function(d){this._start(d)&&this._keydown(d)&&d.preventDefault()},keyup:"_stop",
focus:function(){this.previous=this.element.val()},blur:function(d){return this.cancelBlur?(delete this.cancelBlur,void 0):(this._stop(),this._refresh(),this.previous!==this.element.val()&&this._trigger("change",d),void 0)},mousewheel:function(d,e){if(e){if(!this.spinning&&!this._start(d))return!1;this._spin((0<e?1:-1)*this.options.step,d);clearTimeout(this.mousewheelTimer);this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(d)},100);d.preventDefault()}},"mousedown .ui-spinner-button":function(e){function h(){this.element[0]===
this.document[0].activeElement||(this.element.focus(),this.previous=k,this._delay(function(){this.previous=k}))}var k;k=this.element[0]===this.document[0].activeElement?this.previous:this.element.val();e.preventDefault();h.call(this);this.cancelBlur=!0;this._delay(function(){delete this.cancelBlur;h.call(this)});!1!==this._start(e)&&this._repeat(null,d(e.currentTarget).hasClass("ui-spinner-up")?1:-1,e)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(e){return d(e.currentTarget).hasClass("ui-state-active")?
!1===this._start(e)?!1:(this._repeat(null,d(e.currentTarget).hasClass("ui-spinner-up")?1:-1,e),void 0):void 0},"mouseleave .ui-spinner-button":"_stop"},_draw:function(){var d=this.uiSpinner=this.element.addClass("ui-spinner-input").attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());this.element.attr("role","spinbutton");this.buttons=d.find(".ui-spinner-button").attr("tabIndex",-1).button().removeClass("ui-corner-all");this.buttons.height()>Math.ceil(0.5*d.height())&&
0<d.height()&&d.height(d.height());this.options.disabled&&this.disable()},_keydown:function(e){var h=this.options,k=d.ui.keyCode;switch(e.keyCode){case k.UP:return this._repeat(null,1,e),!0;case k.DOWN:return this._repeat(null,-1,e),!0;case k.PAGE_UP:return this._repeat(null,h.page,e),!0;case k.PAGE_DOWN:return this._repeat(null,-h.page,e),!0}return!1},_uiSpinnerHtml:function(){return"<span class='ui-spinner ui-widget ui-widget-content ui-corner-all'></span>"},_buttonHtml:function(){return"<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon "+
this.options.icons.up+"'>&#9650;</span></a><a class='ui-spinner-button ui-spinner-down ui-corner-br'><span class='ui-icon "+this.options.icons.down+"'>&#9660;</span></a>"},_start:function(d){return this.spinning||!1!==this._trigger("start",d)?(this.counter||(this.counter=1),this.spinning=!0,!0):!1},_repeat:function(d,e,k){d=d||500;clearTimeout(this.timer);this.timer=this._delay(function(){this._repeat(40,e,k)},d);this._spin(e*this.options.step,k)},_spin:function(d,e){var k=this.value()||0;this.counter||
(this.counter=1);k=this._adjustValue(k+d*this._increment(this.counter));this.spinning&&!1===this._trigger("spin",e,{value:k})||(this._value(k),this.counter++)},_increment:function(e){var h=this.options.incremental;return h?d.isFunction(h)?h(e):Math.floor(e*e*e/5E4-e*e/500+17*e/200+1):1},_precision:function(){var d=this._precisionOf(this.options.step);return null!==this.options.min&&(d=Math.max(d,this._precisionOf(this.options.min))),d},_precisionOf:function(d){d=""+d;var e=d.indexOf(".");return-1===
e?0:d.length-e-1},_adjustValue:function(d){var e,k,l=this.options;return e=null!==l.min?l.min:0,k=d-e,k=Math.round(k/l.step)*l.step,d=e+k,d=parseFloat(d.toFixed(this._precision())),null!==l.max&&d>l.max?l.max:null!==l.min&&l.min>d?l.min:d},_stop:function(d){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",d))},_setOption:function(d,e){if("culture"===d||"numberFormat"===d){var k=this._parse(this.element.val());return this.options[d]=
e,this.element.val(this._format(k)),void 0}("max"===d||"min"===d||"step"===d)&&"string"==typeof e&&(e=this._parse(e));"icons"===d&&(this.buttons.first().find(".ui-icon").removeClass(this.options.icons.up).addClass(e.up),this.buttons.last().find(".ui-icon").removeClass(this.options.icons.down).addClass(e.down));this._super(d,e);"disabled"===d&&(e?(this.element.prop("disabled",!0),this.buttons.button("disable")):(this.element.prop("disabled",!1),this.buttons.button("enable")))},_setOptions:e(function(d){this._super(d);
this._value(this.element.val())}),_parse:function(d){return"string"==typeof d&&""!==d&&(d=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(d,10,this.options.culture):+d),""===d||isNaN(d)?null:d},_format:function(d){return""===d?"":window.Globalize&&this.options.numberFormat?Globalize.format(d,this.options.numberFormat,this.options.culture):d},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},
_value:function(d,e){var k;""!==d&&(k=this._parse(d),null!==k&&(e||(k=this._adjustValue(k)),d=this._format(k)));this.element.val(d);this._refresh()},_destroy:function(){this.element.removeClass("ui-spinner-input").prop("disabled",!1).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow");this.uiSpinner.replaceWith(this.element)},stepUp:e(function(d){this._stepUp(d)}),_stepUp:function(d){this._start()&&(this._spin((d||1)*this.options.step),
this._stop())},stepDown:e(function(d){this._stepDown(d)}),_stepDown:function(d){this._start()&&(this._spin((d||1)*-this.options.step),this._stop())},pageUp:e(function(d){this._stepUp((d||1)*this.options.page)}),pageDown:e(function(d){this._stepDown((d||1)*this.options.page)}),value:function(d){return arguments.length?(e(this._value).call(this,d),void 0):this._parse(this.element.val())},widget:function(){return this.uiSpinner}})})(jQuery);
(function(d,e){function f(d){return 1<d.hash.length&&decodeURIComponent(d.href.replace(k,""))===decodeURIComponent(location.href.replace(k,""))}var h=0,k=/#.*$/;d.widget("ui.tabs",{version:"1.10.3",delay:300,options:{active:null,collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_create:function(){var e=this,f=this.options;this.running=!1;this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",
f.collapsible).delegate(".ui-tabs-nav > li","mousedown"+this.eventNamespace,function(e){d(this).is(".ui-state-disabled")&&e.preventDefault()}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){d(this).closest("li").is(".ui-state-disabled")&&this.blur()});this._processTabs();f.active=this._initialActive();d.isArray(f.disabled)&&(f.disabled=d.unique(f.disabled.concat(d.map(this.tabs.filter(".ui-state-disabled"),function(d){return e.tabs.index(d)}))).sort());this.active=!1!==this.options.active&&
this.anchors.length?this._findActive(f.active):d();this._refresh();this.active.length&&this.load(f.active)},_initialActive:function(){var f=this.options.active,h=this.options.collapsible,k=location.hash.substring(1);return null===f&&(k&&this.tabs.each(function(h,m){return d(m).attr("aria-controls")===k?(f=h,!1):e}),null===f&&(f=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),(null===f||-1===f)&&(f=this.tabs.length?0:!1)),!1!==f&&(f=this.tabs.index(this.tabs.eq(f)),-1===f&&(f=h?!1:0)),!h&&!1===
f&&this.anchors.length&&(f=0),f},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):d()}},_tabKeydown:function(f){var h=d(this.document[0].activeElement).closest("li"),k=this.tabs.index(h),p=!0;if(!this._handlePageNav(f)){switch(f.keyCode){case d.ui.keyCode.RIGHT:case d.ui.keyCode.DOWN:k++;break;case d.ui.keyCode.UP:case d.ui.keyCode.LEFT:p=!1;k--;break;case d.ui.keyCode.END:k=this.anchors.length-1;break;case d.ui.keyCode.HOME:k=0;break;
case d.ui.keyCode.SPACE:return f.preventDefault(),clearTimeout(this.activating),this._activate(k),e;case d.ui.keyCode.ENTER:return f.preventDefault(),clearTimeout(this.activating),this._activate(k===this.options.active?!1:k),e;default:return}f.preventDefault();clearTimeout(this.activating);k=this._focusNextTab(k,p);f.ctrlKey||(h.attr("aria-selected","false"),this.tabs.eq(k).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",k)},this.delay))}},_panelKeydown:function(e){this._handlePageNav(e)||
e.ctrlKey&&e.keyCode===d.ui.keyCode.UP&&(e.preventDefault(),this.active.focus())},_handlePageNav:function(f){return f.altKey&&f.keyCode===d.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):f.altKey&&f.keyCode===d.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):e},_findNextTab:function(e,f){for(var h=this.tabs.length-1;-1!==d.inArray((e>h&&(e=0),0>e&&(e=h),e),this.options.disabled);)e=f?e+1:e-1;return e},_focusNextTab:function(d,
e){return d=this._findNextTab(d,e),this.tabs.eq(d).focus(),d},_setOption:function(d,f){return"active"===d?(this._activate(f),e):"disabled"===d?(this._setupDisabled(f),e):(this._super(d,f),"collapsible"===d&&(this.element.toggleClass("ui-tabs-collapsible",f),f||!1!==this.options.active||this._activate(0)),"event"===d&&this._setupEvents(f),"heightStyle"===d&&this._setupHeightStyle(f),e)},_tabId:function(d){return d.attr("aria-controls")||"ui-tabs-"+ ++h},_sanitizeSelector:function(d){return d?d.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,
"\\$&"):""},refresh:function(){var e=this.options,f=this.tablist.children(":has(a[href])");e.disabled=d.map(f.filter(".ui-state-disabled"),function(d){return f.index(d)});this._processTabs();!1!==e.active&&this.anchors.length?this.active.length&&!d.contains(this.tablist[0],this.active[0])?this.tabs.length===e.disabled.length?(e.active=!1,this.active=d()):this._activate(this._findNextTab(Math.max(0,e.active-1),!1)):e.active=this.tabs.index(this.active):(e.active=!1,this.active=d());this._refresh()},
_refresh:function(){this._setupDisabled(this.options.disabled);this._setupEvents(this.options.event);this._setupHeightStyle(this.options.heightStyle);this.tabs.not(this.active).attr({"aria-selected":"false",tabIndex:-1});this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-expanded":"false","aria-hidden":"true"});this.active.length?(this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true",tabIndex:0}),this._getPanelForTab(this.active).show().attr({"aria-expanded":"true",
"aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var e=this;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist");this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1});this.anchors=this.tabs.map(function(){return d("a",this)[0]}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1});this.panels=
d();this.anchors.each(function(h,k){var p,q,s,t=d(k).uniqueId().attr("id"),u=d(k).closest("li"),v=u.attr("aria-controls");f(k)?(p=k.hash,q=e.element.find(e._sanitizeSelector(p))):(s=e._tabId(u),p="#"+s,q=e.element.find(p),q.length||(q=e._createPanel(s),q.insertAfter(e.panels[h-1]||e.tablist)),q.attr("aria-live","polite"));q.length&&(e.panels=e.panels.add(q));v&&u.data("ui-tabs-aria-controls",v);u.attr({"aria-controls":p.substring(1),"aria-labelledby":t});q.attr("aria-labelledby",t)});this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role",
"tabpanel")},_getList:function(){return this.element.find("ol,ul").eq(0)},_createPanel:function(e){return d("<div>").attr("id",e).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)},_setupDisabled:function(e){d.isArray(e)&&(e.length?e.length===this.anchors.length&&(e=!0):e=!1);for(var f,h=0;f=this.tabs[h];h++)!0===e||-1!==d.inArray(h,e)?d(f).addClass("ui-state-disabled").attr("aria-disabled","true"):d(f).removeClass("ui-state-disabled").removeAttr("aria-disabled");
this.options.disabled=e},_setupEvents:function(e){var f={click:function(d){d.preventDefault()}};e&&d.each(e.split(" "),function(d,e){f[e]="_eventHandler"});this._off(this.anchors.add(this.tabs).add(this.panels));this._on(this.anchors,f);this._on(this.tabs,{keydown:"_tabKeydown"});this._on(this.panels,{keydown:"_panelKeydown"});this._focusable(this.tabs);this._hoverable(this.tabs)},_setupHeightStyle:function(e){var f,h=this.element.parent();"fill"===e?(f=h.height(),f-=this.element.outerHeight()-this.element.height(),
this.element.siblings(":visible").each(function(){var e=d(this),h=e.css("position");"absolute"!==h&&"fixed"!==h&&(f-=e.outerHeight(!0))}),this.element.children().not(this.panels).each(function(){f-=d(this).outerHeight(!0)}),this.panels.each(function(){d(this).height(Math.max(0,f-d(this).innerHeight()+d(this).height()))}).css("overflow","auto")):"auto"===e&&(f=0,this.panels.each(function(){f=Math.max(f,d(this).height("").height())}).height(f))},_eventHandler:function(e){var f=this.options,h=this.active,
k=d(e.currentTarget).closest("li"),q=k[0]===h[0],s=q&&f.collapsible,t=s?d():this._getPanelForTab(k),u=h.length?this._getPanelForTab(h):d(),h={oldTab:h,oldPanel:u,newTab:s?d():k,newPanel:t};e.preventDefault();k.hasClass("ui-state-disabled")||k.hasClass("ui-tabs-loading")||this.running||q&&!f.collapsible||!1===this._trigger("beforeActivate",e,h)||(f.active=s?!1:this.tabs.index(k),this.active=q?d():k,this.xhr&&this.xhr.abort(),u.length||t.length||d.error("jQuery UI Tabs: Mismatching fragment identifier."),
t.length&&this.load(this.tabs.index(k),e),this._toggle(e,h))},_toggle:function(e,f){function h(){q.running=!1;q._trigger("activate",e,f)}function k(){f.newTab.closest("li").addClass("ui-tabs-active ui-state-active");s.length&&q.options.show?q._show(s,q.options.show,h):(s.show(),h())}var q=this,s=f.newPanel,t=f.oldPanel;this.running=!0;t.length&&this.options.hide?this._hide(t,this.options.hide,function(){f.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active");k()}):(f.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),
t.hide(),k());t.attr({"aria-expanded":"false","aria-hidden":"true"});f.oldTab.attr("aria-selected","false");s.length&&t.length?f.oldTab.attr("tabIndex",-1):s.length&&this.tabs.filter(function(){return 0===d(this).attr("tabIndex")}).attr("tabIndex",-1);s.attr({"aria-expanded":"true","aria-hidden":"false"});f.newTab.attr({"aria-selected":"true",tabIndex:0})},_activate:function(e){var f;e=this._findActive(e);e[0]!==this.active[0]&&(e.length||(e=this.active),f=e.find(".ui-tabs-anchor")[0],this._eventHandler({target:f,
currentTarget:f,preventDefault:d.noop}))},_findActive:function(e){return!1===e?d():this.tabs.eq(e)},_getIndex:function(d){return"string"==typeof d&&(d=this.anchors.index(this.anchors.filter("[href$='"+d+"']"))),d},_destroy:function(){this.xhr&&this.xhr.abort();this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible");this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role");this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeUniqueId();
this.tabs.add(this.panels).each(function(){d.data(this,"ui-tabs-destroy")?d(this).remove():d(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")});this.tabs.each(function(){var e=d(this),f=e.data("ui-tabs-aria-controls");
f?e.attr("aria-controls",f).removeData("ui-tabs-aria-controls"):e.removeAttr("aria-controls")});this.panels.show();"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(f){var h=this.options.disabled;!1!==h&&(f===e?h=!1:(f=this._getIndex(f),h=d.isArray(h)?d.map(h,function(d){return d!==f?d:null}):d.map(this.tabs,function(d,e){return e!==f?e:null})),this._setupDisabled(h))},disable:function(f){var h=this.options.disabled;if(!0!==h){if(f===e)h=!0;else{if(f=this._getIndex(f),
-1!==d.inArray(f,h))return;h=d.isArray(h)?d.merge([f],h).sort():[f]}this._setupDisabled(h)}},load:function(e,h){e=this._getIndex(e);var k=this,p=this.tabs.eq(e),q=p.find(".ui-tabs-anchor"),s=this._getPanelForTab(p),t={tab:p,panel:s};f(q[0])||(this.xhr=d.ajax(this._ajaxSettings(q,h,t)),this.xhr&&"canceled"!==this.xhr.statusText&&(p.addClass("ui-tabs-loading"),s.attr("aria-busy","true"),this.xhr.success(function(d){setTimeout(function(){s.html(d);k._trigger("load",h,t)},1)}).complete(function(d,e){setTimeout(function(){"abort"===
e&&k.panels.stop(!1,!0);p.removeClass("ui-tabs-loading");s.removeAttr("aria-busy");d===k.xhr&&delete k.xhr},1)})))},_ajaxSettings:function(e,f,h){var k=this;return{url:e.attr("href"),beforeSend:function(e,l){return k._trigger("beforeLoad",f,d.extend({jqXHR:e,ajaxSettings:l},h))}}},_getPanelForTab:function(e){e=d(e).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+e))}})})(jQuery);
(function(d){function e(e,f){var h=(e.attr("aria-describedby")||"").split(/\s+/);h.push(f);e.data("ui-tooltip-id",f).attr("aria-describedby",d.trim(h.join(" ")))}function f(e){var f=e.data("ui-tooltip-id"),h=(e.attr("aria-describedby")||"").split(/\s+/),f=d.inArray(f,h);-1!==f&&h.splice(f,1);e.removeData("ui-tooltip-id");(h=d.trim(h.join(" ")))?e.attr("aria-describedby",h):e.removeAttr("aria-describedby")}var h=0;d.widget("ui.tooltip",{version:"1.10.3",options:{content:function(){var e=d(this).attr("title")||
"";return d("<a>").text(e).html()},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,tooltipClass:null,track:!1,close:null,open:null},_create:function(){this._on({mouseover:"open",focusin:"open"});this.tooltips={};this.parents={};this.options.disabled&&this._disable()},_setOption:function(e,f){var h=this;return"disabled"===e?(this[f?"_disable":"_enable"](),this.options[e]=f,void 0):(this._super(e,f),"content"===e&&d.each(this.tooltips,
function(d,e){h._updateContent(e)}),void 0)},_disable:function(){var e=this;d.each(this.tooltips,function(f,h){var n=d.Event("blur");n.target=n.currentTarget=h[0];e.close(n,!0)});this.element.find(this.options.items).addBack().each(function(){var e=d(this);e.is("[title]")&&e.data("ui-tooltip-title",e.attr("title")).attr("title","")})},_enable:function(){this.element.find(this.options.items).addBack().each(function(){var e=d(this);e.data("ui-tooltip-title")&&e.attr("title",e.data("ui-tooltip-title"))})},
open:function(e){var f=this,h=d(e?e.target:this.element).closest(this.options.items);h.length&&!h.data("ui-tooltip-id")&&(h.attr("title")&&h.data("ui-tooltip-title",h.attr("title")),h.data("ui-tooltip-open",!0),e&&"mouseover"===e.type&&h.parents().each(function(){var e,h=d(this);h.data("ui-tooltip-open")&&(e=d.Event("blur"),e.target=e.currentTarget=this,f.close(e,!0));h.attr("title")&&(h.uniqueId(),f.parents[this.id]={element:this,title:h.attr("title")},h.attr("title",""))}),this._updateContent(h,
e))},_updateContent:function(d,e){var f,h=this.options.content,p=this,q=e?e.type:null;return"string"==typeof h?this._open(e,d,h):(f=h.call(d[0],function(f){d.data("ui-tooltip-open")&&p._delay(function(){e&&(e.type=q);this._open(e,d,f)})}),f&&this._open(e,d,f),void 0)},_open:function(f,h,m){function n(d){s.of=d;p.is(":hidden")||p.position(s)}var p,q,s=d.extend({},this.options.position);if(m){if(p=this._find(h),p.length)return p.find(".ui-tooltip-content").html(m),void 0;h.is("[title]")&&(f&&"mouseover"===
f.type?h.attr("title",""):h.removeAttr("title"));p=this._tooltip(h);e(h,p.attr("id"));p.find(".ui-tooltip-content").html(m);this.options.track&&f&&/^mouse/.test(f.type)?(this._on(this.document,{mousemove:n}),n(f)):p.position(d.extend({of:h},this.options.position));p.hide();this._show(p,this.options.show);this.options.show&&this.options.show.delay&&(q=this.delayedShow=setInterval(function(){p.is(":visible")&&(n(s.of),clearInterval(q))},d.fx.interval));this._trigger("open",f,{tooltip:p});m={keyup:function(e){e.keyCode===
d.ui.keyCode.ESCAPE&&(e=d.Event(e),e.currentTarget=h[0],this.close(e,!0))},remove:function(){this._removeTooltip(p)}};f&&"mouseover"!==f.type||(m.mouseleave="close");f&&"focusin"!==f.type||(m.focusout="close");this._on(!0,h,m)}},close:function(e){var h=this,m=d(e?e.currentTarget:this.element),n=this._find(m);this.closing||(clearInterval(this.delayedShow),m.data("ui-tooltip-title")&&m.attr("title",m.data("ui-tooltip-title")),f(m),n.stop(!0),this._hide(n,this.options.hide,function(){h._removeTooltip(d(this))}),
m.removeData("ui-tooltip-open"),this._off(m,"mouseleave focusout keyup"),m[0]!==this.element[0]&&this._off(m,"remove"),this._off(this.document,"mousemove"),e&&"mouseleave"===e.type&&d.each(this.parents,function(e,f){d(f.element).attr("title",f.title);delete h.parents[e]}),this.closing=!0,this._trigger("close",e,{tooltip:n}),this.closing=!1)},_tooltip:function(e){var f="ui-tooltip-"+h++,m=d("<div>").attr({id:f,role:"tooltip"}).addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content "+(this.options.tooltipClass||
""));return d("<div>").addClass("ui-tooltip-content").appendTo(m),m.appendTo(this.document[0].body),this.tooltips[f]=e,m},_find:function(e){return(e=e.data("ui-tooltip-id"))?d("#"+e):d()},_removeTooltip:function(d){d.remove();delete this.tooltips[d.attr("id")]},_destroy:function(){var e=this;d.each(this.tooltips,function(f,h){var n=d.Event("blur");n.target=n.currentTarget=h[0];e.close(n,!0);d("#"+f).remove();h.data("ui-tooltip-title")&&(h.attr("title",h.data("ui-tooltip-title")),h.removeData("ui-tooltip-title"))})}})})(jQuery);
(function(d,e){d.effects={effect:{}};(function(d,e){function k(d,e,f){var h=u[e.type]||{};return null==d?f||!e.def?null:e.def:(d=h.floor?~~d:parseFloat(d),isNaN(d)?e.def:h.mod?(d+h.mod)%h.mod:0>d?0:d>h.max?h.max:d)}function l(k){var l=s(),m=l._rgba=[];return k=k.toLowerCase(),y(q,function(d,f){var n,p=f.re.exec(k),p=p&&f.parse(p),q=f.space||"rgba";return p?(n=l[q](p),l[t[q].cache]=n[t[q].cache],m=l._rgba=n._rgba,!1):e}),m.length?("0,0,0,0"===m.join()&&d.extend(m,n.transparent),l):n[k]}function m(d,
e,f){return f=(f+1)%1,1>6*f?d+6*(e-d)*f:1>2*f?e:2>3*f?d+6*(e-d)*(2/3-f):d}var n,p=/^([\-+])=\s*(\d+\.?\d*)/,q=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(d){return[d[1],d[2],d[3],d[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(d){return[2.55*d[1],2.55*d[2],2.55*d[3],d[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(d){return[parseInt(d[1],
16),parseInt(d[2],16),parseInt(d[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(d){return[parseInt(d[1]+d[1],16),parseInt(d[2]+d[2],16),parseInt(d[3]+d[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(d){return[d[1],d[2]/100,d[3]/100,d[4]]}}],s=d.Color=function(e,h,k,l){return new d.Color.fn.parse(e,h,k,l)},t={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,
type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},u={"byte":{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},v=s.support={},x=d("<p>")[0],y=d.each;x.style.cssText="background-color:rgba(1,1,1,.5)";v.rgba=-1<x.style.backgroundColor.indexOf("rgba");y(t,function(d,e){e.cache="_"+d;e.props.alpha={idx:3,type:"percent",def:1}});s.fn=d.extend(s.prototype,{parse:function(m,p,q,u){if(m===e)return this._rgba=[null,null,
null,null],this;(m.jquery||m.nodeType)&&(m=d(m).css(p),p=e);var v=this,w=d.type(m),x=this._rgba=[];return p!==e&&(m=[m,p,q,u],w="array"),"string"===w?this.parse(l(m)||n._default):"array"===w?(y(t.rgba.props,function(d,e){x[e.idx]=k(m[e.idx],e)}),this):"object"===w?(m instanceof s?y(t,function(d,e){m[e.cache]&&(v[e.cache]=m[e.cache].slice())}):y(t,function(e,h){var l=h.cache;y(h.props,function(d,e){if(!v[l]&&h.to){if("alpha"===d||null==m[d])return;v[l]=h.to(v._rgba)}v[l][e.idx]=k(m[d],e,!0)});v[l]&&
0>d.inArray(null,v[l].slice(0,3))&&(v[l][3]=1,h.from&&(v._rgba=h.from(v[l])))}),this):e},is:function(d){var f=s(d),k=!0,l=this;return y(t,function(d,m){var n,p=f[m.cache];return p&&(n=l[m.cache]||m.to&&m.to(l._rgba)||[],y(m.props,function(d,f){return null!=p[f.idx]?k=p[f.idx]===n[f.idx]:e})),k}),k},_space:function(){var d=[],e=this;return y(t,function(f,h){e[h.cache]&&d.push(f)}),d.pop()},transition:function(d,e){var f=s(d),h=f._space(),l=t[h],m=0===this.alpha()?s("transparent"):this,n=m[l.cache]||
l.to(m._rgba),p=n.slice();return f=f[l.cache],y(l.props,function(d,h){var l=h.idx,m=n[l],q=f[l],s=u[h.type]||{};null!==q&&(null===m?p[l]=q:(s.mod&&(q-m>s.mod/2?m+=s.mod:m-q>s.mod/2&&(m-=s.mod)),p[l]=k((q-m)*e+m,h)))}),this[h](p)},blend:function(e){if(1===this._rgba[3])return this;var h=this._rgba.slice(),k=h.pop(),l=s(e)._rgba;return s(d.map(h,function(d,e){return(1-k)*l[e]+k*d}))},toRgbaString:function(){var e="rgba(",h=d.map(this._rgba,function(d,e){return null==d?2<e?1:0:d});return 1===h[3]&&(h.pop(),
e="rgb("),e+h.join()+")"},toHslaString:function(){var e="hsla(",h=d.map(this.hsla(),function(d,e){return null==d&&(d=2<e?1:0),e&&3>e&&(d=Math.round(100*d)+"%"),d});return 1===h[3]&&(h.pop(),e="hsl("),e+h.join()+")"},toHexString:function(e){var h=this._rgba.slice(),k=h.pop();return e&&h.push(~~(255*k)),"#"+d.map(h,function(d){return d=(d||0).toString(16),1===d.length?"0"+d:d}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}});s.fn.parse.prototype=s.fn;t.hsla.to=
function(d){if(null==d[0]||null==d[1]||null==d[2])return[null,null,null,d[3]];var e,f,h=d[0]/255,k=d[1]/255,l=d[2]/255;d=d[3];var m=Math.max(h,k,l),n=Math.min(h,k,l),p=m-n,q=m+n,s=0.5*q;return e=n===m?0:h===m?60*(k-l)/p+360:k===m?60*(l-h)/p+120:60*(h-k)/p+240,f=0===p?0:0.5>=s?p/q:p/(2-q),[Math.round(e)%360,f,s,null==d?1:d]};t.hsla.from=function(d){if(null==d[0]||null==d[1]||null==d[2])return[null,null,null,d[3]];var e=d[0]/360,f=d[1],h=d[2];d=d[3];f=0.5>=h?h*(1+f):h+f-h*f;h=2*h-f;return[Math.round(255*
m(h,f,e+1/3)),Math.round(255*m(h,f,e)),Math.round(255*m(h,f,e-1/3)),d]};y(t,function(l,m){var n=m.props,q=m.cache,u=m.to,t=m.from;s.fn[l]=function(l){if(u&&!this[q]&&(this[q]=u(this._rgba)),l===e)return this[q].slice();var m,p=d.type(l),v="array"===p||"object"===p?l:arguments,x=this[q].slice();return y(n,function(d,e){var f=v["object"===p?d:e.idx];null==f&&(f=x[e.idx]);x[e.idx]=k(f,e)}),t?(m=s(t(x)),m[q]=x,m):s(x)};y(n,function(e,h){s.fn[e]||(s.fn[e]=function(k){var m,n=d.type(k),q="alpha"===e?this._hsla?
"hsla":"rgba":l,s=this[q](),u=s[h.idx];return"undefined"===n?u:("function"===n&&(k=k.call(this,u),n=d.type(k)),null==k&&h.empty?this:("string"===n&&(m=p.exec(k),m&&(k=u+parseFloat(m[2])*("+"===m[1]?1:-1))),s[h.idx]=k,this[q](s)))})})});s.hook=function(e){e=e.split(" ");y(e,function(e,h){d.cssHooks[h]={set:function(e,k){var m,n="";if("transparent"!==k&&("string"!==d.type(k)||(m=l(k)))){if(k=s(m||k),!v.rgba&&1!==k._rgba[3]){for(m="backgroundColor"===h?e.parentNode:e;(""===n||"transparent"===n)&&m&&
m.style;)try{n=d.css(m,"backgroundColor"),m=m.parentNode}catch(p){}k=k.blend(n&&"transparent"!==n?n:"_default")}k=k.toRgbaString()}try{e.style[h]=k}catch(q){}}};d.fx.step[h]=function(e){e.colorInit||(e.start=s(e.elem,h),e.end=s(e.end),e.colorInit=!0);d.cssHooks[h].set(e.elem,e.start.transition(e.end,e.pos))}})};s.hook("backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor");d.cssHooks.borderColor=
{expand:function(d){var e={};return y(["Top","Right","Bottom","Left"],function(f,h){e["border"+h+"Color"]=d}),e}};n=d.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}})(jQuery);(function(){function f(e){var f,h=e.ownerDocument.defaultView?
e.ownerDocument.defaultView.getComputedStyle(e,null):e.currentStyle,k={};if(h&&h.length&&h[0]&&h[h[0]])for(e=h.length;e--;)f=h[e],"string"==typeof h[f]&&(k[d.camelCase(f)]=h[f]);else for(f in h)"string"==typeof h[f]&&(k[f]=h[f]);return k}var h=["add","remove","toggle"],k={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};d.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(e,f){d.fx.step[f]=function(d){("none"!==
d.end&&!d.setAttr||1===d.pos&&!d.setAttr)&&(jQuery.style(d.elem,f,d.end),d.setAttr=!0)}});d.fn.addBack||(d.fn.addBack=function(d){return this.add(null==d?this.prevObject:this.prevObject.filter(d))});d.effects.animateClass=function(e,m,n,p){var q=d.speed(m,n,p);return this.queue(function(){var m,n=d(this),p=n.attr("class")||"",v=q.children?n.find("*").addBack():n,v=v.map(function(){return{el:d(this),start:f(this)}});m=function(){d.each(h,function(d,f){e[f]&&n[f+"Class"](e[f])})};m();v=v.map(function(){this.end=
f(this.el[0]);var e=this.start,h=this.end,l,m,n={};for(l in h)m=h[l],e[l]!==m&&(k[l]||(d.fx.step[l]||!isNaN(parseFloat(m)))&&(n[l]=m));return this.diff=n,this});n.attr("class",p);v=v.map(function(){var e=this,f=d.Deferred(),h=d.extend({},q,{queue:!1,complete:function(){f.resolve(e)}});return this.el.animate(this.diff,h),f.promise()});d.when.apply(d,v.get()).done(function(){m();d.each(arguments,function(){var e=this.el;d.each(this.diff,function(d){e.css(d,"")})});q.complete.call(n[0])})})};d.fn.extend({addClass:function(e){return function(f,
h,k,q){return h?d.effects.animateClass.call(this,{add:f},h,k,q):e.apply(this,arguments)}}(d.fn.addClass),removeClass:function(e){return function(f,h,k,q){return 1<arguments.length?d.effects.animateClass.call(this,{remove:f},h,k,q):e.apply(this,arguments)}}(d.fn.removeClass),toggleClass:function(f){return function(h,k,p,q,s){return"boolean"==typeof k||k===e?p?d.effects.animateClass.call(this,k?{add:h}:{remove:h},p,q,s):f.apply(this,arguments):d.effects.animateClass.call(this,{toggle:h},k,p,q)}}(d.fn.toggleClass),
switchClass:function(e,f,h,k,q){return d.effects.animateClass.call(this,{add:f,remove:e},h,k,q)}})})();(function(){function f(e,f,h,n){return d.isPlainObject(e)&&(f=e,e=e.effect),e={effect:e},null==f&&(f={}),d.isFunction(f)&&(n=f,h=null,f={}),("number"==typeof f||d.fx.speeds[f])&&(n=h,h=f,f={}),d.isFunction(h)&&(n=h,h=null),f&&d.extend(e,f),h=h||f.duration,e.duration=d.fx.off?0:"number"==typeof h?h:h in d.fx.speeds?d.fx.speeds[h]:d.fx.speeds._default,e.complete=n||f.complete,e}function h(e){return!e||
"number"==typeof e||d.fx.speeds[e]?!0:"string"!=typeof e||d.effects.effect[e]?d.isFunction(e)?!0:"object"!=typeof e||e.effect?!1:!0:!0}d.extend(d.effects,{version:"1.10.3",save:function(d,e){for(var f=0;e.length>f;f++)null!==e[f]&&d.data("ui-effects-"+e[f],d[0].style[e[f]])},restore:function(d,f){var h,n;for(n=0;f.length>n;n++)null!==f[n]&&(h=d.data("ui-effects-"+f[n]),h===e&&(h=""),d.css(f[n],h))},setMode:function(d,e){return"toggle"===e&&(e=d.is(":hidden")?"show":"hide"),e},getBaseline:function(d,
e){var f,h;switch(d[0]){case "top":f=0;break;case "middle":f=0.5;break;case "bottom":f=1;break;default:f=d[0]/e.height}switch(d[1]){case "left":h=0;break;case "center":h=0.5;break;case "right":h=1;break;default:h=d[1]/e.width}return{x:h,y:f}},createWrapper:function(e){if(e.parent().is(".ui-effects-wrapper"))return e.parent();var f={width:e.outerWidth(!0),height:e.outerHeight(!0),"float":e.css("float")},h=d("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",
border:"none",margin:0,padding:0}),n={width:e.width(),height:e.height()},p=document.activeElement;try{p.id}catch(q){p=document.body}return e.wrap(h),(e[0]===p||d.contains(e[0],p))&&d(p).focus(),h=e.parent(),"static"===e.css("position")?(h.css({position:"relative"}),e.css({position:"relative"})):(d.extend(f,{position:e.css("position"),zIndex:e.css("z-index")}),d.each(["top","left","bottom","right"],function(d,h){f[h]=e.css(h);isNaN(parseInt(f[h],10))&&(f[h]="auto")}),e.css({position:"relative",top:0,
left:0,right:"auto",bottom:"auto"})),e.css(n),h.css(f).show()},removeWrapper:function(e){var f=document.activeElement;return e.parent().is(".ui-effects-wrapper")&&(e.parent().replaceWith(e),(e[0]===f||d.contains(e[0],f))&&d(f).focus()),e},setTransition:function(e,f,h,n){return n=n||{},d.each(f,function(d,f){var l=e.cssUnit(f);0<l[0]&&(n[f]=l[0]*h+l[1])}),n}});d.fn.extend({effect:function(){function e(f){function k(){d.isFunction(n)&&n.call(m[0]);d.isFunction(f)&&f()}var m=d(this),n=h.complete,v=h.mode;
(m.is(":hidden")?"hide"===v:"show"===v)?(m[v](),k()):p.call(m[0],h,k)}var h=f.apply(this,arguments),m=h.mode,n=h.queue,p=d.effects.effect[h.effect];return d.fx.off||!p?m?this[m](h.duration,h.complete):this.each(function(){h.complete&&h.complete.call(this)}):!1===n?this.each(e):this.queue(n||"fx",e)},show:function(d){return function(e){if(h(e))return d.apply(this,arguments);var m=f.apply(this,arguments);return m.mode="show",this.effect.call(this,m)}}(d.fn.show),hide:function(d){return function(e){if(h(e))return d.apply(this,
arguments);var m=f.apply(this,arguments);return m.mode="hide",this.effect.call(this,m)}}(d.fn.hide),toggle:function(d){return function(e){if(h(e)||"boolean"==typeof e)return d.apply(this,arguments);var m=f.apply(this,arguments);return m.mode="toggle",this.effect.call(this,m)}}(d.fn.toggle),cssUnit:function(e){var f=this.css(e),h=[];return d.each(["em","px","%","pt"],function(d,e){0<f.indexOf(e)&&(h=[parseFloat(f),e])}),h}})})();(function(){var e={};d.each(["Quad","Cubic","Quart","Quint","Expo"],function(d,
k){e[k]=function(e){return Math.pow(e,d+2)}});d.extend(e,{Sine:function(d){return 1-Math.cos(d*Math.PI/2)},Circ:function(d){return 1-Math.sqrt(1-d*d)},Elastic:function(d){return 0===d||1===d?d:-Math.pow(2,8*(d-1))*Math.sin((80*(d-1)-7.5)*Math.PI/15)},Back:function(d){return d*d*(3*d-2)},Bounce:function(d){for(var e,f=4;((e=Math.pow(2,--f))-1)/11>d;);return 1/Math.pow(4,3-f)-7.5625*Math.pow((3*e-2)/22-d,2)}});d.each(e,function(e,f){d.easing["easeIn"+e]=f;d.easing["easeOut"+e]=function(d){return 1-
f(1-d)};d.easing["easeInOut"+e]=function(d){return 0.5>d?f(2*d)/2:1-f(-2*d+2)/2}})})()})(jQuery);
(function(d){var e=/up|down|vertical/,f=/up|left|vertical|horizontal/;d.effects.effect.blind=function(h,k){var l,m,n,p=d(this),q="position top bottom left right height width".split(" "),s=d.effects.setMode(p,h.mode||"hide");l=h.direction||"up";var t=e.test(l),u=t?"height":"width",v=t?"top":"left",x=f.test(l),y={},z="show"===s;p.parent().is(".ui-effects-wrapper")?d.effects.save(p.parent(),q):d.effects.save(p,q);p.show();l=d.effects.createWrapper(p).css({overflow:"hidden"});m=l[u]();n=parseFloat(l.css(v))||
0;y[u]=z?m:0;x||(p.css(t?"bottom":"right",0).css(t?"top":"left","auto").css({position:"absolute"}),y[v]=z?n:m+n);z&&(l.css(u,0),x||l.css(v,n+m));l.animate(y,{duration:h.duration,easing:h.easing,queue:!1,complete:function(){"hide"===s&&p.hide();d.effects.restore(p,q);d.effects.removeWrapper(p);k()}})}})(jQuery);
(function(d){d.effects.effect.bounce=function(e,f){var h,k,l,m=d(this),n="position top bottom left right height width".split(" "),p=d.effects.setMode(m,e.mode||"effect"),q="hide"===p;h="show"===p;var s=e.direction||"up",p=e.distance,t=e.times||5,u=2*t+(h||q?1:0),v=e.duration/u,x=e.easing,y="up"===s||"down"===s?"top":"left",s="up"===s||"left"===s,z=m.queue(),A=z.length;(h||q)&&n.push("opacity");d.effects.save(m,n);m.show();d.effects.createWrapper(m);p||(p=m["top"===y?"outerHeight":"outerWidth"]()/
3);h&&(l={opacity:1},l[y]=0,m.css("opacity",0).css(y,s?2*-p:2*p).animate(l,v,x));q&&(p/=Math.pow(2,t-1));l={};for(h=l[y]=0;t>h;h++)k={},k[y]=(s?"-=":"+=")+p,m.animate(k,v,x).animate(l,v,x),p=q?2*p:p/2;q&&(k={opacity:0},k[y]=(s?"-=":"+=")+p,m.animate(k,v,x));m.queue(function(){q&&m.hide();d.effects.restore(m,n);d.effects.removeWrapper(m);f()});1<A&&z.splice.apply(z,[1,0].concat(z.splice(A,u+1)));m.dequeue()}})(jQuery);
(function(d){d.effects.effect.clip=function(e,f){var h,k,l=d(this),m="position top bottom left right height width".split(" "),n="show"===d.effects.setMode(l,e.mode||"hide"),p="vertical"===(e.direction||"vertical"),q=p?"height":"width",p=p?"top":"left",s={};d.effects.save(l,m);l.show();h=d.effects.createWrapper(l).css({overflow:"hidden"});h="IMG"===l[0].tagName?h:l;k=h[q]();n&&(h.css(q,0),h.css(p,k/2));s[q]=n?k:0;s[p]=n?0:k/2;h.animate(s,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){n||
l.hide();d.effects.restore(l,m);d.effects.removeWrapper(l);f()}})}})(jQuery);
(function(d){d.effects.effect.drop=function(e,f){var h,k=d(this),l="position top bottom left right opacity height width".split(" "),m=d.effects.setMode(k,e.mode||"hide"),n="show"===m;h=e.direction||"left";var p="up"===h||"down"===h?"top":"left",q="up"===h||"left"===h?"pos":"neg",s={opacity:n?1:0};d.effects.save(k,l);k.show();d.effects.createWrapper(k);h=e.distance||k["top"===p?"outerHeight":"outerWidth"](!0)/2;n&&k.css("opacity",0).css(p,"pos"===q?-h:h);s[p]=(n?"pos"===q?"+=":"-=":"pos"===q?"-=":
"+=")+h;k.animate(s,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){"hide"===m&&k.hide();d.effects.restore(k,l);d.effects.removeWrapper(k);f()}})}})(jQuery);
(function(d){d.effects.effect.explode=function(e,f){function h(){A.push(this);A.length===s*t&&(u.css({visibility:"visible"}),d(A).remove(),v||u.hide(),f())}var k,l,m,n,p,q,s=e.pieces?Math.round(Math.sqrt(e.pieces)):3,t=s,u=d(this),v="show"===d.effects.setMode(u,e.mode||"hide"),x=u.show().css("visibility","hidden").offset(),y=Math.ceil(u.outerWidth()/t),z=Math.ceil(u.outerHeight()/s),A=[];for(k=0;s>k;k++){n=x.top+k*z;q=k-(s-1)/2;for(l=0;t>l;l++)m=x.left+l*y,p=l-(t-1)/2,u.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",
visibility:"visible",left:-l*y,top:-k*z}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:y,height:z,left:m+(v?p*y:0),top:n+(v?q*z:0),opacity:v?0:1}).animate({left:m+(v?0:p*y),top:n+(v?0:q*z),opacity:v?1:0},e.duration||500,e.easing,h)}}})(jQuery);(function(d){d.effects.effect.fade=function(e,f){var h=d(this),k=d.effects.setMode(h,e.mode||"toggle");h.animate({opacity:k},{queue:!1,duration:e.duration,easing:e.easing,complete:f})}})(jQuery);
(function(d){d.effects.effect.fold=function(e,f){var h,k,l=d(this),m="position top bottom left right height width".split(" ");h=d.effects.setMode(l,e.mode||"hide");var n="show"===h,p="hide"===h,q=e.size||15,s=/([0-9]+)%/.exec(q),t=!!e.horizFirst,u=(k=n!==t)?["width","height"]:["height","width"],v=e.duration/2,x={},y={};d.effects.save(l,m);l.show();h=d.effects.createWrapper(l).css({overflow:"hidden"});k=k?[h.width(),h.height()]:[h.height(),h.width()];s&&(q=parseInt(s[1],10)/100*k[p?0:1]);n&&h.css(t?
{height:0,width:q}:{height:q,width:0});x[u[0]]=n?k[0]:q;y[u[1]]=n?k[1]:0;h.animate(x,v,e.easing).animate(y,v,e.easing,function(){p&&l.hide();d.effects.restore(l,m);d.effects.removeWrapper(l);f()})}})(jQuery);
(function(d){d.effects.effect.highlight=function(e,f){var h=d(this),k=["backgroundImage","backgroundColor","opacity"],l=d.effects.setMode(h,e.mode||"show"),m={backgroundColor:h.css("backgroundColor")};"hide"===l&&(m.opacity=0);d.effects.save(h,k);h.show().css({backgroundImage:"none",backgroundColor:e.color||"#ffff99"}).animate(m,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){"hide"===l&&h.hide();d.effects.restore(h,k);f()}})}})(jQuery);
(function(d){d.effects.effect.pulsate=function(e,f){var h,k=d(this),l=d.effects.setMode(k,e.mode||"show");h="show"===l;var m="hide"===l,l=2*(e.times||5)+(h||"hide"===l?1:0),n=e.duration/l,p=0,q=k.queue(),s=q.length;(h||!k.is(":visible"))&&(k.css("opacity",0).show(),p=1);for(h=1;l>h;h++)k.animate({opacity:p},n,e.easing),p=1-p;k.animate({opacity:p},n,e.easing);k.queue(function(){m&&k.hide();f()});1<s&&q.splice.apply(q,[1,0].concat(q.splice(s,l+1)));k.dequeue()}})(jQuery);
(function(d){d.effects.effect.puff=function(e,f){var h=d(this),k=d.effects.setMode(h,e.mode||"hide"),l="hide"===k,m=parseInt(e.percent,10)||150,n=m/100,p={height:h.height(),width:h.width(),outerHeight:h.outerHeight(),outerWidth:h.outerWidth()};d.extend(e,{effect:"scale",queue:!1,fade:!0,mode:k,complete:f,percent:l?m:100,from:l?p:{height:p.height*n,width:p.width*n,outerHeight:p.outerHeight*n,outerWidth:p.outerWidth*n}});h.effect(e)};d.effects.effect.scale=function(e,f){var h=d(this),k=d.extend(!0,
{},e),l=d.effects.setMode(h,e.mode||"effect"),m=parseInt(e.percent,10)||(0===parseInt(e.percent,10)?0:"hide"===l?0:100),n=e.direction||"both",p=e.origin,q={height:h.height(),width:h.width(),outerHeight:h.outerHeight(),outerWidth:h.outerWidth()},s="horizontal"!==n?m/100:1,m="vertical"!==n?m/100:1;k.effect="size";k.queue=!1;k.complete=f;"effect"!==l&&(k.origin=p||["middle","center"],k.restore=!0);k.from=e.from||("show"===l?{height:0,width:0,outerHeight:0,outerWidth:0}:q);k.to={height:q.height*s,width:q.width*
m,outerHeight:q.outerHeight*s,outerWidth:q.outerWidth*m};k.fade&&("show"===l&&(k.from.opacity=0,k.to.opacity=1),"hide"===l&&(k.from.opacity=1,k.to.opacity=0));h.effect(k)};d.effects.effect.size=function(e,f){var h,k,l,m,n,p,q=d(this),s="position top bottom left right width height overflow opacity".split(" ");n="position top bottom left right overflow opacity".split(" ");var t=["width","height","overflow"],u=["fontSize"],v=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],x=["borderLeftWidth",
"borderRightWidth","paddingLeft","paddingRight"],y=d.effects.setMode(q,e.mode||"effect"),z=e.restore||"effect"!==y,A=e.scale||"both",G=e.origin||["middle","center"],E=q.css("position"),B=z?s:n,w={height:0,width:0,outerHeight:0,outerWidth:0};"show"===y&&q.show();n={height:q.height(),width:q.width(),outerHeight:q.outerHeight(),outerWidth:q.outerWidth()};"toggle"===e.mode&&"show"===y?(q.from=e.to||w,q.to=e.from||n):(q.from=e.from||("show"===y?w:n),q.to=e.to||("hide"===y?w:n));l=q.from.height/n.height;
m=q.from.width/n.width;h=q.to.height/n.height;k=q.to.width/n.width;("box"===A||"both"===A)&&(l!==h&&(B=B.concat(v),q.from=d.effects.setTransition(q,v,l,q.from),q.to=d.effects.setTransition(q,v,h,q.to)),m!==k&&(B=B.concat(x),q.from=d.effects.setTransition(q,x,m,q.from),q.to=d.effects.setTransition(q,x,k,q.to)));("content"===A||"both"===A)&&l!==h&&(B=B.concat(u).concat(t),q.from=d.effects.setTransition(q,u,l,q.from),q.to=d.effects.setTransition(q,u,h,q.to));d.effects.save(q,B);q.show();d.effects.createWrapper(q);
q.css("overflow","hidden").css(q.from);G&&(p=d.effects.getBaseline(G,n),q.from.top=(n.outerHeight-q.outerHeight())*p.y,q.from.left=(n.outerWidth-q.outerWidth())*p.x,q.to.top=(n.outerHeight-q.to.outerHeight)*p.y,q.to.left=(n.outerWidth-q.to.outerWidth)*p.x);q.css(q.from);("content"===A||"both"===A)&&(v=v.concat(["marginTop","marginBottom"]).concat(u),x=x.concat(["marginLeft","marginRight"]),t=s.concat(v).concat(x),q.find("*[width]").each(function(){var f=d(this),n=f.height(),p=f.width(),q=f.outerHeight(),
s=f.outerWidth();z&&d.effects.save(f,t);f.from={height:n*l,width:p*m,outerHeight:q*l,outerWidth:s*m};f.to={height:n*h,width:p*k,outerHeight:n*h,outerWidth:p*k};l!==h&&(f.from=d.effects.setTransition(f,v,l,f.from),f.to=d.effects.setTransition(f,v,h,f.to));m!==k&&(f.from=d.effects.setTransition(f,x,m,f.from),f.to=d.effects.setTransition(f,x,k,f.to));f.css(f.from);f.animate(f.to,e.duration,e.easing,function(){z&&d.effects.restore(f,t)})}));q.animate(q.to,{queue:!1,duration:e.duration,easing:e.easing,
complete:function(){0===q.to.opacity&&q.css("opacity",q.from.opacity);"hide"===y&&q.hide();d.effects.restore(q,B);z||("static"===E?q.css({position:"relative",top:q.to.top,left:q.to.left}):d.each(["top","left"],function(d,e){q.css(e,function(e,f){var h=parseInt(f,10),k=d?q.to.left:q.to.top;return"auto"===f?k+"px":h+k+"px"})}));d.effects.removeWrapper(q);f()}})}})(jQuery);
(function(d){d.effects.effect.shake=function(e,f){var h,k=d(this),l="position top bottom left right height width".split(" "),m=d.effects.setMode(k,e.mode||"effect"),n=e.direction||"left";h=e.distance||20;var p=e.times||3,q=2*p+1,s=Math.round(e.duration/q),t="up"===n||"down"===n?"top":"left",u="up"===n||"left"===n,n={},v={},x={},y=k.queue(),z=y.length;d.effects.save(k,l);k.show();d.effects.createWrapper(k);n[t]=(u?"-=":"+=")+h;v[t]=(u?"+=":"-=")+2*h;x[t]=(u?"-=":"+=")+2*h;k.animate(n,s,e.easing);for(h=
1;p>h;h++)k.animate(v,s,e.easing).animate(x,s,e.easing);k.animate(v,s,e.easing).animate(n,s/2,e.easing).queue(function(){"hide"===m&&k.hide();d.effects.restore(k,l);d.effects.removeWrapper(k);f()});1<z&&y.splice.apply(y,[1,0].concat(y.splice(z,q+1)));k.dequeue()}})(jQuery);
(function(d){d.effects.effect.slide=function(e,f){var h,k=d(this),l="position top bottom left right width height".split(" "),m=d.effects.setMode(k,e.mode||"show"),n="show"===m;h=e.direction||"left";var p="up"===h||"down"===h?"top":"left",q="up"===h||"left"===h,s={};d.effects.save(k,l);k.show();h=e.distance||k["top"===p?"outerHeight":"outerWidth"](!0);d.effects.createWrapper(k).css({overflow:"hidden"});n&&k.css(p,q?isNaN(h)?"-"+h:-h:h);s[p]=(n?q?"+=":"-=":q?"-=":"+=")+h;k.animate(s,{queue:!1,duration:e.duration,
easing:e.easing,complete:function(){"hide"===m&&k.hide();d.effects.restore(k,l);d.effects.removeWrapper(k);f()}})}})(jQuery);
(function(d){d.effects.effect.transfer=function(e,f){var h=d(this),k=d(e.to),l="fixed"===k.css("position"),m=d("body"),n=l?m.scrollTop():0,m=l?m.scrollLeft():0,p=k.offset(),k={top:p.top-n,left:p.left-m,height:k.innerHeight(),width:k.innerWidth()},p=h.offset(),q=d("<div class='ui-effects-transfer'></div>").appendTo(document.body).addClass(e.className).css({top:p.top-n,left:p.left-m,height:h.innerHeight(),width:h.innerWidth(),position:l?"fixed":"absolute"}).animate(k,e.duration,e.easing,function(){q.remove();
f()})}})(jQuery);function ExpressionInterpreter(){}
ExpressionInterpreter.prototype={html:function(d,e){$(d).html(this.addImgs(this.eval(this.addStored(e))));this.renderMath(d)},append:function(d,e){$(d).append(this.addImgs(this.eval(this.addStored(e))));this.renderMath(d)},interpInput:function(d){return this.eval(this.addStored(d))},interpImgs:function(d){return this.addImgs(d)},interp:function(d){return this.addImgs(this.eval(this.addStored(d)))},renderMath:function(d){MathJax.Hub.Queue(["Typeset",MathJax.Hub,d?$(d).attr("id"):void 0])},addStored:function(d){with({get:DataGetFuncs.get})return d.replace(/get[\s]*\([A-Za-z0-9,\s\-\.'"]*\)/g,
function(d,f){return eval(d)})},eval:function(d){if("number"==typeof d)return d;d=d.replace(/eval[\s]*\([0-9\(\)\+\-\*\/\s,\.'"]*\)/g,function(d,f){return eval(d)});return Number(d)===d?Number(d):d},sliceArgs:function(d){var e=[];d=d.replace(/[A-Za-z0-9\s-]*\(/,"");d=d.replace(")","");d+=",";for(var f=-1<d.indexOf(",");f;)f=d.indexOf(","),e.push(d.slice(0,f).killWhiteSpace()),d=d.slice(f+1,d.length),f=-1<d.indexOf(",");return e},finishAppend:function(){this.div=void 0;this.addedMath=!1},addImgs:function(d,
e){return d.replace(/img[\s]*\([A-Za-z0-9\+\-\*\/\s,\.'"]*\)/g,function(d,e){return eval(d)})},parseImgFunc:function(d,e){var f=this.sliceArgs(d),h=f[0],k=f[1],f=f[2],h=h.replace(/['"]/g,"");if(e)return{attrs:{src:[window.IMGPATHPREFIX+h]}};h=templater.img({attrs:{src:[window.IMGPATHPREFIX+h]}});f&&(h=templater.center({innerHTML:h}));"br"==k?h=templater.br()+h+templater.br():"p"==k&&(h=templater.p({innerHTML:h}));return h}};function SceneNavigator(){}
SceneNavigator.prototype={showPrompt:function(d,e,f){timeline.show(d,e,f)},refresh:function(){timeline.refresh()},nextPrompt:function(d,e){e=defaultTo(!0,e);timeline.curSection();var f=timeline.curPrompt(),h=timeline.now();if(d||this.checkWillAdvance()){this.sendAnswersToCW(window.curLevel.quiz);if(e)var k=this.checkDirections(f.directions);instrs=void 0!=k?this.evalDirections(k):{advance:!0,killBranches:!1};instrs.killBranches&&timeline.sections[timeline.sectionIdx].killBranches();instrs.advance&&
(f=this.getNextIdxs(),h=timeline.now(),f.sectionIdx==h.sectionIdx&&f.promptIdx==Math.floor(h.promptIdx)?timeline.surface(!0):this.showPrompt(f.sectionIdx,f.promptIdx))}},getNextIdxs:function(){var d=timeline.sectionIdx,e=timeline.curSection(),f=Math.floor(e.promptIdx);f+1==e.sectionData.prompts.length?d+1<timeline.sections.length&&(d++,f=0):f++;return{sectionIdx:d,promptIdx:f}},checkDirections:function(d){return d&&(d=d())?d:{advance:!0,killBranches:!0}},evalDirections:function(d){var e={branchPromptsPreClean:function(d,
e){d=d instanceof Array?d:[d];timeline.sections[timeline.sectionIdx].branchPromptsPreClean(d);return{advance:!0,killBranches:defaultTo(!1,e)}},branchPromptsPostClean:function(d,e){d=d instanceof Array?d:[d];timeline.sections[timeline.sectionIdx].branchPromptsPostClean(d);return{advance:!0,killBranches:defaultTo(!1,e)}},branchSections:function(d,e){d=d instanceof Array?d:[d];timeline.sections[timeline.sectionIdx].branchSections(d);return{advance:!0,killBranches:defaultTo(!1,e)}},surface:function(d,
e){timeline.surface(d);return{advance:!1,killBranches:defaultTo(!1,e)}},advance:function(){return{advance:!0,killBranches:!0}}};with(e)return eval(d)},getPrevIdxs:function(){var d=timeline.now(),e=d.sectionIdx,f=e,h=d=Math.ceil(d.promptIdx);0==d?0<e&&(f--,h=timeline.sections[f].sectionData.prompts.length-1):h--;return{sectionIdx:f,promptIdx:h}},checkWillAdvance:function(){var d=this.getNextIdxs();(d=Math.min(1,this.checkWillAdvanceConditions(d.sectionIdx,d.promptIdx)))&&(d=Math.min(d,this.checkWillAdvanceQuiz()));
return d},checkWillAdvanceConditions:function(d,e){var f=timeline.sectionIdx!=d,h=timeline.now(),h=conditionManager.canAdvance(h.promptIdx),k=!0;f&&h&&(k=conditionManager.canAdvance(-1));return Math.min(h,k)},checkWillAdvanceQuiz:function(){var d=curLevel.quiz;if(d){if(d.allAnswered()){if(d.allCorrect())return!0;d.fireAlertWrong();return!1}alert("You haven't answered all the questions.");return!1}return!0},sendAnswersToCW:function(d){d&&d.sendAnswersToCW()},prevPrompt:function(){var d=this.getPrevIdxs(),
e=timeline.now();d.sectionIdx==e.sectionIdx&&d.promptIdx==e.promptIdx?timeline.surface(!1):this.showPrompt(d.sectionIdx,d.promptIdx)}};function Templater(){}
Templater.prototype={elem:function(d){d.attrs=d.attrs||{};d.style=d.style||void 0;d.innerHTML=d.innerHTML||"";!d.attrs.class?d.attrs.class=[globalHTMLClass]:d.attrs.class.push(globalHTMLClass);d.templater=this;return this.elemTemp(d)},img:function(d){d?d.type="img":d={type:"img"};return this.elem(d)},div:function(d){d?d.type="div":d={type:"div"};return this.elem(d)},button:function(d){d?d.type="button":d={type:"button"};return this.elem(d)},textarea:function(d){d?d.type="textarea":d={type:"textarea"};
return this.elem(d)},p:function(d){d?d.type="p":d={type:"p"};return this.elem(d)},br:function(){return"<br>"},tab:function(){return"&#09;"},table:function(d){d?d.type="table":d={type:"table"};return this.elem(d)},tr:function(d){d?d.type="tr":d={type:"tr"};return this.elem(d)},td:function(d){d?d.type="td":d={type:"td"};return this.elem(d)},center:function(d){d?d.type="center":d={type:"center"};return this.elem(d)},label:function(d){d?d.type="label":d={type:"label"};return this.elem(d)},canvas:function(d){d?
d.type="canvas":d={type:"canvas"};return this.elem(d)},input:function(d){d?d.type="input":d={type:"input"};return this.elem(d)},checkbox:function(d){d=d||{};d.attrs=d.attrs||{};d.attrs.type=["checkbox"];return this.input(d)},select:function(d){d?d.type="select":d={type:"select"};return this.elem(d)},option:function(d){d?d.type="option":d={type:"option"};return this.elem(d)},ul:function(d){d?d.type="ul":d={type:"ul"};return this.elem(d)},li:function(d){d?d.type="li":d={type:"li"};return this.elem(d)},
a:function(d){d?d.type="a":d={type:"a"};return this.elem(d)},appendRadio:function(d,e,f,h){var k=templater.div({attrs:{id:[h+"TemplaterWrapper"]},style:{height:46,position:"relative",top:"15px"}});$(d).append(k);d=$("#"+h+"TemplaterWrapper");k="";f=f||0;for(var l=0;l<e.length;l++){var m,n,p;m=e[l];n=m.text;m=m.id;n=this.a({innerHTML:n,attrs:{href:["#"]}});p=[h];l==f&&p.push("on");m=this.li({innerHTML:n,attrs:{"class":p,id:[m]}});k+=m}f=this.ul({innerHTML:k,attrs:{id:[h]}});$(d).append(f);this.radioActivate(e,
h)},radioActivate:function(d,e){for(var f=0;f<d.length;f++){var h,k;h=d[f];k=$("#"+h.id);this.bindRadio(k,e,h.cb)}},bindRadio:function(d,e,f){$(d).click(function(){$("li."+e).removeClass("on");$(this).addClass("on");f&&f()})},tableFromArray:function(d,e,f){var h="";e=e||{};f=f||{};var k=e.table,l=e.tr;e=e.td;var m=f.table,n=f.tr;f=f.td;for(var p=0;p<d.length;p++){var q=d[p];rowInnerHTML="";for(var s=0;s<q.length;s++)rowInnerHTML+=templater.td({innerHTML:q[s],attrs:e?{"class":e.concat()}:void 0,style:f?
f:void 0});h+=templater.tr({innerHTML:rowInnerHTML,attrs:l?{"class":l.concat()}:void 0,style:n?n:void 0})}return templater.table({innerHTML:h,attrs:k?{"class":k.concat()}:void 0,style:m?m:void 0})},style:function(d){return this.styleTemp(d)},elemTemp:_.template("<<%= type%><% for (var attr in attrs) { %><%= ' ' + attr %>='<%= attrs[attr].join(' ') %>'<% } %><%= style ? ' ' : '' %><%= templater.style({style: style}) %>><%= innerHTML %></<%= type %>>"),styleTemp:_.template("<% if (!style) {return ''} %>style='<% for (var stylet in style) { %><%= stylet %>:<%= style[stylet] %>;<% } %>'")};function Dot(d,e,f,h,k,l,m){var n=window.spcs[h];this.x=d;this.y=e;this.v=f;this.m=n.m;this.r=n.r;this.spcName=h;this.elemId=defaultTo(-1,l);this.idNum=n.idNum;this.hF298=defaultTo(0,1E3*n.hF298/N);this.uF298=defaultTo(0,1E3*n.uF298/N);this.hVap298=defaultTo(0,1E3*n.hVap298/N);this.sF298=defaultTo(0,1E3*n.sF298/N);this.cvKinetic=1.5*R/N;this.cv=n.cv/N;this.cp=this.cv+R/N;this.cpLiq=defaultTo(this.cv,n.cpLiq/N);this.spcVolLiq=defaultTo(0.0010,n.spcVolLiq/N);this.tag=k;this.returnTo=m;this.tConst=tConst;
this.pxToE=pxToE;this.pxToMS=pxToMS;this.parentLists=[];this.internalPotential=this.temp()*(this.cv-this.cvKinetic);this.peCur=this.tempLast=this.peLast=0;this.active=!0}function Species(d,e,f,h,k,l,m,n,p,q,s,t,u){this.spcName=d;this.m=e;this.r=f;this.col=h;this.idNum=k;this.cv=l;this.cp=l+R;this.hF298=m;this.uF298=this.hF298-298.15*R/1E3;this.hVap298=n;this.sF298=p;this.antoineCoeffs=q;this.cpLiq=s;this.spcVolLiq=t;this.dots=u.addSpcs(d)}
Species.prototype={populate:function(d,e,f,h,k,l,m,n){n=n||dotManager;var p=d.x;d=d.y;var q=e.dx;e=e.dy;for(var s=[],t=0;t<f;t++){var u=p+Math.random()*q,v=d+Math.random()*e,x=tempToV(this.m,h),y=2*Math.random()*Math.PI,z=x*Math.cos(y),x=x*Math.sin(y);s.push(D(u,v,V(z,x),this.spcName,k,l,m))}n.add(s)},depopulate:function(d){console.trace();d?dotManager.removeByInfo({name:this.def.spcName,tag:d}):dotManager.removeByInfo({name:this.def.spcName})},place:function(d){for(var e=[],f=0;f<d.length;f++){var h=
d[f];e.push(D(h.pos.x,h.pos.y,h.dir.copy().mult(tempToV(this.m,h.temp)),this.spcName,h.tag,void 0,h.returnTo))}dotManager.add(e)},placeSingle:function(d,e,f,h,k){birth=D(d.x,d.y,e.copy().mult(tempToV(this.m,f)),this.spcName,h,void 0,k);dotManager.add(birth)},enthalpy:function(d){return(1E3*this.hF298+(this.cv+R)*(d-298.15))/N},internalEnergy:function(d){return(1E3*this.uF298+this.cv*(d-298.15))/N},tBoil:function(d){d/=MMHGTOBAR;var e=this.antoineCoeffs;return e.b/(e.a-Math.log10(d))-e.c},pPure:function(d){var e=
this.antoineCoeffs;return MMHGTOBAR*Math.pow(10,e.a-e.b/(e.c+d))}};function Point(d,e){this.x=d;this.y=e}function Vector(d,e){this.dx=d;this.dy=e}function Color(d,e,f){this.r=d;this.g=e;this.b=f;this.setHex()}function D(d,e,f,h,k,l,m){return new Dot(d,e,f,h,k,l,m)}function P(d,e){return new Point(d,e)}function V(d,e){return new Vector(d,e)}function Col(d,e,f){return new Color(d,e,f)}function ValObj(d){this.x=d}
Vector.prototype={UV:function(){var d=Math.sqrt(this.dx*this.dx+this.dy*this.dy);return V(this.dx/d,this.dy/d)},mag:function(){return Math.sqrt(this.dx*this.dx+this.dy*this.dy)},add:function(d){this.dx+=d.dx;this.dy+=d.dy;return this},sub:function(d){this.dx-=d.dy;this.dy-=d.dx;return this},set:function(d){this.dx=d.dx;this.dy=d.dy},neg:function(){this.dx*=-1;this.dy*=-1;return this},dotProd:function(d){return this.dx*d.dx+this.dy*d.dy},crossProd:function(d){return this.dx*d.dy-this.dy*d.dx},magSqr:function(){return this.dx*
this.dx+this.dy*this.dy},copy:function(){return new Vector(this.dx,this.dy)},mult:function(d){this.dx*=d;this.dy*=d;return this},multVec:function(d){this.dx*=d.dx;this.dy*=d.dy;return this},setMag:function(d){this.mult(d/this.mag());return this},adjust:function(d,e){this.dx+=d;this.dy+=e;return this},rotate:function(d){var e=this.dx,f=this.dy,h=Math.cos(d);d=Math.sin(d);this.dx=e*h-f*d;this.dy=e*d+f*h;return this},perp:function(d){var e=this.dx,f=this.dy;d?"cw"==d?(this.dx=f,this.dy=-e):(this.dx=
-f,this.dy=e):(this.dx=f,this.dy=-e);return this},angle:function(){return Math.atan2(this.dy,this.dx)},sameAs:function(d){return this.dx==d.dx&&this.dy==d.dy},isValid:function(){return void 0!==this.dx&&!isNaN(this.dx)&&void 0!==this.dy&&!isNaN(this.dy)},zero:function(){this.y=this.x=0}};
Color.prototype={adjust:function(d,e,f){this.r=Math.round(Math.min(255,Math.max(0,this.r+d)));this.g=Math.round(Math.min(255,Math.max(0,this.g+e)));this.b=Math.round(Math.min(255,Math.max(0,this.b+f)));this.setHex();return this},set:function(d){void 0!==d.r&&(this.r=d.r);void 0!==d.g&&(this.g=d.g);void 0!==d.b&&(this.b=d.b);this.setHex();return this},setFromUnround:function(d){void 0!==d.r&&(this.r=Math.round(d.r));void 0!==d.g&&(this.g=Math.round(d.g));void 0!==d.b&&(this.b=Math.round(d.b));this.setHex();
return this},setHex:function(){var d=Number(Math.round(this.r)).toString(16),e=Number(Math.round(this.g)).toString(16),f=Number(Math.round(this.b)).toString(16);1==d.length&&(d="0"+d);1==e.length&&(e="0"+e);1==f.length&&(f="0"+f);this.hex="#"+d+e+f},copy:function(){return new Color(this.r,this.g,this.b)},add:function(d){this.r=Math.round(Math.min(255,Math.max(0,this.r+d.r)));this.g=Math.round(Math.min(255,Math.max(0,this.g+d.g)));this.b=Math.round(Math.min(255,Math.max(0,this.b+d.b)));this.setHex();
return this},addNoBounds:function(d){this.r=Math.round(this.r+d.r);this.g=Math.round(this.g+d.g);this.b=Math.round(this.b+d.b);this.setHex();return this},mult:function(d){this.r=Math.round(Math.min(255,Math.max(0,this.r*d)));this.g=Math.round(Math.min(255,Math.max(0,this.g*d)));this.b=Math.round(Math.min(255,Math.max(0,this.b*d)));this.setHex();return this},sameAs:function(d){return this.r==d.r&&this.g==d.g&&this.b==d.b}};
Point.prototype={distTo:function(d){var e=this.x-d.x;d=this.y-d.y;return Math.sqrt(e*e+d*d)},distSqrTo:function(d){var e=this.x-d.x;d=this.y-d.y;return e*e+d*d},VTo:function(d){return new Vector(d.x-this.x,d.y-this.y)},UVTo:function(d){var e=Math.sqrt((this.x-d.x)*(this.x-d.x)+(this.y-d.y)*(this.y-d.y));return new Vector((d.x-this.x)/e,(d.y-this.y)/e)},fracVTo:function(d,e){return this.VTo(d).mult(e)},fracMoveTo:function(d,e){this.movePt(this.fracVTo(d,e));return this},set:function(d){this.x=d.x;
this.y=d.y},avg:function(d){return new Point((this.x+d.x)/2,(this.y+d.y)/2)},area:function(d,e){var f=V(d.x-this.x,d.y-this.y),h=f.UV(),f=f.mag(),h=V(-h.dy,h.dx),k=V(e.x-this.x,e.y-this.y),h=Math.abs(h.dotProd(k));return 0.5*f*h},copy:function(){return new Point(this.x,this.y)},movePt:function(d){void 0!==d.dx&&(this.x+=d.dx);void 0!==d.dy&&(this.y+=d.dy);return this},moveInDir:function(d,e){this.x+=Math.cos(e)*d;this.y+=Math.sin(e)*d;return this},position:function(d){void 0!==d.x&&(this.x=d.x);void 0!==
d.y&&(this.y=d.y);return this},scale:function(d,e){var f=this.y-d.y;this.x=d.x+(this.x-d.x)*e;this.y=d.y+f*e;return this},rotate:function(d,e){var f=new Vector(d.x,d.y);this.movePt(f.copy().neg());var h=this.x,k=this.y;this.x=h*Math.cos(e)-k*Math.sin(e);this.y=h*Math.sin(e)+k*Math.cos(e);this.movePt(f);return this},mirror:function(d,e){var f=e.UV(),h=d.VTo(this),f=f.perp("cw"),h=h.dotProd(f);0>h?this.movePt(f.mult(Math.abs(2*h))):0<h&&this.movePt(f.neg().mult(2*h));return this},rect:function(d,e){var f=
Array(4);"ccw"==e?(f[0]=this.copy(),f[1]=this.copy().movePt({dy:d.dy}),f[2]=this.copy().movePt(d),f[3]=this.copy().movePt({dx:d.dx})):(f[0]=this.copy(),f[1]=this.copy().movePt({dx:d.dx}),f[2]=this.copy().movePt(d),f[3]=this.copy().movePt({dy:d.dy}));return f},roundedRect:function(d,e,f){d=this.rect(d,f);return this.roundPts(d,e)},roundPts:function(d,e){this.sameAs(d[0])||(d=[this].concat(d));var f=Array(2*d.length);d["-1"]=d[d.length-1];d.push(d[0]);for(var h=0;h<d.length-1;h++)f[2*h]=d[h].copy().fracMoveTo(d[String(h-
1)],e/2),f[2*h+1]=d[h].copy().fracMoveTo(d[String(h+1)],e/2);return f},sameAs:function(d){return this.x==d.x&&this.y==d.y},closeTo:function(d){return 1>Math.abs(this.x-d.x)&&1>Math.abs(this.y-d.y)},isValid:function(){return void 0!==this.x&&!isNaN(this.x)&&void 0!==this.y&&!isNaN(this.y)},track:function(d){var e,f,h,k,l;d instanceof Point?(e=d,f=V(0,0),d=h=!1):(e=d.pt,f=void 0==d.offset?V(0,0):V(d.offset.dx||0,d.offset.dy||0),h=/x/i.test(d.noTrack),d=/y/i.test(d.noTrack));k=!h?1:0;l=!d?1:0;h=function(){this.x+=
k*(e.x-this.x+f.dx);this.y+=l*(e.y-this.y+f.dy)};this.trackListenerId=unique(this.x+","+this.y+"tracksWithUniqueId",curLevel.updateListeners);addListener(curLevel,"update",this.trackListenerId,h,this);h||(console.log("tried to track "+this.trackListenerId+" but input wasn't right"),console.trace());this.tracking=!0;return this},trackStop:function(){this.tracking&&(removeListener(curLevel,"update",this.trackListenerId),this.trackListenerId=void 0,this.tracking=!1);return this}};
Dot.prototype={KE:function(){return 0.5*this.m*(this.v.dx*this.v.dx+this.v.dy*this.v.dy)},temp:function(){return 0.5*this.m*(this.v.dx*this.v.dx+this.v.dy*this.v.dy)*this.tConst},tempCondense:function(){return(this.cv*(this.temp()-298.15)+this.hVap298)/this.cpLiq+298.15},tempVaporize:function(d){return(this.cpLiq*(this.temp()-298.15)-this.hVap298)/this.cv+298.15},hVap:function(){return this.hVap298+(this.temp()-298.15)*(this.cv-this.cpLiq)},setTemp:function(d){var e=this.temp();this.v.mult(Math.sqrt(d/
e));this.internalPotential*=d/e;return this},setTempNoReference:function(d){var e=this.v.UV(),f=Math.sqrt(2*d/(this.m*this.tConst));this.v.dx=e.dx*f;this.v.dy=e.dy*f;this.internalPotential=d*(this.cv-this.cvKinetic)},addEnergy:function(d){var e=this.temp();tF=Math.max(1,e+d/this.cv);this.v.mult(Math.sqrt(tF/e));this.internalPotential*=tF/e;return(tF-e)*this.cv},adjTemp:function(d){var e=this.temp();this.internalPotential+=d*(this.cv-this.cvKinetic)/this.N;this.v.mult(Math.sqrt((e+d)/e));return this},
enthalpy:function(){return this.hF298+(this.temp()-298.15)*(this.cv+R/N)},internalEnergy:function(){return this.uF298+(this.temp()-298.15)*this.cv},kineticEnergy:function(){return this.temp()*this.cvKinetic},speed:function(){return this.v.mag()*this.pxToMS},kill:function(d){for(var e=0;e<this.parentLists.length;e++)this.parentLists[e].splice(this.parentLists[e].indexOf(this),1);this.parentLists.splice(0,this.parentLists.length);d&&(this.active=!1)}};toInherit={gridder:{makeGrid:function(){for(var d=this.numCols,e=this.numRows,f=Array(d),h=0;h<d;h++){for(var k=Array(e),l=0;l<e;l++)k[l]=[];f[h]=k}return f}},ArrayExtenders:{pushNumber:function(d){!isNaN(d)&&void 0!==d&&this.push(d);return this},append:function(d){for(var e=0;e<d.length;e++)this.push(d[e]);return this},average:function(){for(var d=0,e=0;e<this.length;e++)d+=this[e];return d/this.length},switchElements:function(d,e){var f=this[d];this[d]=this[e];this[e]=f;return this}},MathExtenders:{log10:function(d){return Math.log(d)/
2.302585092994046}},StringExtenders:{killWhiteSpace:function(){return this.replace(/\s+/g,"")},killNumbers:function(){return this.replace(/[0-9]/g,"")},toCamelCase:function(){return this.replace(/(?:^\w|[A-Z]|\b\w)/g,function(d,e){return 0==e?d.toLowerCase():d.toUpperCase()}).replace(/\s+/g,"")},toCapitalCamelCase:function(){return this.replace(/(?:^\w|[A-Z]|\b\w)/g,function(d,e){return d.toUpperCase()}).replace(/\s+/g,"")},sanitize:function(){return this.replace(/'/g,"&#39;").replace(/"/g,"&#34;").replace(/</g,
"&#60;").replace(/>/g,"&#62;").replace(/{/g,"&#123;").replace(/}/g,"&#125;")}},ArrowFuncs:{getPts:function(){var d=Array(3),e=this.dims.dx,f=this.dims.dy;d[0]=P(0,0.2*f);d[1]=P(0.7*e,0.2*f);d[2]=P(0.7*e,0.5*f);f=deepCopy(d).reverse();d.push(P(e,0));for(e=0;e<f.length;e++)d.push(P(f[e].x,-f[e].y));return d}}};function gauss(d,e){var f=Math.random()+Math.random()+Math.random()-1.5;return d+f*e}function bound(d,e,f){return Math.min(Math.max(d,e),f)}function stepTowards(d,e,f){f=Math.abs(f);return d<e?Math.min(e,d+f):Math.max(e,d-f)}function changeTemp(d,e){for(var f=dotManager.get(d),h=0;h<f.length;h++)f[h].setTemp(e)}function changeRMS(d,e){for(var f=dotManager.get(d),h=rms(dataHandler.velocities(d)),h=e/h,k=0;k<f.length;k++)f[k].v.mult(h)}function tempToV(d,e){e=2*e/tConst;return Math.sqrt(e/d)}
function VToTemp(d,e){return 0.5*d*e*e*tConst}function tempToKE(d){return d/tConst}function returnEscapist(d){returnTo=defaultTo(0,d.returnTo);var e=walls[returnTo][0],f=walls[returnTo][1],h=walls[returnTo].wallUVs[0],k=(e.x+f.x)/2-5*h.dy,e=(e.y+f.y)/2+5*h.dx;d.v.dy=Math.abs(d.v.dy);d.x=k;d.y=e}function defaultTo(d,e){return void 0===e?d:e}function validNumber(d){return isNaN(d)||void 0===d?!1:d}function round(d,e){var f=Math.pow(10,e);return Math.round(d*f)/f}
function unique(d,e){if("function"==typeof e){if(e(d)){for(var f=1;e(d+f);)f++;return d+f}}else if(e[d]){for(f=1;e[d+f];)f++;return d+f}return d}function addListener(d,e,f,h,k){d[e+"Listeners"][f]=new Listener(h,k)}function addListenerOnce(d,e,f,h,k){d[e+"Listeners"][f]=new Listener(function(){h.apply(k);removeListener(d,e,f)},void 0)}function addInterval(d,e,f,h){extraIntervals[d]=window.setInterval(function(){e.apply(f)},h)}
function removeInterval(d){extraIntervals[d]&&(window.clearInterval(extraIntervals[d]),extraIntervals[d]=void 0)}function removeListener(d,e,f){delete d[e+"Listeners"][f]}function Listener(d,e){this.func=d;this.obj=e}function removeListenerByName(d,e,f){for(var h=!1,k=getListenerByName(d,e,f);void 0!==k;)h=!0,delete d[e+"Listeners"][k],k=getListenerByName(d,e,f);return h}function makeListenerHolder(d,e){d[e+"Listeners"]={};return d[e+"Listeners"]}
function listenerExists(d,e,f){return void 0!==d[e+"Listeners"][f]}function emptyListener(d,e){d[e+"Listeners"]={}}function getListenerByName(d,e,f){for(thisFuncName in d[e+"Listeners"])if(-1!=thisFuncName.indexOf(f))return thisFuncName}function store(d,e){stored[d]=e}function getStore(d){return stored[d]}function eraseStore(d){d?stored[d]=void 0:stored={}}
function getAndEval(d){if("number"==typeof d)return d;if("string"==typeof d)return interpreter.interpInput(d);if("boolean"==typeof d)return d;if(d instanceof Point){var e=this.getAndEval(d.x);d=this.getAndEval(d.y);return P(e,d)}if(d instanceof Vector)return e=this.getAndEval(d.dx),d=this.getAndEval(d.dy),V(e,d);if(d instanceof Color){var e=this.getAndEval(d.r),f=this.getAndEval(d.g);d=this.getAndEval(d.b);return Col(e,f,d)}if(d instanceof Array){e=[];for(f=0;f<d.length;f++)e.push(this.getAndEval(d[f]));
return e}if("function"==typeof d)return d;if(d instanceof Object){e={};for(f in d)e[f]=this.getAndEval(d[f]);return e}}function deepCopy(d){var e=new d.constructor,f;for(f in d)e[f]="object"==typeof d[f]?deepCopy(d[f]):d[f];return e}function deepCopySafe(d){return deepCopyStep(d,[d],[])}
function deepCopyStep(d,e,f){var h;try{h=new d.constructor}catch(k){h={}}f.push(h);for(var l in d){var m=d[l];if("object"==typeof m){var n=e.indexOf(m);h[l]=-1==n?deepCopyStep(m,e.concat([m]),f.concat()):f[n]}else h[l]=m}return h}function recordData(d,e,f,h){h=defaultTo("record",h);store("record"+d,h);var k=f.func,l=f.obj;addListener(curLevel,h,d,function(){e.push(k.apply(l))},l)}function recordDataStop(d){var e=getStore("record"+d);removeListener(curLevel,e,d)}
function grabAttrs(d,e){var f={},h;for(h in d){f[h]={};for(var k=0;k<e.length;k++)f[h][e[k]]=d[h][e[k]]}return f}function execListeners(d){for(var e in d){var f=d[e];f.func.apply(f.obj)}}
function makeSlider(d,e,f,h,k,l,m,n){var p="";k=""+templater.center({innerHTML:k});p+=templater.div({attrs:{id:[h+"parent"]},style:{padding:"5px"},innerHTML:templater.div({attrs:{id:[h]}})});d.append(k);e.append(p);p=$(f+"parent");f=$(f);(!p.length||!f.length)&&p;addJQueryElems($(f),"slider");f.slider("option",l);for(l=0;l<m.length;l++){var q=m[l],p=q.eventType;k=q.obj;q=q.func;void 0===k?sliderBind(f,p,q,""):sliderBind(f,p,q,k)}if(n)div[n]();sliderList.push(h);return[d,e]}
function sliderBind(d,e,f,h){d.bind(e,function(d,e){f.apply(h,[d,e])});return d}function addJQueryElems(d,e){d=d instanceof Array?d:[d];for(var f=0;f<d.length;f++){var h=d[f];$(h)[e]();recursiveAddClass(h,globalHTMLClass)}}function recursiveAddClass(d,e){$(d).addClass(e);for(var f=$(d).children(),h=0;h<f.length;h++){var k=$(f[h]);recursiveAddClass(k,e)}}function stringTogetherGET(d){var e=[],f;for(f in d)e.push(f+"="+d[f]);return e.join("&")}
function hideSliders(){for(;0<sliderList.length;idIdx++)$("#"+sliderList[0]).hide()}function S(d,e,f){sceneNavigator.showPrompt(d,e,f)}function alertValid(d){void 0!==d&&""!=d&&alert(d)}function fillEmptyGraphDivs(){for(var d=0;d<graphHolderDivs.length;d++)fillEmptyGraphDiv($("#"+graphHolderDivs[d]))}function fillEmptyGraphDiv(d){"empty"==$(d).attr("filledWith")&&new GraphBlank(d)}function rotatePts(d,e,f){for(var h=0;h<d.length;h++)d[h].rotate(e,f)}
function mirrorPts(d,e,f){for(var h=0;h<d.length;h++)d[h].mirror(e,f);return d}function angleToUV(d){return V(Math.cos(d),Math.sin(d))}function UVToAngle(d){return Math.atan2(d.dy,d.dx)}function getSign(d){return 0>d?-1:1}function fracDiff(d,e){return Math.abs(d-e)/Math.min(Math.abs(d),Math.abs(e))}function getLen(d){for(var e=0,f=0;f<d.length-1;f++)e+=d[f].distTo(d[f+1]);return e}function exprHasReturn(d){return/(\(|\:|\?|\s|\{)return/.test(" "+d)}
function byAttr(d,e,f){if(d instanceof Array)for(var h=0;h<d.length;h++){if(d[h][f]==e)return d[h]}else for(h in d)if(d[h][f]==e)return d[h]}function inRect(d,e,f){f=mouseOffset(f);return f.x>=d.x&&f.x<=d.x+e.dx&&f.y>=d.y&&f.y<=d.y+e.dy}function ptInRect(d,e,f){return f.x>=d.x&&f.x<=d.x+e.dx&&f.y>=d.y&&f.y<=d.y+e.dy}function extend(d,e){return function(){return e(d())}}function getNth(d,e){var f=0,h;for(h in d)if(f++==e)return d[h]}function countAttrs(d){var e=0,f;for(f in d)e++;return e}
function objectsEqual(d,e){return Math.min(objectsEqualInDirection(d,e),objectsEqualInDirection(e,d))}function objectsEqualInDirection(d,e){for(var f in d)if(e&&e.hasOwnProperty(f))if("object"==typeof d[f]){if(!objectsEqual(d[f],e[f]))return!1}else{if(d[f]!=e[f])return!1}else return!1;return!0}function rms(d){for(var e=0,f=0;f<d.length;f++)e+=d[f]*d[f];e/=d.length;return Math.sqrt(e)}globalMousePos=P(0,0);
function mouseOffset(d){d=$(d).offset();return P(globalMousePos.x-d.left,globalMousePos.y-d.top)}function mouseOffsetDiv(d){d=$("#"+d).offset();return P(globalMousePos.x-d.left,globalMousePos.y-d.top)}$(document).mousemove(function(d){globalMousePos.x=d.pageX;globalMousePos.y=d.pageY;for(var e in curLevel.mousemoveListeners)d=curLevel.mousemoveListeners[e],d.func.apply(d.obj)});$(document).mousedown(function(d){for(var e in curLevel.mousedownListeners)d=curLevel.mousedownListeners[e],d.func.apply(d.obj)});
$(document).mouseup(function(d){for(var e in curLevel.mouseupListeners)d=curLevel.mouseupListeners[e],d.func.apply(d.obj)});function DrawingTools(){}
DrawingTools.prototype={dots:function(d){for(var e in spcs){var f=spcs[e].dots;d.fillStyle=spcs[e].col.hex;if(f[0])var h=f[0].r;for(var k=0;k<f.length;k++)d.beginPath(),d.arc(f[k].x,f[k].y,h,0,2*Math.PI,!0),d.closePath(),d.fill()}},dotsAsst:function(d,e){for(var f=0;f<d.length;f++)e.fillStyle=spcs[d[f].spcName].col.hex,e.beginPath(),e.arc(d[f].x,d[f].y,d[f].r,0,2*Math.PI,!0),e.closePath(),e.fill()},walls:function(d,e){for(var f=0;f<d.length;f++){var h=d[f];if(h.show){e.beginPath();e.strokeStyle=h.col.hex;
e.moveTo(h[0].x,h[0].y);for(var k=1;k<h.length-1;k++)e.lineTo(h[k].x,h[k].y);e.closePath();e.stroke()}}},circle:function(d,e,f,h,k){k.beginPath();k.arc(d.x,d.y,e,0,2*Math.PI,!0);k.closePath();h?(k.fillStyle=f.hex,k.fill()):(k.strokeStyle=f.hex,k.stroke())},fillPts:function(d,e,f){f.fillStyle=e.hex;f.beginPath();f.moveTo(d[0].x,d[0].y);for(e=1;e<d.length;e++)f.lineTo(d[e].x,d[e].y);f.closePath();f.fill()},fillPtsAlpha:function(d,e,f,h){var k=h.globalAlpha;h.globalAlpha=f;draw.fillPts(d,e,h);h.globalAlpha=
k},fillPtsStroke:function(d,e,f,h){h.fillStyle=e.hex;h.strokeStyle=f.hex;h.beginPath();h.moveTo(d[0].x,d[0].y);for(e=1;e<d.length;e++)h.lineTo(d[e].x,d[e].y);h.closePath();h.stroke();h.fill()},roundedRect:function(d,e,f,h,k){var l=d.x;d=d.y;var m=e.dx;e=e.dy;k.fillStyle=h.hex;k.beginPath();k.moveTo(l+f,d);this.curvedLine(P(l+m-f,d),P(l+m,d),P(l+m,d+f),k);this.curvedLine(P(l+m,d+e-f),P(l+m,d+e),P(l+m-f,d+e),k);this.curvedLine(P(l+f,d+e),P(l,d+e),P(l,d+e-f),k);this.curvedLine(P(l,d+f),P(l,d),P(l+f,
d),k);k.closePath();k.fill()},fillRect:function(d,e,f,h){h.fillStyle=f.hex;h.fillRect(d.x,d.y,e.dx,e.dy)},fillStrokeRect:function(d,e,f,h,k){k.strokeStyle=h.hex;k.fillStyle=f.hex;k.fillRect(d.x,d.y,e.dx,e.dy);k.strokeRect(d.x,d.y,e.dx,e.dy)},strokeRect:function(d,e,f,h){h.strokeStyle=f.hex;h.strokeRect(d.x,d.y,e.dx,e.dy)},line:function(d,e,f,h){h.strokeStyle=f.hex;h.beginPath();h.moveTo(d.x,d.y);h.lineTo(e.x,e.y);h.closePath();h.stroke()},curvedLine:function(d,e,f,h){h.lineTo(d.x,d.y);h.quadraticCurveTo(e.x,
e.y,f.x,f.y)},path:function(d,e,f){f.strokeStyle=e.hex;f.beginPath();f.moveTo(d[0].x,d[0].y);for(e=1;e<d.length;e++)f.lineTo(d[e].x,d[e].y);f.stroke()},text:function(d,e,f,h,k,l,m){m.save();m.translate(e.x,e.y);m.rotate(l);m.fillStyle=h.hex;m.font=f;m.textAlign=k;e=parseFloat(f);f=0;for(h=d.indexOf("\n");-1!=h;)k=d.slice(0,h),m.fillText(k,0,f),f+=e+2,d=d.slice(h+1,d.length),h=d.indexOf("\n");m.fillText(d,0,f);m.restore()}};function DotManager(){this.lists={ALLDOTS:[]};this.spcLists={};this.count=0}
DotManager.prototype={add:function(d){d instanceof Array?this.count+=d.length:this.count++;this.execAllCombos(this.addFunc,d)},remove:function(d,e){e=void 0===e?!0:e;if(d instanceof Array){this.count-=d.length;for(var f=0;f<d.length;f++)d[f].kill(e)}else this.count--,d.kill(e)},removeByAttr:function(d,e){for(var f=this.lists.ALLDOTS,h=f.length-1;0<=h;h--)f[h][d]==e&&f[h].kill()},changeDotSpc:function(d,e){d instanceof Array||(d=[d]);for(var f=spcs[e],h=0;h<d.length;h++){var k=d[h],l=(k.hF298-1E3*
f.hF298/N+k.cv*(k.temp()-298.15))/(f.cv/N)+298.15;if(0<l){for(var m=0;m<k.parentLists.length;m++)k.parentLists[m].splice(k.parentLists[m].indexOf(k),1);k.parentLists=[];k.m=f.m;k.r=f.r;k.col=f.col;k.spcName=f.spcName;k.hF298=1E3*f.hF298/N;k.hVap298=1E3*f.hVap298/N;k.idNum=f.idNum;k.cvKinetic=1.5*R/N;k.cv=f.cv/N;k.cp=k.cv+R;k.cpLiq=f.cpLiq/N;k.spcVolLiq=f.spcVolLiq/N;k.setTempNoReference(l);l=this.getRelevantLists(k);for(m=0;m<l.length;m++)k.parentLists.push(l[m]),l[m].push(k)}}},changeDotWall:function(d,
e){var f,h;d instanceof Array||(d=[d]);for(var k=0;k<d.length;k++){var l=d[k];l.tag=e;l.returnTo=e;f=0;for(h=l.parentLists.length;f<h;f++)l.parentLists[f].splice(l.parentLists[f].indexOf(l),1);l.parentLists=[];var m=this.getRelevantLists(l);f=0;for(h=m.length;f<h;f++)l.parentLists.push(m[f]),m[f].push(l)}},addSpcs:function(d){this.lists[d]||(this.lists[d]=[],this.spcLists[d]=this.lists[d]);return this.lists[d]},removeByInfo:function(d){d.spcName&&d.tag?this.execAllCombos(this.removeByNameAndTagFunc,
d):d.spcName?this.execAllCombos(this.removeByNameFunc,d):d.tag?this.execAllCombos(this.removeByTagFunc,d):(console.log("No useful info given to removeByInfo func in DotManager"),console.trace())},getWithLog:function(d){var e=this.get(d);if(e)return e;console.log("Bad species data");console.log(d)},get:function(d){return this.createIfNotExists(d)},clearAll:function(){for(var d in this.lists)this.lists[d].splice(0,this.lists[d].length)},createIfNotExists:function(d){if(d){if(d.spcName&&d.tag)return this.getByNameAndTag(d);
if(d.spcName)return this.getByName(d.spcName);if(d.tag)return this.getByTag(d.tag)}else return this.lists.ALLDOTS},addFunc:function(d,e){d.push(e);e.parentLists.push(d)},removeFunc:function(d,e){var f=d.indexOf(e);-1<f?(d.splice(f,1),e.parentLists.splice(e.parentLists.indexOf(d),1)):(console.log("Tried to remove dot from global list of spcName "+e.spcName+" and tag "+e.tag+". Dot not present."),console.trace())},removeByNameAndTagFunc:function(d,e){for(var f=d.length-1;-1<f;f--)d[f].spcName==e.spcName&&
d[f].tag==e.tag&&d[f].kill()},removeByNameFunc:function(d,e){for(var f=d.length-1;-1<f;f--)d[f].spcName==e.spcName&&(d.splice(f,1),d[f].kill())},removeByNameAndTagFunc:function(d,e){for(var f=d.length-1;-1<f;f--)d[f].tag==e.tag&&(d.splice(f,1),d[f].kill())},execAllCombos:function(d,e){if(e instanceof Array&&e.length)var f=e,h={spcName:f[0].spcName,tag:f[0].tag};else h=e;h=this.getRelevantLists(h);if(f)for(var k=0;k<f.length;k++)this.execFuncOnLists(d,h,f[k]);else e instanceof Dot&&this.execFuncOnLists(d,
h,e)},execFuncOnLists:function(d,e,f){f.active=!0;for(var h=0;h<e.length;h++)d(e[h],f)},getRelevantLists:function(d){var e=[];e.push(this.lists.ALLDOTS);d.spcName&&d.tag&&e.push(this.getByNameAndTag(d));d.spcName&&e.push(this.getByName(d.spcName));d.tag&&e.push(this.getByTag(d.tag));return e},getByNameAndTag:function(d){if(this.lists[d.spcName+"-"+d.tag])return this.lists[d.spcName+"-"+d.tag];if(spcs[d.spcName])return this.lists[d.spcName+"-"+d.tag]=[],this.lists[d.spcName+"-"+d.tag];console.log("Tried to get bad spcName "+
spcName);console.trace()},getByName:function(d){if(this.lists[d])return this.lists[d];if(spcs[d])return this.lists[d]=[],this.lists[d];console.log("Tried to get bad spcName "+d);console.trace()},getByTag:function(d){this.lists[d]||(this.lists[d]=[]);return this.lists[d]}};AuxFunctions={getDims:function(){var d=$("#main").height(),d=d-$("#auxSpacer").height();return V(400,d/2)},pickParentDiv:function(d,e){if(void 0===e){for(var f=0;f<auxHolderDivs.length;f++){var h=$("#"+auxHolderDivs[f]),k=$(h).attr("filledWith");if(""==k)return $(h).attr("filledWith",d),h}console.log("Aux divs are all full!");console.trace()}else{h=$("#"+auxHolderDivs[e]);if(!h.length)return console.log("Bad div idx "+e+".  Defaulting to next empty slot"),this.pickParentDiv(d);k=$(h).attr("filledWith");
if(""==k||void 0==k)return $(h).attr("filledWith",d),h;console.log("Trying to add "+d+" in "+e+" but "+e+" is already filled with "+k+".");console.log("Defaulting to next empty slot");return this.pickParentDiv(d)}},parentDivEmpty:function(){var d=this.parentDiv.attr("filledWith");return void 0==d||""==d},cleanUpParent:function(){$(this.parentDiv).removeAttr("style");$(this.parentDiv).html("");$(this.parentDiv).attr("filledWith","")}};function PhaseEquilGenerator(){this.oneComp=new PhaseEquilGenerator.OneComp;this.twoComp=new PhaseEquilGenerator.TwoComp}PhaseEquilGenerator.TwoComp=function(){};
PhaseEquilGenerator.TwoComp.prototype={constP:function(d,e,f,h,k){var l=d.tBoil(h),m=e.tBoil(h),n=l<m?d:e;d=l>m?d:e;f=this.makeConstPEquil(h,n,d,l<m?l:m,l>m?l:m,f[n.spcName],f[d.spcName],k);return new PhaseEquilGenerator.TwoComp.EquilData(f,n.spcName,d.spcName,h)},makeConstPEquil:function(d,e,f,h,k,l,m,n){for(var p=[],q=1/(n-1),s=0,t=0;s<n;s++){var u=this.solveTAtStep(h+(k-h)*t,d,t,e,f,h,k,l,m);if(!1!==u){var v=this.solvePTotal(u,t,e,f,l,m),x=this.pSpc(e,u,l,1-t);p.push(new PhaseEquilGenerator.TwoComp.EquilPt(1-
t,t,x/v,1-x/v,u,d))}t+=q}return p},solveTAtStep:function(d,e,f,h,k,l,m,n,p){for(var q=this.solvePTotal(d,f,h,k,n,p),s=0;0.01<fracDiff(q,e);){s++;var t=this.getDPDT(d,f,h,k,l,m,n,p);d+=(e-q)/t;q=this.solvePTotal(d,f,h,k,n,p);if(40==s)return!1}return d},getDPDT:function(d,e,f,h,k,l,m,n){k=0.995*d;d*=1.005;l=this.solvePTotal(k,e,f,h,m,n);return(this.solvePTotal(d,e,f,h,m,n)-l)/(d-k)},solvePTotal:function(d,e,f,h,k,l){f=this.pSpc(f,d,k,1-e);d=this.pSpc(h,d,l,e);return f+d},pSpc:function(d,e,f,h){return d.pPure(e)*
f(h,e)*h}};PhaseEquilGenerator.TwoComp.EquilPt=function(d,e,f,h,k,l){this.xLight=d;this.xHeavy=e;this.yLight=f;this.yHeavy=h;this.temp=k;this.pressure=l};PhaseEquilGenerator.TwoComp.EquilData=function(d,e,f,h){this.data=d;this.keyLight=e;this.keyHeavy=f;this.pressure=h};PhaseEquilGenerator.OneComp=function(){};
PhaseEquilGenerator.OneComp.prototype={equilData:function(d,e,f,h,k){k=window.spcs[d];d=this.genLiqGasData(k,e,f);f=this.genSolidLiqEqData(k,e,f);e=this.genSolidGasEqData(k,h,e);return[d,f,e]},genLiqGasData:function(d,e,f){for(var h=[],k=e;k<=f;k+=(f-e)/20){var l=d.pPure(k);h.push(new PhaseEquilGenerator.OneComp.EquilPt(d.spcName,k,l))}return h},genSolidLiqEqData:function(d,e,f){var h=d.pPure(e);f=d.pPure(f);h=new PhaseEquilGenerator.OneComp.EquilPt(d.spcName,e,h);d=new PhaseEquilGenerator.OneComp.EquilPt(d.spcName,
e,f);return[h,d]},genSolidGasEqData:function(d,e,f){for(var h=[],k=d.pPure(f),l=0.5*d.pPure(e),m=Math.log(k/l)/(f-e),n=l/Math.exp(m*e),p=0;20>p;p++){var q=e+p/19*(f-e),s=n*Math.exp(q*m),s=l+(s-l)*Math.log((Math.E-1)*(s-l)/(k-l)+1);h.push(new PhaseEquilGenerator.OneComp.EquilPt(d.spcName,q,s))}return h}};PhaseEquilGenerator.OneComp.EquilPt=function(d,e,f){this.spcName=d;this.temp=e;this.pressure=f};GraphBase={setStds:function(){window.storedGraphs[this.handle]=this;window.curLevel.graphs[this.handle]=this;this.hashMarkLen=10;this.checkMarkOversize=3;this.bgCol=curLevel.bgCol;this.gridCol=Col(72,72,72);this.toggleCol=Col(255,255,255);this.data={};this.legend={};this.markers={};this.textCol=Col(255,255,255);this.flashMult=1.5;this.flashRate=0.1;this.graphBoundCol=Col(255,255,255);this.integralCol=Col(150,150,150);this.integralAlpha=0.5;this.ptStroke=Col(0,0,0);this.rectSideLen=8;this.characLen=
Math.sqrt(Math.pow(this.rectSideLen,2)/2);this.buttonId=this.handle+"Reset";this.graphId=this.handle+"Graph";this.parentDiv=this.pickParentDiv("graph");this.parentDivId=$(this.parentDiv).attr("id");this.makeReset=defaultTo(!0,this.makeReset);var d=this.makeCanvas(this.dims,this.parentDiv,this.handle+"Graph",this.makeReset,this.handle+"Button");this.graphDisplayHTMLElement=d.HTMLElem;this.graphDisplay=d.canvas;this.layers=new GraphBase.Layers;this.wrapperId;this.initDrawLayers();this.hasData=!1},makeDataFunc:function(d){with(DataGetFuncs)return exprHasReturn(d)?
eval("(function(){"+d+"})"):eval("(function(){return "+d+"})")},initDrawLayers:function(){addListener(curLevel,"update","drawLayers"+this.handle,this.drawLayers,this)},setNumGridLinesAndSpacing:function(d){var e,f,h;d=d?d:{};d.x?(e=d.x,f=this.getGridSpacing(e,this.graphRangeFrac.x,this.dims.dx)):(f=40,e=Math.ceil(this.dims.dx*Math.abs(this.graphRangeFrac.x.max-this.graphRangeFrac.x.min)/f));d.y?(d=d.y,h=this.getGridSpacing(d,this.graphRangeFrac.y,this.dims.dy)):(h=40,d=Math.ceil(this.dims.dy*Math.abs(this.graphRangeFrac.y.max-
this.graphRangeFrac.y.min)/h));this.numGridLines=P(e,d);this.gridSpacing=P(f,h)},makeCanvas:function(d,e,f,h,k){var l=this;e.html("");d=templater.canvas({attrs:{id:[f],"class":["noSelect"],width:[d.dx],height:[d.dy]}});h&&(d+=templater.button({attrs:{id:[k]},style:{position:"absolute",right:".5em",bottom:".5em"},innerHTML:templater.img({attrs:{src:[window.IMGPATHPREFIX+"img/refresh.gif"]}})}));d=$(d);$(e).append(d);h&&(addJQueryElems($("#"+k),"button"),$("#"+k).click(function(){l.reset()}));e=document.getElementById(f);
f=e.getContext("2d");return{HTMLElem:e,canvas:f}},restoreHTML:function(){this.parentDivEmpty()||(this.parentDiv=this.pickParentDiv("graph"),this.parentDivId=$(this.parentDiv).attr("id"));var d=this.makeCanvas(this.dims,this.parentDiv,this.handle+"Graph",this.makeReset,this.handle+"Button");this.graphDisplayHTMLElement=d.HTMLElem;this.graphDisplay=d.canvas;this.layers.setDrawCanvas(this.graphDisplay);if(this.legend)for(var e in this.legend)this.legend[e].setCanvas(this.graphDisplay),this.legend[e].toggleActivate()},
clearHTML:function(){this.cleanUpParent()},remove:function(){this.disable();removeListener(curLevel,"update","drawLayers"+this.handle);removeListenerByName(curLevel,"update","flashAdvance"+this.handle);this.layers.removeAll();this.cleanUpParent();return this},enable:function(d){for(var e in this.data)this.data[e].recordStart();this.active=!0;if(d){for(e in this.data)this.data[e].addVal();this.addLast()}return this},disable:function(){for(var d in this.data)this.data[d].recordStop();this.active=!1;
return this},integrate:function(d){this.data[d].integralPts=this.getIntegralPts(d);this.drawIntegral(d);return this},getIntegralPts:function(d){var e=this.data[d].src.x,f=this.data[d].src.y;d=Array(e.length);for(var h=0;h<e.length;h++)d[h]=this.valToCoord(P(e[h],f[h]));e=this.yStart*this.dims.dy;f=d[0].x;d.push(P(d[d.length-1].x,e));d.push(P(f,e));return d},setData:function(d,e){var f=this.data[d];f?f.setData(e):console.log("Bad set handle "+d)},drawAllBG:function(){this.drawBGRect();this.drawGrid();
this.drawBounds();this.legend&&this.drawLegend();this.drawLabels()},drawBGRect:function(){draw.roundedRect(P(0,0),V(this.dims.dx,this.dims.dy),20,this.bgCol,this.graphDisplay)},drawGrid:function(){for(var d=this.axisRange.x.min/10,e=0;e<this.numGridLines.x;e++){var d=this.logScale.x?10*d:this.axisRange.x.min+this.stepSize.x*e,f=this.valToCoord(P(d,1)),h=f.x,k=this.graphRangeFrac.y.max*this.dims.dy,f=P(h,this.graphRangeFrac.y.min*this.dims.dy+this.hashMarkLen),h=P(h,k);draw.line(f,h,this.gridCol,this.graphDisplay)}d=
this.axisRange.y.min/10;for(e=0;e<this.numGridLines.y;e++)d=this.logScale.y?10*d:this.axisRange.y.min+this.stepSize.y*e,f=this.valToCoord(P(1,d)),h=f.y,k=this.graphRangeFrac.x.min*this.dims.dx,f=P(this.graphRangeFrac.x.max*this.dims.dx-this.hashMarkLen,h),h=P(k,h),draw.line(f,h,this.gridCol,this.graphDisplay)},drawBounds:function(){var d=P(this.graphRangeFrac.x.min*this.dims.dx,this.graphRangeFrac.y.max*this.dims.dy),e=V(this.dims.dx*(this.graphRangeFrac.x.max-this.graphRangeFrac.x.min),this.dims.dy*
(this.graphRangeFrac.y.min-this.graphRangeFrac.y.max));draw.strokeRect(d,e,this.graphBoundCol,this.graphDisplay)},drawLabels:function(){var d=P(this.dims.dx*(this.graphRangeFrac.x.min+this.graphRangeFrac.x.max)/2,Math.min(this.dims.dy*this.graphRangeFrac.y.min+50,this.dims.dy-20)),e=P(Math.max(this.dims.dx*this.graphRangeFrac.x.min-50,20),this.dims.dy*(this.graphRangeFrac.y.min+this.graphRangeFrac.y.max)/2);d.y+=this.labelFontSize/2;e.y+=this.labelFontSize/2;draw.text(this.xLabel,d,this.labelFont,
this.textCol,"center",0,this.graphDisplay);draw.text(this.yLabel,e,this.labelFont,this.textCol,"center",-Math.PI/2,this.graphDisplay)},drawLegend:function(){for(var d in this.legend)this.legend[d].draw()},drawMarkers:function(){for(var d in this.markers)this.markers[d].draw()},clearData:function(d,e){var f=this.data[d];f&&f.clearData();e&&this.drawAllData()},enqueueData:function(d,e){var f=this.data[d];f&&f.enqueueData(e)},updateRange:function(){var d=this.valRange.copy(),e;for(e in this.data)this.data[e].updateRange(this.valRange);
this.setAxisBounds(d)},flushQueues:function(d,e){e=defaultTo(!1,e);d=defaultTo(!0,d);var f=this.valRange.copy(),h;for(h in this.data){var k=this.data[h];k.visible&&k.updateRange(this.valRange)}k=this.axisRange.copy();this.setAxisBounds(f);if(!this.rangeIsSame(k.x,this.axisRange.x)||!this.rangeIsSame(k.y,this.axisRange.y))e=!0;e?this.drawAllData():this.drawPts();d&&this.flashInit();for(h in this.data)this.data[h].flushQueue();this.drawLayers()},drawLayers:function(d){if((turn%2||d)&&this.hasData&&
this.layers.count){this.drawAllData();for(d=0;d<this.layers.layers.length;d++)for(var e=this.layers.layers[d],f=0;f<e.length;f++)e[f].draw()}},flashInit:function(){for(var d in this.data)this.data[d].flashInit()},rangeIsSame:function(d,e){return!(d.max!=e.max||d.min!=e.min)},getGridSpacing:function(d,e,f){e=f*Math.abs(e.max-e.min);return(e-20)/(d-1)},setAxisBounds:function(d){this.setAxisBoundsX(d);this.setAxisBoundsY(d)},setAxisBoundsX:function(d){var e=this.axisInit,f=this.valRange;!(e.x.min<f.x.min&&
e.x.max>f.x.max)&&!this.axesFixed.x?d?this.rangeIsSame(d.x,this.valRange.x)||this.getXBounds():this.getXBounds():this.setAxisToInit("x")},setAxisBoundsY:function(d){var e=this.axisInit,f=this.valRange;!(e.y.min<f.y.min&&e.y.max>f.y.max)&&!this.axesFixed.y?d?this.rangeIsSame(d.y,this.valRange.y)||this.getYBounds():this.getYBounds():this.setAxisToInit("y")},setAxisToInit:function(d){var e=this.axisRange[d],f=this.axisInit[d],h=this.numGridLines[d];e.min=f.min;e.max=f.max;this.stepSize[d]=(e.max-e.min)/
(h-1)},getXBounds:function(){var d=this.valRange.x.max-this.valRange.x.min,e=void 0,f=void 0;0!=d?this.logScale.x?(f=this.numGridLines.x-1,e=Math.pow(10,Math.floor(Math.log(this.valRange.x.min)/Math.LN10)),f=e*Math.pow(10,f),d=1):(e=d/(this.numGridLines.x-2),f=Math.pow(10,Math.floor(Math.log10(e))),d=Math.ceil(e/f)*f,e=Math.floor(this.valRange.x.min/d)*d,f=e+(this.numGridLines.x-1)*d):(d=0.2,e=Math.floor(this.valRange.x.min),f=e+d*this.numGridLines.x);if(e<this.axisRange.x.min||f>this.axisRange.x.max)this.axisRange.x.min=
e,this.axisRange.x.max=f,this.stepSize.x=d},getYBounds:function(){var d=Math.abs(this.valRange.y.max-this.valRange.y.min),e=void 0,f=void 0;0!=d?this.logScale.y?(f=this.numGridLines.y-1,e=Math.pow(10,Math.floor(Math.log(this.valRange.y.min)/Math.LN10)),f=e*Math.pow(10,f),d=1):(e=d/(this.numGridLines.y-2),f=Math.pow(10,Math.floor(Math.log10(e))),d=Math.ceil(e/f)*f,e=Math.floor(this.valRange.y.min/d)*d,f=e+(this.numGridLines.y-1)*d):(e=Math.floor(this.valRange.y.min),d=0.2,f=e+d*this.numGridLines.y);
if(e<this.axisRange.y.min||f>this.axisRange.y.max)this.axisRange.y.min=e,this.axisRange.y.max=f,this.stepSize.y=d},drawAxisVals:function(){0<this.stepSize.x&&0<this.stepSize.y&&(this.drawSingleAxisVals(this.numGridLines.x,this.graphRangeFrac,this.axisRange.x,this.logScale.x,this.stepSize.x,function(d,e,f,h,k,l){return d.x.min*e.dx+f.x*h},function(d,e,f,h,k,l){return d.y.min*e.dy+k+10+l/2}),this.drawSingleAxisVals(this.numGridLines.y,this.graphRangeFrac,this.axisRange.y,this.logScale.y,this.stepSize.y,
function(d,e,f,h,k,l){return d.x.min*e.dx-k-10},function(d,e,f,h,k,l){return d.y.min*e.dy-f.y*h}))},drawSingleAxisVals:function(d,e,f,h,k,l,m){for(var n=!1,p=!0,q=0;q<d;q++){var s=l(e,this.dims,this.gridSpacing,q,this.hashMarkLen,this.axisValFontSize),t=m(e,this.dims,this.gridSpacing,q,this.hashMarkLen,this.axisValFontSize),u;u=h?this.numToAxisVal(f.min*Math.pow(10,q)):this.numToAxisVal(f.min+k*q,1);(n=n||3<u.length)&&(p=!p);p&&draw.text(u,P(s,t),this.axisValFont,this.textCol,"center",0,this.graphDisplay)}},
makeLegendEntry:function(d,e,f,h){var k=this.dims.dx-this.legendWidth+5,l=30,m;for(m in this.legend)l+=35;d=new GraphBase.LegendEntry(this,d,e,k,l,this.legendFontSize,this.dims,this.toggleCol,this.legendFont,this.textCol,h);d.toggleActivate();this.legend[f]=d;this.drawAllBG()},numToAxisVal:function(d){return(0.1>=Math.abs(d)||1E3<=Math.abs(d))&&0!=d?d.toExponential():d.toFixed(1)},getRange:function(d){var e=Number.MAX_VALUE,f=-Number.MAX_VALUE,h;for(h in this.data)for(var k=this.data[h].data[d],l=
0;l<k.length;l++)var m=k[l],e=Math.min(e,m),f=Math.max(f,m);return{min:e,max:f}},resetStd:function(){for(var d in this.data)this.data[d].reset();removeListener(curLevel,"update","flash"+this.name);this.drawAllBG();this.resetRanges();this.hasData=!1},resetRanges:function(){this.axisRange=new GraphBase.Range(Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE);this.valRange=new GraphBase.Range(Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE)},ptsExist:function(d){for(var e=
0;e<d.length;e++){var f=d[e];if(void 0===f.x||void 0===f.y||isNaN(f.x)||isNaN(f.y))return!1}return!0},valToCoord:function(d){var e;e=this.logScale.x?this.graphRangeFrac.x.min*this.dims.dx+this.gridSpacing.x*(this.numGridLines.x-1)*Math.log(d.x/this.axisRange.x.min)/Math.log(this.axisRange.x.max/this.axisRange.x.min):this.graphRangeFrac.x.min*this.dims.dx+this.gridSpacing.x*(this.numGridLines.x-1)*(d.x-this.axisRange.x.min)/(this.axisRange.x.max-this.axisRange.x.min);d=this.logScale.y?this.dims.dy-
(1-this.graphRangeFrac.y.min)*this.dims.dy-this.gridSpacing.y*Math.log(d.y/this.axisRange.y.min)/Math.LN10:this.dims.dy-(1-this.graphRangeFrac.y.min)*this.dims.dy-this.gridSpacing.y*(this.numGridLines.y-1)*(d.y-this.axisRange.y.min)/(this.axisRange.y.max-this.axisRange.y.min);return P(e,d)},dataScaling:function(){return V(this.gridSpacing.x/this.stepSize.x,this.gridSpacing.y/this.stepSize.y)},checkMark:function(d,e,f,h,k){var l=Col(0,0,0);d.x-=f;d.y-=f;e.dx+=2*f;e.dy+=2*f;return new CheckMark(d,e,
h,l,k)},addMarker:function(d){d.handle?(d.graphDisplay=this.graphDisplay,d.graph=this,d.layers=this.layers,this.markers[d.handle]=new GraphBase.Marker(d)):console.log("Tried to add a graph marker for "+this.handle+" with no handle.  Add a handle.")},LegendEntry:function(d,e,f,h,k,l,m,n,p,q,s){this.graph=d;this.set=e;this.pos=P(h,k);this.font=p;this.textCol=q;this.toggleCol=n;this.text=f;this.textPos=P(h+10,k+l/2);this.fontSize=l;this.boxPos=P(m.dx-18,k-5);this.boxDims=V(13,13);this.mouseListenerName=
"toggle"+this.graph.handle.toCapitalCamelCase()+this.set.handle.toCapitalCamelCase();this.drawMarker=s;this.checkMark=d.checkMark(this.boxPos.copy(),this.boxDims.copy(),d.checkMarkOversize,d.toggleCol,d.graphDisplay)}};
GraphBase.LegendEntry.prototype={draw:function(){this.drawToggle();this.drawText();this.drawMarker(this.pos)},drawToggle:function(){draw.fillStrokeRect(this.boxPos,this.boxDims,this.graph.gridCol,this.toggleCol,this.graph.graphDisplay);this.set.visible&&this.checkMark.draw()},drawText:function(){draw.text(this.text,this.textPos,this.font,this.textCol,"left",0,this.graph.graphDisplay)},toggle:function(){ptInRect(this.boxPos,this.boxDims,mouseOffsetDiv(this.graph.parentDivId))&&(this.set.visible=this.set.visible?
!1:!0,this.graph.drawAllBG(),this.graph.drawAllData())},toggleActivate:function(){addListener(curLevel,"mouseup",this.mouseListenerName,this.toggle,this)},toggleDeactivate:function(){removeListener(curLevel,"mouseup",this.mouseListenerName)},setCanvas:function(d){this.checkMark.setCanvas(d)}};GraphBase.Range=function(d,e,f,h){this.x={min:d,max:e};this.y={min:f,max:h}};GraphBase.Range.prototype={copy:function(){return new GraphBase.Range(this.x.min,this.x.max,this.y.min,this.y.max)}};
GraphBase.Marker=function(d){this.handle=d.handle;this.dataX="function"==typeof d.x?d.x:this.wrapInDataGet(d.x);this.dataY="function"==typeof d.y?d.y:this.wrapInDataGet(d.y);this.graph=d.graph;this.graphDisplay=d.graphDisplay;validNumber(this.dataX())&&validNumber(this.dataY())?this.coordLast=this.graph.valToCoord(P(this.dataX(),this.dataY())):this.coordLast=void 0;this.markerType=d.markerType;this.col=d.col;this.visible=!0;this.layers=d.layers;this.dataValid=!0;if(this.drawFuncs[this.markerType])this.drawCB=
this.drawFuncs[this.markerType];else{console.log("Bad marker type "+this.markerType+".  Choices include ");for(var e in this.drawFuncs)console.log(e)}this.characLen=15;this.imgCharacLen=this.characLen+2;this.layers.addItem("marker",this);var f=this;d.label&&(this.legendEntry=this.addLegendEntry(d.label,function(d){f.drawCB(d)}))};
GraphBase.Marker.prototype={wrapInDataGet:function(d){with(DataGetFuncs)d=exprHasReturn(d)?eval("(function(){"+d+"})"):eval("(function(){return "+d+"})");return d},setDataValid:function(){try{this.dataValid=!1!==validNumber(this.dataX())&&!1!==validNumber(this.dataY())?!0:!1}catch(d){this.dataValid=!1}},setDrawCanvas:function(d){this.graphDisplay=d},addLegendEntry:function(d,e){this.graph.makeLegendEntry(this,d,this.handle,e)},draw:function(){this.visible&&(this.dataValid&&(this.coordLast=this.graph.valToCoord(P(this.dataX(),
this.dataY()))),this.drawCB(this.coordLast))},drawFuncs:{bullseye:function(d){var e=this.characLen;window.draw.circle(d,0.15*e,this.col,!0,this.graphDisplay);window.draw.line(d.copy().movePt(V(-e/2,0)),d.copy().movePt(V(e/2,0)),this.col,this.graphDisplay);window.draw.line(d.copy().movePt(V(0,-e/2)),d.copy().movePt(V(0,e/2)),this.col,this.graphDisplay);window.draw.circle(d,0.3*e,this.col,!1,this.graphDisplay)}},remove:function(){this.layers.removeItem("marker",this)}};
GraphBase.Layers=function(){this.layers=[];this.handleIdxPairs={};this.count=0};
GraphBase.Layers.prototype={addLayer:function(d){this.layers.push([]);this.handleIdxPairs[d]=this.layers.length-1},setDrawCanvas:function(d){for(var e=0;e<this.layers.length;e++)for(var f=this.layers[e],h=0;h<f.length;h++)f[h].setDrawCanvas(d)},removeLayer:function(d){var e=this.handleIdxPairs[d];for(d in this.handleIdxPairs)this.handleIdxPairs[d]>e&&this.handleIdxPairs[d]--;this.count-=this.layers[e].length;this.layers.splice(e,1);delete this.handleIdxPairs[d]},addItem:function(d,e){this.layers[this.handleIdxPairs[d]].push(e);
this.count++},removeItem:function(d,e){var f=this.layers[this.handleIdxPairs[d]].indexOf(e);this.layers[this.handleIdxPairs[d]].splice(f,1);this.count--},removeAll:function(){for(var d=0;d<this.layers.length;d++)for(var e=this.layers[d],f=0;f<e.length;f++)e[f].remove()}};function GraphPhaseTwoComp(d){this.spcAName=d.spcAName;this.spcBName=d.spcBName;this.spcA=spcs[this.spcAName];this.spcB=spcs[this.spcBName];this.wallGas=d.wallGas;this.liquid=d.liquid;this.primaryKeyType=/light/i.test(d.primaryKey)?"Light":"Heavy";this.handle=d.handle;this.actCoeffFuncs=d.actCoeffFuncs;this.pressure=d.pressure||1;d.axesFixed={x:!0};d.numGridLines={x:6};this.keyNamePairs=this.getKeyNamePairs(this.spcA,this.spcB,this.pressure);(!this.spcA||!this.spcB)&&console.log("Bad species data for phase diagram "+
this.spcAName+" "+this.spcBName);d.yLabel="Temp";d.xLabel="frac "+this.keyNamePairs[this.primaryKeyType].toCapitalCamelCase();d.makeReset=!1;this.graph=new GraphScatter(d);this.equilData;this.updateEquilData(this.pressure);this.equilDataHandle=this.handle+"PhaseData";this.graph.addSet({handle:this.equilDataHandle,label:"Phase\nData",pointCol:Col(255,255,255),flashCol:Col(0,0,0),trace:!0,recording:!1,showPts:!1});this.recordFracData(this.wallGas,this.keyNamePairs[this.primaryKeyType]);this.recordFracData(this.liquid.wallLiq,
this.keyNamePairs[this.primaryKeyType]);var e=this.liquid;this.liqTempFunc=function(){return e.temp};this.gasTempFunc=this.makeTempFunc(this.wallGas);this.yFuncKillLow=this.makeFracFunc(this.wallGas,this.keyNamePairs[this.primaryKeyType],!0);this.yFunc=this.makeFracFunc(this.wallGas,this.keyNamePairs[this.primaryKeyType]);this.xFuncKillLow=this.makeFracFunc(this.liquid.wallLiq,this.keyNamePairs[this.primaryKeyType],!0);this.xFunc=this.makeFracFunc(this.liquid.wallLiq,this.keyNamePairs[this.primaryKeyType]);
this.updateGraph();this.active=!1;defaultTo(!0,d.makeLiquidMarker)&&this.makeLiquidMarker();defaultTo(!0,d.makeSystemMarker)&&this.makeSystemMarker();defaultTo(!0,d.makeGasMarker)&&this.makeGasMarker();this.graph.hasData=!0}
GraphPhaseTwoComp.prototype={recordFracData:function(d,e){d.recordFrac({spcName:e,tag:d.handle})},setDataValid:function(){this.graph.setDataValid()},makeLiquidMarker:function(){this.graph.addMarker({handle:"liquid",col:Col(200,0,0),markerType:"bullseye",x:this.xFuncKillLow,y:this.liqTempFunc,label:"Liquid"})},makeSystemMarker:function(){var d=this,e=d.liquid,f=e.wallGas,h=e.wallGas.dotManager,k=e.wallLiq.dotManager;this.graph.addMarker({handle:"system",col:Col(200,200,0),markerType:"bullseye",x:function(){return(d.xFunc()*
k.count+d.yFunc()*h.count)/(h.count+k.count)},y:function(){var h=f.getCv();return(h*d.gasTempFunc()+e.Cp*d.liqTempFunc())/(h+e.Cp)},label:"System"})},makeGasMarker:function(){this.graph.addMarker({handle:"gas",col:Col(0,200,0),markerType:"bullseye",x:this.yFuncKillLow,y:this.gasTempFunc,label:"Gas"})},makeTempFunc:function(d){var e=d.getDataSrc("temp");return function(){for(var d=0,h=Math.max(0,e.length-30);h<e.length;h++)d+=e[h];return d/Math.min(Math.max(1,e.length),30)}},makeFracFunc:function(d,
e,f){var h=d.getDataSrc("frac",{spcName:e,tag:d.handle}),k=d.dotManager;return f?function(){if(50<k.count){for(var d=0,e=Math.max(0,h.length-30);e<h.length;e++)d+=h[e];return d/Math.min(Math.max(1,h.length),30)}return-1E5}:function(){for(var d=0,e=Math.max(0,h.length-30);e<h.length;e++)d+=h[e];return d/Math.min(Math.max(1,h.length),30)}},clearHTML:function(){this.graph.clearHTML()},restoreHTML:function(){this.graph.restoreHTML()},drawAllData:function(){this.graph.drawAllData()},disable:function(){this.graph.disable()},
save:function(){},addLast:function(){this.graph.addLast()},remove:function(){this.graph.remove()},setPressure:function(d){var e=this.updateEquilData(d);this.updateGraph();this.pressure=d;return e},getKeyNamePairs:function(d,e,f){return d.tBoil(f)<e.tBoil(f)?{Light:d.spcName,Heavy:e.spcName}:{Light:e.spcName,Heavy:d.spcName}},updateEquilData:function(d){d=phaseEquilGenerator.twoComp.constP(this.spcA,this.spcB,this.actCoeffFuncs,d,20);for(var e=[],f=[],h=0;h<d.data.length;h++){var k=d.data[h],l=k.temp,
m=k["y"+this.primaryKeyType];e.push(P(k["x"+this.primaryKeyType],l));f.push(P(m,l))}this.equilData=e.concat(f.reverse());return d},updateGraph:function(){this.graph.clearData(this.equilDataHandle,!1);this.graph.enqueueData(this.equilDataHandle,this.equilData);this.graph.updateRange();this.graph.drawAllData()}};function GraphPhaseOneComp(d){this.spcName=d.spcName;this.spc=spcs[this.spcName];this.wallGas=d.wallGas;this.liquid=d.liquid;this.handle=d.handle;this.pressure=d.pressure||1;d.axesFixed={x:!1,y:!1};d.numGridLines={x:6};d.xLabel="Temperature (K)";d.yLabel="Pressure "+this.spcName+" (bar)";d.makeReset=!1;this.equilDataSets=void 0;this.triplePointTemp=d.triplePointTemp;this.criticalPointTemp=d.criticalPointTemp;this.updateEquilData();var e=this.getYMin(this.equilDataSets),f=this.getYMax(this.equilDataSets),
f=this.getOrderOfMagRange(e,f);d.numGridLines=defaultTo({},d.numGridLines);d.numGridLines.y=f+1;d.axisInit.y={min:Math.pow(10,Math.floor(Math.log(e)/Math.LN10)),step:1};d.logScale={y:!0};this.graph=new GraphScatter(d);this.equilDataHandles=this.makeEqDataHandles(this.equilDataSets,this.handle);this.addEqDataSets(this.graph,this.equilDataSets,this.equilDataHandles);this.tempFunc=this.makeTempFunc(this.wallGas,this.liquid);this.pressureFunc=this.makePressureFunc(this.wallGas,this.spcName);this.updateGraph();
this.active=!1;defaultTo(!0,d.makeSystemMarker)&&this.makeMarker();this.graph.hasData=!0}
GraphPhaseOneComp.prototype={addEqDataSets:function(d,e,f){for(d=0;d<e.length;d++)this.graph.addSet({handle:this.equilDataHandles[d],label:"Phase\nData",pointCol:Col(255,255,255),flashCol:Col(0,0,0),trace:!0,recording:!1,showPts:!1})},makeMarker:function(){this.graph.addMarker({handle:"system",col:Col(200,0,0),markerType:"bullseye",x:this.tempFunc,y:this.pressureFunc,label:"System"})},updateEquilData:function(){this.equilDataSets=phaseEquilGenerator.oneComp.equilData(this.spcName,this.triplePointTemp,
this.criticalPointTemp,this.triplePointTemp-25,!1)},getYMin:function(d){for(var e=Number.MAX_VALUE,f=0;f<d.length;f++)for(var h=d[f],k=0;k<h.length;k++)e=Math.min(h[k].pressure,e);return e},getYMax:function(d){for(var e=Number.MIN_VALUE,f=0;f<d.length;f++)for(var h=d[f],k=0;k<h.length;k++)e=Math.max(h[k].pressure,e);return e},getOrderOfMagRange:function(d,e){return Math.ceil(Math.log(e)/Math.LN10)-Math.floor(Math.log(d)/Math.LN10)},makePressureFunc:function(d,e){var f=d.recordFrac({spcName:e,tag:d.handle}).src(),
h=d.getDataSrc("pExt",void 0,!0),k=!1!==h?h:d.getDataSrc("pInt",void 0,!0);return function(){for(var d=0,e=Math.max(0,k.length-30);e<k.length;e++)d+=k[e];e=f[f.length-1]?f[f.length-1]:1;return d/Math.min(k.length,30)*e}},makeTempFunc:function(d,e){var f=d.getDataSrc("temp");return function(){var h=e.Cp,k=d.getCv();return(f[f.length-1]*k+e.temp*h)/(k+h)}},updateGraph:function(){for(var d=0;d<this.equilDataSets.length;d++)this.graph.clearData(this.equilDataHandles[d],!1),this.graph.enqueueData(this.equilDataHandles[d],
this.equilDataToPoints(this.equilDataSets[d]));this.graph.updateRange();this.graph.drawAllData()},setPressure:function(){},makeEqDataHandles:function(d,e){for(var f=[],h=0;h<d.length;h++)f.push(e+"PhaseDataSet"+h);return f},equilDataToPoints:function(d){for(var e=[],f=0;f<d.length;f++)e.push(P(d[f].temp,d[f].pressure));return e}};function GraphScatter(d){this.active=!0;this.handle=d.handle;this.dims=this.getDims();this.xLabel=d.xLabel;this.yLabel=d.yLabel;var e=d.axesInit||d.axisInit;this.labelFontSize=15;this.legendFontSize=12;this.axisValFontSize=11;this.labelFont=this.labelFontSize+"pt calibri";this.legendFont=this.legendFontSize+"pt calibri";this.axisValFont=this.axisValFontSize+"pt calibri";this.borderSpacing=70;this.logScale=d.logScale?{x:defaultTo(!1,d.logScale.x),y:defaultTo(!1,d.logScale.y)}:{x:!1,y:!1};this.legendWidth=
80;d.axesFixed=d.axesFixed||{};this.axesFixed={x:defaultTo(!1,d.axesFixed.x),y:defaultTo(!1,d.axesFixed.y)};this.graphRangeFrac=new GraphBase.Range(this.borderSpacing/this.dims.dx,(this.dims.dx-(this.legendWidth+8))/this.dims.dx,1-this.borderSpacing/this.dims.dy,0.05);this.makeReset=d.makeReset;this.setNumGridLinesAndSpacing(d.numGridLines);this.axisInit=this.setAxesInit(e,this.numGridLines);this.resetRanges();this.stepSize=new GraphScatter.Coord(0,0);this.setStds();this.layers.addLayer("flasher");
this.layers.addLayer("marker");this.drawAllBG()}
_.extend(GraphScatter.prototype,AuxFunctions,GraphBase,{setAxesInit:function(d,e){var f,h,k,l;this.logScale.x?(l=e.x-1,Math.pow(10,Math.floor(Math.log(d.x.min)/Math.LN10)),Math.pow(10,l)):(f=d.x.min,h=f+d.x.step*(e.x-1));this.logScale.y?(l=e.y-1,k=Math.pow(10,Math.floor(Math.log(d.y.min)/Math.LN10)),l=k*Math.pow(10,l)):(k=d.y.min,l=k+d.y.step*(e.y-1));return new GraphBase.Range(f,h,k,l)},addSet:function(d){if(!this.data[d.handle]){var e=this,f=new GraphScatter.Set(this,d.handle,d.label,d.data,d.pointCol,
d.flashCol,d.fillInPts,d.fillInPtsMin,d.trace,d.recording,d.showPts),h=d.pointCol.copy();this.data[d.handle]=f;var k;k=d.trace&&defaultTo(!0,d.showPts)?function(d){draw.line(d.copy().movePt(V(-9,0)),d.copy().movePt(V(9,0)),h,e.graphDisplay);e.drawPtStd(d,h)}:d.trace?function(d){draw.line(d.copy().movePt(V(-9,0)),d.copy().movePt(V(9,0)),h,e.graphDisplay)}:function(d){e.drawPtStd(d,h)};this.makeLegendEntry(f,f.label,d.handle,k);this.drawAllBG()}},setDataValid:function(){for(var d in this.data)this.data[d].setDataValid();
for(var e in this.markers)this.markers[e].setDataValid()},drawAllData:function(){this.drawAllBG();this.drawAxisVals();this.drawPts(!1)},drawPts:function(d){for(var e in this.data)this.data[e].drawPts(!1!==d)},addLast:function(){for(var d in this.data){var e=this.data[d];e.recording&&e.dataValid&&(e.trimNewData(),e.enqueuePts())}this.flushQueues(!0,!1);this.hasData=!0},getAxisBounds:function(){this.getXBounds();this.getYBounds()},graphPt:function(d,e,f){d=this.valToCoord(P(d,e));this.drawPtStd(d,f)},
drawPtStd:function(d,e){this.drawPt(d,e,this.characLen)},drawPt:function(d,e,f,h){h=h||this.graphDisplay;var k=d.x,l=d.y;d=P(k-f,l);var m=P(k,l-f),n=P(k+f,l);f=P(k,l+f);draw.fillPtsStroke([d,m,n,f],e,this.ptStroke,h)},reset:function(){this.resetStd()}});
GraphScatter.Set=function(d,e,f,h,k,l,m,n,p,q,s){this.graph=d;this.handle=e;this.label=f;this.data=new GraphScatter.Data;this.showPts=defaultTo(!0,s);this.graphedPts=[];this.graphedPtIdxs=[];h=h||{};this.dataFuncs=new GraphScatter.DataFuncs(d,h.x,h.y);this.pointCol=k;this.flashCol=l;this.fillInPts=defaultTo(!0,m);this.fillInPtsMin=defaultTo(5,n);this.trace=defaultTo(!1,p);this.visible=!0;this.recordListenerName=this.graph.handle+this.handle.toCapitalCamelCase()+"Record";this.traceLastIdxs=new GraphScatter.Coord(0,
0);this.flashers=[];this.queuePts=[];this.queueIdxs=[];this.recording=defaultTo(!0,q);this.dataValid=!0;this.recording&&this.recordStart()};
GraphScatter.Set.prototype={reset:function(){this.graphedPts.splice(0,this.graphedPts.length);this.graphedPtIdxs.splice(0,this.graphedPtIdxs.length);this.flashers.splice(0,this.flashers.length);this.queueIdxs.splice(0,this.queueIdxs.length);this.queuePts.splice(0,this.queuePts.length)},setDataValid:function(){try{var d=this.dataFuncs.x(),e=this.dataFuncs.y();this.dataValid=!1!==validNumber(d)&&!1!==validNumber(e)?!0:!1}catch(f){this.dataValid=!1}},addVal:function(){this.data.x.push(this.dataFuncs.x());
this.data.y.push(this.dataFuncs.y())},clearData:function(){this.queuePts.splice(0,this.queuePts.length);this.queueIdxs.splice(0,this.queueIdxs.length);this.data.clear()},enqueueData:function(d){var e=this.data.x.length;this.queuePts=this.queuePts.concat(d);this.addData(d);for(d=e;d<this.data.x.length;d++)this.queueIdxs.push(P(d,d))},addData:function(d){this.data.addData(d)},recordStart:function(){addListener(curLevel,"update",this.recordListenerName,function(){this.dataValid&&this.addVal()},this)},
recordStop:function(){removeListener(curLevel,"update",this.recordListenerName)},trimNewData:function(){if(this.graphedPtIdxs.length){var d=this.data.x,e=this.data.y,f=this.graphedPtIdxs[this.graphedPtIdxs.length-1].x,h=this.graphedPtIdxs[this.graphedPtIdxs.length-1].y,k=d.length-f;if(k!=e.length-h)return!1;f=this.findRuns(d,e,h,f,k);for(h=f.length-1;0<=h;h--)this.trimRun(d,e,f[h])}},findRuns:function(d,e,f,h,k){for(var l=function(d,e,f){this.xStartIdx=d;this.yStartIdx=e;this.length=f},m=[],n=[],
p=void 0,q=f,s=h,t=0;t<k-1;t++){var u=P(d[f+t],e[h+t]);if(1>=n.length)n.push(u),2==n.length&&(p=n[0].VTo(n[1]).UV());else{var v=n[n.length-1].VTo(u).UV();0.99<Math.abs(v.dotProd(p))?n.push(u):(3<=n.length&&m.push(new l(q,s,f+t-q,h+t-s)),n=[u],q=f+t,s=h+t)}}3<=n.length&&m.push(new l(q,s,f+t-q,h+t-s));return m},trimRun:function(d,e,f){for(var h=P(d[f.xStartIdx],e[f.yStartIdx]),k=P(d[f.xStartIdx+f.length-1],e[f.yStartIdx+f.length-1]),l=h,m=k,n=l.VTo(m),p=m.VTo(l),q=!0,s=1;s<f.length-1;s++){var t=P(d[f.xStartIdx+
s],e[f.yStartIdx+s]);if(q&&(0>h.VTo(t).dotProd(n)||0>k.VTo(t).dotProd(p)))q=!1;0>n.dotProd(l.VTo(t))?(l=t,n=l.VTo(m)):0>p.dotProd(m.VTo(t))&&(m=t,p=m.VTo(l))}p=[h.x];n=[h.y];l!=h&&(p.push(l.x),n.push(l.y));m!=k&&(p.push(m.x),n.push(m.y));p.push(k.x);n.push(k.y);h=[f.xStartIdx,f.length].concat(p);f=[f.yStartIdx,f.length].concat(n);Array.prototype.splice.apply(d,h);Array.prototype.splice.apply(e,f)},enqueuePts:function(){var d=this.data.pt(),e=[],f=[];if(d.isValid()){var h=new GraphScatter.Coord(this.data.x.length-
1,this.data.y.length-1);if(this.fillInPts&&this.data.x.length&&this.data.y.length&&this.graphedPtIdxs.length)var k=this.graphedPtIdxs[this.graphedPtIdxs.length-1],l=this.data.pt(k.x,k.y),k=this.fillInPtsFunc(d,h,l,k,this.data),e=e.concat(k.newPts),f=f.concat(k.dataIdxs);e.push(d);f.push(h)}this.queuePts=this.queuePts.concat(e);this.queueIdxs=this.queueIdxs.concat(f)},fillInPtsFunc:function(d,e,f,h,k){var l=e.x-h.x;if(l!=e.y-h.y)return{newPts:[],dataIdxs:[]};d=this.graph.valToCoord(d);var m=this.graph.valToCoord(f);
e=this.graph.dataScaling();for(var m=d.VTo(m).UV().perp(),n=l-1;0<n;n--){var l=h.x+n,p=h.y+n,q=d.VTo(this.graph.valToCoord(P(k.x[l],k.y[p]))),q=Math.abs(q.dotProd(m));if(q>this.fillInPtsMin){n=P(k.x[l],k.y[p]);e=this.getEdgePt({x:l,y:p},h,m,n,q,d,k,e);if(!e)break;d=e.dataIdx;e=e.pt;f=this.fillInPtsFunc(e,d,f,h,k);return{newPts:[e].concat(f.newPts),dataIdxs:[d].concat(f.dataIdxs)}}}return{newPts:[],dataIdxs:[]}},getEdgePt:function(d,e,f,h,k,l,m,n){for(d=d.x-e.x-1;0<d;d--){n=e.x+d;var p=e.y+d,q=l.VTo(this.graph.valToCoord(P(m.x[n],
m.y[p]))),q=Math.abs(q.dotProd(f));if(q<k)return{pt:h,dataIdx:{x:n+1,y:p+1}};h=P(m.x[n],m.y[p]);k=q}},updateRange:function(d){this.trace?this.updateRangeFromData(d):this.updateRangeFromPts(d)},updateRangeFromData:function(d){for(var e=this.queueIdxs[0]?this.queueIdxs[0].x:0;e<this.data.x.length;e++){var f=this.data.x[e],h=this.data.y[e];d.x.max=Math.max(d.x.max,f);d.x.min=Math.min(d.x.min,f);d.y.max=Math.max(d.y.max,h);d.y.min=Math.min(d.y.min,h)}},updateRangeFromPts:function(d){for(var e=0;e<this.queuePts.length;e++){var f=
this.queuePts[e].x,h=this.queuePts[e].y;d.x.max=Math.max(d.x.max,f);d.x.min=Math.min(d.x.min,f);d.y.max=Math.max(d.y.max,h);d.y.min=Math.min(d.y.min,h)}},drawPts:function(d){if(this.visible&&(this.showPts||this.trace)&&(this.queuePts.length||this.graphedPts.length)){var e,f=[];d?(e=this.queuePts,f=this.queueIdxs):(e=this.graphedPts.concat(this.queuePts),f=this.graphedPtIdxs.concat(this.queueIdxs));this.trace&&(d?this.graphedPtIdxs.length&&f.length&&this.drawTrace(this.graphedPtIdxs[this.graphedPtIdxs.length-
1].x,f[f.length-1].x,this.graphedPtIdxs[this.graphedPtIdxs.length-1].y,f[f.length-1].y):this.drawTrace(f[0].x,f[f.length-1].x,f[0].y,f[f.length-1].y));if(this.showPts)for(d=0;d<e.length;d++)this.graph.graphPt(e[d].x,e[d].y,this.pointCol)}},flashInit:function(){if(this.visible&&this.showPts)for(var d=0;d<this.queuePts.length;d++){var e=this.queuePts[d],f=this.pointCol,h=this.flashCol,k=h.copy();new GraphScatter.Flasher(e,f,h,k,this.graph.characLen*this.graph.flashMult,2*this.graph.characLen*this.graph.flashMult,
this.graph.characLen,this.graph.flashMult,this.graph.flashRate,this.graph.graphDisplay,this.graph.layers,this.graph)}},flushQueue:function(){this.graphedPts=this.graphedPts.concat(this.queuePts);this.graphedPtIdxs=this.graphedPtIdxs.concat(this.queueIdxs);this.queuePts.splice(0,this.queuePts.length);this.queueIdxs.splice(0,this.queueIdxs.length)},drawTrace:function(d,e,f,h){if(e-d==h-f&&void 0!==d&&void 0!==f){e-=d;h=[this.graph.valToCoord(P(this.data.x[d],this.data.y[f]))];for(var k=1;k<e+1;k++){var l=
this.graph.valToCoord(P(this.data.x[d+k],this.data.y[f+k]));l.closeTo(h[h.length-1])||h.push(l)}draw.path(h,this.pointCol,this.graph.graphDisplay)}else console.log("Data count mismatch for tracing"),console.trace()}};GraphScatter.DataFuncs=function(d,e,f){this.x=d.makeDataFunc(e);this.y=d.makeDataFunc(f)};GraphScatter.Data=function(){this.x=[];this.y=[]};
GraphScatter.Data.prototype={pt:function(d){return void 0===d?P(this.x[this.x.length-1],this.y[this.y.length-1]):P(this.x[d],this.y[d])},addData:function(d){for(var e=0;e<d.length;e++)this.x.push(d[e].x),this.y.push(d[e].y)},toPts:function(){for(var d=[],e=0;e<this.x.length;e++)d.push(this.x[e],this.y[e]);return d},clear:function(){this.x.splice(0,this.x.length);this.y.splice(0,this.y.length)}};GraphScatter.Coord=function(d,e){this.x=d;this.y=e};
GraphScatter.Coord.prototype={copy:function(){return new GraphScatter.prototype.Coord(this.x,this.y)}};
GraphScatter.Flasher=function(d,e,f,h,k,l,m,n,p,q,s,t){this.pt=d;this.pointCol=e;this.flashCol=f;this.curCol=h;this.curCharacLen=k;this.imgCharacLen=l;this.finalCharacLen=m;this.flashMult=n;this.flashRate=p;this.graphDisplay=q;this.layers=s;this.graph=t;this.coordLast=this.graph.valToCoord(this.pt);this.advanceListenerHandle=this.addAdvanceListener();this.lifetime=1/this.flashRate;this.age=0;s.addItem("flasher",this)};
GraphScatter.Flasher.prototype={addAdvanceListener:function(){var d="flashAdvance"+this.graph.handle+this.pt.x+this.pt.y;addListener(curLevel,"update",d,function(){this.advance()},this);return d},setDrawCanvas:function(d){this.graphDisplay=d},draw:function(){this.coordLast=this.graph.valToCoord(this.pt);this.graph.drawPt(this.coordLast,this.curCol,this.curCharacLen,this.graphDisplay)},remove:function(){this.layers.removeItem("flasher",this);removeListener(curLevel,"update",this.advanceListenerHandle)},
advance:function(){this.curCharacLen=stepTowards(this.curCharacLen,this.finalCharacLen,-this.finalCharacLen*this.flashMult*this.flashRate);var d=this.curCol,e=Col(0,0,0);e.r=this.colStep("r");e.g=this.colStep("g");e.b=this.colStep("b");d.set(e);this.age>this.lifetime+1&&this.remove();this.age++},colStep:function(d){var e=this.pointCol[d];return stepTowards(this.curCol[d],e,(e-this.flashCol[d])*this.graph.flashRate)}};function GraphHist(d){this.active=!0;this.handle=d.handle;this.dims=this.getDims();this.xLabel=d.xLabel;this.yLabel=d.yLabel;this.labelFontSize=15;this.axisValFontSize=11;var e=d.axesInit;this.labelFont=this.labelFontSize+"pt calibri";this.axisValFont=this.axisValFontSize+"pt calibri";this.borderSpacing=70;this.graphRangeFrac=new GraphBase.Range(this.borderSpacing/this.dims.dx,0.95,1-this.borderSpacing/this.dims.dy,0.05);this.logScale=d.logScale?{x:defaultTo(!1,d.logScale.x),y:defaultTo(!1,d.logScale.y)}:
{x:!1,y:!1};this.numBins=18;this.axesFixed={x:defaultTo(!1,d.axesFixed.x),y:defaultTo(!1,d.axesFixed.y)};this.setNumGridLinesAndSpacing(d.numGridLines);this.axisInit=new GraphBase.Range(e.x.min,e.x.min+e.x.step*(this.numGridLines.x-1),e.y.min,e.y.min+e.y.step*(this.numGridLines.y-1));this.resetRanges();this.stepSize={x:0,y:0};Col(255,100,0);this.setStds();this.drawAllBG()}
_.extend(GraphHist.prototype,AuxFunctions,GraphBase,{addSet:function(d){this.data[d.handle]||(d=new GraphHist.Set(this,d.handle,d.data,d.barCol),this.data[d.handle]=d,this.drawAllBG())},drawAllData:function(){this.drawAllBG();this.bins&&(this.drawAxisVals(),this.graphBins())},addLast:function(){var d="",e;for(e in this.data)d=e;d=this.data[d];d.addVal();this.makeBins(d);this.hasData=!0},plotData:function(d){var e="",f;for(f in this.data)e=f;this.data[e].data.x=d;this.makeBins(this.data[e])},makeBins:function(d){this.valRange.x=
this.getRange("x");this.setAxisBoundsX();this.bins=this.makeBinBlanks(d.data.x);this.populateBins(d.data.x);this.setYAxis();this.drawAllData()},makeBinBlanks:function(d){d=[];this.binWidth=round((this.valRange.x.max-this.valRange.x.min)/(this.numBins-1),1);for(var e=0;e<this.numBins;e++)d.push(0);return d},populateBins:function(d){for(var e=0;e<d.length;e++)this.bins[Math.floor((d[e]-this.valRange.x.min)/this.binWidth)]++},setYAxis:function(){for(var d=0,e=0;e<this.bins.length;e++)d=Math.max(this.bins[e],
d);this.valRange.y.min=0;this.valRange.y.max=d;this.setAxisBoundsY()},graphBins:function(){var d,e;for(e in this.data)d=e;d=this.data[d].barCol;for(e=0;e<this.bins.length;e++){var f=this.binWidth*(e+1),h=this.valToCoord(P(this.binWidth*e,this.bins[e])),f=this.valToCoord(P(f,0)),f=h.VTo(f);draw.fillStrokeRect(h,f,d,this.bgCol,this.graphDisplay)}},clear:function(){this.clearStd()}});
GraphHist.Set=function(d,e,f,h){this.graph=d;this.handle=e||"onlyData";this.data=new GraphHist.Data;this.dataFunc=new GraphHist.DataFunc(d,f);this.dataValid=!0;this.barCol=h;this.visible=!0};GraphHist.Set.prototype={addVal:function(){this.data.x=this.dataFunc.x()},recordStop:function(){},setDataValid:function(){try{this.dataValid=!1!==validNumber(this.dataFunc.x())?!0:!1}catch(d){}}};GraphHist.Data=function(){this.x=[]};GraphHist.DataFunc=function(d,e){this.x=d.makeDataFunc(e)};function GraphBlank(d){this.dims=this.getGraphDims();this.borderSpacing=70;this.xStart=this.borderSpacing/this.dims.dx;this.yStart=1-this.borderSpacing/this.dims.dy;this.legendWidth=80;this.xEnd=(this.dims.dx-(this.legendWidth+8))/this.dims.dx;this.yEnd=0.05;this.gridSpacing=40;this.setNumGridLines();this.setStds();this.handle="blank"+Math.round(1E5*Math.random());this.parentDiv=d;this.makeCanvasNoReset(this.dims,d);this.parentDiv.attr("filledWith","blank");this.drawBGBlank()}
_.extend(GraphBlank.prototype,GraphBase,{drawBGBlank:function(){this.graph.save();this.drawBGRect();this.graph.globalAlpha=0.2;this.drawGrid();this.drawBounds();this.graph.restore()}});function DataDisplayer(){this.entries={}}
DataDisplayer.prototype={setReadouts:function(d){this.readouts=d},addEntry:function(d){var e=d.label||"",f=defaultTo(1,d.decPlaces),h=d.handle,k=d.expr||"",l=d.units||"",m=this.readouts[d.readout];m||console.log("Bad readout name "+d.readout);d="display"+e+this.entries.length;var n=m.addEntry(e+h),p=new DataDisplayer.Entry(h,e,f,k,l,d,this,n);this.entries[p.handle]=p;addListener(curLevel,"update",d,function(){var d=e,h;h=p.func();h=void 0===h?"":"number"==typeof h?h.toFixed(f):h;d=d+(h+" ")+l;n.setText(d)});
return p},setEntryValue:function(d,e){var f=this.entries[d];f||console.log("bad handle "+d);var h=e-f.func();f.expr=f.expr+" + "+h;f.func=f.wrapExprInFunc()},removeEntry:function(d){this.entries[d]&&this.entries[d].remove()}};DataDisplayer.Entry=function(d,e,f,h,k,l,m,n){this.handle=d;this.label=e;this.decPlaces=f;this.expr=h;this.func=this.wrapExprInFunc();this.units=k;this.listenerStr=l;this.dataDisplayer=m;this.readoutEntry=n;this.removed=!1};
DataDisplayer.Entry.prototype={remove:function(){this.removed||(delete this.dataDisplayer.entries[this.handle],this.readoutEntry.remove(),removeListener(curLevel,"update",this.listenerStr),this.removed=!0)},wrapExprInFunc:function(){var d=this.expr;with(DataGetFuncs)d=exprHasReturn(d)?eval("(function(){"+d+"})"):eval("(function(){return "+d+"})");return d}};DataGetFuncs={tempSmooth:function(d){d=walls[d].getDataSrc("temp");for(var e=Math.min(15,d.length),f=d.length-e,h=0,k=0;k<e;k++)h+=d[f+k];return h/e},collisions:function(){for(var d=collide.hitsPerTurn,e=Math.min(15,d.length),f=d.length-e,h=0,k=0;k<e;k++)h+=d[f+k];return 1E3*h/e/updateInterval},temp:function(d){d=walls[d].getDataSrc("temp");return d[d.length-1]},pInt:function(d){d=walls[d].getDataSrc("pInt");return d[d.length-1]},pExt:function(d){d=walls[d].getDataSrc("pExt");return d[d.length-1]},
vol:function(d){d=walls[d].getDataSrc("vol");return d[d.length-1]},q:function(d){d=walls[d].getDataSrc("q");return d[d.length-1]},mass:function(d){d=walls[d].getDataSrc("mass");return d[d.length-1]},moles:function(d,e){var f=walls[d].getDataSrc("moles",e);return f[f.length-1]},frac:function(d,e){var f=walls[d].getDataSrc("frac",e);return f[f.length-1]},time:function(d){d=walls[d].getDataSrc("time");return d[d.length-1]},work:function(d){d=walls[d].getDataSrc("work");return d[d.length-1]},enthalpy:function(d){d=
walls[d].getDataSrc("enthalpy");return d[d.length-1]},internalEnergy:function(d){d=walls[d].getDataSrc("internalEnergy");return d[d.length-1]},vDist:function(d,e){var f=walls[d].getDataSrc("vDist",e);return f[f.length-1]},get:function(d,e,f,h,k){d=getStore(d);var l,m="int"==e||"float"==e;d&&(l="int"==e?Math.round(parseFloat(d)):"float"==e?parseFloat(d):"string"==e?d.sanitize():Number(d)==d?Number(d):d,m&&(k=void 0===k||isNaN(k)?l:k,h=void 0===h||isNaN(h)?l:h,l=bound(l,h,k)));if(void 0===l||m&&isNaN(l))l=
f;return l},img:function(d,e,f,h){if(h)return{attrs:{src:[window.IMGPATHPREFIX+d]}};d=templater.img({attrs:{src:[window.IMGPATHPREFIX+d]}});f&&(d=templater.center({innerHTML:d}));"br"==e?d=templater.br()+d+templater.br():"p"==e&&(d=templater.p({innerHTML:d}));return d}};function Experiment(){this.mutables={count:new Experiment.Mutable("LevelData.mainSequence[0].sceneData.dots[0].count")};this.data={tempFinal:new Experiment.Data('walls.wally.getDataSrc("temp")')};this.listData={vol:new Experiment.Data('walls.wally.getDataSrc("vol")'),temp:new Experiment.Data('walls.wally.getDataSrc("temp")')};this.everyNth=4;this.dataToEval={};this.dimensions=[new Experiment.Dimension([{paths:["count"],testVals:"[300, 500 ... 500]"}])];this.appendEqData=!1;this.numReps=1;this.runTime=
10;this.draw=!1;this.runNum=0;this.totalRuns=this.getTotalRuns();console.log("Running "+this.totalRuns+" tests at "+this.runTime+" seconds each.");console.log("Total run time: "+this.totalRuns*this.runTime+" seconds");this.resultsSets=[];this.repIdx=0;this.dimValIdxs=this.makeDimValIdxs(this.dimensions);this.finished=!1;this.measureNext()}
Experiment.prototype={measureNext:function(){var d=this;this.finished?(console.log("Done!  Ready to print"),curLevel.pause()):(this.setVals(this.mutables,this.dimensions,this.dimValIdxs),sceneNavigator.refresh(),this.draw||(curLevel.drawRun=function(){}),setTimeout(function(){d.tryNextMeasurement()},1E3*this.runTime))},print:function(d){d||(d=Experiment.Dimension.prototype.extendSet("[0 ... "+(this.dimensions.length-1)+"]"));d=this.sortResults(this.resultsSets,d);var e;e='<table border="1" cellpadding="3">'+
this.makeHeaderRow();for(var f=0;f<d.length;f++)e+=d[f].asTableBlock(this.appendEqData,this.everyNth,!0);e+="</table>";$("body").append("<br>");$("body").append(e)},sortResults:function(d,e){if(!e.length)return d;for(var f=e[0],h=this.sortSetsByDimIdx(d.concat(),f),f=this.pluckGroups(h,f),k=h=0;k<f.length;k++){var l=[h,f[k].length].concat(this.sortResults(f[k],e.slice(1,e.length-1)));Array.prototype.splice.apply(d,l);h+=f[k].length}return d},pluckGroups:function(d,e){for(var f=[],h=-1,k=0;k<d.length;k++)d[k].dimValIdxs[e]!=
h&&(f.push([]),h=d[k].dimValIdxs[e]),f[f.length-1].push(d[k]);return f},sortSetsByDimIdx:function(d,e){for(var f=0;f<d.length;f++)for(var h=0;h<d.length-1;h++){var k=d[h],l=d[h+1];l.dimValIdxs[e]<k.dimValIdxs[e]&&(d[h]=l,d[h+1]=k)}return d},tryNextMeasurement:function(){this.recordPt(this.data,this.mutables,this.listData,this.dimValIdxs);this.finished=this.tick();this.measureNext()},tick:function(){this.runNum++;console.log(Math.round(100*this.runNum/this.totalRuns)+" %");var d=this.dimensions,e=
this.dimValIdxs;this.repIdx++;return this.repIdx==this.numReps?(this.repIdx=0,this.nextDimVal(d,e)):!1},nextDimVal:function(d,e){for(var f=d.length-1;0<=f;f--)if(e[f]++,e[f]==d[f].numPts)e[f]=0;else return!1;return!0},makeDimValIdxs:function(d){for(var e=[],f=0;f<d.length;f++)e.push(0);return e},makeHeaderRow:function(){var d="<tr>",e;for(e in this.mutables)d+="<td>"+e+"</td>";for(e in this.data)d+="<td>"+e+"</td>";for(e in this.listData)d+="<td>"+e+"</td>";for(e in this.dataToEval)d+="<td>"+e+"</td>";
this.appendEqData&&(d+="<td>eq const</td><td>mole frac prods</td>");return d+="</tr>"},getTotalRuns:function(){for(var d=1,e=0;e<this.dimensions.length;e++)d*=this.dimensions[e].numPts;return d*this.numReps},recordPt:function(d,e,f,h){this.resultsSets.length?this.resultsSets[this.resultsSets.length-1].isAtIdxs(h)||this.resultsSets.push(new Experiment.ResultsSet(h)):this.resultsSets.push(new Experiment.ResultsSet(h));this.resultsSets[this.resultsSets.length-1].results=new Experiment.Results(d,e,f,
this.dataToEval)},setVals:function(d,e,f){for(var h=0;h<e.length;h++)for(var k=e[h],l=f[h],m=0;m<k.paths.length;m++)for(var n=k.testVals[m][l],p=k.paths[m],q=0;q<p.length;q++)eval(d[p[q]].path+" = "+n)}};Experiment.ResultsSet=function(d){this.dimValIdxs=d.concat();this.results=void 0};
Experiment.ResultsSet.prototype={addResults:function(d){this.results=d},isAtIdxs:function(d){for(var e=0;e<d.length;e++)if(d[e]!=this.dimValIdxs[e])return!1;return!0},asTableBlock:function(d,e,f){var h="";f&&(h+="<tr><td></td></tr>");return h+=this.results.asTableBlock(d,e)}};Experiment.Dimension=function(d){this.paths=_.pluck(d,"paths");d=_.pluck(d,"testVals");this.testVals=this.extendSets(d,this.paths);this.numPts=this.testVals[0].length};
Experiment.Dimension.prototype={extendSets:function(d,e){for(var f=[],h=0;h<d.length;h++)d[h]instanceof Array?f.push(d[h]):f.push(this.extendSet(d[h]));this.checkValLens(f,e);return f},extendSet:function(d){-1==d.indexOf("...")&&console.log("Unrecognized set "+d);d=d.replace("..."," ... ");var e=this.cleanSigVals(d.match(/[\-0-9\.]+/g)),f;d=e[0];3==e.length?(f=e[1]-e[0],e=e[2]):(e=e[1],f=e>d?1:-1);return this.setFromSigVals(d,f,e)},checkValLens:function(d,e){for(var f=d[0].length,h=d[0].length,k=
0;k<d.length;k++)f=Math.min(d[k].length,f),h=Math.max(d[k].length,h);f!=h&&(console.log("Dimension with paths "),console.log(e),console.log("has mismatched values sets: max length is "+h+" and min length is "+f),console.log("THIS EXPERIMENT WILL NOT WORK"))},cleanSigVals:function(d){for(var e=[],f=0;f<d.length;f++){var h=/[\.]+/.exec(d[f]);h&&h[0]!=d[f]?e.push(Number(d[f])):h||e.push(Number(d[f]))}return e},setFromSigVals:function(d,e,f){var h=[];if(d<f)for(;d<=f;d+=e)h.push(d);else for(;d>=f;d+=
e)h.push(d);return h}};Experiment.Results=function(d,e,f,h){this.data={};this.spcDefs=deepCopy(LevelData.spcDefs);var k=walls[0].getDataSrc("temp");this.finalTemp=this.avgLast(k,300);this.setPts=this.recordMutables(e);for(var l in d)this.data[l]=d[l].avg(200);this.listData={};for(a in f)this.listData[a]=eval(f[a].path);this.evaledData=this.evalData(h,this.data)};
Experiment.Results.prototype={log:function(){console.log("\nSet point");console.log(this.objToStr(this.setPts));console.log("Produced data");console.log(this.objToStr(this.data)+"\n")},recordMutables:function(d){var e={},f;for(f in d)e[f]=eval(d[f].path);return e},evalData:function(d,e){var f={};with(e)for(var h in d)f[h]=eval(d[h].path);return f},asTableBlock:function(d,e){var f="<tr>",h;for(h in this.setPts)f+="<td>"+this.setPts[h]+"</td>";for(h in this.data)f+="<td>"+this.data[h]+"</td>";for(h in this.listData)f+=
"<td>"+this.listData[h][0]+"</td>";for(h in this.evaledData)f+="<td>"+this.evaledData[h]+"</td>";d&&(f+=this.makeEqData(this.spcDefs));f+="</tr>";countAttrs(this.listData)&&(f=this.appendListDataToTableBlock(this.setPts,this.data,this.listData,this.evaledData,d,f,e));return f},makeEqData:function(d){var e=this.finalTemp,f=1E3*(d[2].hF298+d[3].hF298-(d[1].hF298+d[0].hF298));d=Math.exp(-(f-298*(d[2].sF298+d[3].sF298-d[1].sF298-d[0].sF298))/(298.15*R))*Math.exp(-(f/R)*(1/e-1/298.15));for(var h,e=0;1>=
e&&!(h=Newton(d+" - (x*x)/((1-x)*(1-x))",{x:e},"x"),0<=h&&1>=h);e+=0.1);return"<td>"+d+"</td><td>"+h+"</td>"},appendListDataToTableBlock:function(d,e,f,h,k,l,m){k=0;for(var n in f)k=Math.max(f[n].length,k);for(var p=1;p<k;p++)if(0==p%m){l+="<tr>";for(n in d)l+="<td></td>";for(n in e)l+="<td></td>";for(n in f)l+="<td>"+(void 0!==this.listData[n][p]?this.listData[n][p]:"")+"</td>";for(n in h)l+="<td></td>";l+="</tr>"}return l},objToStr:function(d){var e="",f;for(f in d)e+=f+": "+d[f]+", ";return e},
avgLast:function(d,e){for(var f=0,h=Math.max(0,d.length-e);h<d.length;h++)f+=d[h];return f/Math.min(e,d.length)}};Experiment.Mutable=function(d){this.path=d};Experiment.Mutable.prototype={get:function(){return eval(this.path)},set:function(d){eval(this.path+" = "+d)}};Experiment.Data=function(d){this.path=d};
Experiment.Data.prototype={all:function(){return eval(this.path)},last:function(){var d=eval(this.path);return d[d.length-1]},avg:function(d){for(var e=eval(this.path),f=0,h=Math.max(0,e.length-d);h<e.length;h++)f+=e[h];return f/d}};
function Newton(d,e,f){for(var h=function(e){e=deepCopy(e);with(e){e[f]+=1E-7;var h=eval(d);e[f]-=2E-7;e=eval(d);return(h-e)/2E-7}},k=function(e){with(e)return eval(d)},l=k(e),m=0;1E-7<Math.abs(l);){var n=h(e);e[f]-=l/n;l=k(e);m++;if(1E3<m)return e[f]+" EQ DID NOT CONVERGE"}return e[f]};ReactionFuncs={rxnIsEnabled:function(d){return this.getRxn(this.activeRxns,d)?!0:!1},rxnsAreType:function(d,e){if(d.length)for(var f=1;f<d.length;f++)if(!d[f]instanceof e)return!1;return!0},getRxn:function(d,e){for(var f=0;f<d.length;f++)if(e==d[f].handle)return d[f]},react:function(d,e,f){for(var h=d.internalEnergy()+e.internalEnergy(),k=0,l=0,m=0.5*(d.x+e.x),n=0.5*(d.y+e.y),p=[],q=0;q<f.length;q++){for(var s=f[q],t=[],k=k+s.def.uF298*s.count,l=l+this.spcs[s.spcName].cv*s.count,u=0;u<s.count;u++){var v=
2*Math.random()*Math.PI,v=V(Math.sin(v),Math.cos(v));t.push(D(m+3*v.dx,n+3*v.dy,v,s.spcName,d.tag,d.elemId,d.returnTo))}p.push(t)}k*=1E3/N;l/=N;f=(h-k)/l+298.15;if(0<f){this.dotManager.remove([d,e],!0);for(d=0;d<p.length;d++){t=p[d];this.dotManager.add(t);for(e=0;e<t.length;e++)t[e].setTemp(f)}return!0}return!1},canReact:function(d,e,f){d=d.internalEnergy()+e.internalEnergy();for(var h=e=0,k=0;k<f.length;k++){var l=f[k];e+=l.def.uF298*l.count;h+=this.spcs[l.spcName].cv*l.count}e*=1E3/N;h/=N;return 0<
(d-e)/h+298.15}};ReactionComponent=function(d,e){this.spcName=d;this.count=e;this.def=window.spcs[d]};ReactionComponent.prototype={copy:function(){return new ReactionComponent(this.spcName,this.count)},flatten:function(d){for(var e=[],f=0;f<this.count;f++)e.push(this[d]);return e}};function ReactionHandlerEmergent(d,e,f,h,k,l){this.collide=d;this.dotManager=e;this.tConst=h;this.rxns=f;this.spcs=void 0;this.activeRxns=k;this.pausedRxns=l}
_.extend(ReactionHandlerEmergent.prototype,ReactionFuncs,{addReaction:function(d){d.parent=this;d=new ReactionHandlerEmergent.Reaction(d);this.initRxn(d);return d},enableRxn:function(d){if(d=this.getRxn(this.pausedRxns,d))this.pausedRxns.splice(this.pausedRxns.indexOf(d),1),this.initRxn(d)},disableRxn:function(d){this.removeRxn(d)},removeRxn:function(d){for(var e in this.rxns){for(var f=this.rxns[e],h=!1,k=f.length-1;0<=k;k--)f[k].handle==d&&(f.splice(k,1),h=!0);h&&(0==f.length?this.collide.setHandlerByIdStr(e,
{func:this.collide.impactStd,obj:this.collide}):1==f.length&&(f=f[0],this.initPair(f,!0)))}if(f=this.getRxn(this.activeRxns,d))this.activeRxns.splice(this.activeRxns.indexOf(f),1),this.pausedRxns.push(f)},initRxn:function(d){this.initPair(d);this.activeRxns.push(d)},removeAllReactions:function(){this.collide.setDefaultHandler({func:this.collide.impactStd,obj:this})},initPair:function(d){var e=this.collide.getIdStr(d.rctADef,d.rctBDef);this.rxns[e]?this.rxns[e].push(d):this.rxns[e]=[d];1<this.rxns[e].length?
this.rxnsAreType(this.rxns[e],ReactionHandlerEmergent.Reaction)?this.collide.setHandler(d.rctA,d.rctB,{func:this.rctHandlerMultPairs(e),obj:this}):(console.log("Cannot mix reaction types."),console.log("Failed to add reaction: "),console.log(d)):this.collide.setHandler(d.rctA,d.rctB,{func:this.rctHandlerSinglePair(e),obj:this})},countProds:function(d){var e=0,f;for(f in d)e+=d[f];return e},hitE:function(d,e,f,h){return 0.5*(Math.abs(f)*f*d.m*d.cvKinetic+Math.abs(h)*h*e.m*e.cvKinetic)*this.tConst},
probFunc:function(d,e,f){return d>1.5*e?1/(1+Math.exp(-f/R)):0},rctHandlerSinglePair:function(d){var e=this.rxns[d][0],f=e.activeE,h=this.collide,k=e.prods;return function(d,m,n,p,q){var s=this.hitE(d,m,p,-q);return Math.random()<this.probFunc(s,f,e.sRxn298)?!this.react(d,m,k)?h.impactStd(d,m,n,p,q):!1:h.impactStd(d,m,n,p,q)}},rctHandlerMultPairs:function(d){var e=this.rxns[d],f=this.collide;return function(d,k,l,m,n){for(var p=this.hitE(d,k,m,-n),q=[],s=0,t=0;t<e.length;t++)q[t]=this.probFunc(p,
e[t].activeE,rxn.sF298),s+=q[t];t=this.pickRxnIdx(q,1<s?1/s:1);return!1===t?f.impactStd(d,k,l,m,n):this.react(d,k,e[t].prods)?!1:f.impactStd(d,k,l,m,n)}},pickRxnIdx:function(d,e){for(var f=Math.random(),h=0,k=0;k<d.length;k++)if(h+=d[k]*e,h>f)return k;return!1}});
ReactionHandlerEmergent.Reaction=function(d){this.attrs=d;this.handle=d.handle;this.parent=d.parent;this.rctA=d.rctA||d.rctB;this.rctB=d.rctA&&d.rctB?d.rctB:void 0;this.rctADef=this.parent.spcs[this.rctA];this.rctBDef=this.parent.spcs[this.rctB];this.activeE=1E3*d.activeE/N;if(this.rctA&&!this.rctADef)return console.log("reactant a "+this.rctA+" doesn't exist");if(this.rctB&&!this.rctBDef)return console.log("reactant b "+this.rctB+" doesn't exist");this.prods=this.reformatProds(d.prods);this.prodCount=
this.countProds(this.prods);this.sRxn298=this.calcSRxn([new ReactionComponent(this.rctA,1),new ReactionComponent(this.rctB,1)],this.prods,this.parent.spcs)};
ReactionHandlerEmergent.Reaction.prototype={copy:function(){return new this.parent.Reaction(this.attrs)},doubleProds:function(){for(var d=0;d<this.prods.length;d++)this.prods[d].count*=2;this.prodCount*=2;return this},calcSRxn:function(d,e,f){for(var h=0,k=0;k<e.length;k++)h+=f[e[k].spcName].sF298*e[k].count;for(k=0;k<d.length;k++)h-=f[d[k].spcName].sF298*d[k].count;return h},increaseProd:function(d,e){for(var f=!1,h=0;h<this.prods.length;h++){var k=this.prods[h];if(k.spcName==d){k.count+=e;f=!0;
break}}f||this.prods.push(new ReactionComponent(d,e));this.prodCount+=e;return this},reformatProds:function(d){var e=[],f;for(f in d)e.push(new ReactionComponent(f,d[f]));return e},countProds:function(d){for(var e=0,f=0;f<d.length;f++)e+=d[f].count;return e},remove:function(){this.parent.removeRxn(this.handle)}};function ReactionHandlerNonEmergent(d,e,f,h,k,l){this.collide=d;this.dotManager=e;this.tConst=h;this.rxns=f;this.chanceMap=this.spcs=void 0;this.activeRxns=k;this.pausedRxns=l}
_.extend(ReactionHandlerNonEmergent.prototype,ReactionFuncs,{setSpcs:function(d){this.spcs=d;this.chanceMap={};for(var e in this.rxns)this.chanceMap[e]={}},addReaction:function(d){var e=this;d.parent=this;var f=new ReactionHandlerNonEmergent.Reaction(d,this.rxns);this.activeRxns.push(f);addListenerOnce(curLevel,"update","initRxn"+f.handle,function(){f.init();e.readyHandlers(e.collide,e.rxns,f,e.chanceMap)},void 0)},disableRxn:function(d){this.removeRxn(d)},removeRxn:function(d){if(d=this.getRxn(this.activeRxns,
d)){d.inited||removeListener(curLevel,"update","initRxn"+d.handle);var e=d.pairs,f=this.chanceMap,h=this.rxns;d.removeListener();this.splicePairsFromRxns(e,h);this.splicePairsFromChanceMap(e,f);this.activeRxns.splice(this.activeRxns.indexOf(d),1);this.pausedRxns.push(d);this.readyHandlers(this.collide,this.rxns,d,this.chanceMap)}},rxnIsEnabled:function(d){return this.getRxn(this.activeRxns,d)?!0:!1},enableRxn:function(d){if(d=this.getRxn(this.pausedRxns,d))d.init(),this.pausedRxns.splice(this.pausedRxns.indexOf(d),
1),this.activeRxns.push(d),this.readyHandlers(this.collide,this.rxns,d,this.chanceMap)},splicePairsFromRxns:function(d,e){for(var f in e)for(var h=e[f],k=0;k<d.length;k++){var l=h.indexOf(d[k]);0<=l&&h.splice(l,1)}},splicePairsFromChanceMap:function(d,e){for(var f in e){var h=e[f],k;for(k in h)for(var l=h[k],m=0;m<d.length;m++)l.removePair(d[m])}},readyHandlers:function(d,e,f,h){for(var k=0;k<f.pairs.length;k++){var l=f.pairs[k].idStr;pairRxns=e[l];1==pairRxns.length?this.initSingleRxnPair(pairRxns[0],
l,d):1<pairRxns.length?this.initMultiRxnPair(pairRxns,l,d,h):0==pairRxns.length&&d.resetHandlerByIdStr(l)}},initSingleRxnPair:function(d,e,f){e=d.idStr;f.setHandlerByIdStr(e,new Listener(function(e,k,l,m,n){var p=d.rxn.wallGroupsMap[e.tag],q=p[d.queuePath];if(Math.random()<p[d.chancePath]){if(0<q.now)return this.react(e,k,d.prods)?(q.now--,!1):f.impactStd(e,k,l,m,n);this.canReact(e,k,d.prods)&&q.now--}return f.impactStd(e,k,l,m,n)},this))},initMultiRxnPair:function(d,e,f,h){f.setHandlerByIdStr(e,
new Listener(function(k,l,m,n,p){var q=h[e][k.tag],s=1/Math.max(1,q.total),t=Math.random();if(q.total<t)return f.impactStd(k,l,m,n,p);for(var u=0,v=0;v<d.length;v++){var q=d[v],x=q.rxn.wallGroupsMap[k.tag],u=u+s*x[q.chancePath];if(u>=t){s=x[q.queuePath];if(0<s.now)return this.react(k,l,q.prods)?(s.now--,!1):f.impactStd(k,l,m,n,p);this.canReact(k,l,q.prods)&&s.now--;return f.impactStd(k,l,m,n,p)}}},this))}});
ReactionHandlerNonEmergent.Reaction=function(d,e){this.parent=d.parent;this.chanceMap=this.parent.chanceMap;this.collide=this.parent.collide;this.handle=d.handle;this.enqueueListenerHandle=this.handle+"Enqueue";this.checkRxnSideCount(d.rcts);this.checkRxnSideCount(d.prods);this.allRxns=e;this.rctsNet=this.reformatSide(d.rcts);this.prodsNet=this.reformatSide(d.prods);this.sRxn298=this.calcSRxn298(this.rctsNet,this.prodsNet);this.pairs=[];this.preExpForward=d.preExpForward;this.activeEForward=1E3*d.activeEForward;
this.updateWalls();this.updateQueue=this.wrapUpdateQueue();this.listenerHandle=this.handle+"UpdateQueue";this.inited=!1};
ReactionHandlerNonEmergent.Reaction.prototype={init:function(){var d=this.chanceMap;this.inited=!0;addListener(curLevel,"data",this.listenerHandle,function(){this.updateWalls();for(var e=0;e<this.wallGroups.length;e++)this.updateQueue(this.wallGroups[e],d)},this);this.addCollisionPairs(this.collide,this.rctsNet,this.prodsNet,this.allRxns,this.chanceMap,window.dotManager,window.spcs);for(var e=0;e<this.wallGroups.length;e++)this.updateQueue(this.wallGroups[e],d)},getWallTemp:function(d){d=window.walls[d.wallHandle].data.temp;
var e=d.src();if(e.length)return e[e.length-1];d=d.listener();return d.func.apply(d.obj)},remove:function(){this.parent.removeRxn(this.handle)},removeListener:function(){removeListener(curLevel,"data",this.listenerHandle)},updateWalls:function(){var d=this.chanceMap;this.wallGroups=this.makeWallGroups(window.walls,this.wallGroups||[],this.rctsNet,this.prodsNet);this.wallGroupsMap={};for(var e=0;e<this.wallGroups.length;e++){var f=this.wallGroups[e].wallHandle;this.wallGroupsMap[f]=this.wallGroups[e];
for(var h in d)void 0===d[h][f]&&(d[h][f]=new ReactionHandlerNonEmergent.WallChanceObj)}},addCollisionPairs:function(d,e,f,h,k,l,m){l=this.countRxnSide(e);var n=this.countRxnSide(f);e=this.copyRxnSide(e);f=this.copyRxnSide(f);2==l&&2==n?this.addTwoTwo(m,h,d,e,f,k):1==l&&1==n?this.addOneOne(m,h,d,e,f,k):(1==l&&2==n||2==l&&1==n)&&this.addOneTwo(m,h,d,e,f,k)},addOneOne:function(d,e,f,h,k,l){var m,n;for(n in d)l=this.copyRxnSide(h),m=this.copyRxnSide(k),this.addToRxnSide(l,n,1),this.addToRxnSide(m,n,
1),this.addTwoTwo(d,e,f,l,m)},addOneTwo:function(d,e,f,h,k,l){var m=!1;1==this.countRxnSide(k)&&(m=!0);var n=!m?"chanceForward":"chanceBackward",p=!m?"chanceBackward":"chanceForward",q=!m?"rctQueue":"prodQueue",s=!m?"prodQueue":"rctQueue";l=!m?this.copyRxnSide(h):this.copyRxnSide(k);h=!m?this.copyRxnSide(k):this.copyRxnSide(h);for(var t in d)k=this.copyRxnSide(l),m=this.copyRxnSide(h),this.copyRxnSide(h),this.copyRxnSide(l),this.addToRxnSide(k,t,1),this.addToRxnSide(m,t,1),k=new ReactionHandlerNonEmergent.ReactivePair(this,
f,k,m,n,q),this.pushPair(f,e,d,k);t=new ReactionHandlerNonEmergent.ReactivePair(this,f,this.copyRxnSide(h),this.copyRxnSide(l),p,s);this.pushPair(f,e,d,t)},addTwoTwo:function(d,e,f,h,k,l){var m=new ReactionHandlerNonEmergent.ReactivePair(this,f,h,k,"chanceForward","rctQueue");h=new ReactionHandlerNonEmergent.ReactivePair(this,f,k,h,"chanceBackward","prodQueue");this.pushPair(f,e,d,m,l);this.pushPair(f,e,d,h,l)},pushPair:function(d,e,f,h){d=h.idStr;this.pairs.push(h);void 0==e[d]?e[d]=[h]:e[d].push(h)},
countRxnSide:function(d){for(var e=0,f=0;f<d.length;f++)e+=d[f].count;return e},addToRxnSide:function(d,e,f){for(var h=0;h<d.length;h++)if(d[h].spcName==e){d[h].count+=f;return}d.push(new ReactionComponent(e,f))},copyRxnSide:function(d){for(var e=[],f=0;f<d.length;f++)e.push(d[f].copy());return e},wrapUpdateQueue:function(){var d=this,e=this.preExpForward,f=this.activeEForward,h=this.sRxn298,k=this.calcHRxn298(this.rctsNet,this.prodsNet),l=Math.exp(-(k-298.15*h)/(8.314*298.15)),m=this.pairs;return function(h,
p){var q=h.temp[h.temp.length-1],s=h.rctQueue,t=h.prodQueue,u=s.init,v=s.now,x=t.init,y=t.now;h.chanceForward=d.moveAlongSigmoid(h.chanceForward,0!==v?0.2*v/(0<u?Math.sqrt(u):1):0);h.chanceBackward=d.moveAlongSigmoid(h.chanceBackward,0!==y?0.2*y/(0<x?Math.sqrt(x):1):0);h.rateScalar=0.999<h.chanceForward||0.999<h.chanceBackward?d.moveAlongSigmoid(h.rateScalar,-0.3):d.moveAlongSigmoid(h.rateScalar,0.3);u=l*Math.exp(-k/8.314*(1/q-1/298.15));q=h.rateScalar*e*Math.exp(-f/(8.314*q));u=q/u;q=Math.max(0,
Math.round(d.getNumInDir(q,d.rctsNet,h.moles,h.vol[h.vol.length-1])+Math.random()-0.5));u=Math.max(0,Math.round(d.getNumInDir(u,d.prodsNet,h.moles,h.vol[h.vol.length-1])+Math.random()-0.5));s.init=q;s.now=q;t.init=u;t.now=u;for(s=0;s<m.length;s++)t=m[s],p[t.idStr][h.wallHandle].updatePairChance(t,h[t.chancePath])}},avgLast:function(d,e){var f=0;e=Math.min(e,d.length);for(var h=d.length-e;h<d.length;h++)f+=d[h];return f/e},moveAlongSigmoid:function(d,e){return Math.min(Math.max(1E-4,1/(1+(1/d-1)*Math.exp(-e))),
0.9999)},getNumInDir:function(d,e,f,h){d=0.0010*N*d*dataInterval;for(var k=0;k<e.length;k++){var l=f[e[k].spcName];d*=Math.pow(l[l.length-1]/h,e[k].count)}return d},checkRxnSideCount:function(d){if(2<this.countRxnSide(d)||0>=this.countRxnSide(d))console.log("Bad number of products or reactions for non-emergent reaction"),console.log("Reaction will not work"),console.log(d)},calcHRxn298:function(d,e){for(var f=0,h=0;h<e.length;h++)f+=e[h].def.hF298*e[h].count;for(h=0;h<d.length;h++)f-=d[h].def.hF298*
d[h].count;return 1E3*f},makeWallGroups:function(d,e,f,h){for(var k=[],l=0;l<d.length;l++){var m=d[l];if(m.data.temp&&m.closed&&!m.isLiquid){var n=this.getWallGroup(e,m.handle);n?k.push(n):k.push(new ReactionHandlerNonEmergent.WallGroup(m,m.handle,f,h))}}return k},getWallGroup:function(d,e){for(var f=0;f<d.length;f++)if(d[f].wallHandle==e)return d[f]},makeQueues:function(d,e){for(var f={},h=0;h<d.length;h++)f[d[h].handle]=e[d[h].handle]?e[d[h].handle]:new ReactionHandlerNonEmergent.Queue;return f},
countRxnSide:function(d){for(var e=0,f=0;f<d.length;f++)e+=d[f].count;return e},flatten:function(d,e){for(var f=[],h=0;h<d.length;h++)f=f.concat(d[h].flatten(e));return f},reformatSide:function(d){for(var e=[],f=0;f<d.length;f++)e.push(new ReactionComponent(d[f].spcName,d[f].count));return e},calcSRxn298:function(d,e){for(var f=0,h=0;h<e.length;h++)f+=e[h].def.sF298*e[h].count;for(h=0;h<d.length;h++)f-=d[h].def.sF298*d[h].count;return f}};
ReactionHandlerNonEmergent.WallGroup=function(d,e,f,h){this.temp=d.getDataSrc("temp");this.vol=d.getDataSrc("vol");this.moles={};this.wallHandle=d.handle;this.chanceBackward=this.chanceForward=0.1;this.rateScalar=0.9999;this.rctQueue=new ReactionHandlerNonEmergent.Queue;this.prodQueue=new ReactionHandlerNonEmergent.Queue;this.populateMoles(d,e,this.moles,f);this.populateMoles(d,e,this.moles,h)};
ReactionHandlerNonEmergent.WallGroup.prototype={populateMoles:function(d,e,f,h){for(var k=0;k<h.length;k++){var l=d.recordMoles({tag:e,spcName:h[k].spcName});l.recordVal();f[h[k].spcName]=l.src()}}};ReactionHandlerNonEmergent.Queue=function(){this.now=this.init=0};ReactionHandlerNonEmergent.ReactivePair=function(d,e,f,h,k,l){this.rxn=d;this.rcts=f;this.prods=h;this.chancePath=k;this.queuePath=l;d=d.flatten(this.rcts,"def");this.idStr=e.getIdStr(d[0],d[1])};
ReactionHandlerNonEmergent.WallChanceObj=function(d){this.total=0;this.pairChances=[]};
ReactionHandlerNonEmergent.WallChanceObj.prototype={updatePairChance:function(d,e){for(var f=!1,h=0;h<this.pairChances.length;h++)this.pairChances[h].pair==d&&(this.pairChances[h].chance=e,f=!0);f||this.pairChances.push(new ReactionHandlerNonEmergent.PairChances(d,e));this.updateTotal()},removePair:function(d){for(var e=this.pairChances.length-1;0<=e;e--)this.pairChances[e].pair==d&&this.pairChances.splice(e,1);this.updateTotal()},updateTotal:function(){for(var d=this.total=0;d<this.pairChances.length;d++)this.total+=
this.pairChances[d].chance}};ReactionHandlerNonEmergent.PairChances=function(d,e){this.pair=d;this.chance=e};function CollideHandler(d){this.tConst=tConst;this.rxns={};this.dotManager=d;this.activeRxns=[];this.pausedRxns=[];this.numHits=0;this.hitsPerTurn=[];this.checkStore=this.check;this.breakUpStore=this.breakUp;this.recordingHits=!1;this.recordCleanUpListenerName="recordCollideHits";this.rxnHandlerEmergent=new ReactionHandlerEmergent(this,this.dotManager,this.rxns,this.tConst,this.activeRxns,this.pausedRxns);this.rxnHandlerNonEmergent=new ReactionHandlerNonEmergent(this,this.dotManager,this.rxns,this.tConst,
this.activeRxns,this.pausedRxns)}
_.extend(CollideHandler.prototype,toInherit.gridder,{setSpcs:function(d){this.spcs=d;this.setDefaultHandler({func:this.impactStd,obj:this},this.spcs);this.rxnHandlerEmergent.spcs=d;this.rxnHandlerNonEmergent.setSpcs(d);this.setup(this.spcs)},setDefaultHandler:function(d,e){for(var f=countAttrs(e),h=0;h<f;h++)for(var k=h;k<f;k++)this[h+"-"+k]=d,this.rxns[h+"-"+k]=[]},getIdStr:function(d,e){return d.idNum<e.idNum?d.idNum+"-"+e.idNum:e.idNum+"-"+d.idNum},setHandler:function(d,e,f){var h=this.getIdStr(this.spcs[d],
this.spcs[e]);this.isIdStr(h)?this[h]=f:console.log("bad spc names "+d+" "+e)},setHandlerByIdStr:function(d,e){this.isIdStr(d)?this[d]=e:console.log("bad id string "+d)},resetHandlerByIdStr:function(d){this.isIdStr(d)?(this.rxns[d]=[],this.setHandlerByIdStr(d,new Listener(this.impactStd,this))):console.log("Bad id str "+d)},isIdStr:function(d){return/^[0-9]+\-[0-9]+$/.test(d)},recordCollisions:function(){this.check=this.checkRecord;this.breakUp=this.breakUpRecord;this.recordingCollisions=!0;addListener(curLevel,
"sectionCleanUp",this.recordCleanUpListenerName,this.recordCollisionsStop,this)},recordCollisionsStop:function(){this.check=this.checkStore;this.breakUp=this.breakUpStore;this.recordingCollisions=!1;removeListener(curLevel,"sectionCleanUp",this.recordCleanUpListenerName)},check:function(){for(var d=this.gridSize,e=this.xSpan,f=this.ySpan,h=this.grid=this.makeGrid(),k=dotManager.lists.ALLDOTS,l=k.length-1;-1<l;l--){var m=k[l],n=Math.floor(m.x/d),p=Math.floor(m.y/d),q=!0,s=Math.max(n-1,0),t=Math.min(n+
1,e)+1;a:for(;s<t;s++)for(var u=Math.max(p-1,0),v=Math.min(p+1,f)+1;u<v;u++)for(var x=h[s][u].length-1;0<=x;x--){var y=h[s][u][x],z=m.x-y.x,A=m.y-y.y;if(z*z+A*A<=(m.r+y.r)*(m.r+y.r)&&(z=this[Math.min(m.idNum,y.idNum)+"-"+Math.max(m.idNum,y.idNum)],A=V(y.x-m.x,y.y-m.y).UV(),!1===z.func.apply(z.obj,[m,y,A,m.v.dotProd(A),y.v.dotProd(A)]))){q=!1;h[s][u].splice(x,1);break a}}0<=n&&0<=p&&n<this.numCols&&p<this.numRows?q&&h[n][p].push(m):(returnEscapist(m),console.log("ball out of bounds"))}},checkRecord:function(){var d=
this.gridSize,e=this.xSpan,f=this.ySpan,h=this.grid=this.makeGrid();this.hitsPerTurn.push(this.numHits);this.numHits=0;for(var k=dotManager.lists.ALLDOTS,l=k.length-1;-1<l;l--){var m=k[l],n=Math.floor(m.x/d),p=Math.floor(m.y/d),q=!0,s=Math.max(n-1,0),t=Math.min(n+1,e)+1;a:for(;s<t;s++)for(var u=Math.max(p-1,0),v=Math.min(p+1,f)+1;u<v;u++)for(var x=h[s][u].length-1;-1<x;x--){var y=h[s][u][x],z=m.x-y.x,A=m.y-y.y;if(z*z+A*A<=(m.r+y.r)*(m.r+y.r)&&(z=this[Math.min(m.idNum,y.idNum)+"-"+Math.max(m.idNum,
y.idNum)],A=V(y.x-m.x,y.y-m.y).UV(),!1===z.func.apply(z.obj,[m,y,A,m.v.dotProd(A),y.v.dotProd(A)]))){q=!1;h[s][u].splice(x,1);break a}}0<=n&&0<=p&&n<this.numCols&&p<this.numRows?q&&h[n][p].push(m):(returnEscapist(m),console.log("ball out of bounds"))}},impactStd:function(d,e,f,h,k){var l=(h*(d.m-e.m)+2*e.m*k)/(d.m+e.m),m=(k*(e.m-d.m)+2*d.m*h)/(d.m+e.m),n=d.temp(),p=e.temp();d.v.dx+=f.dx*(l-h);d.v.dy+=f.dy*(l-h);e.v.dx+=f.dx*(m-k);e.v.dy+=f.dy*(m-k);h=d.temp();k=e.temp();l=n+(h-n)*d.cvKinetic/d.cv;
m=p+(k-p)*e.cvKinetic/e.cv;d.v.mult(Math.sqrt(l/h));d.internalPotential*=l/n;e.v.mult(Math.sqrt(m/k));e.internalPotential*=m/p;this.breakUp(d,e,f);return!0},breakUp:function(d,e,f){var h=d.r+e.r,k=e.x-f.dx*h,l=e.y-f.dy*h;e.x=d.x+f.dx*h;e.y=d.y+f.dy*h;d.x=k;d.y=l},breakUpRecord:function(d,e,f){this.numHits++;var h=d.r+e.r,k=e.x-f.dx*h,l=e.y-f.dy*h;e.x=d.x+f.dx*h;e.y=d.y+f.dy*h;d.x=k;d.y=l},setup:function(d){this.gridSize=Math.max(5,2*this.getMaxR(d));this.numCols=Math.ceil(myCanvas.width/this.gridSize+
1);this.numRows=Math.ceil(myCanvas.height/this.gridSize+1);this.xSpan=Math.floor(myCanvas.width/this.gridSize);this.ySpan=Math.floor(myCanvas.height/this.gridSize)},getMaxR:function(d){var e=0,f;for(f in d)e=Math.max(e,d[f].r);return e}});function DotMigrator(d){this.numCols=this.numRows=100}
DotMigrator.prototype={migrateDots:function(d,e,f,h,k){if(!f||!k)console.log("One or more of the order types wasn't sent to the dot migrator"),console.trace(),console.log(f),console.log(k);var l=document.getElementById("myCanvas").width,m=document.getElementById("myCanvas").height,l=l/this.numCols,m=m/this.numRows,n=this.spliceOpenWalls(window.walls),p=_.sortBy(n,function(d){return d.handle});e=_.sortBy(e,function(d){return d});h=_.sortBy(h,function(d){return d});n=this.makeModifiedMap(p,"contract",
0.12345,l,m);p=this.makeModifiedMap(p,"expand",0.12345,l,m);h=this.makeBooleanMap(p,h,k);e=this.makeBooleanMap(n,e,f);this.subtractBooleanMap(e,h);e=this.mapToCoordList(e);if(!e.length)return!1;f=this.numCols;k=this.numRows;for(n=0;n<d.length;n++)h[Math.floor((d[n].x+0.12345)/l)][Math.floor((d[n].y+0.12345)/m)]&&this.migrateDot(d[n],e,0.12345,f,k,l,m)},spliceOpenWalls:function(d){for(var e=[],f=0;f<d.length;f++)d[f].closed&&e.push(d[f]);return e},mapToCoordList:function(d){for(var e=[],f=0;f<d.length;f++)for(var h=
0;h<d[0].length;h++)d[f][h]&&e.push(P(f,h));return e},migrateDot:function(d,e,f,h,k,l,m){e=e[Math.floor(Math.random()*e.length)];d.x=f+(e.x+Math.random())*l;d.y=f+(e.y+Math.random())*m},makeBooleanMap:function(d,e,f){for(var h=this.makeGridBoolean(this.numCols,this.numRows),k=0,l=d.length;k<l;k++)for(var m=0,n=d[0].length;m<n;m++)h[k][m]=this.listsOverlap(e,d[k][m],f);return h},listsOverlap:function(d,e,f){if("and"==f){for(f=0;f<d.length;f++)if(0>e.indexOf(d[f]))return!1;return!0}if("only"==f){if(d.length!=
e.length)return!1;for(f=0;f<d.length;f++)if(d[f]!=e[f])return!1;return!0}if("or"==f){for(f=0;f<d.length;f++)if(-1<e.indexOf(d[f]))return!0;return!1}},subtractBooleanMap:function(d,e){for(var f=0,h=d.length;f<h;f++)for(var k=0,l=d[0].length;k<l;k++)d[f][k]=d[f][k]&&!e[f][k]},makeModifiedMap:function(d,e,f,h,k){for(var l=this.makeGrid(this.numCols,this.numRows),m=[],n=0;n<d.length;n++){var p=new DotMigrator.WallMap(d[n],this.numCols,this.numRows,f,h,k);p[e]();m.push(p)}for(n=0;n<this.numCols;n++)for(d=
0;d<this.numRows;d++)for(e=0;e<m.length;e++)m[e].grid[n][d]&&l[n][d].push(m[e].wall.handle);return l},makeGrid:function(d,e){for(var f=Array(d),h=0;h<d;h++){for(var k=Array(e),l=0;l<e;l++)k[l]=[];f[h]=k}return f},makeGridBoolean:function(d,e){for(var f=Array(d),h=0;h<d;h++){for(var k=Array(e),l=0;l<e;l++)k[l]=!1;f[h]=k}return f}};DotMigrator.WallMap=function(d,e,f,h,k,l){this.wall=d;this.grid=this.makeGrid(e,f);this.mapWallOntoGrid(d,this.grid,h,k,l)};
DotMigrator.WallMap.prototype={makeGrid:function(d,e){for(var f=Array(d),h=0;h<d;h++){for(var k=Array(e),l=0;l<e;l++)k[l]=!1;f[h]=k}return f},mapWallOntoGrid:function(d,e,f,h,k){for(var l,m,n=0;n<e.length;n++){var p=f+k*(n+0.5),q=[];l=0;for(m=d.length-1;l<d.length;l++)(d[l].y<p&&d[m].y>=p||d[m].y<p&&d[l].y>=p)&&q.push(d[l].x+(p-d[l].y)/(d[m].y-d[l].y)*(d[m].x-d[l].x)),m=l;for(l=0;l<q.length-1;)q[l]>q[l+1]?(m=q[l],q[l]=q[l+1],q[l+1]=m,l&&l--):l++;for(l=0;l<q.length;l+=2)for(m=q[l];m<q[l+1];m+=5)xGridIdx=
Math.floor((m-f)/h),e[xGridIdx][n]=!0}},expand:function(){for(var d=this.grid,e=this.makeGrid(d.length,d[0].length),f=0;f<d.length;f++)for(var h=0;h<d[0].length;h++)if(d[f][h]||d[f][h+1]||d[f-1]&&d[f-1][h]||d[f+1]&&d[f+1][h])e[f][h]=!0;this.grid=e},contract:function(){for(var d=this.grid,e=this.makeGrid(d.length,d[0].length),f=0;f<d.length;f++)for(var h=0;h<d[0].length;h++)if(d[f][h]&&d[f][h+1]&&(d[f-1]?d[f-1][h]:1)&&(d[f+1]?d[f+1][h]:1))e[f][h]=!0;this.grid=e}};
DotMigrator.MigratingDot=function(d,e,f){this.dot=d;this.allowedWallHandles=e;this.disallowedWallHandles=f};function CanvasManager(){this.canvases=[]}
CanvasManager.prototype={draw:function(){for(var d=0;d<this.canvases.length;d++){this.canvases[d].clear();for(var e=this.canvases[d],f=this.canvases[d].listeners,h=0;h<f.length;h++)f[h].cb.apply(f[h].obj,[e.ctx])}},addCanvas:function(d,e,f,h){d=new CanvasManager.Canvas(d,e,f,h);this.canvases.push(d)},addListener:function(d,e,f,h,k){var l=this.getByHandle(this.canvases,d);if(l){d=new CanvasManager.Canvas.Listener(e,k,f,h);if(e=this.getByHandle(l.listeners,e))l.listeners.splice(l.listeners.indexOf(e,
1)),console.log("overwriting listener "+e.handle);this.spliceByZIndex(l.listeners,d)}else console.log("Bad canvas handle "+d)},removeCanvas:function(d){for(var e=0;e<this.canvases.length;e++)this.canvases[e].handle==d&&this.canvases.splice(e,1)},removeListener:function(d,e){var f=this.getByHandle(this.canvases,d);if(f){var h=this.getByHandle(f.listeners,e);h&&f.listeners.splice(f.listeners.indexOf(h),1)}},spliceByZIndex:function(d,e){for(var f=d.length,h=0;h<d.length;h++)if(d[0].zIndex>=e.zIndex){f=
h;break}d.splice(f,0,e)},getByHandle:function(d,e){for(var f=0;f<d.length;f++)if(d[f].handle==e)return d[f]}};CanvasManager.Canvas=function(d,e,f,h){this.handle=d;this.htmlElem=e;this.ctx=f;this.listeners=[];this.bgCol=h};CanvasManager.Canvas.prototype={clear:function(){var d=this.htmlElem.width,e=this.htmlElem.height;this.ctx.clearRect(0,0,d,e);this.ctx.fillStyle=this.bgCol.hex;this.ctx.fillRect(0,0,d,e)}};
CanvasManager.Canvas.Listener=function(d,e,f,h){this.handle=d;this.zIndex=e;this.cb=f;this.obj=h};function Attractor(){this.eDebt=0;this.k1=0.5;this.k2=0.07}
_.extend(Attractor.prototype,toInherit.gridder,{setup:function(){this.gridSize=30;this.numCols=Math.ceil(myCanvas.width/this.gridSize+1);this.numRows=Math.ceil(myCanvas.height/this.gridSize+1);this.xSpan=Math.floor(myCanvas.width/this.gridSize);this.ySpan=Math.floor(myCanvas.height/this.gridSize);this.dotManager=dotManager;return this},attract:function(){for(var d=this.makeGrid(),e=this.gridSize,f=this.xSpan,h=this.ySpan,k=dotMagnager.lists.ALLDOTS,l=0;l<k.length;l++){var m=k[l];if(0<m.attractStr){m.tempLast=
m.temp();for(var n=Math.floor(m.x/e),p=Math.floor(m.y/e),q=Math.max(n-1,0);q<=Math.min(n+1,f);q++)for(var s=Math.max(p-1,0);s<=Math.min(p+1,h);s++)for(var t=d[q][s].length-1;-1<t;t-=1){var u=d[q][s][t],v=m.x-u.x,x=m.y-u.y,y=Math.sqrt(v*v+x*x),z=V(v,x);z.dx/=y;z.dy/=y;var y=Math.max(0,y-m.r-u.r)*pxToE,v=m.attractStrs[u.idNum],x=(m.attractRad+u.attractRad)/2,A=x*x*x*x*x,G=(0.97*x+y)*(0.97*x+y)*(0.97*x+y)*(0.97*x+y)*(0.97*x+y),E=-v*(5*A/(G*(0.97*x+y))-8*A*x*x*x/(G*(0.97*x+y)*(0.97*x+y)*(0.97*x+y)*(0.97*
x+y))),B=z.copy().mult(E/m.m),z=z.mult(-E/u.m);m.v.add(B);u.v.add(z);y=-v*(A*x*x*x/(G*(0.97*x+y)*(0.97*x+y)*(0.97*x+y))-A/G);m.peCur+=y;u.peCur+=y}d[n][p].push(m)}}this.adjustE()},adjustE:function(){for(var d=dotManager.lists.ALLDOTS,e=0;e<d.length;e++){var f=d[e];if(0<f.attractStr){var h=f.tempLast+f.peCur-f.peLast;0>h&&(this.eDebt+=10-h,h=10);f.setTemp(h);f.peLast=f.peCur;f.peCur=0}}0<this.eDebt&&this.exactDebt()},exactDebt:function(){for(var d=0.3*dataHandler.avgTemp(),e=dotManager.lists.ALLDOTS,
f=0;f<e.length;f++){var h=e[f],k=h.temp();if(k>d){var l=Math.min(Math.min(k-d,5),this.eDebt);this.eDebt-=l;h.setTemp(k-l);if(0>=this.eDebt)break}}},zeroAllEnergies:function(){for(var d=dotManager.lists.ALLDOTS,e=0;e<d.length;e++)d[e].peLast=0,d[e].keLast=0,d[e].tempLast=0},assignELastAll:function(){for(var d=this.makeGrid(),e=this.gridSize,f=this.xSpan,h=this.ySpan,k=dotManager.lists.ALLDOTS,l=0;l<k.length;l++){var m=k[l];if(0<m.attrStr){m.tempLast=m.temp();for(var n=Math.floor(m.x/e),p=Math.floor(m.y/
e),q=Math.max(n-1,0);q<=Math.min(n+1,f);q++)for(var s=Math.max(p-1,0);s<=Math.min(p+1,h);s++)for(var t=d[q][s].length-1;-1<t;t-=1){var u=d[q][s][t],v=pxToE*V(m.x-u.x,m.y-u.y).mag(),v=Math.max(0,v-m.r-u.r)*pxToE,x=(m.attractRad+u.attractRad)/2,y=x*x*x*x*x,z=(0.97*x+v)*(0.97*x+v)*(0.97*x+v)*(0.97*x+v)*(0.97*x+v),v=-m.attractStrs[u.idNum]*(y*x*x*x/(z*(0.97*x+v)*(0.97*x+v)*(0.97*x+v))-y/z);m.peLast+=v;u.peLast+=v}d[n][p].push(m)}}}});function DataHandler(){this.tConst=tConst}
DataHandler.prototype={temp:function(d){return this.KEAvg(d)*this.tConst},tempFunc:function(d){var e=this;return function(){return e.KEAvg(d)*e.tConst}},countFunc:function(d){var e=this;return function(){return e.count(d)}},count:function(d){return dotManager.get(d).length},RMS:function(d){var e=0;d=dotManager.get(d);for(var f=0;f<d.length;f++)e+=d[f].v.magSqr();return pxToMS*Math.sqrt(e/d.length)},velocities:function(d){d=dotManager.get(d);for(var e=Array(d.length),f=0;f<d.length;f++)e[f]=d[f].v.mag();
return e},velocityAvg:function(d){vList=this.velocities(d);for(var e=d=0;e<vList.length;e++)d+=vList[e];return d/vList.length},KEAvg:function(d){var e=0;d=dotManager.get(d);for(var f=0;f<d.length;f++)e+=d[f].KE();return e/d.length},volume:function(d){return void 0===d?walls.totalVolume():walls.wallVolume(d)},volumeFunc:function(d){var e=this;return function(){return e.volume(d)}}};function WallHandler(d){var e=d?Array(d.pts.length):[];_.extend(e,WallMethods.main,WallMethods.collideMethods);e.defaultCol=Col(255,255,255);d&&(e.assemble(d),d.handles.length!=d.pts.length&&console.log("NAME YOUR WALLS"),d.handlers&&e.doInitHandlers(d.handlers));e.setup();return e}
WallMethods={main:{assemble:function(d){this.removed=!1;var e=d.pts,f=d.handles;this.numWalls=e.length;this.qArrowFill=Col(200,0,0);this.qArrowFillFinal=Col(100,0,0);this.qArrowStroke=Col(255,255,255);var h=defaultTo([],d.bounds),k=defaultTo([],d.vols),l=defaultTo([],d.shows),m=defaultTo([],d.records);d=defaultTo([],d.temps);for(var n=0;n<e.length;n++)this.setWallVals(n,e[n],f[n],h[n],k[n],l[n],m[n],d[n])},setDefaultReadout:function(d){this.defaultReadout=d;return this},unsetDefaultReadout:function(){this.defaultReadout=
void 0;return this},setup:function(){this.gridDim=20;this.xSpan=Math.floor(myCanvas.width/this.gridDim);this.ySpan=Math.floor(myCanvas.height/this.gridDim);this.numCols=Math.ceil(myCanvas.width/this.gridDim);this.numRows=Math.ceil(myCanvas.height/this.gridDim);for(var d=0;d<this.length;d++)this.setupWall(d)},setAllHandler:function(d){for(var e=0;e<this.length;e++)this.setWallHandler(e,d)},pareData:function(){for(var d=0;d<this.length;d++)this[d].pareData()},setWallHandler:function(d,e){var f=this.idxByInfo(d);
/isothermal/i.test(e)&&this[f].isothermalInit();for(var h=0;h<this[f].length;h++)"string"==typeof e?this[f].handlers[h]=new Listener(this[e],this):"object"==typeof e&&(this[f].handlers[h]=e)},setSubWallHandler:function(d,e,f){d=this.idxByInfo(d);"string"==typeof f?(this[d][e].isothermal=/isothermal/i.test(f),this[d].handlers[e]=new Listener(this[f],this)):"object"==typeof f&&(this[d].handlers[e]=f)},getSubWallHandler:function(d,e){return this[this.idxByInfo(d)].handlers[e]},setupWall:function(d){this[d].wallUVs=
this.getWallUV(d);this[d].wallPerpUVs=this.getPerpUVs(d);this[d].wallGrids=this.scatterPts(d)},scatterPts:function(d){var e=this.makeBlankGrid(),f=this[d];f.scatter=Array(f.length-1);var h=f.wallUVs,k=this.gridDim;for(d=0;d<f.scatter.length;d++)for(var l=h[d],m=f[d].distTo(f[d+1]),m=Math.ceil(m/k),n=f[d],p=0;p<m;p++){var q=Math.floor((n.x+l.dx*k*p)/k),s=Math.floor((n.y+l.dy*k*p)/k);(-1!=q||-1!=s)&&e[q][s].push(d)}return e},makeBlankGrid:function(){for(var d=Array(this.numCols+1),e=0;e<this.numCols+
1;e++){for(var f=Array(this.numRows+1),h=0;h<this.numRows+1;h++)f[h]=[];d[e]=f}return d},setWallVals:function(d,e,f,h,k,l,m,n,p,q,s,t){h={min:P(0,h&&h.yMin?h.yMin:30),max:P(0,h&&h.yMax?h.yMax:435)};this[d]=e;_.extend(this[d],WallMethods.wall,WallMethods.wallDataHandler);this[d].handle=f;this[d].hitMode="didHitStd";this[d].vs=this.makeWallVs(e);this[d].bounds=h;this[d].dotManager=q||dotManager;k&&this[d].setVol(k);this[d].col=defaultTo(this.defaultCol,p);this[d].show=defaultTo(!0,l);!1!==s?(this.closeWall(this[d]),
this[d].closed=!0):this[d].closed=!1;this[d].ptsInit=this.copyWallPts(this[d]);this[d].g=g;this[d].pConst=pConst;this[d].liquids={};this[d].data={};this[d].q=0;this[d].hitThreshold=15;this[d].handlers=[];this[d].pIntLen=35;this[d].surfAreaAdj={};this[d].eToAdd=0;this[d].isLiquid=!1;this[d].isothermal=!1;this[d].removed=!1;this[d].tSet=n;this[d].massChunks={};this[d].forceInternal=0;this[d].pLastRecord=turn;this[d].isothermalRate=defaultTo(1,t);this[d].boundMaxHandlers=[];this[d].boundMinHandlers=
[];this[d].mass=0;this[d].Cp=this[d].setupCp();this[d].parent=this;makeListenerHolder(this[d],"cleanUp");this[f]=this[d];(m=defaultTo(!0,m))&&this[d].recordDefaults()},addWall:function(d){this.numWalls++;var e=this.length;this.setWallVals(e,d.pts,d.handle,d.bounds,d.vol,d.show,d.record,d.temp,d.col,d.dotManager,d.close,d.isothermalRate);this.setupWall(e);this.setWallHandler(e,d.handler);d.border&&this[e].addBorder(d.border);d.hitMode&&this[e].setHitMode(d.hitMode);return this[e]},makeWallVs:function(d){for(var e=
[],f=0;f<d.length;f++)e.push(V(0,0));e.push(e[0]);return e},setPtsInit:function(){for(var d=0;d<this.length;d++)this[d].ptsInit=this.copyWallPts(this[d])},copyWallPts:function(d){for(var e=d.length,f=Array(e),h=0;h<e;h++)f[h]=d[h].copy();return f},idxByHandle:function(d){for(var e=0;e<this.length;e++)if(d==this[e].handle)return e;console.log("Failed to get wall idx by handle\nHandle:"+d)},idxByInfo:function(d){return parseFloat(d)!=d?this.idxByHandle(d):d},remove:function(){for(var d=this.length-
1;0<=d;d-=1)this.removeWall(d);this.removed=!0;emptyListener(curLevel,"wallMove")},removeWall:function(d){this[d]&&(this.numWalls-=1,this[d].recordAllStop(),this[d].cleanUp(),this[d].removeBorder(),this[d].removed=!0,d=this.idxByInfo(d),this[this[d].handle]=void 0,this.splice(d,1),this.removeHandlers(d))},removeHandlers:function(d){for(var e in this)-1!=e.indexOf(d+"-")&&(this[e]=void 0)},closeWall:function(d){d.push(P(d[0].x,d[0].y))},getPerpUVs:function(d){d=this[d].wallUVs;for(var e=Array(d.length),
f=0;f<d.length;f++){var h=d[f];e[f]=V(-h.dy,h.dx)}return e},getWallUV:function(d){for(var e=this[d].length-1,f=Array(e),h=0;h<e;h++){var k=this[d][h],l=this[d][h+1];f[h]=V(l.x-k.x,l.y-k.y).UV()}return f},check:function(){for(var d=this.gridDim,e=this.xSpan,f=this.ySpan,h=dotManager.lists.ALLDOTS,k=0;k<h.length;k++){var l=h[k],m=[],n=[],p=Math.floor(l.x/d),q=Math.floor(l.y/d),s=Math.max(p-1,0),p=Math.min(p+1,e)+1;a:for(;s<p;s++)for(var t=Math.max(q-1,0),u=Math.min(q+1,f)+1;t<u;t++)for(var v=0;v<this.length;v++)for(var x=
this[v].wallGrids[s][t],y=0;y<x.length;y++){var z=x[y];if(!1===this.haveChecked(v,z,m,n)){if(!0===this[v].checkWallHit(l,z))break a;m.push(v);n.push(z)}}}},haveChecked:function(d,e,f,h){for(var k=0;k<f.length;k++)if(f[k]==d&&h[k]==e)return!0;return!1},getWallsByHandles:function(d){for(var e=[],f=0;f<d.length;f++)e.push(this[d[f]]),e[e.length-1]||console.log("Bad wall handle "+d[f]);return e},wallVolume:function(d){return this.area(this[d].slice(0,this[d].length-1))*vConst},area:function(d){var e=
0,f=this.isConvex(d),h=f.multiplier;if(f.isConvex)return this.areaConvex(d);d=this.splitConcave(d,h);e+=this.area(d[0]);return e+=this.area(d[1])},isConvex:function(d){for(var e=this.getMult(d),f=1;f<d.length-1;f++){var h=this.abcs(d,f),h=this.angleBetweenPts(h.a,h.b,h.c,e);if(h>Math.PI)return{isConvex:!1,multiplier:e}}this.angleBetweenPts(d[d.length-2],d[d.length-1],d[0],e);h=this.angleBetweenPts(d[d.length-1],d[0],d[1],e);return h>Math.PI?{isConvex:!1,multiplier:e}:{isConvex:!0,multiplier:e}},getMult:function(d){var e=
Math.PI*(d.length-2),f=this.getAreaUVs(d),h=this.getIntAngles(d,f,1);d=this.getIntAngles(d,f,-1);if(round(h,2)==round(e,2))return 1;if(round(d,2)==round(e,2))return-1},getAreaUVs:function(d){for(var e=Array(d.length),f=0;f<d.length-1;f++){var h=d[f],k=d[f+1];e[f]=h.VTo(k).UV()}h=d[d.length-1];k=d[0];e[e.length]=h.VTo(k).UV();return e},getIntAngles:function(d,e,f){e=0;for(var h=1;h<d.length-1;h++)e+=this.angleBetweenPts(d[h-1],d[h],d[h+1],f);e+=this.angleBetweenPts(d[d.length-2],d[d.length-1],d[0],
f);return e+=this.angleBetweenPts(d[d.length-1],d[0],d[1],f)},splitConcave:function(d,e){for(var f=Array(d.length+2),h=0;h<d.length;h++)f[h]=d[h];f[f.length-2]=d[0];f[f.length-1]=d[1];for(h=1;h<f.length-1;h++){var k=this.abcs(f,h);if(this.angleBetweenPts(k.a,k.b,k.c,e)>Math.PI)return h==d.length&&(h=0),this.splitAt(f.slice(0,f.length-2),h,e)}},splitAt:function(d,e,f){d=d.slice(e,d.length).concat(d.slice(0,e));f=d[0];for(e=2;e<d.length-1;e++)if(!this.crossesWall(f,d[e],d))return f=d.slice(0,e+1),d=
d.slice(0,1).concat(d.slice(e,d.length)),[f,d]},abcs:function(d,e){return{a:d[e-1],b:d[e],c:d[e+1]}},crossesWall:function(d,e,f){d.VTo(e);for(var h=1;h<f.length;h++){var k,l;h==f.length-1?(k=f[h],l=f[0]):(k=f[h],l=f[h+1]);if(this.linesCross(d,e,k,l))return!0}return!1},linesCross:function(d,e,f,h){var k=d.VTo(e),l=f.VTo(h),m=k.mag(),n=l.mag(),k=k.UV(),p=l.UV(),l=this.getDist(d,e,f,h,k,p,"p1");d=this.getDist(d,e,f,h,k.neg(),p.neg(),"p2");l.dx=round(l.dx,5);l.dy=round(l.dy,5);d.dx=round(d.dx,5);d.dy=
round(d.dy,5);m=round(m,5);n=round(n,5);return!(l.dx>=m||l.dy>=n||d.dx>=m||d.dy>=n)},getDist:function(d,e,f,h,k,l,m){"p1"==m?(a=d,b=f):(a=e,b=h);if(0==k.dx&&0==l.dx)return new Vector(Infinity,Infinity);if(0==k.dx)return d=a.x-b.x,d=Math.abs(d/l.dx),k=b.copy().movePt(l.copy().mult(d)),new Vector(a.distTo(k),b.distTo(k));if(0==l.dx)return d=b.x-a.x,d=Math.abs(d/k.dx),k=a.copy().movePt(k.copy().mult(d)),new Vector(a.distTo(k),b.distTo(k));if(0==k.dy&&0==l.dy)return new Vector(Infinity,Infinity);if(0==
k.dy)return d=a.y-b.y,d=Math.abs(d/l.dy),k=b.copy().movePt(l.copy().mult(d)),new Vector(a.distTo(k),b.distTo(k));if(0==l.dy)return d=b.y-a.y,d=Math.abs(d/k.dy),k=a.copy().movePt(k.copy().mult(d)),new Vector(a.distTo(k),b.distTo(k));d=l.dx*k.dy/k.dx-l.dy;if(0==d)return new Vector(Infinity,Infinity);d=(b.y-a.y-k.dy*b.x/k.dx+a.x*k.dy/k.dx)/d;return new Vector((b.x+l.dx*d-a.x)/k.dx,d)},angleBetweenPts:function(d,e,f,h){var k=d.VTo(e).UV();d=k.copy().neg();e=e.VTo(f).UV();h=k.copy().add(e).perp(1==h?"cw":
"ccw");d=Math.atan2(d.dy,d.dx);e=Math.atan2(e.dy,e.dx);h=Math.atan2(h.dy,h.dx);return this.distBetweenAngles(d,h)+this.distBetweenAngles(h,e)},distBetweenAngles:function(d,e){0>d&&(d+=2*Math.PI);0>e&&(e+=2*Math.PI);var f=Math.max(d,e)-Math.min(d,e);return f>Math.PI?2*Math.PI-f:f},areaConvex:function(d){for(var e=0,f=d[0],h=2;h<d.length;h++)e+=f.area(d[h-1],d[h]);return e}}};WallMethods.DataObj=function(){this.srcVal=[];this.wallHandleVal=this.idArgsVal=this.typeVal=this.idVal=void 0;this.recordingVal=!1;this.recordStopVal=this.listenerVal=void 0;this.readoutVal};
WallMethods.DataObj.prototype={recordVal:function(){this.srcVal.push(this.listenerVal.func.apply(this.listenerVal.obj))},id:function(d){d&&(this.idVal=d);return this.idVal},listener:function(d){d&&(this.listenerVal=d);return this.listenerVal},type:function(d){d&&(this.typeVal=d);return this.typeVal},idArgs:function(d){d&&(this.idArgsVal=d);return this.idArgsVal},argsMatch:function(d){return objectsEqual(this.idArgsVal,d)},readout:function(d){d&&(this.readoutVal=d);return this.readoutVal},wallHandle:function(d){d&&
(this.wallHandleVal=d);return this.wallHandleVal},src:function(d){d&&(this.srcVal=d);return this.srcVal},recording:function(d){void 0!==d&&(this.recordingVal=d);return this.recordingVal},recordStop:function(d){d?this.recordStopVal=d:this.recordStopVal&&this.recordingVal&&this.recordStopVal()}};WallMethods.wall={reset:function(){for(var d=this.ptsInit,e=0;e<d.length;e++)this[e].x=d[e].x,this[e].y=d[e].y;for(d=this.forceInternal=0;d<this.vs.length;d++)this.vs[d].zero();this.parent.setupWall(this.parent.indexOf(this))},setVol:function(d){d=this.volToY(d);this[0].position({y:d});this[1].position({y:d})},volToY:function(d){var e=this[2].distTo(this[3]);return this[2].y-d/(vConst*e)},checkWallHit:function(d,e){var f=this.wallUVs[e],h=this.wallPerpUVs[e],k=new Vector(d.x+d.v.dx-h.dx*d.r-this[e].x,
d.y+d.v.dy-h.dy*d.r-this[e].y),k=-h.dotProd(k),l=-h.dotProd(d.v);return 0<=k&&k<=this.hitThreshold&&this.isBetween(d,e,f)?(this[this.hitMode](d,e,f,l,h),!0):!1},didHitStd:function(d,e,f,h,k){var l=this.handlers[e];l.func.apply(l.obj,[d,this,e,f,h,k])},isBetween:function(d,e,f){var h=new Point(this[e].x-f.dx*d.r,this[e].y-f.dy*d.r);e=new Point(this[e+1].x+f.dx*d.r,this[e+1].y+f.dy*d.r);h=new Vector(d.x-h.x,d.y-h.y);d=new Vector(d.x-e.x,d.y-e.y);return 0<=h.dotProd(f)&&0>=d.dotProd(f)},didHitArrowDV:function(d,
e,f,h,k){var l=d.v.copy(),m=this.handlers[e];m.func.apply(m.obj,[d,this,e,f,h,k]);e=P(d.x,d.y);f=d.v.copy();d=-k.dotProd(d.v);this.drawArrowV(e,l,f,h,d)},didHitArrowSpd:function(d,e,f,h,k){var l=d.v.copy(),m=this.handlers[e];m.func.apply(m.obj,[d,this,e,f,h,k]);e=P(d.x,d.y);f=d.v.copy();d=-k.dotProd(d.v);this.drawArrowSpd(e,l,f,h,d)},didHitGravity:function(d,e,f,h,k){var l=this.handlers[e];if(0!=f.dx)var m=d.y,n=d.v.dy;l.func.apply(l.obj,[d,this,e,f,h,k]);0!=f.dx&&(e=d.v.dy*d.v.dy+2*gInternal*(d.y-
m),0<=e?d.v.dy=0<d.v.dy?Math.sqrt(e):-Math.sqrt(e):(d.v.dy=-1E-7,d.y=(d.v.dy*d.v.dy-n*n)/(2*gInternal)+m))},drawArrowV:function(d,e,f,h,k){var l=Array(3);l[0]=d.copy().movePt(e.copy().mult(10).neg());l[1]=d.copy();l[2]=d.copy().movePt(f.copy().mult(10));e="drawArrow"+round(d.x,0)+round(d.y,0);new ArrowLine(e,l,Col(255,0,0),50,"main");d=d.copy().movePt(f.mult(15));h=(Math.abs(h)+Math.abs(k))*pxToMS;animText.newAnim({pos:d},{pos:d.copy().movePt({dy:-20}),col:curLevel.bgCol},{text:"deltaV = "+round(h,
1)+"m/s",time:3E3})},drawArrowSpd:function(d,e,f,h,k){h=Array(3);h[0]=d.copy().movePt(e.copy().mult(10).neg());h[1]=d.copy();h[2]=d.copy().movePt(f.copy().mult(10));e="drawArrow"+round(d.x,0)+round(d.y,0);new ArrowLine(e,h,Col(255,0,0),50,"main");d=d.copy().movePt(f.mult(15));f=0.1*f.mag()*pxToMS;animText.newAnim({pos:d},{pos:d.copy().movePt({dy:-20}),col:curLevel.bgCol},{text:"Speed = "+round(f,1)+"m/s",time:3E3})},changeSetPt:function(d,e,f){if(/isothermal/i.test(e))var h="cVIsothermal";else/adiabatic/i.test(e)&&
(h="cVAdiabatic");removeListener(curLevel,"wallMove","cV"+this.handle);e=d-this[0].y;0!=e&&(e=getSign(e),this.vs[0].dy=f*e,this.vs[1].dy=f*e,this.parent.setSubWallHandler(this.handle,0,h),addListener(curLevel,"wallMove","cV"+this.handle,function(){var e=this[0].y,f=stepTowards(e,d,this.vs[0].dy);this[0].y=f;this[1].y=f;this[this.length-1].y=f;this.parent.setupWall(this.handle);round(e,2)==round(d,2)&&(removeListener(curLevel,"wallMove","cV"+this.handle),this.parent.setSubWallHandler(this.handle,0,
"staticAdiabatic"),this.vs[0].dy=0,this.vs[1].dy=0)},this))},releaseWithBounds:function(d,e,f,h){this.moveStop();removeListener(curLevel,"wallMove","releaseWithBounds"+this.handle);removeListener(curLevel,"wallMove","cP"+this.handle);this.parent.setSubWallHandler(this.handle,0,f);d=defaultTo(0,d);e=defaultTo(Number.MAX_VALUE,e);var k=g,l=this.bounds;addListener(curLevel,"wallMove","releaseWithBounds"+this.handle,function(){var f=this[0].y,n=f+this.vs[0].dy+0.5*k;n<d||n>e?(this.moveStop(),this.parent.setSubWallHandler(this.handle,
0,"staticAdiabatic"),n<d?(h(d),f=d):(h(e),f=e)):n>l.max.y||n<l.min.y?f=this.hitBounds(f,k,l.min.y,l.max.y):(f=n,this.vs[0].dy+=k,this.vs[1].dy+=k);this[0].y=f;this[1].y=f;this[this.length-1].y=f;this.parent.setupWall(this.handle)},this)},moveInit:function(){var d=g,e=this.bounds;addListener(curLevel,"wallMove","cP"+this.handle,function(){var f=this[0].y,h,k=f+this.vs[0].dy+0.5*d;if(k>e.max.y){for(var l=!0,m=0;m<this.boundMaxHandlers.length;m++)this.boundMaxHandlers[m].replacesStd?(h=this.boundMaxHandlers[m].func.apply(this.boundMaxHandlers[m].obj,
[this,k,e.max.y]),l=!1):this.boundMaxHandlers[m].func.apply(this.boundMaxHandlers[m].obj,[this,k,e.max.y]);l&&(h=this.hitBounds(f,d,e.min.y,e.max.y))}else if(k<e.min.y){l=!0;for(m=0;m<this.boundMinHandlers.length;m++)this.boundMinHandlers[m].replacesStd?(h=this.boundMinHandlers[m].func.apply(this.boundMinHandlers[m].obj,[this,k,e.min.y]),l=!1):this.boundMinHandlers[m].func.apply(this.boundMinHandlers[m].obj,[this,k,e.min.y]);l&&(h=this.hitBounds(f,d,e.min.y,e.max.y))}else h=k,this.vs[0].dy+=d,this.vs[1].dy+=
d;this[0].y=h;this[1].y=h;this[this.length-1].y=h;this.parent.setupWall(this.handle)},this)},addBoundHandler:function(d,e){var f=this["bound"+d.toCapitalCamelCase()+"Handlers"];f?f.push(e):console.log("Bad wall bound handler type "+d)},removeBoundHandler:function(d,e){var f=this["bound"+d.toCapitalCamelCase()+"Handlers"];if(f){var h=f.indexOf(e);0<=h&&f.splice(h,1)}else console.log("Bad wall bound handler type "+d)},moveStop:function(){this.vs[0].dy=0;this.vs[1].dy=0;removeListener(curLevel,"wallMove",
"cP"+this.handle);removeListener(curLevel,"wallMove","releaseWithBounds"+this.handle)},hitBounds:function(d,e,f,h){var k=1,l=this.vs[0].dy,m=Math.max(f,Math.min(h,d+l*k+0.5*e*k*k));d=l*l+2*e*(m-d);if(m==h)var n=(-l+Math.sqrt(d))/e;else m==f&&(n=(-l-Math.sqrt(d))/e);this.vs[0].dy+=e*n;this.vs[1].dy+=e*n;this.vs[0].dy*=-1;this.vs[1].dy*=-1;k-=n;l=this.vs[0].dy;-2*l<k*e&&0>l&&(f=Math.abs(2*l/e),k-=Math.floor(k/f)*f);this.vs[0].dy+=e*k;this.vs[1].dy+=e*k;return m+l*k+0.5*e*k*k},setHitMode:function(d){/^[sS]td$/.test(d)||
/^[aA]rrowDV$/.test(d)||/^[aA]rrowSpd$/.test(d)||/^[gG]ravity$$/.test(d)?this.hitMode="didHit"+d.toCapitalCamelCase():console.log("bad hitMode "+d)},setDefaultReadout:function(d){this.defaultReadout=d;return this},unsetDefaultReadout:function(){this.defaultReadout=void 0;return this},setTemp:function(d){this.tSet=d},getCv:function(){var d=0,e;for(e in window.spcs)var f=dotManager.get({tag:this.handle,spcName:e}),d=d+(f?f.length:0)*spcs[e].cv/N;return d},isothermalInit:function(d){if(d)if("number"==
typeof d)this.tSet=d;else if(/current/i.test(d)){var e=this.getDataSrc("temp");e.length&&(this.tSet=e[e.length-1])}this.eToAdd=0;dotManager.get({tag:this.handle});e=this.data.temp.src();this.isothermal||(addListener(curLevel,"data","recordEnergyForIsothermal"+this.handle,function(){var d;d=this.tSet-(e[e.length-1]||this.tSet);this.eToAdd=this.getCv()*d;for(var h in this.liquids){var k=this.liquids[h],l="setT"+k.handle;removeListener(curLevel,"update",l);var m=this.tSet;d=m-k.temp;if(1<Math.abs(d)){var n=
d/15;addListener(curLevel,"update",l,function(){var d=stepTowards(k.temp,m,n);this.q+=(d-k.temp)*k.Cp*JtoKJ;k.temp=d;d==m&&removeListener(curLevel,"update",l)},this)}}},this),this.recordQ());for(d=0;d<this.length;d++)this[d].isothermal=!0;this.isothermal=!0},isothermalStop:function(){this.isothermal=!1;removeListener(curLevel,"data","recordEnergyForIsothermal"+this.handle)},surfArea:function(){var d=0;for(ptIdx=0;ptIdx<this.length-1;ptIdx++)d+=this[ptIdx].distTo(this[ptIdx+1]);return d},updateMass:function(){var d=
0,e;for(e in this.massChunks)d+=this.massChunks[e];this.mass=d},setMass:function(d,e){this.massChunks[d]=e;this.updateMass();return this},unsetMass:function(d){if(d)delete this.massChunks[d];else for(d in this.massChunks)delete this.massChunk[d];this.updateMass();return this},addLiquid:function(d){this.liquids[d.handle]=d},removeLiquid:function(d){"string"==typeof d&&(d=this.liquids[d]);d&&d.handle&&delete this.liquids[d.handle]},setBounds:function(d,e){var f=this.bounds;e&&(e instanceof Point?f.max=
e:f.max.y=e);d&&(d instanceof Point?f.min=d:f.min.y=d)},addBorder:function(d){d.wall=this;this.border=new WallMethods.Border(d)},removeBorder:function(){this.border&&this.border.remove()},addPts:function(d,e){for(var f=[],h=this.parent.idxByInfo(this.handle),k=d;k<this.length;k++)f.push(this.parent.getSubWallHandler(h,d));this.concat();h=[];for(k=0;k<e.length;k++)h.push(V(0,0));h=[d,0].concat(h);k=[d,0].concat(e);Array.prototype.splice.apply(this,k);Array.prototype.splice.apply(this.vs,h);for(h=d+
e.length;h<this.length;h++)this.parent.setSubWallHandler(this.handle,h,f[h-e.length-d]);f=f[0]||this.handlers[d-1];for(h=d;h<d+e.length;h++)this.parent.setSubWallHandler(this.handle,h,f);this.parent.setupWall(this.handle);this.border&&!this.border.removed&&this.border.update()},removePts:function(d,e){for(var f=[],h=this.parent.idxByInfo(this.handle),k=d+e;k<this.length;k++)f.push(this.parent.getSubWallHandler(h,k));this.splice(d,e);this.vs.splice(splice,e);for(k=d;k<this.length;k++)this.parent.setSubWallHandler(h,
k,f[k-d]);this.parent.setupWall(this.handle);this.border&&!this.border.removed&&this.border.update()},getPt:function(d){return this[d]},getUV:function(d){return this.wallUVs[d]},getPerpUV:function(d){return this.wallPerpUVs[d]},populateArrows:function(d){var e=this.parent.qArrowFill,f=this.parent.qArrowFillFinal,h=this.parent.qArrowStroke,k=getSign(d),l={"-1":"cw",1:"ccw"}[k];this.turnLastArrow=this.data.q.src().length-1;d=V(110*Math.abs(d),170*Math.abs(d));var m=d.copy();m.dx*=1.4;m.dy*=0.85;var n=
{"-1":0,1:-m.dx-30};if(7<d.dx||7<d.dy)for(var p=0;p<this.length-1;p++)if(this[p].isothermal)for(var q=this[p].distTo(this[p+1]),s=Math.round(q/150),t=q/=s+1,u=0;u<s;u++){var v=this[p].copy().movePt(this.wallUVs[p].copy().mult(t)).movePt(this.wallPerpUVs[p].copy().mult(n[k]));new ArrowFly({pos:v,dist:30,UV:this.wallUVs[p].copy().perp(l),fill:e,fillFinal:f,stroke:h,dims:d,dimsFinal:m,lifespan:3500});t+=q}},cleanUp:function(){var d=this.cleanUpListeners,e;for(e in d){var f=d[e];f.func.apply(f.obj)}}};
WallMethods.BoundHandler=function(d,e,f){this.func=d;this.obj=e;this.replacesStd=f};WallMethods.wallDataHandler={setupCp:function(){for(var d=this.handle,e=[],f=[],h=0;h<LevelData.spcDefs.length;h++){var k=dotManager.get({tag:d,spcName:LevelData.spcDefs[h].spcName});k&&(e.push(k),f.push(LevelData.spcDefs[h].cv/N))}return function(){for(var d=0,h=0;h<e.length;h++)d+=e[h].length*f[h];return d}},pExt:function(){return this.pConst*this.mass*this.g/(this[1].x-this[0].x)},pInt:function(){var d=this.surfArea(),e;for(e in this.surfAreaAdj)d+=this.surfAreaAdj[e].val;d=this.pConst*this.forceInternal/
((turn-this.pLastRecord)*d);this.forceInternal=0;this.pLastRecord=turn;this.pIntList[this.pIntIdx]=d;this.pIntIdx++;this.pIntIdx==this.pIntLen&&(this.pIntIdx=0);return this.pIntList.average()},addSurfAreaAdjust:function(d){this.surfAreaAdj[d]={val:0};return this.surfAreaAdj[d]},removeSurfAreaAdjust:function(d){delete this.surfAreaAdj[d]},getDataObj:function(d,e,f){if(this.data[d])if(this.data[d]instanceof Array)for(f=0;f<this.data[d].length;f++){if(this.data[d][f].argsMatch(e))return this.data[d][f]}else return this.data[d];
else!0!==f&&(console.log('Tried to get bad data type "'+d+'" with args'),console.log(e));return!1},getDataSrc:function(d,e,f){if(this.data[d])if(this.data[d]instanceof Array)for(f=0;f<this.data[d].length;f++){if(this.data[d][f].argsMatch(e))return this.data[d][f].srcVal}else return this.data[d].srcVal;else f||(console.log('Tried to get bad data type "'+d+'" with args'),console.log(e));return!1},removeDataObj:function(d,e){if(this.data[d])if(this.data[d]instanceof Array){for(var f=0;f<this.data[d].length;f++)if(this.data[d][f].argsMatch(e))return this.data[d].splice(f,
1);console.log("Couldn't find data "+d+" with args "+e)}else return delete this.data[d]},pareData:function(){for(var d in this.data){var e=this.data[d];if(e instanceof Array)for(var f=0;f<e.length;f++)600<e[f].srcVal.length&&e[f].srcVal.splice(0,e[f].srcVal.length-300);else 600<e.srcVal.length&&e.srcVal.splice(0,e.srcVal.length-300)}},createSingleValDataObj:function(d,e,f){var h=new WallMethods.DataObj;f?this.data[d]?this.data[d].push(h):this.data[d]=[h]:this.data[d]=h;this.setupStdDataObj(h,d);h.recordStop(function(){});
h.srcVal=[e()];return h},recordDefaults:function(){this.recordTime();this.recordTemp();this.recordPInt();this.recordVol()},recordTime:function(){this.data.time=new WallMethods.DataObj;var d=this.data.time,e=new Listener(function(){return(Date.now()-f)/1E3},this);this.setupStdDataObj(d,"time",e);var f=Date.now();recordData(d.id()+d.wallHandle(),d.src(),e,"update")},recordTemp:function(d){var e=this.data.temp;if(!e||!e.recording()){this.data.temp=new WallMethods.DataObj;e=this.data.temp;d||(d=function(){for(var d=
0,e=0;e<f.length;e++)d+=f[e].KE();return f.length?tConst*d/f.length:0});d=new Listener(d,this);this.setupStdDataObj(e,"temp",d);var f=this.dotManager.getWithLog({tag:this.handle});recordData(e.id()+e.wallHandle(),e.src(),d,"update")}return this},recordRMS:function(){},getRMSMass:function(d){if(d)for(var e in spcs)for(var f=spcs[e].dots,h=0;h<f.length;h++)if(d){if(f[h].tag==d)return f[h].m}else return f[h].m},recordPInt:function(){var d=this.data.pInt;if(!d||!d.recording()){this.data.pInt=new WallMethods.DataObj;
var d=this.data.pInt,e=new Listener(this.pInt,this);this.setupStdDataObj(d,"pInt",e);this.pIntList=[];this.pIntIdx=0;recordData(d.id()+d.wallHandle(),d.src(),e,"update")}return d},recordPExt:function(){var d=this.data.pExt;if(!d||!d.recording()){var e=new Listener(this.pExt,this);this.data.pExt=new WallMethods.DataObj;d=this.data.pExt;this.setupStdDataObj(d,"pExt",e);recordData(d.id()+d.wallHandle(),d.src(),e,"update")}return d},recordVol:function(){var d=this.data.vol;if(!d||!d.recording()){var e=
new Listener(function(){return this.parent.wallVolume(this.handle)},this);this.data.vol=new WallMethods.DataObj;d=this.data.vol;this.setupStdDataObj(d,"vol",e);recordData(d.id()+d.wallHandle(),d.src(),e,"update")}return d},recordWork:function(){var d=this.data.work;if(!d||!d.recording()){this.data.work=new WallMethods.DataObj;d=this.data.work;this.work=0;var e=LtoM3,f=PUNITTOPA,h=JtoKJ,k=this,l=this.getDataObj("vol").src(),m=new Listener(function(){var d=l.length,d=e*(l[d-1]-l[d-2]);if(isNaN(d))return k.work=
0;var m=k.pExt()*f;k.work-=h*m*d;return k.work},this);this.setupStdDataObj(d,"work",m);recordData(d.id()+d.wallHandle(),d.src(),m,"update")}return d},recordMass:function(){var d=this.data.mass;if(!d||!d.recording()){this.data.mass=new WallMethods.DataObj;var e=new Listener(function(){return this.mass},this),d=this.data.mass;this.setupStdDataObj(d,"mass",e);recordData(d.id()+d.wallHandle(),d.src(),e,"update")}return d},recordQ:function(){var d=this.data.q;if(!d||!d.recording()){this.data.q=new WallMethods.DataObj;
var d=this.data.q,e=new Listener(function(){return this.q},this);this.setupStdDataObj(d,"q",e);recordData(d.id()+d.wallHandle(),d.src(),e,"update")}return d},recordEnthalpyTotal:function(){return this.recordEnergy("enthalpyTotal","cp","hF298",!1)},recordInternalEnergyTotal:function(){return this.recordEnergy("internalEnergyTotal","cv","uF298",!1)},recordEnthalpy:function(){return this.recordEnergy("enthalpy","cp","hF298",!0)},recordInternalEnergy:function(){return this.recordEnergy("internalEnergy",
"cv","uF298",!0)},recordEnergy:function(d,e,f,h){h=defaultTo(!0,h);var k=[],l=[],m=[],n=[],p=[],q=this.data[d];if(!q||!q.recording()){this.data[d]=new WallMethods.DataObj;var q=this.data[d],s=this.getDataSrc("temp");if(this.isLiquid){for(var t=0;t<LevelData.spcDefs.length;t++)if(void 0!==LevelData.spcDefs[t][f]&&void 0!==LevelData.spcDefs[t].cpLiq){var u=this.dotManager.get({tag:this.handle,spcName:LevelData.spcDefs[t].spcName});p.push(u);l.push(1E3*LevelData.spcDefs[t][f]/N);m.push(1E3*LevelData.spcDefs[t].hVap298/
N);n.push(LevelData.spcDefs[t].cpLiq/N)}e=function(){for(var d=0,e=0,f=s[s.length-1]-298.15,k=0;k<p.length;k++)d+=p[k].length*(l[k]+n[k]*f-m[k]),e+=p[k].length;return h?d*N/e:d}}else{for(t=0;t<LevelData.spcDefs.length;t++)u=this.dotManager.get({tag:this.handle,spcName:LevelData.spcDefs[t].spcName}),p.push(u),l.push(1E3*LevelData.spcDefs[t][f]/N),k.push(LevelData.spcDefs[t][e]/N);e=function(){for(var d=0,e=0,f=s[s.length-1]-298.15,m=0;m<p.length;m++)d+=p[m].length*(l[m]+k[m]*f),e+=p[m].length;return h?
d*N/e:d}}e=new Listener(e,this);this.setupStdDataObj(q,d,e);recordData(q.id()+q.wallHandle(),q.src(),e,"update")}return q},recordVDist:function(d){var e=this.dotManager.createIfNotExists(d);this.data.vDist||(this.data.vDist=[]);if(!this.getDataObj("vDist",d)){this.data.vDist.push(new WallMethods.DataObj);var f=this.data.vDist[this.data.vDist.length-1],h=new Listener(function(){for(var d=[],f=0;f<e.length;f++)d.push(e[f].speed());return d},this);this.setupInfoDataObj(f,"vDist",d,h);recordData(f.id()+
f.wallHandle(),f.src(),h,"update")}},recordMoles:function(d){var e,f=this.dotManager.createIfNotExists(d);this.data.moles||(this.data.moles=[]);if(e=this.getDataObj("moles",d))return e;this.data.moles.push(new WallMethods.DataObj);e=this.data.moles[this.data.moles.length-1];var h=new Listener(function(){return f.length/N},this);this.setupInfoDataObj(e,"moles",d,h);recordData(e.id()+e.wallHandle(),e.src(),h,"update");return e},recordFrac:function(d){var e,f=this.dotManager.createIfNotExists(d),h=this.dotManager.createIfNotExists(d.tag?
{tag:d.tag}:void 0);this.data.frac||(this.data.frac=[]);if(this.getDataObj("frac",d))e=this.getDataObj("frac",d);else{this.data.frac.push(new WallMethods.DataObj);e=this.data.frac[this.data.frac.length-1];var k=new Listener(function(){return!h.length?1:f.length/(h.length||1)},this);this.setupInfoDataObj(e,"frac",d);recordData(e.id()+e.wallHandle(),e.src(),k,"update")}return e},setupStdDataObj:function(d,e,f){d.recording(!0);d.recordStop(this.recordStop);d.id(e);d.type(e);d.listener(f);d.wallHandle(this.handle)},
setupInfoDataObj:function(d,e,f,h){d.recording(!0);d.recordStop(this.recordStopDestroy);d.id(e+(f.spcName||"").toCapitalCamelCase()+(f.tag||"").toCapitalCamelCase());d.wallHandle(this.handle);d.listener(h);d.type(e);d.idArgs(f)},recordStopDestroy:function(){this.recording(!1);walls[this.wallHandle()].removeDataObj(this.type(),this.idArgs());recordDataStop(this.id()+this.wallHandle())},recordStop:function(){this.recording(!1);recordDataStop(this.id()+this.wallHandle())},recordAllStop:function(){for(var d in this.data){var e=
this.data[d];if(e instanceof Array)for(var f=0;f<e.length;f++)e[f].recordStop();else e.recordStop()}return this},resetWork:function(){this.work=0;return this},resetQ:function(){this.q=0;return this},displayQArrowsRate:function(d){d=d.threshold;if(this.data.q.recording()&&(!this.data.qArrowsRate||!this.data.qArrowsRate.recording())&&(!this.data.qArrowsAmmt||!this.data.qArrowsAmmt.recording())){this.data.qArrowsRate=new WallMethods.DataObj;var e=this.data.qArrowsRate;e.displaying(!0);e.wallHandle(this.handle);
e.id("qArrowsRate");this.turnLastArrow=Math.max(0,this.data.q.length-1);this.qArrowThreshold=defaultTo(d,0.3);var f="checkForDisplayArrows"+e.wallHandle(),h=this;qSrc=this.data.q.src();addListener(curLevel,"update",f,function(){h.checkDisplayArrows(qSrc)},this);this.turnLastArrow=turn;addListener(this,"cleanUp","qArrowsRate",function(){removeListener(curLevel,"update",f);removeListenerByName(curLevel,"update","ArrowFly")})}else console.log("Tried to display q arrowsRate for wall "+this.handle+" while not recording or already displaying.  Will not display."),
console.trace()},makeDataList:function(){var d=[];d.displaying=!1;d.recording=!1;return d},resetQ:function(){this.q=0;this.displayingQArrowsAmmt&&(this.displayQArrowsAmmtStop(),this.displayQArrowsAmmt(this.qArrowAmmtMax))},resetWork:function(){this.work=0},checkDisplayArrows:function(d){d=d[d.length-1]-d[this.turnLastArrow];Math.abs(d)>this.qArrowThreshold&&(this.populateArrows(d),this.turnLastArrow=turn)}};WallMethods.collideMethods={cPAdiabaticDamped:function(d,e,f,h,k,l){h=d.temp();l=0.5*d.m*(d.v.dx*d.v.dx+d.v.dy*d.v.dy);d.v.copy();var m=d.v.dy,n=e.vs[f].dy,p=d.m,q=e.mass,s=Math.abs(n);if(1<s){f=m*m;var t=n*n,s=0.0017*s*s*s-0.0281*s*s+0.205*s+0.8466,u=s*s,v=p*(1+p/(u*q)),x=-2*p*(m*p/q+n)/u;f=(-x+Math.sqrt(x*x-4*v*((p*(p*f/q+2*n*m)+q*t)/u-p*f-q*t)))/(2*v);d.y+=d.r;e.vs[0].dy=(p*m+q*n-p*f)/(q*s);e.vs[1].dy=e.vs[0].dy}else t=e[f],f=(m*(p-q)+2*q*n)/(d.m+q),e.vs[0].dy=(n*(q-p)+2*p*m)/(q+p),e.vs[1].dy=
e.vs[0].dy,d.y=t.y+d.r;m=0.5*d.m*(d.v.dx*d.v.dx+f*f);l=Math.sqrt((l+2*(m-l)/3)/m);f*=l;d.v.dx*=l;d.setTemp(h+(0.5*tConst*d.m*(d.v.dx*d.v.dx+f*f)-h)*d.cvKinetic/d.cv);0>d.v.dy*f&&(d.v.dy*=-1);e.forceInternal+=d.m*(Math.abs(k)+Math.abs(d.v.dy))},cPAdiabatic:function(d,e,f,h,k,l){h=d.temp();d.v.copy();l=d.v.dy;var m=e.vs[f].dy,n=d.m,p=e.mass,q=e[f];f=(l*(n-p)+2*p*m)/(d.m+p);e.vs[0].dy=(m*(p-n)+2*n*l)/(p+n);e.vs[1].dy=e.vs[0].dy;d.y=q.y+d.r;l=Math.sqrt((KEO+2*(KEF-KEO)/3)/KEF);f*=l;d.v.dx*=l;d.setTemp(h+
(0.5*tConst*d.m*(d.v.dx*d.v.dx+f*f)-h)*d.cvKinetic/d.cv);0>d.v.dy*f&&(d.v.dy*=-1);e.forceInternal+=d.m*(Math.abs(k)+Math.abs(d.v.dy))},staticAdiabatic:function(d,e,f,h,k,l){this.reflect(d,h,k);e.forceInternal+=2*d.m*Math.abs(k)},cVIsothermal:function(d,e,f,h,k,l){if(e.eToAdd){l=getSign(e.eToAdd);f=d.temp();l*=Math.min(Math.abs(e.eToAdd),20*d.cv*e.isothermalRate);0>l&&f<=20*e.isothermalRate&&(l=-Math.max(0,f-1)*d.cv);e.eToAdd-=l;var m=f+l/d.cv,n=Math.sqrt(m/f),p=k*n;this.reflect(d,h,k);d.v.dx*=n;d.v.dy*=
n;d.internalPotential*=m/f;e.forceInternal+=d.m*(Math.abs(k)+Math.abs(p));e.q+=l*JtoKJ}else e.forceInternal+=2*d.m*Math.abs(k),this.reflect(d,h,k)},cVAdiabatic:function(d,e,f,h,k,l){d.v.dy=-d.v.dy+2*e.vs[f].dy},reflect:function(d,e,f){d.v.dx-=2*e.dy*f;d.v.dy+=2*e.dx*f;d.x-=e.dy;d.y+=e.dx}};WallMethods.Border=function(d){this.wall=d.wall;this.type=d.type;this.yMin=void 0!==d.yMin?d.yMin:this.wall[0].y;this.col=d.col||this.wall.col.copy().adjust(-100,-100,-100);this.thick=d.thickness||5;this.update=this.pickGenerator(this.type);this.canvasHandle=this.wall.canvasHandle||"main";this.update();this.removed=!1};
WallMethods.Border.prototype={remove:function(){this.removed=!0;canvasManager.removeListener(this.canvasHandle,this.listenerName)},pickGenerator:function(d){if("open"==d)return this.genOpen();if("wrap"==d)return this.genWrap()},genOpen:function(){return this.genBorder(this.thick,this.col,1,"end",!0)},genWrap:function(){return this.genBorder(this.thick,this.col,0,"end",!1)},genBorder:function(d,e,f,h,k){var l=this;this.listenerName="drawBorder"+this.wall.handle.toCapitalCamelCase();return function(){l.remove();
var m=l.genSegs(f,h,d,k);canvasManager.addListener(this.canvasHandle,l.listenerName,function(d){for(var f=0;f<m.length;f++)draw.fillPts(m[f],e,d)},this,1);l.removed=!1}},genSegs:function(d,e,f,h){var k=[];e="end"==e?this.wall.length-1:e;for(var l=d;l<e;l++){var m=this.wall.wallPerpUVs[l].copy().neg(),n=this.wall[l].copy(),p=this.wall[l+1].copy(),q=l+1==e?0:l+1,s;s=this.getExtendV(m,this.wall[l-1]?l-1:this.wall.length-2,d-1,f,h);m=this.getExtendV(m,q,0,f,h);m=p.copy().movePt(m);s=n.copy().movePt(s);
"open"==this.type&&(l==d?(n.y=this.yMin,s.y=this.yMin):l==e-1&&(p.y=this.yMin,m.y=this.yMin));k.push([n,p,m,s])}return k},getExtendV:function(d,e,f,h,k){var l=this.wall.wallPerpUVs[e].copy().neg();e=k&&e==f?d.copy():l.add(d).UV();d=d.dotProd(e);return e.mult(h/d)}};function ButtonManager(d){this.wrapperDivId=d;this.groups=[]}
ButtonManager.prototype={addGroup:function(d,e,f,h,k){var l=$("#"+this.wrapperDivId),m="group"+d,n=m+"Wrapper",p=m+"Padder",q=templater.div({attrs:{id:[m],"class":["buttonGroup"]}}),q=e+templater.br()+q,n=templater.div({attrs:{id:[n],handle:[d],"class":["buttonManagerElem","displayText","buttonGroupWrapper"]},innerHTML:q}),p=templater.div({attrs:{id:[p],handle:[d],"class":["buttonManagerElem","buttonGroupPadder"]},innerHTML:n});l.append(p);this.groups.push(new ButtonManager.Group(l,m,d,e,f,h,k))},
removeGroup:function(d){var e=this.getGroup(d);e?(d=this.groups.indexOf(e),e=this.getGroupDiv(e),this.groups.splice(d,1),e.remove()):console.log("Bad group handle "+d)},clickButton:function(d,e){var f=this.getGroup(d);f?f.clickButton(e):console.log("Tried to click button in bad group handle "+d)},hideButton:function(d,e){var f=this.getGroup(d);f?f.hideButton(e):console.log("Bad group handle "+d)},showButton:function(d,e){var f=this.getGroup(d);f?f.showButton(e):console.log("Bad group handle "+d)},
removeButton:function(d,e){var f=this.getGroup(d);f?f.removeButton(e):console.log("Bad group handle "+d)},getGroupDiv:function(d){for(var e=$("#"+this.wrapperDivId).children(),f=0;f<e.length;f++)if($(e[f]).attr("handle")==d.handle)return $(e[f])},arrangeGroupWrappers:function(){var d=this.arrangeObjs(this.groups);this.arrangeHTML($("#"+this.wrapperDivId),d)},arrangeAllGroups:function(){for(var d=0;d<this.groups.length;d++)this.arrangeGroup(this.groups[d].handle)},arrangeGroup:function(d){var e=this.getGroup(d);
e?(d=this.arrangeObjs(e.buttons),this.arrangeHTML($("#"+e.groupId),d)):console.log("Bad group name "+d)},setButtonWidth:function(){for(var d=$("button.buttonManagerElem"),e=100,f=0;f<d.length;f++)var h=d[f],e=Math.max(e,$(h).outerWidth());for(f=0;f<d.length;f++)h=d[f],$(h).css("width",e)},arrangeHTML:function(d,e){for(var f=d.children(),h=!1,k=0;k<f.length;k++){var l=f[k],m=e[k],l=$(l).attr("handle");if(h=Math.max(h,l!=m.handle))break}if(h){h={};for(k=0;k<f.length;k++)l=f[k],h[$(l).attr("handle")]=
$(l).clone(!0);d.html("");for(f=0;f<e.length;f++)d.append(h[e[f].handle])}},addButton:function(d,e,f,h,k,l){var m=this.getGroup(d);m?m.addButton(e,f,h,k,l):console.log("Bad group handle "+d)},getGroup:function(d){for(var e=0;e<this.groups.length;e++)if(this.groups[e].handle==d)return this.groups[e]},arrangeObjs:function(d){var e=[];d=this.sortObjs(d.concat());var f=this.slicePrefs(d);d=this.sliceNoPrefs(d);for(var h=0;h<f.length;h++){var k=f[h].prefIdx;e[k]?e.push(f[h]):e[k]=f[h]}for(h=f=0;f<d.length;)void 0==
e[h]&&(e[h]=d[f],f++),h++;for(h=e.length-1;0<=h;h--)void 0==e[h]&&e.splice(h,1);return e},sortObjs:function(d){for(var e=0;e<d.length;e++)for(var f=0;f<d.length-1;f++)if(d[f].prefIdx>d[f+1].prefIdx||void 0==d[f].prefIdx){var h=d[f];d[f]=d[f+1];d[f+1]=h}return d},slicePrefs:function(d){for(var e=0;e<d.length;e++)if(void 0==d[e].prefIdx)return d.slice(0,e);return d.slice(0,d.length)},sliceNoPrefs:function(d){for(var e=0;e<d.length;e++)if(void 0==d[e].prefIdx)return d.slice(e,d.length);return[]}};
ButtonManager.Group=function(d,e,f,h,k,l,m){this.mgrDiv=d;this.groupId=e;this.handle=f;this.label=h;this.prefIdx=k;this.buttons=[];this.isRadio=l;this.isToggle=m&&!l};
ButtonManager.Group.prototype={addButton:function(d,e,f,h,k,l){var m=d+"Button",n=d+"Wrapper";this.buttons.push(new ButtonManager.Button(d,m,n,e,f,h,l));e=templater.button({innerHTML:e,attrs:{id:[m],"class":["buttonManagerElem","buttonManagerButton"],handle:[d]}});d=templater.div({innerHTML:e,attrs:{id:[n],"class":["buttonManagerElem","buttonWrapper"],handle:[d]}});$("#"+this.groupId).append(d);m=$("button#"+m);addJQueryElems(m,"button");d=this.buttons[this.buttons.length-1];n=d.click;e=d.mousedown;
f=d.mouseup;this.isRadio?n=this.wrapInRadio(d,n):this.isToggle&&(n=this.wrapInToggle(d,n));k&&n&&n();k&&this.isRadio?this.pushRadio(d):k&&this.isToggle&&this.toggleButton(d);n&&$(m).click(n);e&&$(m).mousedown(e);f&&$(m).mouseup(f)},clickButton:function(d){d=this.getButton(d);$("button#"+d.buttonId).click()},hideButton:function(d){d=this.getButton(d);$("button#"+d.buttonId).hide()},showButton:function(d){d=this.getButton(d);$("button#"+d.buttonId).show()},removeButton:function(d){d=this.getButton(d);
this.getButtonDiv(d).remove();this.buttons.splice(this.buttons.indexOf(d),1)},wrapInRadio:function(d,e){var f=e,h=this;return function(){h.pushRadio(d);f()}},wrapInToggle:function(d,e){var f=e,h=this;return function(){h.toggleButton(d);f()}},pushRadio:function(d){for(var e=0;e<this.buttons.length;e++)$("#"+this.buttons[e].buttonId).removeClass("ui-button-as-radio-selected");$("#"+d.buttonId).addClass("ui-button-as-radio-selected")},toggleButton:function(d){d=$("#"+d.buttonId);d.hasClass("ui-button-as-radio-selected")?
d.removeClass("ui-button-as-radio-selected"):d.addClass("ui-button-as-radio-selected")},getButton:function(d){for(var e=0;e<this.buttons.length;e++)if(this.buttons[e].handle==d)return this.buttons[e];console.log("Bad button handle "+d)},getButtonDiv:function(d){for(var e=$("#"+this.groupId).children(),f=0;f<e.length;f++)if($(e[f]).attr("handle")==d.handle)return $(e[f])}};
ButtonManager.Button=function(d,e,f,h,k,l,m){this.handle=d;this.buttonId=e;this.wrapperId=f;this.label=h;this.click;this.mousedown;this.mouseup;k.mousedown||k.mouseup?(k.mousedown&&(this.mousedown=this.wrapExprs(k.mousedown)),k.mouseup&&(this.mouseup=this.wrapExprs(k.mouseup))):this.click=this.wrapExprs(k);this.prefIdx=l};
ButtonManager.Button.prototype={wrapExprs:function(d){if("function"==typeof d)return d;d=d instanceof Array?d.join(";")+";":d+";";with(DataGetFuncs)d=eval("(function() {"+d+"})");return d}};function QuizRenderer(){this.hoverCol=Col(0,81,117);this.selectedCol=Col(40,121,147)}
QuizRenderer.prototype={render:function(d,e){var f=new QuizRenderer.Quiz(d);if(this.checkQuizTyping(f)){var h=templater.div({attrs:{id:["quizWrapper"]}}),k=templater.div({attrs:{id:["quizContent"],"class":["niceFont","whiteFont"]}}),l=templater.div({attrs:{id:["quizFooter"]}});$(e).append(h);h=$("#quizWrapper");$(h).append(k);$(h).append(l);k=$("#quizContent");l=$("#quizFooter");for(h=0;h<f.questions.length;h++)this.renderQuestion(f.questions[h],k);d[0]&&"setVals"==d[0].type?this.appendButtons(l,
function(){sceneNavigator.prevPrompt()},function(){sceneNavigator.refresh()},"Back","Set values"):this.appendButtons(l,function(){sceneNavigator.prevPrompt()},function(){sceneNavigator.nextPrompt()},"Back","Submit");return f}},checkQuizTyping:function(d){d=d.questions;for(var e=!1,f=!1,h=0;h<d.length;h++)"setVals"==d.type?e=!0:f=!0;return e&&f?(console.log("Bad quiz typing.  Can't mix setVals with others"),!1):!0},renderQuestion:function(d,e){"multChoice"==d.type?this.renderMultChoice(d,e):"text"==
d.type?this.renderTextBox(d,e,3,50):"textSmall"==d.type?this.renderTextBox(d,e,1,10):"setVals"==d.type&&this.renderTextBox(d,e,1,10)},renderMultChoice:function(d,e){for(var f=d.options,h=void 0===d.questionText?"":interpreter.interp(d.questionText)+templater.br(),h=h+"<div style = 'padding-top:4px;'>",k=0;k<f.length;k++)var l=f[k],h=h+templater.div({attrs:{id:[d.storeAs+String(k)],"class":["multChoiceBlock"]},innerHTML:l.text});e.append(h+"</div>");for(k=0;k<f.length;k++)l=f[k],l.div=$("#"+d.storeAs+
String(k));this.bindMultChoiceQuestion(d)},bindMultChoiceQuestion:function(d){var e=this,f=d.options,h=function(h){var k=f[h];d.answered=!0;if(!k.selected){for(var n=0;n<f.length;n++)f[n]!=k&&(f[n].div.css("background-color","transparent"),f[n].selected=!1);k.selected=!0;store(d.storeAs,h);d.hasCorrectAnswer()?d.correct=k.correct?!0:!1:d.correct=!0;$(k.div).css("background-color",e.selectedCol.hex)}};void 0!==getStore(d.storeAs)&&h(getStore(d.storeAs));for(var k=0;k<d.options.length;k++)this.bindMultChoiceOption(d,
h,d.options,d.options[k])},bindMultChoiceOption:function(d,e,f,h){var k=this;h.div.click(function(){e(f.indexOf(h))});h.div.hover(function(){h.selected||$(this).css("background-color",k.hoverCol.hex)},function(){h.selected||$(this).css("background-color","transparent")})},renderTextBox:function(d,e,f,h){var k=d.storeAs,l=defaultTo("Type your answer here.",d.boxText);textareaHTML=templater.textarea({attrs:{id:[k],rows:[f],cols:[h],placeholder:[l]}});f=(void 0===d.questionText?"":interpreter.interp(d.questionText)+
templater.br())+templater.table({attrs:{"class":["niceFont","whiteFont"]},innerHTML:templater.tr({innerHTML:templater.td({innerHTML:d.label})+templater.td({innerHTML:"&#32;&#32;"})+templater.td({innerHTML:textareaHTML})+templater.td({innerHTML:d.units||""})})});e.append(f);d.div=$("#"+k);var m=function(e){e=void 0!==e?e:d.div.val();""!=e&&(store(d.storeAs,e),d.answered=!0,d.hasCorrectAnswer()?0.05>fracDiff(parseFloat(d.answer),parseFloat(val))?d.correct=!0:d.correct=!1:d.correct=!0)};getStore(d.storeAs)&&
(m(getStore(d.storeAs)),d.div.html(getStore(d.storeAs)));d.div.change(function(){m()})},appendButtons:function(d,e,f,h,k){h=templater.button({attrs:{id:["quizButtonLeft"]},innerHTML:h})+templater.button({attrs:{id:["quizButtonRight"]},innerHTML:k});h=templater.div({attrs:{id:["quizSubmitWrapper"]},style:{"float":"right"},innerHTML:h});$(d).append(h);$("#quizButtonLeft").click(e);$("#quizButtonRight").click(f);addJQueryElems($("#quizButtonLeft"),"button");addJQueryElems($("#quizButtonRight"),"button");
$(d).css("min-height",$("#quizButtonLeft").height()+5+"px")}};QuizRenderer.Quiz=function(d){this.questions=[];for(var e=0;e<d.length;e++)this.questions.push(new QuizRenderer.Question(d[e]))};
QuizRenderer.Quiz.prototype={allAnswered:function(){for(var d=0;d<this.questions.length;d++)if(!this.questions[d].answered)return!1;return!0},allCorrect:function(){for(var d=0;d<this.questions.length;d++)if(!this.questions[d].correct)return!1;return!0},fireAlertWrong:function(){for(var d=0;d<this.questions.length;d++){var e=this.questions[d];if(e.hasCorrectAnswer()&&!e.correct)if("multChoice"==e.type)for(var f=0;f<e.options.length;f++){if(e.options[f].selected&&e.options[f].message){alert(e.options[f].message);
return}}else if(e.message){alert(e.message);break}}},sendAnswersToCW:function(){for(var d=0;d<this.questions.length;d++)this.questions[d].sendAnswerToCW()}};
QuizRenderer.Question=function(d){this.type=d.type;this.label=this.getQuestionLabel(d.label,this.CWQuestionId);this.boxText=defaultTo(d.text,d.boxText);this.CWQuestionId=d.CWQuestionId;this.questionText=this.getQuestionText(d.questionText||d.preText,this.CWQuestionId);this.units=d.units;this.message=d.message;this.storeAs=d.storeAs;this.options=this.makeOptions(d.options);this.answered=!1;this.answer=d.answer;this.correct=!1;this.div=void 0};
QuizRenderer.Question.prototype={makeOptions:function(d){if(d){for(var e=[],f=0;f<d.length;f++)e.push(new QuizRenderer.MultChoiceOption(d[f],this.CWQuestionId));return e}},getQuestionText:function(d,e){if(void 0===e)return d;var f=new XMLHttpRequest;if(/^(http|https)/.test(document.URL)){var h=window.stringTogetherGET({"goto":"simulation",command:"get_question_text",question_id:e});f.open("GET","CW.php?"+h,!1);f.send(null)}return f.responseText?f.responseText.replace(/\\\\/g,"\\"):d},getQuestionLabel:function(d,
e){if(void 0===e)return d;var f=new XMLHttpRequest;if(/^(http|https)/.test(document.URL)){var h=window.stringTogetherGET({"goto":"simulation",command:"get_question_label",question_id:e});f.open("GET","CW.php?"+h,!1);f.send(null)}return f.responseText?f.responseText.replace(/\\\\/g,"\\"):defaultText},hasCorrectAnswer:function(){if(("text"==this.type||"textSmall"==this.type||"setVals"==this.type)&&void 0!==this.answer)return!0;if("multChoice"==this.type)for(var d=0;d<this.options.length;d++)if(this.options[d].correct)return!0;
return!1},sendAnswerToCW:function(){var d=new XMLHttpRequest,e;if("text"==this.type||"textSmall"==this.type||"setVals"==this.type)e=getStore(this.storeAs),e=btoa(e),/^(http|https)/.test(document.URL)&&(e=window.stringTogetherGET({"goto":"simulation",command:"send_answer",question_id:this.CWQuestionId,answer_text_64:e}),d.open("GET","CW.php?"+e,!1),d.send(null));else if("multChoice"==this.type)for(var f=0;f<this.options.length;f++)this.options[f].selected&&(void 0!==this.options[f].CWAnswerId&&/^(http|https)/.test(document.URL))&&
(e=window.stringTogetherGET({"goto":"simulation",command:"send_answer",question_id:this.CWQuestionId,answer_id:this.options[f].CWAnswerId}),d.open("GET","CW.php?"+e,!1),d.send(null))}};QuizRenderer.MultChoiceOption=function(d,e){this.CWAnswerId=d.CWAnswerId;this.correct=d.correct||!1;this.text=this.getAnswerText(d.text,e,this.CWAnswerId);this.selected=!1;this.message=d.message;this.div=void 0};
QuizRenderer.MultChoiceOption.prototype={getAnswerText:function(d,e,f){if(void 0===e||void 0===f)return d;var h=new XMLHttpRequest;e=window.stringTogetherGET({"goto":"simulation",command:"get_answer_text",question_id:e,answer_id:f});/^(http|https)/.test(document.URL)&&(h.open("GET","CW.php?"+e,!1),h.send(null));return h.responseText?h.responseText.replace(/\\\\/g,"\\"):d}};function SliderManager(d){this.containerId=d;this.sliderGroupWrapper=this.appendSliderGroupWrapper(this.containerId)}
SliderManager.prototype={addSlider:function(d,e,f,h,k){k="number"!=typeof k&&0<=k?this.getMaxIdx(this.sliderGroupWrapper)+1:k;k=this.insertSliderWrapper(this.containerId,this.sliderGroupWrapper,k,e);var l=this.insertSliderPadding(this.containerId,k);e="sliderInnerContainer"+this.containerId+"Handle"+e;var m="#"+this.containerId+" #"+e;makeSlider(l,l,m,e,d,f,h);this.setWidths();return new SliderManager.Slider(this,k,$(m))},setWidths:function(){var d=this.sliderGroupWrapper.children();if(d.length){this.sliderGroupWrapper.css("width",
150*d.length/(1+1.5*d.length)+"%");for(var e=100/d.length,f=0;f<d.length;f++)$(d[f]).css("width",e+"%")}},insertSliderWrapper:function(d,e,f,h){for(var k="sliderIdx"+f+"Handle"+h,l=e.children(),m=-1,n=0;n<l.length;n++){var p=$(l[n]).attr("sliderIdx");if(void 0!==p&&f<=p){m=n;break}}f=templater.div({attrs:{id:[k],handle:[h],sliderIdx:[f],"class":["sliderWrapper"]}});-1==m?e.append(f):$(l[n]).before(f);return $("#"+d+" #"+k)},insertSliderPadding:function(d,e){var f=e.attr("id")+"Padding",h=templater.div({attrs:{id:[f],
"class":["sliderPadding"]}});e.append(h);return $("#"+d+" #"+e.attr("id")+" #"+f)},getMaxIdx:function(d){d=d.children();for(var e=-1,f=0;f<d.length;f++){var h=$(d[f]).attr("sliderIdx");void 0!==h&&!isNaN(h)&&(e=Math.max(h,e))}return e},appendSliderGroupWrapper:function(d){$("#"+d).append(templater.div({attrs:{id:["sliderWrapper"],"class":["sliderGroupWrapper"]}}));return $("#"+d+" #sliderWrapper")}};
SliderManager.Slider=function(d,e,f){this.manager=d;this.wrapper=e;this.slider=f;this.selector=f.selector;this.removed=!1};SliderManager.Slider.prototype={remove:function(){this.removed||(this.wrapper.remove(),this.manager.setWidths(),this.removed=!0)},enable:function(){$(this.selector).slider("enable")},disable:function(){$(this.selector).slider("disable")}};function ActivationEnergySpcChanger(d){this.collideHandler=d;this.pairs={};this.active=!1;this.standardBreakUp=this.collideHandler.breakUp;this.breakUpFunc=this.makeBreakUpFunc()}
ActivationEnergySpcChanger.prototype={addPair:function(d){var e=d.spcNameLow,f=d.spcNameHigh;this.pairs[e]||this.pairs[f]?console.log("Trying to add another energy threshold to either "+e+" or "+f):(this.pairs[d.spcNameLow]=d,this.pairs[d.spcNameHigh]=d,this.active||this.addActiveEBreakUp())},removePair:function(d){delete this.pairs[d.spcNameLow];delete this.pairs[d.spcNameHigh];countAttrs(this.pairs)||(this.active=!1,this.restoreBreakUp())},addActiveEBreakUp:function(){this.collideHandler.breakUp=
this.breakUpFunc},restoreBreakUp:function(){this.collideHandler.breakUp=this.standardBreakUp},makeBreakUpFunc:function(){var d=this;return function(e,f,h){var k,l=d.pairs[e.spcName],m=d.pairs[f.spcName];l&&(k=e.kineticEnergy(),l.activationEnergy>=k&&e.spcName==l.spcNameHigh?dotManager.changeDotSpc([e],l.spcNameLow):l.activationEnergy<k&&e.spcName==l.spcNameLow&&dotManager.changeDotSpc([e],l.spcNameHigh));m&&(k=f.kineticEnergy(),m.activationEnergy>=k&&f.spcName==m.spcNameHigh?dotManager.changeDotSpc([f],
m.spcNameLow):m.activationEnergy<k&&f.spcName==m.spcNameLow&&dotManager.changeDotSpc([f],m.spcNameHigh));d.standardBreakUp(e,f,h)}}};function ConditionManager(){this.conditionSets={}}
ConditionManager.prototype={add:function(d){var e=this.timeStrToStamp(d.requiredFor);this.conditionSets[e]||(this.conditionSets[e]=[]);var e=this.conditionSets[e],f=this.getIfExists(d,e);d=new ConditionManager.TriggerEntry(d);f&&(d.satisfied=f.satisfied,e.splice(e.indexOf(f,1)));e.push(d)},canAdvance:function(d){var e;"number"==typeof d?e=d:/prompt/i.test(d)?e=/[0-9]+/.exec(d):/section/i.test(d)&&(e=-1);return this.checkConditions(this.conditionSets[e]||[])},checkConditions:function(d,e){e=defaultTo(!0,
e);for(var f,h=-1,k=!0,l=0;l<d.length;l++){var m=d[l],n=m.trigger;m.satisfied||(m=!0,"conditions"==n.checkOn&&!n.conditionFunc()?m=!1:!n.isSatisfied()&&!n.conditionFunc()&&(m=!1),!m&&(n.priority>h&&n.message)&&(f=n.message,h=n.priority),m||(k=!1))}e&&f&&alert(f);k&&d.map(function(d){d.satisfied=!0;/conditions/i.test(d.checkOn)&&d.recordVals()});return k},stripForInheritance:function(){for(var d in this.conditionSets)for(var e=this.conditionSets[d],f=e.length-1;0<=f;f--)e[f].satisfied&&e.splice(f,
1);return this},getIfExists:function(d,e){for(var f=0;f<e.length;f++)if(d.handle==e[f].trigger.handle)return e[f]},timeStrToStamp:function(d){return/section/i.test(d)?-1:/prompt/i.test(d)?Number(/[0-9]+/.exec(d)):isNaN(Number(d))?timeline.nowTime().promptIdx:Number(d)}};ConditionManager.TriggerEntry=function(d){this.trigger=d;this.satisfied=!1};compressorFuncs={getBinPts:function(d,e,f,h){var k=[];h=defaultTo(5,h);k.push(P(d.x-e*f.dx/2,d.y-f.dy));k.push(P(d.x-f.dx/2,d.y));k.push(P(d.x+f.dx/2,d.y));k.push(P(d.x+e*f.dx/2,d.y-f.dy));k.push(P(d.x+e*f.dx/2+h,d.y-f.dy));k.push(P(d.x+f.dx/2+h,d.y+h));k.push(P(d.x-f.dx/2-h,d.y+h));k.push(P(d.x-e*f.dx/2-h,d.y-f.dy));k.push(P(d.x-e*f.dx/2,d.y-f.dy));return k}};
objectFuncs={setupStd:function(){this.enabled=!0;this.removed=!1;this.handle&&this.addToCurLevel();this.wrapRemove()},wrapRemove:function(){var d=this.remove;this.remove=function(){this.removed=!0;this.handle&&this.removeFromCurLevel();d.apply(this)}},addToCurLevel:function(){curLevel[curLevel.key(this.type,this.handle)]=this},removeFromCurLevel:function(){var d=curLevel.key(this.type,this.handle);delete curLevel[d]},pickSliderPos:function(){var d;this.wall?d=(this.wall[0].x+this.wall[1].x)/2:this.pos&&
this.dims?d=this.pos.x+this.dims.dx/2:this.pos&&(d=this.pos.x);if(d){var e=$("#main").width()/3;d=Math.floor(d/e);if(0==d)return"left";if(1!=d&&2==d)return"right"}return this.checkForMigrateCenter()},addSlider:function(d,e,f,h,k,l){if(!k||!l){h||(h=this.pickSliderPos());switch(h){case "left":k=$(".active #sliderHolderLeft");$(".active #sliderHolderSingle").hide();$(".active #sliderHolderDouble").show();break;case "center":k=$(".active #sliderHolderCenter");$(".active #sliderHolderSingle").show();
$(".active #sliderHolderDouble").hide();break;case "right":k=$(".active #sliderHolderRight"),$(".active #sliderHolderSingle").hide(),$(".active #sliderHolderDouble").show()}l=k}h=".active #slider"+this.handle.toCapitalCamelCase();k=makeSlider(l,k,h,d,e,f);this.sliderWrapperSelectors||(this.sliderWrapperSelectors=[]);this.sliderWrapperSelectors.push(".active #"+$(l).attr("id"));this.sliderWrapperSelectors.push(".active #"+$(k).attr("id"));return h},checkForMigrateCenter:function(){return""!=$("#sliderHolderCenter").html().killWhiteSpace()?
(this.migrateCenterSlider(),"right"):"center"},migrateCenterSlider:function(){var d=$("#sliderHolderCenter").html();$("#sliderHolderCenter").html("");$("#sliderHolderLeft").html(d)},removeSlider:function(){if(this.sliderWrapperSelectors)for(var d=0;d<this.sliderWrapperSelectors.length;d++)$(this.sliderWrapperSelectors[d]).html("")},hideSliderDivs:function(){$(".active #sliderHolderSingle").hide();$(".active #sliderHolderDouble").hide()},valToPercent:function(d){return 100*(d-this.min)/(this.max-this.min)},
percentToVal:function(d){return d*(this.max-this.min)/100+this.min},pressureToMass:function(d){return d*(this.wall[1].x-this.wall[0].x)/(pConst*g)},massToPressure:function(d){return d*pConst*g/(this.wall[1].x-this.wall[0].x)},toggle:function(){this.enabled?this.disable():this.enable()}};function ActivationEnergyPair(d){this.type="ThresholdEnergyPair";spcs[d.spcNameLow]&&spcs[d.spcNameHigh]?(this.spcNameLow=d.spcNameLow,this.spcNameHigh=d.spcNameHigh,this.spcDefLow=spcs[this.spcNameLow],this.spcDefHigh=spcs[this.spcNameHigh],this.activationEnergy=d.activationEnergy,this.addToChanger(),this.setupStd()):(console.log("One of the species names in threshold energy pair is bad"),console.log("The names are "+d.spcNameLow+" and "+d.spcNameHigh))}
_.extend(ActivationEnergyPair.prototype,objectFuncs,{addToChanger:function(){activationEnergySpcChanger.addPair(this)},remove:function(){activationEnergySpcChanger.removePair(this)}});function ArrowFly(d){this.type="ArrowFly";this.pos=d.pos.copy();if(d.posFinal)this.posFinal=d.posFinal,this.UV=this.pos.VTo(this.posFinal).UV(),this.dir=this.UV.angle(),this.dist=this.pos.distTo(this.posFinal);else if(d.V)this.posFinal=this.pos.copy().movePt(d.V),this.UV=d.V.UV(),this.dir=this.UV.angle();else if((d.dir||d.UV)&&d.dist)d.dir?(this.dir=d.dir,this.UV=angleToUV(d.dir)):(this.UV=d.UV,this.dir=this.UV.angle(),this.UV=d.UV),this.posFinal=this.pos.copy().movePt(this.UV.copy().mult(d.dist)),
this.dist=d.dist;this.canvasHandle=d.canvasHandle||"main";this.dims=d.dims.copy();this.dimsFinal=defaultTo(this.dims,d.dimsFinal);this.fill=d.fill.copy();this.fillUnround={r:this.fill.r,g:this.fill.g,b:this.fill.b};this.fillFinal=defaultTo(this.fill,d.fillFinal);this.stroke=defaultTo(this.fill,d.stroke.copy());this.fade=defaultTo(!0,d.fade);this.fadeTurns=defaultTo(4,d.fadeTurns);this.strokeUnround={r:this.stroke.r,g:this.stroke.g,b:this.stroke.b};this.strokeFinal=defaultTo(this.fillFinal,d.strokeFinal);
this.alpha=defaultTo(1,d.alpha);this.alphaFinal=defaultTo(this.alpha,d.alphaFinal);this.age=0;this.lifespan=Math.round(d.lifespan/updateInterval);this.getSteps();this.pts=this.getPts();this.onFinish=d.onFinish;return this.init()}
_.extend(ArrowFly.prototype,objectFuncs,toInherit.ArrowFuncs,{getSteps:function(){var d=1/this.lifespan;this.posStep=this.pos.VTo(this.posFinal).mult(d);this.dimsStep=V(this.dimsFinal.dx-this.dims.dx,this.dimsFinal.dy-this.dims.dy).mult(d);this.fillStep={r:d*(this.fillFinal.r-this.fill.r),g:d*(this.fillFinal.g-this.fill.g),b:d*(this.fillFinal.b-this.fill.b)};this.strokeStep={r:d*(this.strokeFinal.r-this.stroke.r),g:d*(this.strokeFinal.g-this.stroke.g),b:d*(this.strokeFinal.b-this.stroke.b)};this.alphaStep=
(this.alphaFinal-this.alpha)*d},init:function(){this.updateListenerName=unique(this.type+defaultTo("",this.handle),curLevel.updateListeners);this.drawListenerName=this.updateListenerName+"Draw";canvasManager.addListener(this.canvasHandle,this.drawListenerName,this.draw,this,998);addListener(curLevel,"update",this.updateListenerName,this.run,this);this.setupStd();return this},draw:function(d){d.save();d.globalAlpha=this.alpha;d.translate(this.pos.x,this.pos.y);d.rotate(this.dir);draw.fillPtsStroke(this.pts,
this.fill,this.stroke,d);d.restore()},run:function(){this.takeStep();this.age++;this.age==this.lifespan&&(this.onFinish&&this.onFinish.func.apply(this.onFinish.obj),this.fade?(this.alphaStep=-this.alpha/this.fadeTurns,this.remove(),this.updateListenerName=unique(this.type+defaultTo("",this.handle)+"fade",curLevel.updateListeners),addListener(curLevel,"update",this.updateListenerName,this.runFade,this),this.addCleanUp()):this.remove())},runFade:function(){this.drawCanvas.save();this.drawCanvas.globalAlpha=
this.alpha;this.drawCanvas.translate(this.pos.x,this.pos.y);this.drawCanvas.rotate(this.dir);draw.fillPtsStroke(this.pts,this.fill,this.stroke,this.drawCanvas);this.drawCanvas.restore();this.takeStepFade();this.age++;this.age==this.lifespan+this.fadeTurns&&this.remove()},scale:function(){for(var d=(this.dims.dx+this.dimsStep.dx)/this.dims.dx,e=(this.dims.dy+this.dimsStep.dy)/this.dims.dy,f=0;f<this.pts.length;f++)this.pts[f].x*=d,this.pts[f].y*=e},takeStep:function(){this.pos.movePt(this.posStep);
this.dims.add(this.dimsStep);this.scale();this.alpha+=this.alphaStep;this.fillUnround.r+=this.fillStep.r;this.fillUnround.g+=this.fillStep.g;this.fillUnround.b+=this.fillStep.b;this.strokeUnround.r+=this.strokeStep.r;this.strokeUnround.g+=this.strokeStep.g;this.strokeUnround.b+=this.strokeStep.b;this.fill.setFromUnround(this.fillUnround);this.stroke.setFromUnround(this.strokeUnround)},takeStepFade:function(){this.pos.movePt(this.posStep);this.dims.add(this.dimsStep);this.scale();this.alpha+=this.alphaStep},
remove:function(){canvasManager.removeListener(this.canvasHandle,this.drawListenerName);removeListener(curLevel,"update",this.updateListenerName)}});function ArrowLine(d,e,f,h,k){this.handle=d;this.pts={line:e,arrow:Array(3)};this.col=f;this.canvasHandle="string"===typeof k?k:"main";d=this.pts.line[this.pts.line.length-1];f=d.VTo(this.pts.line[this.pts.line.length-2]).UV();e=f.copy().rotate(0.5);f=f.copy().rotate(-0.5);this.pts.arrow[0]=d.copy().movePt(e.mult(10));this.pts.arrow[1]=d;this.pts.arrow[2]=d.copy().movePt(f.mult(10));return this.show(h)}
ArrowLine.prototype={draw:function(d){for(var e=this.pts.line,f=0;f<e.length-1;f++)draw.line(e[f],e[f+1],this.col,d);e=this.pts.arrow;draw.line(e[0],e[1],this.col,d);draw.line(e[1],e[2],this.col,d)},show:function(d){canvasManager.addListener(this.canvasHandle,"drawArrow"+this.handle,this.draw,this,2);addListener(curLevel,"update","updateArrow"+this.handle,this.makeDrawFunc(d),this);return this},makeDrawFunc:function(d){var e=0;return void 0!==d?function(){e++>=d&&(canvasManager.removeListener(this.canvasHandle,
"drawArrow"+this.handle),removeListener(curLevel,"update","updateArrow"+this.handle))}:function(){}},hide:function(){canvasManager.removeListener(this.handleHandle,"drawArrow"+this.handle);removeListener(curLevel,"update","updateArrow"+this.handle)}};function ArrowStatic(d){this.type="ArrowStatic";this.pos=d.pos.copy();this.dims=d.dims.copy();this.handle=d.handle;this.pts=this.getPts();this.canvasHandle=d.canvasHandle||"main";this.label=d.label?d.label:!1;d.angle?this.angle=d.angle:d.UV&&(this.angle=UVToAngle(d.UV));this.setTextOffset();this.fill=d.fill.copy();this.textCol=defaultTo(Col(255,255,255),d.textCol);this.stroke=defaultTo(d.stroke,Col(0,0,0));this.init()}
_.extend(ArrowStatic.prototype,objectFuncs,toInherit.ArrowFuncs,{init:function(){this.drawListenerName="arrowStatic"+this.handle;this.label?canvasManager.addListener(this.canvasHandle,this.drawListenerName,this.runLabel,this,2):canvasManager.addListener(this.canvasHandle,this.drawListenerName,this.runNoLabel,this,2);this.setupStd()},runLabel:function(d){d.save();d.translate(this.pos.x,this.pos.y);d.rotate(this.angle);draw.fillPtsStroke(this.pts,this.fill,this.stroke,d);d.translate(this.textOffset.dx,
this.textOffset.dy);d.rotate(-this.angle);draw.text(this.label,P(0,0),"13pt calibri",this.textCol,"center",0,d);d.restore()},runNoLabel:function(d){d.save();d.translate(this.pos.x,this.pos.y);d.rotate(this.angle);draw.fillPtsStroke(this.pts,this.fill,this.stroke,d);d.restore()},setTextOffset:function(){this.textOffset=V(7+5*Math.sin(Math.abs(-this.angle)),5*Math.cos(this.angle))},getDims:function(){return this.dims},move:function(d){this.pos.movePt(d);return this},scale:function(d){this.dims.multVec(d);
this.pts=this.getPts();return this},size:function(d){this.dims=d.copy();this.pts=this.getPts();return this},rotate:function(d){this.angle+=d;this.setTextOffset();return this},getAngle:function(){return this.angle},setFill:function(d){this.fill=d.copy()},setStroke:function(d){this.stroke=d.copy()},remove:function(){canvasManager.removeListener(this.canvasHandle,this.drawListenerName)}});function Cell(d){this.type="Cell";this.handle=d.handle;var e=d.pos;this.nodeMass=d.nodeMass||700;var f=d.rad;this.canvasHandle=d.canvasHandle||"main";var h=e.copy().movePt(V(f,f)),k=Math.max(3,d.numCorners)||8;this.membraneColor=d.col;this.sideLenMin=15;this.energyTransferMax=0.5;this.guideNodes=this.makeGuideNodes(e,f,k,this.nodeMass);e=this.makeOuterWallPts(this.guideNodes,10);f=this.makeInnerWallPts(this.guideNodes,10);this.outerWall=walls.addWall({pts:e,handle:"cell"+this.handle.toCapitalCamelCase()+
"Outer",handler:"staticAdiabatic",show:!1,record:!1,col:Col(255,255,255)});this.innerWall=walls.addWall({pts:f,handle:"cell"+this.handle.toCapitalCamelCase()+"Inner",handler:"staticAdiabatic",show:!1,record:!0,col:Col(255,255,255)});this.innerWall.hitThreshold=10;this.outerWall.hitThreshold=10;this.parentWallMemberTag=d.parentWallHandle;this.cellMemberTag=this.innerWall.handle;e=d.innerChanceTransport||{};f=d.outerChanceTransport||{};this.fillInUnspecdSpcs(e);this.fillInUnspecdSpcs(f);this.assignWallHandlers(this.guideNodes,
this.innerWall,this.outerWall,this.parentWallMemberTag,this.cellMemberTag,this.energyTransferMax,e,f,10);this.wallUpdateListenerName=this.addWallUpdateListener(this.guideNodes,this.innerWall,this.outerWall,this.handle,10,this.sideLenMin,d.boundingCorner,d.boundingVector,this.wallColor);this.drawListenerName=this.addDrawListener(this.guideNodes,this.innerWall,this.outerWall,this.membraneColor,this.canvasHandle);this.dotId=timeline.takeNumber();this.addDots(h,this.innerWall,d.dots||{},d.temp,this.dotId,
this.cellMemberTag);this.energyBank=this.energyToTransfer=0;this.energyBankMax=20;this.calcHeatTransferListenerName="calcHeatTrans"+this.handle;this.setupCalcHeatTransfer(this.calcHeatTransferListenerName,this.innerWall,walls[d.parentWallHandle]);window.dotMigrator.migrateDots(window.dotManager.get({tag:this.parentWallMemberTag}),[this.parentWallMemberTag],"only",[this.outerWall.handle],"or");this.setupStd()}
_.extend(Cell.prototype,objectFuncs,{makeGuideNodes:function(d,e,f,h){center=d.copy().movePt(V(e,e));d=[];for(var k=0,l=Math.PI*(f-2)/f,m=2*Math.PI/f,n=0;n<f;n++){var p=P(center.x+e*Math.cos(k),center.y+e*Math.sin(k));d.push(new Cell.GuideNode(p,h,l));k+=m}for(n=0;n<d.length;n++)d[n].prev=0==n?d[d.length-1]:d[n-1],d[n].next=n==d.length-1?d[0]:d[n+1];return d},fillInUnspecdSpcs:function(d){for(var e=0;e<LevelData.spcDefs.length;e++){var f=LevelData.spcDefs[e].spcName;void 0===d[f]&&(d[f]=0)}},makeOuterWallPts:function(d,
e){for(var f=[],h=0,k=d[0];h<d.length;){k.prev.outerWallIdx=h;var l=k.next.pos.VTo(k.pos).perp("ccw"),m=k.pos.VTo(k.prev.pos).perp("ccw"),l=k.pos.copy().movePt(l.add(m).UV().mult(e/2));f.push(l);h++;k=k.prev}return f},makeInnerWallPts:function(d,e){for(var f=[],h=0,k=d[0];h<d.length;){k.innerWallIdx=h;var l=k.prev.pos.VTo(k.pos).perp("ccw"),m=k.pos.VTo(k.next.pos).perp("ccw"),l=k.pos.copy().movePt(l.add(m).UV().mult(e/2));f.push(l);h++;k=k.next}return f},assignWallHandlers:function(d,e,f,h,k,l,m,
n,p){for(var q=0;q<d.length;q++)this.assignWallHandler(e,d[q].innerWallIdx,f,d[q].outerWallIdx,d[q],d[q].next,k,h,-1,l,m,p),this.assignWallHandler(f,d[q].outerWallIdx,e,d[q].innerWallIdx,d[q].next,d[q],h,k,1,l,n,p)},assignWallHandler:function(d,e,f,h,k,l,m,n,p,q,s,t){walls.setSubWallHandler(d.handle,e,{func:function(d,e,x,y,z,A){if(d.tag==m)if(Math.random()<s[d.spcName])this.transferDot(d,n,A,t);else{e=y.dx*(l.pos.x-k.pos.x)+y.dy*(l.pos.y-k.pos.y);var G=y.dx*(d.x-k.pos.x)+y.dy*(d.y-k.pos.y),E=-y.dx*
(d.x-l.pos.x)-y.dy*(d.y-l.pos.y);x=new Point(k.pos.x+0.5*y.dx*e,k.pos.y+0.5*y.dy*e);var G=G/e,B=E/e;vecNodeAPerp=A.copy().mult(k.v.dotProd(A));vecNodeBPerp=A.copy().mult(l.v.dotProd(A));k.v.dx-=vecNodeAPerp.dx;k.v.dy-=vecNodeAPerp.dy;l.v.dx-=vecNodeBPerp.dx;l.v.dy-=vecNodeBPerp.dy;var E=vecNodeAPerp.dx*A.dx+vecNodeAPerp.dy*A.dy,w=vecNodeBPerp.dx*A.dx+vecNodeBPerp.dy*A.dy,G=z+(1-G)*E+(1-B)*w;z=-0.5*(E+w);E+=z;w=k.m*x.distSqrTo(k.pos)+l.m*x.distSqrTo(l.pos);y=y.dx*(d.x-x.x)+y.dy*(d.y-x.y);x=-2*G/(1/
d.m+1/(k.m+l.m)+y*y/w);d.v.dx-=A.dx*x/d.m;d.v.dy-=A.dy*x/d.m;y=0.5*(E/(0.5*e)-y*x/w)*e;vWallTrans_F=z-x/(k.m+l.m);e=-(vWallTrans_F-y);y=-(vWallTrans_F+y);k.v.dx+=A.dx*e;k.v.dy+=A.dy*e;l.v.dx+=A.dx*y;l.v.dy+=A.dy*y;d.x+=A.dx;d.y+=A.dy;A=p*this.energyToTransfer;0<A?(A=Math.min(A,Math.min(this.energyBank,q)),d.addEnergy(A),this.energyBank-=A,this.energyToTransfer-=A*p):(A=Math.min(this.energyBank-A,Math.min(this.energyBankMax-this.energyBank,Math.min(q,Math.max(0,(d.temp()-10)*d.cv)))),d.addEnergy(-A),
this.energyBank+=A)}else d.tag==n&&(A=f.handlers[h],A.func.apply(A.obj,[d,f,h,f.wallUVs[h],-d.v.dotProd(f.wallPerpUVs[h]),f.wallPerpUVs[h]]))},obj:this})},transferDot:function(d,e,f,h){h=2*d.r+h;d.x-=h*f.dx;d.y-=h*f.dy;dotManager.changeDotWall(d,e)},addWallUpdateListener:function(d,e,f,h,k,l,m,n){var p=m.x,q=m.x+n.dx,s=m.y,t=m.y+n.dy;addListener(curLevel,"wallMove","moveCell"+this.handle.toCapitalCamelCase(),function(){for(var h=0;h<d.length;h++)d[h].pos.x+=d[h].v.dx,d[h].pos.y+=d[h].v.dy,d[h].v.dx*=
0.995,d[h].v.dy*=0.995,f[d[h].prev.outerWallIdx].x<p?this.containCell(d,"x",1,this.handle):f[d[h].prev.outerWallIdx].x>q&&this.containCell(d,"x",-1,this.handle),f[d[h].prev.outerWallIdx].y<s?this.containCell(d,"y",1,this.handle):f[d[h].prev.outerWallIdx].y>t&&this.containCell(d,"y",-1,this.handle);for(h=0;h<d.length;h++){var m=d[h],n=m.prev.pos.UVTo(m.pos).perp("cw"),y=m.next.pos.UVTo(m.pos).perp("ccw"),n=n.add(y).UV();this.addAngleForce(m,m.prev,m.next,new Vector(-n.dx,-n.dy));this.addExpansionForce(m,
m.next,l);f[m.outerWallIdx+1].x=m.pos.x+n.dx*k/2;f[m.outerWallIdx+1].y=m.pos.y+n.dy*k/2;e[m.innerWallIdx].x=m.pos.x-n.dx*k/2;e[m.innerWallIdx].y=m.pos.y-n.dy*k/2}f[0].x=f[f.length-1].x;f[0].y=f[f.length-1].y;e[e.length-1].x=e[0].x;e[e.length-1].y=e[0].y;window.walls.setupWall(walls.indexOf(e));window.walls.setupWall(walls.indexOf(f))},this)},addAngleForce:function(d,e,f,h){e=this.angleBetweenPts(d.pos,e.pos,f.pos,h);d.v.dx-=3*h.dx*(e-d.nativeAngle);d.v.dy-=3*h.dy*(e-d.nativeAngle)},addExpansionForce:function(d,
e,f){var h=d.pos.VTo(e.pos);h.magSqr()<f*f&&(f=h.UV(),e.v.dx+=0.2*f.dx,e.v.dy+=0.2*f.dy,d.v.dx-=0.2*f.dx,d.v.dy-=0.2*f.dy)},angleBetweenPts:function(d,e,f,h){h=Math.atan2(h.dy,h.dx);e=d.VTo(e);d=d.VTo(f);f=Math.atan2(e.dy,e.dx);d=Math.atan2(d.dy,d.dx);return this.distBetweenAngles(f,h)+this.distBetweenAngles(h,d)},distBetweenAngles:function(d,e){0>d&&(d+=2*Math.PI);0>e&&(e+=2*Math.PI);var f=Math.max(d,e)-Math.min(d,e);return f>Math.PI?2*Math.PI-f:f},containCell:function(d,e,f,h){var k="contain"+h+
e+f,l=0;listenerExists(curLevel,"update",k)||addListener(curLevel,"update",k,function(){for(var h=2*f/15*Math.sqrt(l*(15-l)),n=0;n<d.length;n++)d[n].pos[e]+=h;l++;15==l&&removeListener(curLevel,"update",k)},void 0)},addDrawListener:function(d,e,f,h,k){canvasManager.addListener(k,"drawCell"+this.handle,function(k){for(var m=0;m<d.length;m++){var n=d[m];draw.fillPts([e[n.innerWallIdx],e[n.next.innerWallIdx],f[n.outerWallIdx],f[n.prev.outerWallIdx]],h,k)}},this,1)},setupCalcHeatTransfer:function(d,e,
f){var h=e.getDataSrc("temp"),k=f.getDataSrc("temp");addListener(curLevel,"update",d,function(){var d=e.Cp(),m=f.Cp();this.energyToTransfer=((d*h[h.length-1]+m*k[k.length-1])/(d+m)-k[k.length-1])*m},this)},addDots:function(d,e,f,h,k,l){for(var m in f){var n=window.spcs[m];n||console.log("Bad species name sent to cell: "+m);for(var p=f[m],q=Math.floor(f[m]/(2*(e.length-1))),s=0;s<e.length-1;s++){var t=e[s],u=e[s+1],v=d.VTo(t.avg(u)).UV();this.populateRightTriangle(d,t,t.avg(u),q,n,h,v,l,k,m);this.populateRightTriangle(d,
u,t.avg(u),q,n,h,v,l,k,m);p-=2*q}this.populateRightTriangle(d,t,t.avg(u),p,n,h,v,l,k,m)}},populateRightTriangle:function(d,e,f,h,k,l,m,n,p,q){k=m.copy().perp("cw");0>f.VTo(e).dotProd(k)&&(k=m.copy().perp("ccw"));var s=[];e=f.distTo(e);f=d.distTo(f);for(var t=0;t<h;t++){var u=Math.sqrt(Math.random())*f,v=Math.random()*e*u/f,x=d.x+m.dx*u+k.dx*v,u=d.y+m.dy*u+k.dy*v,v=V(Math.random()-0.5,Math.random()-0.5).UV();s.push(new Dot(x,u,v,q,n,p,n));s[s.length-1].setTemp(l)}window.dotManager.add(s)},remove:function(){walls.removeWall(this.innerWall.handle);
walls.removeWall(this.outerWall.handle);dotManager.removeByAttr("elemId",this.dotId);removeListener(curLevel,"update","moveCell"+this.handle.toCapitalCamelCase());canvasManager.removeListener(this.canvasHandle,"drawCell"+this.handle)}});Cell.GuideNode=function(d,e,f){this.pos=d;this.prev=this.next=void 0;this.v=V(0,0);this.m=e;this.outerWallIdx=this.innerWallIdx=void 0;this.nativeAngle=f};Cell.GuideNode.prototype={};function CheckMark(d,e,f,h,k){var l=P(d.x,d.y+0.6*e.dy),m=P(d.x+0.4*e.dx,d.y+e.dy),n=P(d.x+e.dx,d.y);d=P(d.x+0.35*e.dx,d.y+0.75*e.dy);this.pts=[l,m,n,d];this.col=f;this.stroke=h;this.drawCanvas=k}CheckMark.prototype={draw:function(){draw.fillPtsStroke(this.pts,this.col,this.stroke,this.drawCanvas)},setCanvas:function(d){this.drawCanvas=d}};function Clamps(d){this.type="Clamps";this.handle=d.handle;this.draw=defaultTo(!1,d.draw);this.releaseWith=defaultTo("button",d.releaseWith);this.currentClamper=void 0;this.clamps=d.clamps;this.wall=walls[d.wallInfo];this.buttonId="clampRelease"+this.wall.handle;this.wallHandler=this.wall.parent.getSubWallHandler(this.wall.handle,0);this.init()}
_.extend(Clamps.prototype,objectFuncs,{init:function(){this.setupStd();this.wall.moveStop();this.assembleClamps();"button"==this.releaseWith?this.makeReleaseButton():this.setupClampClicking();this.draw&&this.drawClamps();this.freezeWall()},assembleClamps:function(){for(var d=0;d<this.clamps.length;d++){var e=this.clamps[d];e.vol&&(e.y=this.wall.volToY(e.vol),delete e.vol);e.clamping=!1}this.sortClamps();this.addInitClamp()},sortClamps:function(){for(var d=0;d<this.clamps.length;d++){for(var e=!1,
f=0;f<this.clamps.length-1;f++)this.clamps[f].y>this.clamps[f+1].y&&(this.clamps.switchElements(f,f+1),e=!0);if(!e)break}},addInitClamp:function(){for(var d=this.wall[0].y,e=0;e<this.clamps.length;e++)if(this.clamps[e].y>d){this.clamps.splice(e,0,{y:d,clamping:!0});this.currentClamper=this.clamps[e];break}},makeReleaseButton:function(){var d=this;addButton(this.buttonId,"Release");$("#"+this.buttonId).click(function(){d.release()})},removeReleaseButton:function(){removeButton(this.buttonId)},release:function(){var d=
void 0,e=void 0;this.currentClamper.clamping=!1;var f=this.clamps.indexOf(this.currentClamper),h=this.clamps[f+1],f=this.clamps[f-1];h&&(d=h.y);f&&(e=f.y);var k=this;this.wall.releaseWithBounds(e,d,this.wallHandler,function(d){k.activateClamp(d)})},activateClamp:function(d){var e=this.clamps.indexOf(this.currentClamper);this.currentClamper.clamping=!1;this.currentClamper=d<this.currentClamper.y?this.clamps[e-1]:this.clamps[e+1];this.currentClamper.clamping=!0;this.freezeWall()},freezeWall:function(){walls.setSubWallHandler(this.wall.handle,
0,"staticAdiabatic")},remove:function(){this.wall.removed||(this.wall.moveInit(),this.wall.parent.setSubWallHandler(walls.indexOf(this.wall),0,this.wallHandler));"button"==this.releaseWith&&this.removeReleaseButton()}});function CompArrow(d){this.type="CompArrow";var e=defaultTo(0,d.wallInfo),f=defaultTo(1.5,d.speed),h=defaultTo("adiabatic",d.compMode),k=defaultTo(!0,d.stops),l=defaultTo({y:{min:30,max:350}},d.bounds);this.wall=walls[e];var m={};m.outer=Col(44,118,172);m.onClick=Col(44,118,172);m.inner=curLevel.bgCol.copy();var n=V(25,15),p="volDragger"+defaultTo("",d.handle);d=d.canvasHandle||"main";var q=canvas,s={};k&&(this.stops=new Stops({stopPt:{height:l.y.max},wallInfo:e}));var t=this.wall;s.onDown=function(){};
s.onMove=function(){t.changeSetPt(this.pos.y,h,f)};s.onUp=function(){};this.dragArrowFunc=this.makeDragArrowFunc(this.wall,0,m,n,p,d,q,s,l);this.dragArrow=this.dragArrowFunc();this.setupStd();return this}
_.extend(CompArrow.prototype,objectFuncs,{remove:function(){this.dragArrow.remove();this.stop&&this.stops.remove()},makeDragArrowFunc:function(d,e,f,h,k,l,m,n,p){return function(){var q=d[1].copy();return(new DragArrow(q,e,f,h,k,l,m,n,p)).show()}},enable:function(){this.dragArrow.setPos(this.wall[1].copy());this.dragArrow.show();this.enabled=!0},disable:function(){this.dragArrow.hide();this.enabled=!1}});function DragArrow(d,e,f,h,k,l,m,n,p){this.type="DragArrow";this.pos=d;this.rotation=e;this.posInit=this.pos.copy();this.cols=f;this.dims=h;this.handle=k;this.listeners=n;this.canvasHandle=l||"main";this.canvasElement=m;this.bounds=p;this.bounds.x?(this.bounds.x.max||(this.bounds.x.max=m.width-h.dx),this.bounds.x.min||(this.bounds.x.min=0)):this.bounds.x={min:0,max:m.width-h.dx};this.bounds.y?(this.bounds.y.max||(this.bounds.y.max=m.height-h.dy),this.bounds.y.min||(this.bounds.y.min=0)):this.bounds.y=
{min:0,max:m.height-h.dy};this.pts={};this.pts.outer=[];this.pts.inner=[];d=this.dims.dx;e=this.dims.dy;this.pts.outer.push(P(0,0));this.pts.outer.push(P(0.9*d,-e/2));this.pts.outer.push(P(d,0));this.pts.outer.push(P(0.9*d,e/2));this.pts.outer.push(P(0,0));this.dirUV=V(Math.cos(this.rotation+Math.PI/2),Math.sin(this.rotation+Math.PI/2));this.draw=this.makeDrawFunc();this.clickListeners=this.makeListenerFuncs()}
DragArrow.prototype={makeDrawFunc:function(){var d,e=this;d=[function(d){d.save();d.translate(e.pos.x,e.pos.y);d.rotate(e.rotation)}];this.cols.stroke?d.push(function(d){draw.fillPtsStroke(e.pts.outer,e.cols.outer,e.cols.stroke,d)}):d.push(function(d){draw.fillPts(e.pts.outer,e.cols.outer,d)});if(this.cols.inner||this.cols.onClick){for(var f=0;f<this.pts.outer.length;f++){var h=this.pts.outer[f].copy().movePt({dx:-this.dims.dx/2}).scale(P(0,0),0.6).movePt({dx:this.dims.dx/2});this.pts.inner.push(h)}this.cols.curInner=
this.cols.inner?this.cols.inner:this.cols.outer;d.push(function(d){draw.fillPts(e.pts.inner,e.cols.curInner,d)})}d.push(function(d){d.restore()});return function(e){for(var f=0;f<d.length;f++)d[f](e)}},makeListenerFuncs:function(){var d=this.listeners,e=this;e.amSelected=new Boolean;if(d.onDown||d.onMove||d.onUp){var f=function(){};e.cols.onClick&&(f=extend(f,function(){e.cols.curInner=e.cols.onClick}));var f=extend(f,function(){d.onDown.apply(e)}),h=this.makeMoveListenerFunc(e),f=extend(f,h);d.onUp&&
(h=this.makeUpListenerFunc(e),f=extend(f,h));return function(){e.amSelected=e.checkSelected();e.amSelected&&(e.posInit=e.pos.copy(),e.mouseInit=mouseOffset(e.canvasElement),f())}}},makeMoveListenerFunc:function(d){var e=d.listeners,f=function(){var e=mouseOffset(d.canvasElement),f=V(e.x-d.mouseInit.x,e.y-d.mouseInit.y).dotProd(d.dirUV),e=d.posInit.x+f*Math.cos(d.rotation+Math.PI/2),f=d.posInit.y+f*Math.sin(d.rotation+Math.PI/2);d.pos.x=Math.max(d.bounds.x.min,Math.min(e,d.bounds.x.max));d.pos.y=Math.max(d.bounds.y.min,
Math.min(f,d.bounds.y.max))};e.onMove&&(f=extend(f,function(){e.onMove.apply(d)}));var h=function(){addListener(curLevel,"mouseup","dragArrow"+d.handle+"RemoveMove",function(){removeListener(curLevel,"mousemove","dragArrow"+d.handle);removeListener(curLevel,"mouseup","dragArrow"+d.handle+"RemoveMove")},"")};return function(){addListener(curLevel,"mousemove","dragArrow"+d.handle,f,"");h()}},makeUpListenerFunc:function(d){var e=function(){addListener(curLevel,"mouseup","mouseup"+d.handle,function(){d.listeners.onUp.apply(d)},
"");addListener(curLevel,"mouseup","mouseup"+d.handle+"remove",function(){removeListener(curLevel,"mouseup","mouseup"+d.handle);removeListener(curLevel,"mouseup","mouseup"+d.handle+"remove")},"")};if(d.cols.onClick)var f=function(){},f=d.cols.inner?extend(f,function(){d.cols.curInner=d.cols.inner}):extend(f,function(){d.cols.curInner=d.cols.outer}),e=extend(e,function(){addListener(curLevel,"mouseup","revertCols"+d.handle,function(){f();removeListener(curLevel,"mouseup","revertCols"+d.handle)},"")});
return e},setPos:function(d){"number"==typeof d.x&&(this.pos.x=d.x);"number"==typeof d.y&&(this.pos.y=d.y)},show:function(){addListener(curLevel,"mousedown","dragArrow"+this.handle,this.clickListeners,"");canvasManager.addListener(this.canvasHandle,"drawDragArrow"+this.handle,this.draw,this,2);return this},hide:function(){removeListener(curLevel,"mousedown","dragArrow"+this.handle);canvasManager.removeListener(this.canvasHandle,"drawDragArrow"+this.handle);return this},reset:function(){this.pos=this.posInit.copy();
removeListener(curLevel,"update","moveWall");return this},remove:function(){removeListener(curLevel,"mousedown","dragArrow"+this.handle);removeListener(curLevel,"update","drawDragArrow"+this.handle)},checkSelected:function(){var d=mouseOffset(this.canvasElement).rotate(this.pos,-this.rotation),e=this.pos.copy().movePt({dy:-this.dims.dy/2});return ptInRect(e,this.dims,d)}};function DragWeights(d){this.type="DragWeights";this.handle=d.handle;this.wallInfo=defaultTo(0,d.wallInfo);this.wall=walls[this.wallInfo];this.zeroY=defaultTo(this.wall[2].y,d.min);this.pistonPt=defaultTo(this.wall[0],d.pistonPt);this.pistonOffset=defaultTo(void 0,d.pistonOffset);this.wallHandler=defaultTo("cPAdiabaticDamped",d.compMode);this.storeBinY=defaultTo(myCanvas.height-15,d.storeBinY);this.blockCol=defaultTo(Col(224,165,75),d.blockCol);this.binCol=defaultTo(Col(150,150,150),d.binCol);void 0!==
d.pInit?this.massInit=this.pressureToMass(d.pInit):this.massInit=this.pressureToMass(1);this.binHeight=defaultTo(45,d.binHeight);this.weightDimRatio=defaultTo(0.5,d.weightDimRatio);this.moveSpeed=defaultTo(20,d.moveSpeed);this.weightScalar=defaultTo(70,d.weightScalar);this.displayText=defaultTo(!0,d.displayText);this.imgSrc=this.binSlant=1.3;this.storeBinWidth=110;this.storeBinSpacing=60;this.pistonBinWidth=150;this.pistonBinSpacing=15;this.blockSpacing=2;this.mass=this.massInit;this.img=this.makeImg("brickImg");
this.massChunkName="dragWeights";this.weightsOnPiston=[];this.font="12pt Calibri";this.fontCol=Col(255,255,255);this.binThickness=5;this.canvasHandle=d.canvasHandle||"main";this.trackingPts=[];this.wall.setMass(this.massChunkName,this.massInit);this.wall.recordPExt();this.wall.recordWork();this.wall.recordMass();this.weightGroups=this.makeWeightGroups(d.weightDefs);this.addWeights(this.weightGroups);this.setupStd();this.init(d.weightDefs)}
_.extend(DragWeights.prototype,objectFuncs,compressorFuncs,{init:function(){this.bins=new DragWeights.Bins(this,this.wall,this.weightGroups,this.storeBinSpacing,this.pistonBinSpacing,this.blockSpacing,this.pistonOffset,this.pistonPt,this.storeBinWidth,this.pistonBinWidth,this.storeBinY);this.savedWallHandler=this.wall.handlers[0];walls.setSubWallHandler(this.wallInfo,0,this.wallHandler);this.displayText||(this.draw=this.drawNoText);canvasManager.addListener(this.canvasHandle,"drawDragWeights"+this.wallInfo,
this.draw,this,1);this.enable();this.wall.moveInit();this.dropAllIntoBins("instant");delete this.tempWeightDefs;return this},remove:function(){this.wall.moveStop();this.trackingPts.map(function(d){d.trackStop()});this.trackingPts.splice(0,this.trackingPts.length);walls.setSubWallHandler(walls.indexOf(this.wall),0,this.savedWallHandler);canvasManager.removeListener(this.canvasHandle,"drawDragWeights"+this.wallInfo);removeListener(curLevel,"mousedown","weights"+this.wallInfo)},getWeightDims:function(d){for(var e=
{},f=this.storeBinWidth-this.blockSpacing,h=0,k=0,l=0;l<d.length;l++){var m=d[l],n=Math.sqrt(m.mass*this.weightScalar/this.weightDimRatio);Math.max(n,h)>h&&(k=m.mass,h=n);e[m.handle]=V(n,n*this.weightDimRatio)}return h>f?(this.weightScalar=0.99*f*f*this.weightDimRatio/k,this.getWeightDims(d)):e},addDefHandles:function(d){for(var e=0;e<d.length;e++)d[e].handle="grp"+e},assignMasses:function(d){for(var e=0;e<d.length;e++)weightDef=d[e],weightDef.mass=this.pressureToMass(weightDef.pressure)},makeWeightGroups:function(d){this.addDefHandles(d);
var e={};this.assignMasses(d);for(var f=this.getWeightDims(d),h=0;h<d.length;h++){var k=d[h],k=new DragWeights.WeightGroup(k.handle,k.pressure,k.mass,f[k.handle],k.count);e[k.handle]=k}return e},addWeights:function(d){var e=0,f;for(f in d)for(var h=d[f],k=0;k<h.count;k++)h.weights.push(new DragWeights.Weight(P(300,500),h.handle,"",e++))},binIsEmpty:function(d,e){var f=this.bins[d][e].slots;for(rowIdx=0;rowIdx<f.length;rowIdx++)for(var h=f[rowIdx],k=0;k<h.length;k++)if(h[k].isFull)return!1;return!0},
weightCount:function(d,e){var f=this.bins[d][e].slots,h=0;for(rowIdx=0;rowIdx<f.length;rowIdx++)for(var k=f[rowIdx],l=0;l<k.length;l++)h+=k[l].isFull;return h},binIsFull:function(d,e){var f=this.bins[d][e].slots;for(rowIdx=0;rowIdx<f.length;rowIdx++)for(var h=f[rowIdx],k=0;k<h.length;k++)if(!h[k].isFull)return!1;return!0},allEmpty:function(d){var e=!0,f;for(f in this.bins[d])e=Math.min(e,this.binIsEmpty(d,f));return e},getPistonMass:function(){var d=0,e;for(e in this.weightGroups)for(var f=this.weightGroups[e],
h=f.weights,f=f.mass,k=0;k<h.length;k++)"piston"==h[k].status&&(d+=f);return d+this.massInit},dropAllIntoBins:function(d){for(var e in this.weightGroups)for(var f=this.weightGroups[e],h=0;h<f.weights.length;h++){var k=f.weights[h];"piston"==k.status?(k.status="inTransit",k.slot.isFull=!1,this.takeOffPiston(k),this.dropIntoBin(k,"store",d)):"store"!=k.status&&(k.status="inTransit",this.dropIntoBin(k,"store",d))}return this},dropAllOntoPiston:function(d){for(var e in this.weightGroups)for(var f=this.weightGroups[e],
h=0;h<f.weights.length;h++){var k=f.weights[h];"store"==k.status?(k.status="inTransit",k.slot.isFull=!1,this.takeOffPiston(k),this.dropIntoBin(k,"piston",d)):"piston"!=k.status&&(k.status="inTransit",this.dropIntoBin(k,"piston",d))}return this},dropIntoBin:function(d,e,f){var h=this;d.status="inTransit";var k=this.getDropSlot(d.groupHandle,e),l=k.slot;l.isFull=!0;d.slot=l;k=k.id;if("instant"==f)this.dropInstant(d,l);else{f=d.groupHandle+d.id+"endId"+this.wallInfo;var m="moveWeight"+f+e+k;removeListenerByName(curLevel,
"update",f)&&(d.slot.isFull=!1,d.slot=void 0);addListener(curLevel,"update",m,function(){var e=l.pos,f=V(e.x-d.pos.x,e.y-d.pos.y).UV();!1!==validNumber(f.dx)&&!1!==validNumber(f.dy)&&(d.pos.x=stepTowards(d.pos.x,e.x,f.dx*this.moveSpeed),d.pos.y=stepTowards(d.pos.y,e.y,f.dy*this.moveSpeed));this.weightArrived(d,l)&&(removeListener(curLevel,"update",m),h.placeWeight(d,l))},this)}},placeWeight:function(d,e){d.status=e.type;"piston"==d.status&&this.putOnPiston(d,e)},dropInstant:function(d,e){d.pos=e.pos.copy();
this.placeWeight(d,e)},weightArrived:function(d,e){return d.pos.sameAs(e.pos)},getDropSlot:function(d,e){for(var f=this.bins[e][d],h=0;h<f.slots.length;h++)for(var k=f.slots[h],l=0;l<k.length;l++){var m=f.slots[h][l];if(!m.isFull)return{slot:m,id:String(h)+String(l)}}alert("BOX IS FULL!  WHY IS THIS HAPPENING?")},draw:function(d){this.drawWeights(d);this.drawBins(d);this.drawBinLabels(d)},drawNoText:function(d){this.drawWeights(d);this.drawBins(d)},drawWeights:function(d){for(var e in this.weightGroups){var f=
this.weightGroups[e],h=f.weights,f=f.dims;if(this.img){d.save();d.scale(f.dx/this.img.width,f.dy/this.img.height);for(var k=0;k<h.length;k++)d.drawImage(this.img,h[k].pos.x*this.img.width/f.dx,h[k].pos.y*this.img.height/f.dy);d.restore()}else for(k=0;k<h.length;k++)draw.fillRect(h[k].pos,f,this.blockCol,d)}},drawBins:function(d){for(var e in this.bins){var f=this.bins[e],h;for(h in f){var k=f[h];k.visible&&draw.fillPts(k.pts,this.binCol,d)}}},drawBinLabels:function(d){for(var e in this.bins.store){var f=
this.bins.store[e];f.visible&&draw.text(this.weightGroups[e].pressure+" bar each",P(f.x+this.storeBinWidth/2,f.y-this.binHeight),this.font,this.fontCol,"center",0,d)}},putOnPiston:function(d,e){this.weightsOnPiston.push(d);d.pos.track({pt:e.pos,noTrack:"x"});this.trackingPts.push(d.pos);d.status="piston";this.mass=this.getPistonMass();this.wall.setMass(this.massChunkName,this.mass)},takeOffPiston:function(d){for(var e=0;e<this.weightsOnPiston.length;e++)d==this.weightsOnPiston[e]&&this.weightsOnPiston.splice([e],
1);d.pos.trackStop();this.trackingPts.splice(this.trackingPts.indexOf(d.pos),1);this.mass=this.getPistonMass();this.wall.setMass(this.massChunkName,this.mass)},mousedown:function(){var d=this.getClicked();d&&(this.pickup(d),"piston"==this.selected.cameFrom&&this.takeOffPiston(this.selected),addListener(curLevel,"mousemove","weights",this.mousemove,this),addListener(curLevel,"mouseup","weights",this.mouseup,this))},mousemove:function(){var d=mouseOffset(myCanvas),e=this.selected.origPos,f=e.weight,
e=e.mouse,h=f.y+(d.y-e.y);this.selected.pos.x=f.x+(d.x-e.x);this.selected.pos.y=h},mouseup:function(){removeListener(curLevel,"mousemove","weights");removeListener(curLevel,"mouseup","weights");var d=this.getDest(),e=this.selected;this.dropIntoBin(e,d);delete this.origPos;this.selected=e.origPos=void 0},getDest:function(){var d=this.selected,e=this.weightGroups[d.groupHandle].dims.dy;return"piston"==d.cameFrom||d.pos.y+e>this.zeroY?"store":"piston"},pickup:function(d){d.cameFrom=d.status;d.status=
"holding";var e=mouseOffset(myCanvas);void 0!==d.slot&&(d.slot.isFull=!1);"piston"==d.status&&this.takeOffPiston(d);delete d.slot;this.selected=d;this.selected.origPos={mouse:e.copy(),weight:d.pos.copy()}},getClicked:function(){for(var d in this.weightGroups){d=this.weightGroups[d];for(var e=0;e<d.weights.length;e++){var f=d.weights[e];if(inRect(f.pos,d.dims,myCanvas)&&("inTransit"==f.status||this.isOnTop(f)))return f}}return!1},mouseOnWeight:function(d,e){var f=mouseOffset(myCanvas);return f.x>=
e.x&&f.x<=e.x+d.dx&&f.y<=e.y&&f.y>=e.y-d.dy},isOnTop:function(d){var e=d.slot;d=this.bins[e.type][d.groupHandle];for(var f=e.col,e=e.row+1;e<d.slots.length;e++)if(d.slots[e][f].isFull)return!1;return!0},mass:function(){return this.mass},disable:function(){removeListener(curLevel,"mousedown","weights"+this.wallInfo);this.enabled=!1},enable:function(){addListener(curLevel,"mousedown","weights"+this.wallInfo,this.mousedown,this);this.enabled=!0},makeImg:function(d){d=document.getElementById(d);if(null==
d)return!1;var e=new Image;e.src=d.src;return e}});DragWeights.Bins=function(d,e,f,h,k,l,m,n,p,q,s){this.piston=this.makePistonBins(d,e,f,q,k,m,n,l);this.store=this.makeStoreBins(d,e,f,p,h,s,l)};
DragWeights.Bins.prototype={makePistonBins:function(d,e,f,h,k,l,m,n){var p=(e[0].x+e[1].x)/2;e={};var q=countAttrs(f),p=p-h*(q-1)/2-k*(q-1)/2,s;for(s in f)e[s]=new DragWeights.PistonBin(d,p,f[s],l,h,n,m,V(d.pistonBinWidth,d.binHeight),d.binSlant,d.binThickness),p+=h+k;return e},makeStoreBins:function(d,e,f,h,k,l,m){var n=(e[0].x+e[1].x)/2;e={};var p=countAttrs(f),n=n-h*(p-1)/2-k*(p-1)/2,q;for(q in f)p=f[q],e[q]=new DragWeights.StoreBin(P(n,l),p,h,m,p,V(d.storeBinWidth,d.binHeight),d.binSlant,d.binThickness),
n+=h+k;return e}};DragWeights.WeightGroup=function(d,e,f,h,k){this.handle=d;this.pressure=e;this.mass=f;this.dims=h;this.weights=[];this.count=k};DragWeights.Weight=function(d,e,f,h){this.pos=d;this.groupHandle=e;this.status=f;this.id=h;this.origPos=this.cameFrom=void 0};
DragWeights.PistonBin=function(d,e,f,h,k,l,m,n,p,q){this.pos;h?(n=h.dx,this.pos=P(e-k/2,0).movePt(V(n,0)).track({pt:m,noTrack:"x",offset:{dy:h.dy}})):this.pos=P(e-k/2,0).track({pt:m,noTrack:"x"});this.pts=[];d.trackingPts.push(this.pos);this.slots=this.getSlots(d,this.pos,f,k,l);this.visible=!1};
DragWeights.PistonBin.prototype={getSlots:function(d,e,f,h,k){var l=f.weights.length,m=f.dims,n=Math.floor(h/(m.dx+k));startX=e.x+(h-n*(m.dx+k))/2;h=Math.ceil(l/n);for(var l=[],p=k,q=0;q<h;q++){for(var s=[],t=startX+k,u=0;u<n;u++){var v=P(t,0).track({pt:e,offset:{dy:-(p+m.dy)},noTrack:"x"});d.trackingPts.push(v);s.push(new DragWeights.Slot(!1,v,f.handle,"piston",q,u));t+=m.dx+k}l.push(s);p+=m.dy+k}return l}};
DragWeights.StoreBin=function(d,e,f,h,k,l,m,n){this.pts=compressorFuncs.getBinPts(d,m,l,n);this.pos=d.copy().movePt(V(-l.dx/2,0));this.slots=this.getSlots(this.pos,k,f,h);this.visible=!0};
DragWeights.StoreBin.prototype={getSlots:function(d,e,f,h){var k=e.weights.length,l=e.dims,m=Math.floor(f/(l.dx+h));f-=m*(l.dx+h);d=d.copy();d.x+=f/2;k=Math.ceil(k/m);f=[];for(var n=d.y-h-l.dy,p=0;p<k;p++){for(var q=[],s=d.x+h,t=0;t<m;t++)q.push(new DragWeights.Slot(!1,P(s,n),e.handle,"store",p,t)),s+=l.dx+h;f.push(q);n-=l.dy+h}return f}};DragWeights.Slot=function(d,e,f,h,k,l){this.isFull=d;this.pos=e;this.handle=f;this.type=h;this.row=k;this.col=l};var flowFuncs={getPts:function(d,e,f,h,k){f=d.VTo(e).mag();var l=this.width/f;this.fracOffset=Math.max(Math.min(this.fracOffset,1-l/2),l/2);f=k+l;k=d.copy().fracMoveTo(e,k-l);d=d.copy().fracMoveTo(e,f);e=k.copy().movePt(h.copy().neg().mult(this.depth));h=d.copy().movePt(h.copy().neg().mult(this.depth));return[k,e,h,d]},addPts:function(){var d=Math.min(this.ptIdxs[0],this.ptIdxs[1]),e=Math.max(this.ptIdxs[0],this.ptIdxs[1]),f=this.wall.getPt(d).copy(),e=this.wall.getPt(e).copy();this.perp=this.wall.getPerpUV(d);
d=this.wall.getUV(d);this.pts=this.getPts(f,e,d,this.perp,this.fracOffset)},addArrows:function(d,e){var f=[],h=30<this.width?2:1,k=this.pts[1].copy();k.movePt(d.copy().neg().mult(this.arrowDims.dy/3));for(var l=this.pts[1].VTo(this.pts[2]),l=l.copy().UV().copy().mult(l.mag()/(h+1)),m=0;m<h;m++)k.movePt(l),f.push(new ArrowStatic({pos:k,dims:this.arrowDims,UV:d.copy(),handle:this.handle+"Idx"+m,fill:this.arrowFill,stroke:this.arrowStroke,cleanUpWith:this.cleanUpWith}));return f}};function Heater(d){this.type="Heater";this.dims=defaultTo(V(100,40),d.dims);this.sliderWrapper=d.sliderWrapper;this.sliderTitleWrapper=d.sliderTitleWrapper;this.wall=walls[d.wallInfo];this.pos=d.pos?d.pos:this.centerOnWall(d.wallInfo,this.dims);d.offset&&this.pos.movePt(d.offset);this.wall.recordQ();this.wall.hitThreshold=30;this.makeSlider=defaultTo(!0,d.makeSlider);this.handle=d.handle;this.canvasHandle=d.canvasHandle||"main";this.cornerRound=0.2;this.qRate=defaultTo(0,d.init);this.qRateMax=defaultTo(1,
d.max);this.qRateMin=-this.qRateMax;this.rot=defaultTo(0,d.rotation);this.tempMax=defaultTo(Number.MAX_VALUE,d.tempMax);this.tempMin=defaultTo(1,d.tempMin);this.center=this.pos.copy().movePt(this.dims.copy().mult(0.5));var e=defaultTo(Col(200,0,0),d.colMax),f=defaultTo(Col(0,0,200),d.colMin),h=defaultTo(Col(100,100,100),d.colDefault);this.draw=this.makeDrawFunc(f,h,e);this.wallPts=this.pos.roundedRect(this.dims,0.3,"ccw");this.addWallHump(this.wallPts);this.eAdded=0;d.liquidHandle&&this.setupLiquidHeat(d.liquidHandle);
this.wallHandleHeater="heater"+this.handle.toCapitalCamelCase();this.hit=this.wrapHit(this.wall.getDataSrc("temp"));this.setupStd();this.makeSlider&&(this.slider=sliderManager.addSlider("Heater",this.handle+"Slider",{value:50},[{eventType:"slide",obj:this,func:this.parseSlider},{eventType:"slidestop",obj:this,func:function(d,e){$(this.slider.slider).slider("option",{value:50});e.value=50;this.parseSlider(d,e)}}],d.sliderIdx));this.init(this.wallHandleHeater,this.wall.handle)}
_.extend(Heater.prototype,objectFuncs,{parseSlider:function(d,e){this.setQRate(e.value)},setQRate:function(d){this.enabled&&(this.qRate=0.02*this.qRateMax*(d-50),this.liquid&&(50!=d?addListener(curLevel,"update","heatLiquid"+this.handle,this.heatLiq,this):removeListener(curLevel,"update","heatLiquid"+this.handle)))},heatLiq:function(){this.liquid.addQ(0.15*this.qRate*updateInterval)},addWallHump:function(d){for(var e=[],f=0;f<d.length-1;f++)d[f].y==d[f+1].y&&e.push(f);d[d.length-1].y==d[0].y&&e.push(d.length-
1);for(var h=e[0],f=0;f<e.length;f++)h=d[e[f]].y<d[h].y?e[f]:h;d.splice(h+1,0,P(h==d.length-1?(d[h].x+d[0].x)/2:(d[h].x+d[h+1].x)/2,d[h].y-5))},disable:function(){this.slider&&this.slider.disable();this.setQRate(50);this.enabled=!1},enable:function(){this.slider&&this.slider.enable();this.enabled=!0},makeDrawFunc:function(d,e,f){this.pts=this.getPts(this.pos,this.dims);rotatePts(this.pts,this.center,this.rot);var h=this.getColorSteps(d,e,f),k=this,l=this.pts;return function(d){var f=getSign(k.qRate),
p=h[String(f)],f=f*k.qRate/k.qRateMax,p=e.copy().adjust(p[0]*f,p[1]*f,p[2]*f);draw.path(l,p,d)}},centerOnWall:function(d,e){var f=walls[d];return P((f[3].x+f[2].x)/2-e.dx/2,f[2].y-30-e.dy)},getPts:function(d,e,f){f=[];d=d.copy().movePt({dy:e.dy/2});var h=e.dy/2+2.5,k=e.dy/2-2.5,l=Math.floor((e.dx-2*h)/(2*(h-k)));f.push(d.copy().movePt({dy:200}));f.push(d.copy());f=f.concat(this.halfElipse(d,h,e.dy/2,0,5));d.movePt({dx:2*h});for(var m=0;m<l;m++)f=f.concat(this.halfElipse(d,k,e.dy/2,Math.PI,5)),d.movePt({dx:-2*
k}),f=f.concat(this.halfElipse(d,h,e.dy/2,0,5)),d.movePt({dx:2*h});f.push(d.copy());f.push(d.copy().movePt({dy:200}));this.endX=f[f.length-1].x;this.dims=V(this.endX-this.pos.x,e.dy);this.center=this.pos.copy().movePt(this.dims.copy().mult(0.5));return f},halfElipse:function(d,e,f,h,k){k=defaultTo(5,k);for(var l=Array(k),m=Math.PI/k,n=d.x+e,p=Math.PI,q=0;q<k;q++){var s=n+e*Math.cos(p),t=d.y+f*Math.sin(p);l[q]=P(s,t);p+=m}rotatePts(l,d,h);return l},getColorSteps:function(d,e,f){var h={};f=[f.r-e.r,
f.g-e.g,f.b-e.b];h["-1"]=[d.r-e.r,d.g-e.g,d.b-e.b];h["1"]=f;return h},init:function(d,e){canvasManager.addListener(this.canvasHandle,"drawHeater"+this.handle,this.draw,this,1);this.setupWalls(d,e);this.eAdded=0},setupWalls:function(d,e){walls.addWall({pts:this.wallPts,handler:{func:this.hit,obj:this},handle:d,record:!1,show:!1});walls[d].createSingleValDataObj("vol",function(){return walls.wallVolume(d)});window.dotMigrator.migrateDots(window.dotManager.get({tag:e}),[e],"only",[d],"or")},wrapHit:function(d){return function(e,
f,h,k,l,m){walls.reflect(e,k,l);e.temp();if(0<this.qRate&&d[d.length-1]<this.tempMax||0>this.qRate&&d[d.length-1]>this.tempMin)e=0.0010*e.addEnergy(this.qRate),this.eAdded+=e,this.wall.q+=e}},setupLiquidHeat:function(d){var e=this;timeline.curSection().addCmmdPoint("now","setup",function(){var f=curLevel.selectObj("Liquid",d);f||console.log("Bad liquid handle for heater "+this.handle+".  Handle "+handle);f.heater=e;f.getWallLiq().recordQ();e.liquid=f},!0,!0)},removeLiquid:function(){this.liquid=void 0},
remove:function(){this.slider.remove();canvasManager.removeListener(this.canvasHandle,"drawHeater"+this.handle);window.walls&&!walls.removed&&walls.removeWall(this.wallHandleHeater)}});function Inlet(d){this.arrowDims=V(15,20);this.arrowFill=Col(200,0,0);this.arrowStroke=Col(100,100,100);this.type="Inlet";(this.temp=d.temp)||console.log("No/zero temperature sent to inlet "+this.handle);this.handle=d.handle;this.width=defaultTo(30,d.width);this.depth=defaultTo(20,d.depth);this.makePts=Boolean(this.depth);this.wallInfo=d.wallInfo;this.wall=walls[this.wallInfo];this.dotTag=d.tag||this.wall.handle;this.dotReturnTo=d.returnTo||this.wall.handle;this.ptIdxs=d.ptIdxs;this.fracOffset=defaultTo(0.5,
d.fracOffset);this.flows=this.processFlows(d.flows);this.flowGroupSliders=this.addFlowSliders(d.sliders||[],this.flows);this.tempSlider=void 0;d.makeTempSlider&&(this.tempMin=d.tempMin,this.tempMax=d.tempMax,this.tempSlider=this.addTempSlider(d.tempMin,d.tempMax,d.temp,d.tempSliderTitle||"Inlet temp"));this.setupStd();this.arrows=[];this.init()}
_.extend(Inlet.prototype,flowFuncs,objectFuncs,{init:function(){this.addPts();this.makePts&&this.wall.addPts(this.ptIdxs[1],this.pts);var d={pos:this.pts[1].copy(),vec:this.pts[1].VTo(this.pts[2]),dir:this.perp.copy()};this.arrows=this.addArrows(this.pts[1].VTo(this.pts[2]).UV().perp("ccw"));this.makeInlet(d,this.flows,this.dotTag,this.dotReturnTo)},processFlows:function(d){for(var e=[],f=0;f<d.length;f++){var h=d[f];e.push(new Inlet.Flow(h.spcName,1E3*h.nDotMax/updateInterval,h.handle))}return e},
parseSlider:function(d,e){this.fracOpen=e.value/100},addFlowSliders:function(d,e){for(var f=[],h=0;h<d.length;h++){var k=d[h],l=this.pluckFlows(e,k.flowHandles),m=k.handle,n=k.title,k=k.fracOpen,l=new Inlet.FlowGroupSlider(n,m,l),m=sliderManager.addSlider(n,this.handle+"Slider"+m.toCapitalCamelCase(),{value:100*k},[{eventType:"slide",obj:l,func:l.parseSlider}],void 0);l.slider=m;f.push(l)}return f},addTempSlider:function(d,e,f,h){("number"!=typeof d||"number"!=typeof e)&&console.log("Making heater "+
this.handle+" temp slider without tempMin or tempMax");f=Math.min(Math.max(d,f),e);return sliderManager.addSlider(h,this.handle+"TempSlider",{value:100*this.tempToFrac(d,e,f)},[{eventType:"slide",obj:this,func:this.parseTempSlider}],void 0)},setFracOpen:function(d,e){var f=this.getSlider(d);f&&f.setFracOpenExternal(bound(e,0,1))},parseTempSlider:function(d,e){this.setTemp(this.fracToTemp(this.tempMin,this.tempMax,e.value/100),!1)},enableSlider:function(d){/temp/i.test(d)?this.tempSlider&&this.tempSlider.enable():
(d=this.getSlider(d))&&d.slider.enable()},disableSlider:function(d){/temp/i.test(d)?this.tempSlider&&this.tempSlider.disable():(d=this.getSlider(d))&&d.slider.disable()},setTemp:function(d,e){this.temp=bound(d,this.tempMin,this.tempMax);!1!==e&&this.tempSlider&&this.tempSlider.slider.slider("value",100*this.tempToFrac(this.tempMin,this.tempMax,d))},fracToTemp:function(d,e,f){return d+(e-d)*f},tempToFrac:function(d,e,f){return(f-d)/(e-d)},pluckFlows:function(d,e){for(var f=[],h=0;h<e.length;h++){var k=
_.find(d,function(d){return d.handle==e[h]});k?f.push(k):console.log("Could not find flow "+e[h]+" for inlet slider")}return f},getSlider:function(d){for(var e=0;e<this.flowGroupSliders.length;e++)if(this.flowGroupSliders[e].handle==d)return this.flowGroupSliders[e];return!1},makeInlet:function(d,e,f,h){var k=d.pos,l=d.vec,m=d.dir,n=Array(e.length),p=e.length;for(d=0;d<n.length;d++)n[d]=0;addListener(curLevel,"update",this.type+this.handle,function(){for(var d=0;d<p;d++){var s=e[d];n[d]+=s.fracOpen*
s.nDotMax;var t=Math.floor(n[d]);if(t){for(var u=[],v=0;v<t;v++){var x=Math.random(),x=P(k.x+l.dx*x,k.y+l.dy*x);u.push({pos:x,dir:m,temp:this.temp,returnTo:h,tag:f})}s.spc.place(u);n[d]-=t}}},this)},remove:function(){for(var d=0;d<this.flowGroupSliders.length;d++)this.flowGroupSliders[d].slider.remove();for(d=0;d<this.arrows.length;d++)this.arrows[d].remove();this.tempSlider&&this.tempSlider.remove();removeListener(curLevel,"update",this.type+this.handle)}});
Inlet.Flow=function(d,e,f){this.spcName=d;this.spc=window.spcs[d];this.nDotMax=e;this.handle=f;this.fracOpen=1};Inlet.FlowGroupSlider=function(d,e,f){this.title=d;this.handle=e;this.slider=void 0;this.flows=f};Inlet.FlowGroupSlider.prototype={parseSlider:function(d,e){this.setFracOpen(e.value/100)},disable:function(){},setFracOpen:function(d){for(var e=this.flows,f=0;f<e.length;f++)e[f].fracOpen=d},setFracOpenExternal:function(d){this.setFracOpen(d);this.slider.slider.slider("value",100*d)}};function Liquid(d){this.type="Liquid";this.wallInfo=d.wallInfo;this.wallGas=walls[this.wallInfo];this.wallPtIdxs=d.wallPts||[this.wallGas.length-2,this.wallGas.length-3];this.handle=d.handle;this.actCoeffType=d.actCoeffType||"ideal";this.actCoeffInfo=d.actCoeffInfo;var e=d.makePhaseDiagram;this.Cp=0;var f=d.tempInit;this.temp=f;var h=d.spcCounts;this.spcDefs=this.getSpcDefs(h);this.tempDisplay=this.temp;this.criticalPointTemp=d.criticalPointTemp;this.triplePointTemp=d.triplePointTemp;this.isTwoComp=
2==countAttrs(this.spcDefs);this.spcA=getNth(this.spcDefs,0);this.isTwoComp&&(this.spcB=getNth(this.spcDefs,1));this.canvasHandle=d.canvasHandle||"main";this.drivingForce=this.makeDrivingForce(this.spcDefs);this.dotMgrLiq=this.makeDotManager(this.spcDefs);this.wallLiq=this.makeWallLiq(this.spcDefs,h,this.wallGas,this.wallPtIdxs,this.dotMgrLiq);this.wallLiq.isLiquid=!0;this.surfAreaObj=this.wallGas.addSurfAreaAdjust(this.handle);this.numAbs=deepCopy(this.drivingForce);this.numEjt=deepCopy(this.numAbs);
this.makeDots(this.wallLiq,this.wallGas,this.wallPtIdxs,h,f,this.dotMgrLiq)&&this.deleteCount(this.spcDefs);this.dataGas=this.initData(this.wallGas,this.spcDefs,["pInt","temp","vol"]);this.setupGrabPExt(this.wallGas,this.dataGas);this.dataLiq=this.initData(this.wallLiq,this.spcDefs);this.recordTempLiq(this.wallLiq);this.drawList=this.makeDrawList(this.dotMgrLiq);this.actCoeffFuncs=this.makeActCoeffFuncs(this.actCoeffType,this.actCoeffInfo,this.spcDefs);this.chanceZeroDf=0.4;this.drivingForceSensitivity=
10;this.updateListenerName=this.type+this.handle;this.phasePressure=d.phasePressure||1;this.makePhaseDiagram=this.wrapMakePhaseDiagram(this,this.spcDefs,this.actCoeffFuncs,"liquid"+this.handle.toCapitalCamelCase(),d.primaryKey,d.makeGasMarker,d.makeSystemMarker,d.makeLiquidMarker,this.phasePressure);e&&(this.phaseDiagram=this.makePhaseDiagram());this.updateEquilData(this.phaseDiagram,[this.phasePressure]);this.setupUpdate(this.spcDefs,this.dataGas,this.dataLiq,this.actCoeffFuncs,this.drivingForce,
this.updateListenerName,this.drawList,this.dotMgrLiq,this.wallLiq,this.numAbs,this.drivingForceSensitivity,this.numEjt,this.wallGas,this.wallPtIdxs,this.surfAreaObj);this.wallGas.addLiquid(this);this.wallBound=this.addWallBound(this.wallGas);this.phaseChangeEnabled=!0;this.equilData;this.energyForDots=0;this.setupStd()}
_.extend(Liquid.prototype,objectFuncs,{getSpcDefs:function(d){var e={},f;for(f in d)e[f]=window.spcs[f];return e},setupGrabPExt:function(d,e){timeline.curSection().addCmmdPoint("now","setup",function(){var f=d.getDataSrc("pExt",void 0,!0);f&&(e.pExt=f)},!0,!0)},makeActCoeffFuncs:function(d,e,f){d=d||"ideal";if(/(twoSfxMrg|twosuffixmargoules)/i.test(d))return this.makeTwoSfxMrgFuncs(f,e.a);if(/van[\s]*laar/i.test(d))return this.makeVanLaar(f,e);if(/ideal/i.test(d)){d={};for(var h in f)d[h]=function(d,
e){return 1};return d}},makeTwoSfxMrgFuncs:function(d,e){var f={},h=R,k;for(k in d)f[k]=function(d,f){return Math.exp(e*(1-d)*(1-d)/(h*f))};return f},makeVanLaar:function(d,e){var f={},h;for(h in d){var k=e[h],l=this.getActCoeffOther(h,e);void 0===k&&console.log("Missing activity coefficient for "+h);f[h]=this.makeVanLaarFunc(k,l)}return f},makeVanLaarFunc:function(d,e){return function(f,h){return Math.exp(d*e*(1-f)/(d*f+e*(1-f))*e*(1-f)/(d*f+e*(1-f)))}},getActCoeffOther:function(d,e){for(var f in e)if(f!=
d)return e[f]},makeWallLiq:function(d,e,f,h,k,l){d=this.getLiqWallVol(d,e);f=this.getWallLiqPts(f,h,d);return window.walls.addWall({pts:f,handler:{func:this.hit,obj:this},handle:"liquid"+this.handle.toCapitalCamelCase(),record:!1,show:!0,dotManager:k,close:!1})},makeNumAbsorbed:function(d){var e={},f;for(f in d)e[f]=0;return e},togglePhaseChange:function(){this.phaseChangeEnabled?this.disablePhaseChange():this.enablePhaseChange()},enablePhaseChange:function(){window.walls.setWallHandler(this.wallLiq.handle,
{func:this.hit,obj:this});this.phaseChangeEnabled=!0},disablePhaseChange:function(){window.walls.setWallHandler(this.wallLiq.handle,{func:this.hitNoPhaseChange,obj:this});this.phaseChangeEnabled=!1},getLiqWallVol:function(d,e,f){var h=0;if(f)for(k in d)h+=d[k].spcVolLiq*f.get({spcName:k}).length/N;else for(var k in d)h+=d[k].spcVolLiq*e[k]/N;return h},getWallLiqPts:function(d,e,f){var h=d[e[0]];e=d[e[1]];d=h.x<e.x?h:e;h=d==h?e:h;f=this.getWallHeight(h.x-d.x,f);d=d.copy().movePt(V(0,-f));return[h.copy().movePt(V(0,
-f)),d]},getWallHeight:function(d,e){return e/(vConst*d)+2},makeDotManager:function(d){var e=new DotManager,f;for(f in d)e.addSpcs(f);return e},makeDots:function(d,e,f,h,k,l){var m=d[1].copy();e=P(Math.max(e[f[0]].x,e[f[1]].x),e[f[0]].y);e=m.VTo(e);for(var n in h)spcs[n].populate(m,e,h[n],k,d.handle,void 0,d.handle,l)},recordTempLiq:function(d){var e=this;d.recordTemp(function(){return e.tempDisplay})},initData:function(d,e,f){var h={};if(f)for(var k=0;k<f.length;k++){var l=f[k],m=d.getDataObj(l,
void 0,!0);m&&(h[l]=m.src())}for(var n in e)e={spcName:n,tag:d.handle},d.recordFrac(e),h[n]=d.getDataObj("frac",e).src();return h},makeDrivingForce:function(d){var e={},f;for(f in d)e[f]=0;return e},setupUpdate:function(d,e,f,h,k,l,m,n,p,q,s,t,u,v,x){this.calcCp=this.setupCalcCp(d,n);this.calcEquil=this.setupUpdateEquil(u,p,d,e,f,h,k,n);this.addDrawListener(m);this.moveDots=this.setupMoveDots(n,d,p,u,v);this.ejectDots=this.setupEjectDots(n,d,k,q,s,m,p,t);var y=this.setupSizeWall(p,u,d,n,v,x),z=this.setupFixLiquidTemp(u,
dotManager,e),A=this.calcCp,G=this.calcEquil,E=this.moveDots,B=this.ejectDots;A();var w=0,C=this;u.getDataSrc("pExt",void 0,!0)||u.getDataSrc("pInt",void 0,!0);addListener(curLevel,"update",l,function(){if(5==w){var d;C.isTwoComp?(C.checkUpdateEquilAndPhaseDiagram=C.setupCheckUpdateEquilPhaseDiagram(C.phaseDiagram,C.wallGas.getDataSrc("pExt",void 0,!0),C.wallGas.getDataSrc("pInt")),d=C.checkUpdateEquilAndPhaseDiagram):d=function(){};removeListener(curLevel,"update",l);var f=C.dotMgrLiq.lists.ALLDOTS,
h=dotManager.lists.ALLDOTS;addListener(curLevel,"update",l,function(){C.willFixTemp(f,h,e.vol[e.vol.length-1],e.temp[e.temp.length-1])&&z();C.tempDisplay=C.temp;A();G();E();C.phaseChangeEnabled&&B();y();d();C.energyForDots=C.addEnergyToDots(window.dotManager.lists.ALLDOTS,C.energyForDots)})}C.tempDisplay=C.temp;A();G();E();y();w++})},willFixTemp:function(d,e,f,h){return 0<d.length&&d.length<75*Math.max(1,this.fluxCoeff(e,f,h))},fluxCoeff:function(d,e,f){return d.length/(e*N)/0.1*Math.sqrt(f/298)},
setupFixLiquidTemp:function(d,e,f){var h=this;return function(){var d=h.tDew(h.spcA,h.spcB,f,h.equilData),e=f.temp[f.temp.length-1],m=getSign(e-d),d=d+m*Math.min(3,m*(e-d)),e=(d-h.temp)*h.Cp;h.temp=d;h.energyForDots-=e}},tDew:function(d,e,f,h){if(d&&e){d=h.data;f=f[h.keyLight][f[h.keyLight].length-1]+1E-5;h=1;for(e=d.length;h<e;h++)if(d[h].yLight<=f){e=d[h-1].yLight;var k=d[h-1].temp;return k+(f-e)*(d[h].temp-k)/(d[h].yLight-e)}}else return d.tBoil(f.pExt?f.pExt[f.pExt.length-1]:f.pInt[f.pInt.length-
1])},addEnergyToDots:function(d,e){if(d.length&&e){for(var f=0,h=0,k=getSign(e),l=Math.floor(Math.random()*d.length);Math.abs(h)<Math.abs(e)&&f<d.length;)h+=d[l].addEnergy(k*Math.min(Math.abs(e-h),0.5)),l++,f++,l==d.length&&(l=0);return e-h}return e},setupCalcCp:function(d,e){var f=this,h={},k;for(k in d)h[k]=e.get({spcName:k});return function(){var e=0,k;for(k in d)e+=d[k].cpLiq*h[k].length/N;f.Cp=e}},setupUpdateEquil:function(d,e,f,h,k,l,m,n){var p=this;return function(){var q=5>Math.abs(d[0].y-
e[0].y);0==n.count?p.updateEquilAllVap(d,e,f,h,k,l,m,n):q?p.updateEquilWithPExt(d,e,f,h,k,l,m,n):p.updateEquilStd(d,e,f,h,k,l,m,n)}},updateEquilAllVap:function(d,e,f,h,k,l,m,n){d=this.tDew(this.spcA,this.spcB,h,this.equilData)-h.temp[h.temp.length-1];for(var p in f)m[p]=d},updateEquilWithPExt:function(d,e,f,h,k,l,m,n){e=0;h={};for(var p in f){n=k[p][k[p].length-1];var q=this.temp,s=l[p](n,q),t=f[p].antoineCoeffs;n*=this.getPPure(t.a,t.b,t.c,q)*s;e+=n;h[p]=n}d=d.pExt()-e;for(p in f)m[p]=d*h[p]/e},
updateEquilStd:function(d,e,f,h,k,l,m,n){for(var p in f){d=h[p][h[p].length-1];e=k[p][k[p].length-1];n=this.temp;var q=l[p](e,n),s=f[p].antoineCoeffs;e*=this.getPPure(s.a,s.b,s.c,n)*q;m[p]=d*(h.pExt?h.pExt[h.pExt.length-1]:h.pInt[h.pInt.length-1])-e}},addDrawListener:function(d){canvasManager.addListener(this.canvasHandle,"drawDots"+this.handle,function(e){draw.dotsAsst(d,e)},void 0,0)},setupMoveDots:function(d,e,f,h,k){var l=this,m=[],n;for(n in e)m.push(d.get({spcName:n}));return function(){for(var d,
e,n,t,u=f[0].x,v=f[1].x,x=h[k[0]].y,y=f[0].y,z=0;z<m.length;z++){var A=m[z];if(e=A.length){t=A[0].m;d=15+Math.ceil(15*Math.random());for(var G=0;G<d;G++){n=0.5*tempToV(t,l.temp);var E=2*Math.PI*Math.random();n=V(Math.cos(E)*n,Math.sin(E)*n);for(E=G;E<e;E+=d)A[E].x=Math.max(v,Math.min(u,A[E].x+n.dx)),A[E].y=Math.max(y,Math.min(x,A[E].y+n.dy))}}}}},setupEjectDots:function(d,e,f,h,k,l,m,n){var p=this,q=this.wallGas,s={},t;for(t in e)s[t]=d.get({spcName:t});return function(){for(var t in e){var v=f[t],
x=h[t];h[t]=0;0<v?n[t]+=x/(v*k+1):0>v&&(n[t]+=1+Math.sqrt(x*(-v*k+1)),n[t]+=(m[0].x-m[1].x)*-v*k/2E3);n[t]=Math.min(n[t],s[t].length);(v=Math.floor(n[t]))&&p.eject(d,window.dotManager,e,t,v,q,l,m);n[t]=0}}},setupSizeWall:function(d,e,f,h,k,l){var m=this;return function(){var n=m.getLiqWallVol(f,void 0,h),n=m.getWallHeight(Math.abs(e[k[0]].x-e[k[1]].x),n);d[0].y=e[k[0]].y-n;d[1].y=e[k[0]].y-n;d.parent.setupWall(d.parent.indexOf(d));l.val=2*n+d[1].x-d[0].x}},setupCheckUpdateEquilPhaseDiagram:function(d,
e,f){var h=e?e:f,k=0,l=this;return function(){h[h.length-1]!=l.equilData.pressure&&k++;15<k&&(l.updateEquilData(d,h),k=0)}},updateEquilData:function(d,e){d?this.equilData=d.setPressure(e[e.length-1]):this.isTwoComp&&(this.equilData=phaseEquilGenerator.constP(this.spcA,this.spcB,this.actCoeffFuncs,e[e.length-1],20))},eject:function(d,e,f,h,k,l,m,n){f=d.get({spcName:h});k=Math.min(f.length,k);k=f.slice(0,k);for(f=0;f<k.length;f++){h=k[f];0==h.temp()&&(h.v.dy=-1);h.setTemp(this.temp);var p=h.hVap();
h.v.dy=-Math.abs(h.v.dy);h.y=n[0].y-1;h.tag=l.handle;h.returnTo=l.handle;m.splice(m.indexOf(h),1);d.remove(h,!1);this.calcCp();this.temp-=p/this.Cp;0==this.Cp&&(this.temp=0,this.energyForDots-=p);0>this.temp&&(this.energyForDots-=this.Cp*(1-this.temp),this.temp=1)}e.add(k)},getPPure:function(d,e,f,h){return Math.pow(10,d-e/(h+f))*MMHGTOBAR},makeDrawList:function(d){for(var e=d.lists.ALLDOTS.concat(),f=[],h=0;h<d.lists.ALLDOTS.length;h++){var k=Math.floor(Math.random()*e.length);f.push(e[k]);e.splice(k,
1)}return f},hit:function(d,e,f,h,k,l,m){e=this.drivingForce;if(void 0!==e[d.spcName]&&(f=this.chanceZeroDf,f/=1-f,f/(f+Math.exp(-e[d.spcName]*this.drivingForceSensitivity))>Math.random()&&this.dataGas.temp.length))return this.absorbDot(d,this.drawList,this.dotMgrLiq,this.wallLiq,this.spcDefs,this.dataGas.temp);this.dotMgrLiq.count?this.adjTemps(d,h,k,this.dataGas,this.dataLiq,this.temp,window.dotManager.spcLists,this.spcDefs):WallMethods.collideMethods.reflect(d,h,k)},hitNoPhaseChange:function(d,
e,f,h,k,l,m){this.adjTemps(d,h,k,this.dataGas,this.dataLiq,this.temp,window.dotManager.spcLists,this.spcDefs)},absorbDot:function(d,e,f,h,k,l){window.dotManager.remove(d,!1);e.splice(Math.floor(Math.random()*e.length),0,d);d.tag=h.handle;d.returnTo=h.handle;e=l[l.length-1];this.energyForDots+=(d.temp()-e)*d.cv;d.setTemp(e);e=this.Cp;f.add(d);this.calcCp();this.temp=(this.temp*e+d.tempCondense()*d.cpLiq)/this.Cp;this.numAbs[d.spcName]++;return!1},adjTemps:function(d,e,f,h,k,l,m,n){var p=h.temp[h.temp.length-
1];h=d.temp();k=d.cv;var q=0,s;for(s in n)q+=m[s].length*n[s].cv/N;m=getSign(l-p);l=Math.abs((l-(this.Cp*l+q*p)/(this.Cp+q))*this.Cp);l=Math.max(m*Math.min(l,100*k),(5-h)*k);k=h+l/k;m=1;0<this.temp-l/this.Cp&&(this.temp-=l/this.Cp,m=Math.sqrt(k/h),d.v.mult(m),d.internalPotential*=k/h);WallMethods.collideMethods.reflect(d,e,f*m)},getWallLiq:function(){return this.wallLiq},getWallGas:function(){return this.wallGas},addQ:function(d){var e=this.Cp;if(0!=e){var f=this.temp;d=Math.min(e*(3E3-f),Math.max((-f+
10)*e,d));this.temp+=d/e;this.wallLiq.q+=0.0010*d}},wrapMakePhaseDiagram:function(d,e,f,h,k,l,m,n,p){var q=this,s=this.makePhaseDiagram;return function(){return s.apply(q,[d,e,f,h,k,l,m,n,p])}},makePhaseDiagram:function(d,e,f,h,k,l,m,n,p){var q,s,t;for(t in e)q?s=t:q=t;this.isTwoComp?(d={x:{min:0,step:0.2},y:{min:300,step:1}},f=new GraphPhaseTwoComp({spcAName:q,spcBName:s,axisInit:d,actCoeffFuncs:f,handle:h,primaryKey:k,liquid:this,wallGas:this.wallGas,makeGasMarker:l,makeSystemMarker:m,makeLiquidMarker:n,
pressure:p})):(d={x:{min:200,step:1}},f=new GraphPhaseOneComp({spcName:q,axisInit:d,handle:h,liquid:this,wallGas:this.wallGas,makeSystemMarker:m,logScale:{y:!0},criticalPointTemp:this.criticalPointTemp,triplePointTemp:this.triplePointTemp}));return f},addWallBound:function(d){d.setBounds(void 0,this.wallLiq[0]);var e=new WallMethods.BoundHandler(function(d,e,k){e=d.vs[0].dy;var l=d.mass;e=(0.5*l*e*e+l*window.g*(k-d[0].y))*window.tConst*window.KB;d.vs[0].dy=0;d.vs[1].dy=0;this.temp+=e/this.Cp;return k},
this,!0);d.addBoundHandler("max",e);return e},remove:function(){canvasManager.removeListener(this.canvasHandle,"drawDots"+this.handle);removeListener(curLevel,"update",this.updateListenerName);this.wallGas.removeLiquid(this);this.heater&&this.heater.removeLiquid();this.wallLiq.removed||walls.removeWall(this.wallLiq.handle);this.wallGas.removed||this.wallGas.removeSurfAreaAdjust(this.handle)}});function Outlet(d){this.arrowDims=V(15,20);this.arrowFill=Col(200,0,0);this.arrowStroke=Col(100,100,100);this.type="Outlet";this.handle=d.handle;this.width=defaultTo(30,d.width);this.depth=defaultTo(20,d.depth)||20;this.fracOpen=defaultTo(1,d.fracOpen);this.makePts=this.depth;this.wallInfo=d.wallInfo;this.wall=walls[this.wallInfo];this.ptIdxs=d.ptIdxs;this.fracOffset=defaultTo(0.5,d.fracOffset);this.arrows=[];this.pFloor=d.pressureFloor||0;this.pList=this.wall.getDataSrc("pInt");this.setupStd();this.init()}
_.extend(Outlet.prototype,flowFuncs,objectFuncs,{init:function(){this.addPts();this.makePts&&this.wall.addPts(this.ptIdxs[1],this.pts);var d=Math.min(this.ptIdxs[0],this.ptIdxs[1])+2;this.arrows=this.addArrows(this.pts[1].VTo(this.pts[2]).UV().perp("cw"));walls.setSubWallHandler(this.wallInfo,d,new Listener(this.hit,this))},hit:function(d,e,f,h,k,l){return this.pList[this.pList.length-1]>this.pFloor?dotManager.remove(d,!0):WallMethods.collideMethods.reflect(d,h,k)},remove:function(){this.arrows.map(function(d){d.remove()})}});function ParticleEmitter(d){this.type="ParticleEmitter";this.pos=d.pos;this.handle=d.handle;this.dir=d.dir;this.parentList=d.parentList;this.width=d.width;this.col=d.col;this.dist=d.dist;this.onGenerate=d.onGenerate;this.onArrive=d.onArrive;this.onRemove=d.onRemove;this.rate=defaultTo(Math.round(0.1*this.width),d.rate);this.speed=defaultTo(5,d.speed);this.speedSpread=defaultTo(1,d.speedSpread);2*this.speedSpread>this.speed&&console.log("Uh-oh.  Making particle emitter with handle "+this.handle+" with speed spread such that particles will hit ~0 speed");
this.accel=defaultTo(0.5,d.accel);this.accelSpread=defaultTo(1,d.accelSpread);this.dirSpread=defaultTo(0,d.dirSpread);this.canvasHandle=d.canvasHandle||"main";this.drawCanvas=defaultTo(c,d.drawCanvas);this.makeBounds();this.setupStd();this.particles=[];return this.init()}
_.extend(ParticleEmitter.prototype,objectFuncs,{init:function(){this.runListenerName=unique("particle"+this.handle,curLevel.updateListeners);this.drawListenerName="drawParticle"+this.handle;canvasManager.addListener(this.canvasHandle,this.drawListenerName,this.draw,this,2);addListener(curLevel,"update",this.runListenerName,this.run,this);return this},adjust:function(d){for(var e in d)this[e]=d[e];this.makeBounds()},makeBounds:function(){this.UV=angleToUV(this.dir);var d=this.pos.copy().movePt(this.UV.copy().rotate(-Math.PI/
2).mult(this.width/2)),e=this.pos.copy().movePt(this.UV.copy().rotate(Math.PI/2).mult(this.width/2));this.prodPt=d;this.prodV=d.VTo(e);this.finishPt=d.copy().movePt(this.UV.copy().mult(this.dist));this.finishV=this.finishPt.VTo(this.prodPt)},run:function(){this.generateNew();this.updateParticles()},trickleOut:function(){this.updateParticles();0==this.particles.length&&this.remove()},generateNew:function(){for(var d=Math.round(Math.random()*this.rate),e=0;e<d;e++)this.particles.push(this.newParticle()),
this.onGenerate&&this.onGenerate.func.apply(this.onGenerate.obj)},newParticle:function(){var d=this.prodPt.copy().movePt(this.prodV.copy().mult(Math.random())),e=Math.max(0.01,this.speed+this.speedSpread*(Math.random()-0.5)),f=Math.max(0,this.accel+this.accelSpread*(Math.random()-0.5)),h=angleToUV(this.dir+this.dirSpread*(Math.random()-0.5)),k=this.getlifespan(d,e,f,h);return{pos:d,V:h.copy().mult(e),accelV:h.copy().mult(f),age:0,lifespan:k}},getlifespan:function(d,e,f,h){d=h.dotProd(this.UV);f=0.5*
f*d;e*=d;return(-e+Math.sqrt(e*e-4*f*-this.dist))/(2*f)},updateParticles:function(){for(var d=this.particles.length-1;0<=d;d-=1){var e=this.particles[d];e.pos.movePt(e.V);e.V.add(e.accelV);e.age++;e.age>e.lifespan&&(this.particles.splice(d,1),this.onArrive&&this.onArrive.func.apply(this.onArrive.obj))}},draw:function(d){d.strokeStyle=this.col.hex;for(var e=0;e<this.particles.length;e++){var f=this.particles[e];d.beginPath();d.moveTo(f.pos.x,f.pos.y);d.lineTo(f.pos.x+2,f.pos.y+2);d.stroke()}},stopFlow:function(){removeListener(curLevel,
"update",this.runListenerName);addListener(curLevel,"update",this.runListenerName,this.trickleOut,this)},remove:function(){this.onRemove&&this.onRemove.func.apply(this.onRemove.obj);this.parentList&&this.parentList.splice(_.indexOf(this.parentList,this),1);canvasManager.removeListener(this.canvasHandle,this.drawListenerName);removeListener(curLevel,"update",this.runListenerName);this.removed=!0}});function Piston(d){this.type="Piston";this.handle=d.handle;this.wallInfo=defaultTo(0,d.wallInfo);this.wall=walls[this.wallInfo];this.min=defaultTo(2,d.min);this.max=defaultTo(15,d.max);this.makeSlider=defaultTo(!1,d.makeSlider);this.drawCanvas=defaultTo(c,d.drawCanvas);this.slant=0.04;this.sliderWrapper=d.sliderWrapper;this.sliderTitleWrapper=d.sliderTitleWrapper;this.left=this.wall[0].x;this.width=this.wall[1].x-this.left;this.shaftThickness=13+17*Math.max(0,Math.min(1,(this.width-200)/300));this.pistonPt=
this.wall[0];var e=defaultTo(2,d.init);this.setPressure(e);this.canvasHandle=d.canvasHandle||"main";this.height=500;this.pistonTop;this.pistonBottom;this.pistonAdjust=9;this.draw=this.makeDrawFunc(this.height,this.left,this.width);this.dataSlotFontCol=Col(255,255,255);this.pStep=0.05;var f=this.left+0.1*this.width*this.slant,h=this.left+this.width/2-this.shaftThickness/2,k=this.left+this.width/2+this.shaftThickness/2,l=this.left+this.width-0.1*this.width*this.slant,m=this.pistonBottom.pos.y-this.pistonAdjust+
this.pistonPt.y,n=Col(255,255,255);this.readoutLeft=new Readout("piston"+this.handle.toCapitalCamelCase()+"Left",f,h,m,"11pt calibri",n,"center",curLevel);this.readoutRight=new Readout("piston"+this.handle.toCapitalCamelCase()+"Right",k,l,m,"11pt calibri",n,"center",curLevel);this.wall.moveInit();this.wall.recordPExt();this.wall.recordWork();this.savedWallHandler=this.wall.handlers[0];this.wallHandler=defaultTo("cPAdiabaticDamped",d.compMode);walls.setSubWallHandler(this.wallInfo,0,this.wallHandler);
this.makeSlider&&(this.slider=sliderManager.addSlider("Pressure",this.handle+"Slider",{value:this.pToPercent(e)},[{eventType:"slide",obj:this,func:this.parseSlider}],d.sliderIdx));this.setupStd();return this.show()}
_.extend(Piston.prototype,objectFuncs,compressorFuncs,{makeDrawFunc:function(d,e,f){var h=d-15;this.pistonTop=this.makeTop(e,f,this.shaftThickness,h,d,7.5,7.5);this.pistonBottom=this.makePlateBottom(P(e,-d+h+7.5),V(f,7.5));var k=this;return function(d){k.setReadoutY();d.save();d.translate(0,k.pistonPt.y);draw.fillPts(k.pistonTop.pts,k.pistonTop.col,d);draw.fillRect(k.pistonBottom.pos,k.pistonBottom.dims,k.pistonBottom.col,d);d.restore()}},makeTop:function(d,e,f,h,k,l,m){var n=this.slant,p=1-n,q=[];
k=P(d+e/2-f/2,-k);var s=Col(150,150,150);e=V(e,l);d=k.copy().movePt({dy:h}).position({x:d});q.push(P(d.x,d.y+e.dy+1));q.push(P(d.x+e.dx*n,d.y));q.push(P(k.x-e.dx*n,d.y));q.push(P(k.x,d.y-15*e.dy*n));q.push(P(k.x,k.y));q.push(P(k.x+f,k.y));q.push(P(k.x+f,d.y-15*e.dy*n));q.push(P(k.x+f+e.dx*n,d.y));q.push(P(d.x+e.dx*p,d.y));q.push(P(d.x+e.dx,d.y+e.dy+1));q.push(P(d.x+e.dx-m,d.y+e.dy+1));q.push(P(d.x+m,d.y+e.dy+1));s=Col(150,150,150);return{pts:q,col:s}},makePlateBottom:function(d,e){var f=Col(100,100,
100);e.adjust(0,1);return{pos:d,dims:e,col:f}},enable:function(){this.slider&&this.slider.slider("option","disabled",!1);this.setMass(this.massStore);delete this.massStore;this.enabled=!0},disable:function(){this.slider&&this.slider.slider("option","disabled",!0);this.massStore=this.mass;this.setMass(0);this.enabled=!1},show:function(){canvasManager.addListener(this.canvasHandle,"drawPiston"+this.handle,this.draw,this,1);this.readoutLeft.show();this.readoutRight.show();return this},pToPercent:function(d){return 100*
(d-this.min)/(this.max-this.min)},hide:function(){canvasManager.removeListener(this.canvasHandle,"drawPiston"+this.handle);this.readoutLeft.hide();this.readoutRight.hide()},parseSlider:function(d,e){this.setPressure(this.percentToVal(e.value))},setPressure:function(d){this.setMass(this.pressureToMass(d))},setMass:function(d){this.mass=d;this.wall.setMass("piston"+this.handle,this.mass)},setReadoutY:function(){this.readoutLeft.position({y:this.pistonBottom.pos.y-this.pistonAdjust+this.pistonPt.y});
this.readoutRight.position({y:this.pistonBottom.pos.y-this.pistonAdjust+this.pistonPt.y})},remove:function(){this.wall.moveStop();this.wall.unsetMass("piston"+this.handle);walls.setSubWallHandler(walls.indexOf(this.wall),0,this.savedWallHandler);this.hide();this.slider&&this.slider.remove();removeListener(curLevel,"update","moveWalls")}});function QArrowsAmmt(d){this.type="QArrowsAmmt";this.wallHandle=d.wallInfo;this.wall=walls[this.wallHandle];this.handle=d.handle;var e=this.wall;e.recordQ();var f=3*(1/d.scale);this.qArrowAmmtMax=isNaN(f)?3:f;this.qArrowAmmtMax=defaultTo(3,3*(1/d.scale));addListener(e,"cleanUp","qArrowsAmmt",function(){for(var d=0;d<this.qArrowsAmmt.length;d++)this.qArrowsAmmt[d].remove();removeListener(curLevel,"update",this.listenerName)},this);this.init(this.wall,this.qArrowAmmtMax);this.setupStd()}
_.extend(QArrowsAmmt.prototype,objectFuncs,{init:function(d,e){Col(175,0,0);var f=V(30,10),h=d[3].copy().fracMoveTo(d[2],0.25),k=d[3].copy().fracMoveTo(d[2],0.75),l=k.VTo(h).perp("cw").UV();h.movePt(l.copy().mult(5));k.movePt(l.copy().mult(5));var h=new ArrowStatic({pos:h,dims:f,fill:Col(175,0,0),stroke:Col(0,0,0),label:"Q",UV:l,handle:this.handle+"Left"}),f=new ArrowStatic({pos:k,dims:f,fill:Col(175,0,0),stroke:Col(0,0,0),label:"Q",UV:l,handle:this.handle+"Right"}),m=e/65;this.qArrowsAmmt=[h,f];
var n="out";qLast=d.q;this.setAmmtArrowDims(this.qArrowsAmmt,15,80,70,90,d.q,e);0<=d.q&&(n="in",this.flipAmmtArrows(this.qArrowsAmmt));this.listenerName=this.handle+"updateQAmmtArrows";addListener(curLevel,"update",this.listenerName,function(){Math.abs(d.q-qLast)>m&&(dir=0>d.q?"out":"in",this.setAmmtArrowDims(this.qArrowsAmmt,15,80,70,90,d.q,e),n!=dir&&(this.flipAmmtArrows(this.qArrowsAmmt),n=dir),qLast=d.q)},this)},flipAmmtArrows:function(d){for(var e=0;e<d.length;e++){var f=d[e],h=angleToUV(f.getAngle()).mult(1);
f.move(h.mult(f.getDims().dx));f.rotate(Math.PI)}},setAmmtArrowDims:function(d,e,f,h,k,l,m){for(var n=0;n<d.length;n++){var p=d[n],q=p.getDims(),s=Math.abs(l)/m,t=e+(f-e)*s;p.size(V(t,h+(k-h)*s));0<l&&p.move(V(0,t-q.dx))}},remove:function(){removeListener(curLevel,"update",this.listenerName)}});function RMSChanger(d){this.type="RMSChanger";this.info=d.info;this.min=defaultTo(1,d.min);this.val=dataHandler.RMS(this.info);this.max=defaultTo(15,d.max);this.handle=d.handle;this.totalDots=dataHandler.count(this.info);this.sliderPos=d.sliderPos;this.setupStd();return this.init()}
_.extend(RMSChanger.prototype,objectFuncs,{init:function(){this.sliderId=this.addSlider(1<this.totalDots?"Molecules' RMS":"Molecule's RMS",{value:this.valToPercent(this.val)},[{eventType:"slide",obj:this,func:this.parseSlider}],this.sliderPos)},parseSlider:function(d,e){changeRMS(this.info,this.percentToVal(e.value))},remove:function(){this.removeSlider()}});function Sandbox(d){this.type="Sandbox";this.handle=d.handle;this.emitterNum=0;d=defaultTo({},d);this.bin={};this.sand={};this.canvasHandle=d.canvasHandle||"main";this.wallInfo=defaultTo(0,d.wallInfo);this.wall=walls[this.wallInfo];this.mass=this.pressureToMass(defaultTo(2,d.init));this.massMin=this.pressureToMass(defaultTo(0.5,d.min));this.massMax=this.pressureToMass(defaultTo(15,d.max));this.particleMass=defaultTo(0.01,d.partMass);this.buttonAddId="sandAdd"+this.handle;this.buttonRemoveId="sandRemove"+
this.handle;this.makeButtons();this.massChunkName="sandMass"+defaultTo("",this.handle);this.wall.setMass(this.massChunkName,this.mass);this.wall.recordPExt();this.wall.recordWork();this.wallHandler=defaultTo("cPAdiabaticDamped",d.compMode);walls.setSubWallHandler(this.wallInfo,0,this.wallHandler);this.trackingPts=[];this.wallPt=this.wall[0];this.emitters=[];this.binX=(this.wall[1].x+this.wall[0].x)/2;this.spcVol=70;this.sand.col=defaultTo(Col(224,165,75),d.sandCol);this.sand.pts=this.getSandPts();
this.sand.pos=P(this.binX,this.wall[0].y).track({pt:this.wallPt,noTrack:"x"});this.trackingPts.push(this.sand.pos);this.pistonPt=this.wall[0].y;this.setupStd();return this.init()}
_.extend(Sandbox.prototype,compressorFuncs,objectFuncs,{init:function(){this.drawListenerName="drawSand"+this.handle;canvasManager.addListener(this.canvasHandle,this.drawListenerName,this.draw,this,2);this.wall.moveInit();this.wall.recordMass();this.wall.recordPExt();return this},makeButtons:function(){var d=this,e=this.handle+"SandButtons";buttonManager.addGroup(e,"Sand controls");buttonManager.addButton(e,"add","Add mass",{mousedown:function(){d.buttonAddDown()}});buttonManager.addButton(e,"remove",
"Remove mass",{mousedown:function(){d.buttonRemoveDown()}})},removeButtons:function(){$("#"+this.buttonAddId).remove();$("#"+this.buttonRemoveId).remove()},draw:function(d){d.save();d.translate(this.sand.pos.x,this.sand.pos.y);var e=Math.sqrt(0.4*this.mass);d.scale(e,e);draw.fillPts(this.sand.pts,this.sand.col,d);this.width=e*(this.sand.pts[this.sand.pts.length-1].x-this.sand.pts[0].x);d.restore()},getSandPts:function(){var d=Array(4);d[0]=P(-10,0);d[1]=P(-7,-2);d[2]=P(-3,-6);d[3]=P(0,-7);ptsRight=
deepCopy(d).splice(0,d.length-1).reverse();mirrorPts(ptsRight,P(0,0),V(0,-10));return d=d.concat(ptsRight)},buttonAddDown:function(){this.mass<this.massMax&&(this.boundUpper(),this.addMass(),addListener(curLevel,"mouseup","mouseUpSandbox",this.buttonAddUp,this))},buttonAddUp:function(){this.boundUpperStop();this.addMassStop();removeListener(curLevel,"mouseup","mouseUpSandbox")},buttonRemoveDown:function(){this.mass>this.massMin&&(this.boundLower(),this.removeMass(),addListener(curLevel,"mouseup",
"mouseUpSandbox",this.buttonRemoveUp,this))},buttonRemoveUp:function(){this.boundLowerStop();this.removeMassStop();removeListener(curLevel,"mouseup","mouseUpSandbox")},boundUpper:function(){var d=this.handle+"BoundUpper";curLevel.updateListeners[d]||addListener(curLevel,"update",d,function(){this.mass>this.massMax&&(this.stopAllEmitters(),removeListener(curLevel,"update",d))},this)},boundLower:function(){var d=this.handle+"BoundLower";curLevel.updateListeners[d]||addListener(curLevel,"update",d,function(){this.mass<
this.massMin&&(this.stopAllEmitters(),removeListener(curLevel,"update",d))},this)},boundUpperStop:function(){removeListener(curLevel,"update",this.handle+"BoundUpper")},boundLowerStop:function(){removeListener(curLevel,"update",this.handle+"BoundLower")},stopAllEmitters:function(){for(var d=0;d<this.emitters.length;d++)this.emitters[d].stopFlow()},addMass:function(){this.emitters.push(this.makeAddEmitter())},addMassStop:function(){this.emitters[this.emitters.length-1].stopFlow()},removeMass:function(){this.emitters.push(this.makeRemoveEmitter())},
removeMassStop:function(){this.emitters[this.emitters.length-1].stopFlow()},makeAddEmitter:function(){var d=this.handle+this.emitterNum;this.emitterNum++;var e={func:this.onArriveAdd,obj:this},f=this.emitters.length,h=Math.PI/2,k=this.sand.col,l=this.wall[0].y,m=new ParticleEmitter({pos:P((this.wall[0].x+this.wall[1].x)/2,0),width:this.width,dist:l,dir:h,col:k,onRemove:n,parentList:this.emitters,onArrive:e,handle:d});m.adding=!0;moveListenerName=unique("adjustEmitter"+f,curLevel.updateListeners);
addListener(curLevel,"update",moveListenerName,function(){m.adjust({dist:this.wallPt.y,width:this.width})},this);var n={func:function(){removeListener(curLevel,"update",moveListenerName)},obj:this};return m},makeRemoveEmitter:function(){var d=this.handle+this.emitterNum;this.emitterNum++;var e={func:this.onGenerateRemove,obj:this},f=this.emitters.length,h=-Math.PI/2,k=this.sand.col,l=(this.wall[0].x+this.wall[1].x)/2,m=this.wall[0].y,n=new ParticleEmitter({pos:P(l,0),width:this.width,dist:m,dir:h,
col:k,onRemove:q,parentList:this.emitters,onGenerate:e,handle:d});n.removing=!0;moveListenerName=unique("adjustEmitter"+f,curLevel.updateListeners);var p=this.wall[0];addListener(curLevel,"update",moveListenerName,function(){n.adjust({pos:P(l,p.y),dist:p.y,width:this.width})},this);var q={func:function(){removeListener(curLevel,"update",moveListenerName)},obj:this};return n},onGenerateRemove:function(){this.mass-=this.particleMass;this.wall.setMass(this.massChunkName,this.mass)},onArriveAdd:function(){this.mass+=
this.particleMass;this.wall.setMass(this.massChunkName,this.mass)},remove:function(){for(var d=0;d<this.emitters.length;d++)this.emitters[d].remove();this.emitters=[];this.trackingPts.map(function(d){d.trackStop()});this.trackingPts.splice(0,this.trackingPts.length);this.removeButtons();canvasManager.removeListener(this.canvasHandle,this.drawListenerName);removeListener(curLevel,"data",this.cleanUpEmittersListenerName);this.wall.moveStop()}});function Stops(d){this.type="Stops";this.handle=d.handle;this.stopWidth=20;this.stopHeight=5;this.boundToSet=void 0;var e=d.stopPt;this.wallInfo=defaultTo(0,d.wallInfo);this.pts=this.wall=walls[this.wallInfo];this.canvasHandle=d.canvasHandle||"main";if(e.vol){var f=this.pts[0].distTo(this.pts[1]);this.height=this.pts[2].y-e.vol/(vConst*f)}else e.y&&(this.height=e.height);if(this.willDraw=defaultTo(!0,d.draw))this.draw=this.makeDrawFunc(this.height);this.setupStd();return this.init()}
_.extend(Stops.prototype,objectFuncs,{makeDrawFunc:function(d){var e=this.pts[3].copy().position({y:d}),f=this.pts[2].copy().position({y:d}).movePt({dx:-this.stopWidth}),h=V(this.stopWidth,this.stopHeight),k=borderCol;return function(d){draw.fillRect(e,h,k,d);draw.fillRect(f,h,k,d)}},init:function(){this.boundToSet=this.height>this.wall[0].y?"max":"min";this.yBoundSave=this.wall.bounds[this.boundToSet];"max"==this.boundToSet?walls[this.wallInfo].setBounds(void 0,this.height):"min"==this.boundToSet&&
walls[this.wallInfo].setBounds(this.height,void 0);this.willDraw&&canvasManager.addListener(this.canvasHandle,"drawStops"+this.wallInfo,this.draw,this,1);return this},remove:function(){window.walls&&!walls.removed&&("max"==this.boundToSet?walls[this.wallInfo].setBounds(void 0,this.yBoundSave):"min"==this.boundToSet&&walls[this.wallInfo].setBounds(this.yBoundSave,void 0));this.willDraw&&canvasManager.addListener(this.canvasHandle,"drawStops"+this.wallInfo);return this}});function TempChanger(d){this.type="tempChanger";this.info=d.info;this.min=defaultTo(100,d.min);this.val=dataHandler.temp(this.info);this.max=defaultTo(1500,d.max);this.sliderPos=d.sliderPos;this.handle=d.handle;this.totalDots=dataHandler.count(this.info);this.setupStd();return this.init()}
_.extend(TempChanger.prototype,objectFuncs,{init:function(){this.sliderId=this.addSlider(1<this.totalDots?"System temperature":"Molecule's kinetic energy",{value:this.valToPercent(this.val)},[{eventType:"slide",obj:this,func:this.parseSlider}],this.sliderPos)},parseSlider:function(d,e){changeTemp(this.info,this.percentToVal(e.value))},remove:function(){this.removeSlider()}});function Tracer(d){this.handle=d.handle;this.type="Tracer";this.info=d.info;this.col=defaultTo(Col(175,175,175),d.col);this.lifespan=Math.round(1E3/updateInterval*defaultTo(5,d.lifespan));this.listenerHandle=this.type+this.handle+"Draw";this.listenerHandleSearch=this.type+this.handle+"Search";this.setupStd();this.canvasHandle=d.canvasHandle||"main";this.drawingTools=draw;this.init()}
_.extend(Tracer.prototype,objectFuncs,{init:function(){this.dot=this.getDot();this.pts=[];this.dot?(removeListener(curLevel,"update",this.listenerHandleSearch),canvasManager.addListener(this.canvasHandle,this.listenerHandle,this.draw,this,3)):addListener(curLevel,"update",this.listenerHandleSearch,this.init,this)},getDot:function(){var d=dotManager.get(this.info);if(0<d.length)return this.info.idx&&this.info.idx<d.length?d[this.info.idx]:d[Math.floor(Math.random()*d.length)]},draw:function(d){this.dot.active?
(this.pts.push(P(this.dot.x,this.dot.y)),this.pts.length>this.lifespan&&this.pts.splice(0,1),this.drawingTools.path(this.pts,this.col,d)):(canvasManager.removeListener(this.canvasHandle,this.listenerHandle),this.init())},remove:function(){removeListener(curLevel,"update",this.listenerHandleSearch);canvasManager.removeListener(this.canvasHandle,this.listenerHandle)}});function Trigger(d){this.type="Trigger";this.handle=d.handle;this.conditionFunc=this.wrapExpr(d.expr);this.checkOn=d.checkOn;this.requiredFor=!1===d.requiredFor?void 0:d.requiredFor||"now";this.message=d.message;this.priority=defaultTo(0,d.priorityUnsatisfied||d.priority);this.satisfyStore=defaultTo(void 0,d.satisfyStore);this.satisfyCmmds=defaultTo(void 0,d.satisfyCmmds);this.amSatisfied=!1;this.setupStd();this.init()}
_.extend(Trigger.prototype,objectFuncs,{init:function(){"conditions"==this.checkOn?this.initCheckOnConditions():this.initCheckOnInterval()},wrapExpr:function(d){with(DataGetFuncs)d=eval("(function() {return "+d+"})");return d},initCheckOnConditions:function(){this.requiredFor&&conditionManager.add(this)},initCheckOnInterval:function(){addListener(curLevel,"update",this.handle,function(){if(this.conditionFunc()){this.amSatisfied=!0;this.recordVals();if(this.satisfyCmmds)for(var d=0;d<this.satisfyCmmds.length;d++)eval(this.satisfyCmmds[d]);
removeListener(curLevel,"update",this.handle)}},this);this.requiredFor&&conditionManager.add(this)},recordVals:function(){with(DataGetFuncs)if(this.satisfyStore)for(var d=0;d<this.satisfyStore.length;d++){var e=this.satisfyStore[d],f=e.storeAs,e=eval(e.expr);store(f,e)}},isSatisfied:function(){return this.amSatisfied},remove:function(){removeListener(curLevel,"update",this.handle)}});function AuxImage(d){this.type="AuxImage";this.handle=d.handle;this.imgFunc=d.imgFunc;this.slotNum=d.slotNum;this.dims=this.getDims();this.bgCol=curLevel.bgCol;this.makeDiv(this.slotNum);this.addImage(this.imgFunc);curLevel.auxs[this.handle]=this;this.setupStd()}
_.extend(AuxImage.prototype,AuxFunctions,objectFuncs,{makeDiv:function(d){this.parentDiv=this.pickParentDiv("picture",d);this.parentDiv.html("");$(this.parentDiv).css({width:this.dims.dx,height:this.dims.dy,"background-color":this.bgCol.hex,"border-radius":20,padding:0})},addImage:function(d){var e=this;d=interpreter.parseImgFunc(d,!0);d.attrs||(d.attrs={});d.attrs.id=[this.type+this.handle];$(this.parentDiv).append(templater.img(d));var f=$("#"+d.attrs.id[0]);$(f).load(function(){var d=V(e.parentDiv.width(),
e.parentDiv.height()),k=V(f.width(),f.height()),l=Math.min(k.dx,d.dx)/k.dx,m=Math.min(k.dy,d.dy)/k.dy,l=Math.min(l,m),k=k.copy().mult(l),d=P(d.dx/2-k.dx/2,d.dy/2-k.dy/2);$(f).css({position:"absolute",left:d.x,top:d.y,width:k.dx,height:k.dy})})},clearHTML:function(){this.cleanUpParent()},restoreHTML:function(){$(this.parentDiv).css({width:this.dims.dx,height:this.dims.dy,"background-color":this.bgCol.hex,"border-radius":20,padding:0});this.addImage(this.imgFunc)},remove:function(){this.cleanUpParent();
delete curLevel.auxs[this.handle]}});function AnimText(d){this.drawCanvas=d}
AnimText.prototype={newAnim:function(d,e,f){var h=unique("animText",curLevel.updateListeners),k=f.text,l=new Boolean,m=new Boolean,n=new Boolean,p=new Boolean,l=void 0!==e.pos,m=void 0!==e.col,n=void 0!==e.rotation,p=void 0!==e.size,q;q=Col(255,255,255);var s=defaultTo("calibri",f.font),t=defaultTo("center",f.align);f=defaultTo(300,f.time);var u,v,x,y;d.size=defaultTo(13,d.size);d.rot=defaultTo(0,d.rot);d.col=defaultTo(q,d.col);u=d.size;v=d.rot;x=d.col;y=d.pos.copy();var z=Math.floor(f/updateInterval),
A=function(){},G=function(){},E=function(){},B=function(){},w,C,U,F,T,O;l&&(l=V(e.pos.x-d.pos.x,e.pos.y-d.pos.y),w=l.UV().mult(l.mag()/z),A=function(){y.x+=w.dx;y.y+=w.dy});m&&(C=Math.ceil((e.col.r-d.col.r)/z),U=Math.ceil((e.col.g-d.col.g)/z),F=Math.ceil((e.col.b-d.col.b)/z),G=function(){x.adjust(C,U,F)});n&&(m=e.rotation-d.rotation,T=m<=Math.PI?m/z:-m/z,E=function(){v+=T});p&&(O=(e.size-d.size)/z,B=function(){u+=O});var M=0,L=this.drawCanvas;addListener(curLevel,"update",h,function(){draw.text(k,
y,Math.floor(u)+"pt "+s,x,t,v,L);A();G();E();B();M==z&&removeListener(curLevel,"update",h);M++},"")}};function Readout(d,e,f,h,k,l,m,n,p){this.handle=d;this.align=defaultTo("left",m);this.canvasHandle=p||"main";this.font=defaultTo("11pt calibri",k);this.fontCol=defaultTo(Col(255,255,255),l);this.leftBound=e;this.width=f-e;this.y=h;this.entries=[];n.readouts[d]=this}
Readout.prototype={draw:function(d){d.save();d.translate(this.leftBound,this.y);for(var e=0;e<this.entries.length;e++){var f=this.entries[e];draw.text(f.text,f.pos,this.font,this.fontCol,this.align,0,d)}d.restore()},update:function(d,e){var f=byAttr(this.entries,d,"name");f.val=round(e,f.decPlaces)},addEntry:function(d,e){var f=new Readout.Entry(d,"",this);e?this.entries.splice(e,0,f):this.entries.push(f);this.positionEntries();this.hide().show();return f},removeEntry:function(d){for(var e=0;e<this.entries.length;e++)if(this.entries[e].handle==
d)return this.entries.splice(e,1),this.positionEntries(),this;console.log("Tried to remove entry that does not exist: "+d)},entryExists:function(d){for(var e=0;e<this.entries.length;e++)if(this.entries[e].name==d)return!0;return!1},removeAllEntries:function(){this.entries=[]},positionEntries:function(){var d=this.entries.length,e;e=1<d?Math.floor(this.width/(d-1)):this.width;if("center"==this.align){e=this.width/(d+1);for(var f=0;f<d;f++){var h=this.entries[f],k=e*(f+1),l=0;h.pos=P(k,l)}}else if("left"==
this.align)for(f=0;f<d;f++)h=this.entries[f],k=e*f,l=0,h.pos=P(k,l)},getNumEntries:function(){var d=0,e;for(e in this.entries)d++;return d},reset:function(d){var e=byName(this.entries,d);this.tickReadout(e.curVal,e.setPt,d)},resetAll:function(){for(var d=0;d<this.entries.length;d++){var e=this.entries[d];this.hardUpdate(e.initVal,e.name)}},position:function(d){void 0!==d.x&&(this.leftBound=d.x);void 0!==d.y&&(this.y=d.y)},show:function(){curLevel.readouts[this.handle]=this;canvasManager.addListener(this.canvasHandle,
"drawReadout"+this.handle,this.draw,this,999);return this},hide:function(){delete curLevel.readouts[this.handle];canvasManager.removeListener(this.canvasHandle,"drawReadout"+this.handle);removeListener(curLevel,"update","drawReadout"+this.handle);return this}};Readout.Entry=function(d,e,f){this.handle=d;this.text=e;this.pos=void 0;this.readout=f};Readout.Entry.prototype={setText:function(d){this.text=d},remove:function(){this.readout.removeEntry(this.handle)}};LevelSettings={bgCol:Col(5,17,26)};
LevelTools={setStds:function(){this.graphs={};this.bgCol=LevelSettings.bgCol.copy();this.wallCol=Col(255,255,255);this.numUpdates=0;this.wallSpeed=defaultTo(1,this.wallSpeed);this.makeListenerHolders();this.auxs={};this.gravitying=this.attracting=!1;this.setUpdateRunListener();addListener(this,"data","run",this.dataRun,this)},addStoreAs:function(d){for(var e=0,f=0;f<d.length;f++)for(var h=d[f],k=0;k<h.prompts.length;k++){var l=h.prompts[k];if(l.quiz)for(var m=0;m<l.quiz.length;m++){var n=l.quiz[m];
void 0===n.storeAs&&(n.storeAs="questionAnswer"+String(e));e++}}},addImgsAndQuestionIds:function(d,e){for(var f=0;f<d.length;f++){var h=d[f];h.prompts||console.log("Section "+f+" has no prompts!  Sections must have at least one prompt.");for(var k=0;k<h.prompts.length;k++){var l=prompt.title,m=prompt.text,n=prompt.quiz;l&&(prompt.title=interpreter.interpImgs(l));m&&(prompt.text=interpreter.interpImgs(l));if(n)for(l=0;l<n.length;l++)if(m=n[l],m.storeAs||(m.storeAs="storeAs"+e),e++,m.options)for(optionIdx=
0;optionIdx<m.options.length;optionIdx++){var p=m.options[optionIdx];for(optionElement in p){var q=p[optionElement];"string"==typeof q&&(p[optionElement]=interpreter.interpImgs(q))}}}}return e},assumeDefaultRxnType:function(d){for(var e=0;e<d.length;e++){var f=d[e];f.sceneData&&!f.sceneData.rxnsEmergent&&(f.sceneData.rxnsEmergent=f.sceneData.rxns);for(var h=0;h<f.prompts.length;h++){var k=f.prompts[h].sceneData;k&&!k.rxnsEmergent&&(k.rxnsEmergent=k.rxns)}}},transferObjCleanUp:function(d){for(var e=
0;e<d.length;e++){var f=d[e];f.sceneData&&this.transferObjDataCleanUp(f.sceneData.objs);for(var h=0;h<f.prompts.length;h++){var k=f.prompts[h];k.sceneData&&this.transferObjDataCleanUp(k.sceneData.objs)}}},transferObjDataCleanUp:function(d){if(d)for(var e=0;e<d.length;e++){var f=d[e];f.attrs.cleanUpWith&&!f.cleanUpWith&&(f.cleanUpWith=f.attrs.cleanUpWith)}},addTriggerCleanUp:function(d){for(var e=0;e<d.length;e++){var f=d[e];f.sceneData&&this.addTriggerDataCleanUp(f.sceneData.triggers);for(var h=0;h<
f.prompts.length;h++){var k=f.prompts[h];k.sceneData&&this.addTriggerDataCleanUp(k.sceneData.triggers)}}},addTriggerDataCleanUp:function(d){d=d||[];for(var e=0;e<d.length;e++){var f=d[e];!f.cleanUpWith&&(f.requiredFor&&"now"!=f.requiredFor)&&(f.cleanUpWith=f.requiredFor)}},setDefaultPromptVals:function(d){for(var e=0;e<d.length;e++)for(var f=d[e],h=0;h<f.prompts.length;h++){var k=f.prompts[h];k.finished=!1;k.title=defaultTo("",k.title);k.text=defaultTo("",k.text)}},addUF298:function(d){for(var e=
0;e<d.length;e++)d[e].uF298=d[e].hF298-298.15*R/1E3},addCp:function(d){for(var e=0;e<d.length;e++)d[e].cp=d[e].cv+R},addSpcs:function(d,e,f){for(var h=0;h<d.length;h++){var k=d[h],l=new Species(k.spcName,k.m,k.r,k.col,h,k.cv,k.hF298,k.hVap298,k.sF298,k.antoineCoeffs,k.cpLiq,k.spcVolLiq,f);e[k.spcName]=l}},move:function(){var d=this.spcs,e;for(e in d)for(var f=d[e].dots,h=0;h<f.length;h++)f[h].x+=f[h].v.dx,f[h].y+=f[h].v.dy},cutSceneStart:function(d,e,f){this.inCutScene=!0;$("#intText").html("");d=
defaultTo("",d);this.pause();$("#dashRunWrapper").hide();$("#buttonManager").hide();!0===e?($("#dashCutScene").show(),this.cutSceneText(d),$("#prompt").html("")):"intro"==e?($("#dashIntro").show(),$("#base").hide(),this.cutSceneText(d)):"outro"==e&&($("#dashOutro").show(),$("#base").hide(),this.cutSceneText(d));$("#canvasDiv").hide();$("#display").show();this.cutSceneDivShow()},cutSceneDivShow:function(){$("#intText").show()},cutSceneText:function(d){$("#intText").html(d)},showRunDivs:function(){$("#intText").html("");
$("#dashRunWrapper").show();$("#buttonManager").show();$("#dashRun").show();$("#dashOutro").hide();$("#dashIntro").hide();$("#dashCutScene").hide();$("#nextPrevDiv").show();$("#base").show();$("#canvasDiv").show();$("#display").hide();$("#intText").hide()},cutSceneEnd:function(){this.inCutScene=!1;this.resume();this.showRunDivs();$("#intText").html("")},pause:function(){this.updateStore=this.update;this.updateDataStore=this.updateData;this.update=function(){};this.updateData=function(){}},resume:function(){this.updateStore&&
(this.update=this.updateStore);this.updateDataStore&&(this.updateData=this.updateDataStore)},hideDash:function(){$("#dashIntro").hide();$("#dashRunWrapper").hide();$("#dashOutro").hide();$("#dashCutScene").hide()},update:function(){this.numUpdates++;turn++;this.updateRun();canvasManager.draw();for(var d in this.updateListeners){var e=this.updateListeners[d];e.func.apply(e.obj)}for(var f in this.wallMoveListeners)e=this.wallMoveListeners[f],e.func.apply(e.obj)},updateData:function(){for(var d in this.dataListeners){var e=
this.dataListeners[d];e.func.apply(e.obj)}this.numUpdates=0},delayGraphs:function(){var d=this;window.setTimeout(function(){d.dataRunNoGraphs();addListener(curLevel,"data","run",d.dataRun,d)},50)},dataRunNoGraphs:function(){for(var d in this.recordListeners){var e=this.recordListeners[d];e.func.apply(e.obj)}},dataRun:function(){for(var d in this.recordListeners){var e=this.recordListeners[d];e.func.apply(e.obj)}for(var f in this.graphs)this.graphs[f].active&&this.graphs[f].addLast()},setUpdateRunListener:function(){this.updateRun=
this.attracting&&this.gravitying?this.updateRunAttractAndGravity:this.attracting?this.updateRunAttract:this.gravitying?this.updateRunGravity:this.updateRunBasic},gravity:function(d){this.gravitying=!0;for(d=0;d<walls.length;d++)walls[d].setHitMode("Gravity");this.setUpdateRunListener()},gravityStop:function(){this.gravitying=!1;this.setUpdateRunListener()},doGravity:function(){for(var d in spcs)for(var e=spcs[d].dots,f=0;f<e.length;f++)e[f].v.dy+=gInternal,e[f].y+=0.5*gInternal},attract:function(d){this.attracting=
!0;attractor.setup();attractor.assignELastAll();this.setUpdateRunListener()},attractStop:function(){this.attracting=!1;attractor.zeroAllEnergies();this.setUpdateRunListener()},updateRunBasic:function(){this.move();collide.check();walls.check()},updateRunGravity:function(){this.move();collide.check();this.doGravity();walls.check()},updateRunAttract:function(){this.move();collide.check();attractor.attract();walls.check()},updateRunAttractAndGravity:function(){this.move();collide.check();attractor.attract();
this.doGravity();walls.check()},drawRun:function(d){draw.dots(d);draw.walls(walls,d)},resetGraphs:function(){for(var d in this.graphs)this.graphs[d].reset()},removeGraph:function(d){this.graphs[d].remove();this.graphs[d]=void 0},removeAllGraphs:function(){for(var d in this.graphs)this.removeGraph(d),delete this.graphs[d]},saveAllGraphs:function(){for(var d in this.graphs)this.graphs[d].save(d+"section"+sectionIdx+"prompt"+promptIdx)},disableAllGraphs:function(){for(var d in this.graphs)this.graphs[d].disable()},
selectObj:function(d,e){return/^wall$/i.test(d)?walls[e]||console.log("Bad command wall handle "+e):this[this.key(d,e)]||console.log("Bad command data: Type "+d+" and handle "+e)},key:function(d,e){return d.toCamelCase()+e.toCapitalCamelCase()},makeListenerHolders:function(){makeListenerHolder(this,"update");makeListenerHolder(this,"wallMove");makeListenerHolder(this,"data");makeListenerHolder(this,"mousedown");makeListenerHolder(this,"mouseup");makeListenerHolder(this,"mousemove");makeListenerHolder(this,
"init");makeListenerHolder(this,"record");makeListenerHolder(this,"sectionCondition");makeListenerHolder(this,"promptCondition");makeListenerHolder(this,"setup")}};function LevelInstance(){this.readouts={};this.setStds()}_.extend(LevelInstance.prototype,LevelTools);function Timeline(d,e,f,h){this.parent=d;this.buttonManagerBlank=e||document.getElementById("buttonManager").outerHTML;this.isSectionsBranch=f||!1;this.isPromptsBranch=h||!1;this.sections=[];this.sectionIdx=void 0;this.curId=0;this.elems=[];this.suspended=!1}
Timeline.prototype={curSection:function(){return this.sections[this.sectionIdx]},curPrompt:function(){return this.sections[this.sectionIdx].curPrompt()},pushSection:function(d,e,f){this.sections.push(new Timeline.Section(this,d,this.buttonManagerBlank,void 0,e,f))},clearCurrentSection:function(){void 0!==this.sectionIdx&&this.sections[this.sectionIdx].clear()},now:function(){return{sectionIdx:this.sectionIdx,promptIdx:this.sections[this.sectionIdx].promptIdx}},nowTime:function(){return{sectionIdx:this.sectionIdx,
promptIdx:Math.floor(this.sections[this.sectionIdx].time)}},surface:function(d){var e=!1;d=defaultTo(!0,d);this.parent&&(this.isSectionsBranch?(e=this.curSection().cleanUpPrompt(d))||this.clearCurrentSection():this.isPromptsBranch&&(e=this.curSection().cleanUpPrompt(d)),e?this.curSection().promptIdx+=0.5:this.parent.catchSurface(this,d))},catchSurface:function(d,e){window.timeline=this;timeline.suspended=!1;this.curSection().pushToGlobal();e||(this.curSection().time-=1E-4);d.isSectionsBranch&&this.curSection().restoreHTML();
e?sceneNavigator.nextPrompt(!0,!1):sceneNavigator.prevPrompt()},findElemBoundsByHandle:function(d){var e=[],f,h,k,l,m,n;h=0;a:for(;h<this.sections.length;h++){l=this.sections[h].moments;for(k=0;k<l.length;k++){m=l[k].events;for(n=0;n<m.walls.length;n++)if(d==m.walls[n].elemDatum.handle&&(e.push(l[k].timestamp),f=h,2==e.length))break a;for(n=0;n<m.objs.length;n++)if(m.objs[n].elemDatum.handle){if(m.objs[n].elemDatum.handle==d&&(e.push(l[k].timestamp),f=h,2==e.length))break a}else if(m.objs[n].elemDatum.attrs&&
m.objs[n].elemDatum.attrs.handle==d&&(e.push(l[k].timestamp),f=h,2==e.length))break a;for(n=0;n<m.cmmds.length;n++)if(d==m.cmmds[n].elemDatum.handle&&(e.push(l[k].timestamp),f=h,2==e.length))break a}}e.push(f);return e},show:function(d,e,f,h){var k=this.sectionIdx!=d;h=k||e!=this.sections[d].promptIdx||h;k&&void 0!==this.sectionIdx&&this.sections[this.sectionIdx].cleanUpPrompt(d>this.sectionIdx);if(k||f)this.clearCurrentSection(),this.sectionIdx=d,this.sections[d].showSection();(h||f)&&this.sections[d].showPrompt(e)},
addOnce:function(d,e,f,h,k){d="now"==d?this.sectionIdx:d;this.sections[d].addOnce(e,f,h,k)},refresh:function(){var d=this.sections[this.sectionIdx],e=d.sectionData.prompts[d.promptIdx],f=d.motherSection,h=d.motherTimeline,d=new Timeline.Section(d.motherTimeline,f.sectionData,this.buttonManagerBlank,f.conditionManager);f.clear();d.copyBranchCmmds(f.moments);var k=h.sections.indexOf(f);h.sections.splice(k,1,d);d.showSection();d.deepStepTo(e,f.branches)},takeNumber:function(){return this.curId++}};
Timeline.Section=function(d,e,f,h,k,l){this.timeline=d;this.inited=!1;this.promptIdx=-1;this.time=-2;this.branches=[];this.sectionData=e;this.moments=[];this.populateMoments(d,d.elems,this.moments,this.sectionData);this.sortMoments();this.level=new LevelInstance;this.mainReadout=new Readout("mainReadout",30,myCanvas.width-125,25,"11pt calibri",Col(255,255,255),"left",this.level);this.dotManager=new DotManager;this.collide=new CollideHandler(this.dotManager);this.walls=WallHandler();this.dataHandler=
new DataHandler;this.dataDisplayer=new DataDisplayer;this.conditionManager=h?h.stripForInheritance():new ConditionManager;this.activationEnergySpcChanger=new ActivationEnergySpcChanger(this.collide);this.buttonManager=new ButtonManager("buttonManager");this.spcs={};LevelTools.addSpcs(LevelData.spcDefs,this.spcs,this.dotManager);this.sliderList=[];this.dataDisplayer.setReadouts(this.level.readouts);this.canvasManager=new CanvasManager;this.canvasManager.addCanvas("main",myCanvas,c,LevelSettings.bgCol);
this.canvasManager.addListener("main","drawRun",LevelTools.drawRun,void 0,0);this.collide.setSpcs(this.spcs);this.level.spcs=this.spcs;this.level.dataHandler=this.dataHandler;this.buttonMangerClone;this.buttonManagerBlank=f;this.dashRunId="dashRun"+window.dashRunId++;this.dashRun=$("#dashRunBlank").clone(!0).attr("id",this.dashRunId);$("#dashRunWrapper").append(this.dashRun);this.sliderManager=new SliderManager(this.dashRunId);this.motherTimeline=k||this.timeline;this.motherSection=l||this};
Timeline.Section.prototype={showSection:function(){this.dashRun.show();this.dashRun.addClass("active");this.replaceDiv($("#buttonManagerWrapper"),$("#buttonManager"),this.buttonManagerClone||this.buttonManagerBlank);this.pushToGlobal();this.inited?(this.restoreAuxs(),this.restoreGraphs()):(this.stepTo(-1),this.promptIdx=-1,this.inited=!0)},restoreHTML:function(){this.dashRun.show();this.dashRun.addClass("active");this.replaceDiv($("#buttonManagerWrapper"),$("#buttonManager"),this.buttonManagerClone||
this.buttonManagerBlank);this.restoreGraphs();this.restoreAuxs()},showPrompt:function(d){var e=this.getTimestamp(d,"headHTML");this.stepTo(e)?(this.timeline.suspended=!0,this.promptIdx=Math.floor(this.time)+0.5):this.promptIdx=d},stepTo:function(d){var e=!1,f=!1,h=this.time;if(d>this.time||d<this.time&&!/headhtml/i.test(this.getTimestampType(d))){var k=this.momentAt(this.time);k&&k.fire(this.time,d);k&&(this.time+=d>this.time?1E-4:-1E-4);for(;d!=this.time;){k=this.nextTowardsDest(this.time,d);if(!k)break;
var l=this.getTimestamp(Math.floor(k.timestamp),"branchPreClean"),m=this.getTimestamp(Math.floor(k.timestamp),"branchPostClean");this.time=k.timestamp;k.fire(h,d);if(1E-5>Math.abs(k.timestamp-l)||1E-5>Math.abs(k.timestamp-m)){e=this.branches[Math.floor(this.time)].timeline;e=e.isSectionsBranch?"sections":e.isPromptsBranch?"prompts":void 0;break}}}else if(d<this.time){(k=this.momentAt(this.time))&&k.fire(this.time,d);k&&(this.time-=1E-4);for(var n=this.getTimestamp(Math.floor(d),"branchPreClean");n!=
this.time;){k=this.nextTowardsDest(this.time,n);if(!k)break;l=this.getTimestamp(Math.floor(k.timestamp),"branchPreClean");m=this.getTimestamp(Math.floor(k.timestamp),"branchPostClean");this.time=k.timestamp;k.fire(h,d);if(1E-5>Math.abs(k.timestamp-l)||1E-5>Math.abs(k.timestamp-m)){e=this.branches[Math.floor(this.time)].timeline;e=e.isSectionsBranch?"sections":e.isPromptsBranch?"prompts":void 0;f=!0;break}}if(!f)for(this.time=this.getTimestamp(Math.floor(d+1E-4),"setup")-1E-4;d!=this.time;){k=this.nextMoment(this.time);
if(!k)break;h=this.time;this.time=k.timestamp;k.fire(h,d)}}return e},deepStepTo:function(d,e){for(var f=-1,h=this.moments.indexOf(this.nextMoment(f));h<this.moments.length-1;h++){var k=this.moments[h],l;k.events.branchCmmd&&(l=k.events.branchCmmd,k.events.branchCmmd=void 0);var m=this.moments[h].timestamp;if(this.sectionData.prompts[Math.floor(k.timestamp)]==d)return this.stepTo(this.getTimestamp(k.timestamp,"headhtml")),this.promptIdx=Math.floor(k.timestamp),!0;this.promptIdx=Math.floor(this.time);
k.fire(f,m);if(l){k.events.branchCmmd=l;var n=Math.floor(this.time),f=e[n];if(f.timeline.isSectionsBranch)this.branches[n]=f;else if(f.timeline.isPromptsBranch){var p=f.timeline.sections[0].branches,q=new Timeline.Moment(k.timestamp);q.events.branchCmmd=l;q.fire(this.time,m);n=this.branches[n];n.timeline.sections[0].copyBranchCmmds(f.timeline.sections[0].moments);f=n.timeline.sections[0].deepStepTo(d,p);this.promptIdx=Math.floor(this.time)+0.5;this.time=k.timestamp;if(f)return!0}}this.time=f=m}return!1},
copyBranchCmmds:function(d){for(var e=0;e<d.length;e++){var f=d[e],h=f.events.branchCmmd;if(h){h.section=this;var k=this.momentAt(f.timestamp);k?k.events.branchCmmd=h:(k=new Timeline.Moment(f.timestamp),k.events.branchCmmd=h,this.spliceInMoment(k))}}},nextTowardsDest:function(d,e){var f=this.momentAt(d);if(f){f=this.moments.indexOf(f);e<d?f--:f++;var h=this.moments[f];if(h&&Math.abs(h.timestamp-d)<=Math.abs(e-d))return this.moments[f]}else if(d<e)for(f=0;f<this.moments.length;f++){if(h=this.moments[f],
h.timestamp>d){if(h.timestamp<=e)return h;break}}else if(e<d)for(f=this.moments.length-1;0<=f;f--)if(h=this.moments[f],h.timestamp<d){if(h.timestamp>=e)return h;break}},nextMoment:function(d){for(var e=0;e<this.moments.length;e++)if(this.moments[e].timestamp>d)return this.moments[e]},momentAt:function(d){for(var e=0;e<this.moments.length;e++)if(1E-5>Math.abs(this.moments[e].timestamp-d))return this.moments[e]},cleanUpPrompt:function(d){d=d?this.getTimestamp(this.sectionData.prompts.length-1,"branchPostClean")+
1E-4:this.getTimestamp(0,"head")-1E-4;var e=this.stepTo(d);this.time=d;return e},spliceInMoment:function(d){for(var e=0;e<this.moments.length;e++)if(this.moments[e].timestamp>d.timestamp){this.moments.splice(e,0,d);break}},branchPromptsPreClean:function(d){var e=this.getTimestamp(Math.floor(this.time),"branchPreClean");this.branchPrompts(d,e)},branchPromptsPostClean:function(d){var e=this.getTimestamp(Math.floor(this.time),"branchPostClean");this.branchPrompts(d,e)},branchPrompts:function(d,e){this.killBranchMoments();
var f=new Timeline.Moment(e),h=new Timeline.Command("point",function(f,h){var m=Math.floor(e);if(h.branches[m]&&h.branches[m].id==d.id)window.timeline=h.branches[m].timeline,timeline.sections[0].pushToGlobal(),m=timeline.now(),timeline.show(m.sectionIdx,m.promptIdx,!1,!0);else{var n=new Timeline(f,h.buttonManagerBlank,!1,!0);h.branches[m]=new Timeline.Branch(n,d.id);n.pushSection({prompts:d},h.motherTimeline,h.motherSection);n.sections[0].inheritState(h);n.sectionIdx=0;n.inited=!0;window.timeline=
n;n.sections[0].pushToGlobal();n.show(0,0)}},void 0,!1,!1,void 0);f.events.branchCmmd=new Timeline.Event.BranchCmmd(this,this.timeline.elems,h,Timeline.stateFuncs.cmmds.spawn,this.timeline.takeNumber(),f,!1);this.spliceInMoment(f)},branchSections:function(d){this.killBranchMoments();var e=this.getTimestamp(Math.floor(this.time),"branchPostClean"),e=new Timeline.Moment(e),f=new Timeline.Command("point",function(e,f){var l=Math.floor(f.time);if(f.branches[l]&&f.branches[l].id==d.id)e.clearCurrentSection(),
window.timeline=f.branches[l].timeline,timeline.sections[timeline.sectionIdx].pushToGlobal(),timeline.sections[timeline.sectionIdx].showSection(),l=timeline.now(),timeline.show(l.sectionIdx,l.promptIdx,!1,!0);else{for(var l=new Timeline(e,e.buttonManagerBlank,!0,!1),m=0;m<d.length;m++)l.pushSection(d[m]);f.branches[f.promptIdx]=new Timeline.Branch(l,d.id);f.timeline.clearCurrentSection();window.timeline=l;l.show(0,0)}},void 0,!1,!1,void 0);e.events.branchCmmd=new Timeline.Event.BranchCmmd(this,this.timeline.elems,
f,Timeline.stateFuncs.cmmds.spawn,this.timeline.takeNumber(),e,!0);this.spliceInMoment(e)},killBranches:function(){this.killBranchMoments();this.branches[this.promptIdx]=void 0},killBranchMoments:function(){var d=this.getTimestamp(Math.floor(this.time),"branchPreClean"),e=this.getTimestamp(Math.floor(this.time),"branchPostClean"),d=this.momentAt(d),e=this.momentAt(e);d&&this.moments.splice(this.moments.indexOf(d),1);e&&this.moments.splice(this.moments.indexOf(e),1)},curPrompt:function(){return this.sectionData.prompts[this.promptIdx]},
replaceDiv:function(d,e,f){e.length&&e.remove();d.append(f)},inheritState:function(d){this.level=d.level;this.collide=d.collide;this.walls=d.walls;this.dotManager=d.dotManager;this.spcs=d.spcs;this.dataDisplayer=d.dataDisplayer;this.sliderList=d.sliderList;this.buttonManager=d.buttonManager;this.dataHandler=d.dataHandler;this.activationEnergySpcChanger=d.activationEnergySpcChanger},pushToGlobal:function(){window.curLevel=this.level;window.collide=this.collide;window.walls=this.walls;window.dotManager=
this.dotManager;window.spcs=this.spcs;window.dataDisplayer=this.dataDisplayer;window.canvasManager=this.canvasManager;window.sliderList=this.sliderList;window.buttonManager=this.buttonManager;window.sliderManager=this.sliderManager;window.dataHandler=this.dataHandler;window.activationEnergySpcChanger=this.activationEnergySpcChanger;window.conditionManager=this.conditionManager},restoreAuxs:function(){for(var d in this.level.auxs)this.level.auxs[d].restoreHTML()},restoreGraphs:function(){for(var d in this.level.graphs){var e=
this.level.graphs[d];e.setDataValid();e.restoreHTML();e.drawAllData()}},clear:function(){if(this.inited){$("#prompt").html("");this.buttonManagerClone=$("#buttonManager").clone(!0);$("#buttonManager").html("");$("#baseHeader").html("");this.dashRun.removeClass("active");this.dashRun.hide();for(var d in this.level.graphs)this.level.graphs[d].clearHTML();for(var e in this.level.auxs)this.level.auxs[e].clearHTML()}},addCmmdSpan:function(d,e){promptIdx="now"==d?this.promptIdx:d;var f=this.getTimestamp(promptIdx,
"setup"),h=this.timeline.takeNumber();cmmd="string"==typeof e||"function"==typeof e?new Timeline.Command("span",e,void 0,!0,!1):new Timeline.Command("span",e.spawn,e.remove,!1,e.once,e.cleanUpWith);this.timeline.elems[h]=cmmd;this.applyCmmdSpan(this.timeline,this.moments,this.timeline.elems,cmmd,"cmmds",cmmd.once,f,h);this.sortMoments()},addCmmdPoint:function(d,e,f,h,k){promptIdx="now"==d?this.promptIdx:d;d=this.timeline.takeNumber();e=this.getTimestamp(promptIdx,e||"setup");f=new Timeline.Command("point",
f,void 0,h,k);this.timeline.elems[d]=f;this.applyCmmdPoint(this.timeline,this.moments,this.timeline.elems,f,"cmmds",k,e,d);this.sortMoments()},populateMoments:function(d,e,f,h){f.push(new Timeline.Moment(-2));this.addSceneDataToMoments(d,e,f,h.sceneData,-1,void 0);for(var k=h.prompts,l=0;l<k.length;l++)k[l].sceneData&&this.addSceneDataToMoments(d,e,f,k[l].sceneData,l);this.populateHTMLMoments(d,e,f,h)},populateHTMLMoments:function(d,e,f,h){h=h.prompts;for(var k=0;k<h.length;k++){var l=h[k],m=this.getTimestamp(k,
"headHTML");this.populatePromptHTML(l,m,d,e,f,k)}},populatePromptHTML:function(d,e,f,h,k,l){var m=this,n,p,q;d.cutScene?(p=f.takeNumber(),n=function(){var e=interpreter.interp(d.text);m.level.cutSceneStart(e,d.cutScene)},q=function(){m.level.cutSceneEnd()},d.quiz&&(n=extend(n,function(){$("#base").hide();m.level.quiz=quizRenderer.render(d.quiz,$("#intText"))}),q=extend(q,function(){$("#base").show();m.level.quiz=void 0}))):(p=f.takeNumber(),n=function(){var e=interpreter.interp(d.text);$("#prompt").html(defaultTo("",
templater.div({innerHTML:e})));d.quiz&&(m.level.quiz=quizRenderer.render(d.quiz,$("#prompt")))},q=function(){$("#prompt").html("");m.level.quiz=void 0});q=new Timeline.Command("span",n,q);n=this.getTimestamp(l,"tailHTML");this.pushSpan(h,q,Timeline.stateFuncs.cmmds.spawn,Timeline.stateFuncs.cmmds.remove,p,k,e,n,!1,"cmmds");d.quiz&&(p=f.takeNumber(),q=new Timeline.Command("span",function(){$("#nextPrevDiv").hide()},function(){$("#nextPrevDiv").show()}),n=this.getTimestamp(l,"tailHTML"),this.pushSpan(h,
q,Timeline.stateFuncs.cmmds.spawn,Timeline.stateFuncs.cmmds.remove,p,k,e,n,!1,"cmmds"));d.title&&(p=f.takeNumber(),q=new Timeline.Command("span",function(){$("#baseHeader").html(d.title)},function(){$("#baseHeader").html("")}),n=this.getTimestamp(l,"tailHTML"),this.pushSpan(h,q,Timeline.stateFuncs.cmmds.spawn,Timeline.stateFuncs.cmmds.remove,p,k,e,n,!1,"cmmds"));if(!0===d.noReset||!0===d.noRefresh)p=f.takeNumber(),q=new Timeline.Command("span",function(){$("#resetExp").hide()},function(){$("#resetExp").show()}),
n=this.getTimestamp(l,"tailHTML"),this.pushSpan(h,q,Timeline.stateFuncs.cmmds.spawn,Timeline.stateFuncs.cmmds.remove,p,k,e,n,!1,"cmmds");l=new Timeline.Command("point",function(){interpreter.renderMath();m.buttonManager.arrangeGroupWrappers();m.buttonManager.arrangeAllGroups();m.buttonManager.setButtonWidth()},void 0,!0);this.pushPoint(k,h,f.takeNumber(),l,Timeline.stateFuncs.cmmds.spawn,!1,"cmmds",!1,e)},addSceneDataToMoments:function(d,e,f,h,k){this.getOrCreateMoment(f,k);h&&(this.applySpanToMoments(d,
f,e,h.walls,"walls",k,Timeline.stateFuncs.walls.spawn,Timeline.stateFuncs.walls.remove),this.applySpanToMoments(d,f,e,h.dots,"dots",k,Timeline.stateFuncs.dots.spawn,Timeline.stateFuncs.dots.remove),this.applySpanToMoments(d,f,e,h.objs,"objs",k,Timeline.stateFuncs.objs.spawn,Timeline.stateFuncs.objs.remove),this.applySpanToMoments(d,f,e,h.dataRecord,"objs",k,Timeline.stateFuncs.dataRecord.spawn,Timeline.stateFuncs.dataRecord.remove),this.applySpanToMoments(d,f,e,h.dataReadouts,"objs",k,Timeline.stateFuncs.dataReadouts.spawn,
Timeline.stateFuncs.dataReadouts.remove),this.applySpanToMoments(d,f,e,h.triggers,"objs",k,Timeline.stateFuncs.triggers.spawn,Timeline.stateFuncs.triggers.remove),this.applySpanToMoments(d,f,e,h.graphs,"objs",k,Timeline.stateFuncs.graphs.spawn,Timeline.stateFuncs.graphs.remove),this.applySpanToMoments(d,f,e,h.rxnsEmergent,"objs",k,Timeline.stateFuncs.rxnsEmergent.spawn,Timeline.stateFuncs.rxnsEmergent.remove),this.applySpanToMoments(d,f,e,h.rxnsNonEmergent,"objs",k,Timeline.stateFuncs.rxnsNonEmergent.spawn,
Timeline.stateFuncs.rxnsNonEmergent.remove),this.applySpanToMoments(d,f,e,h.buttonGroups,"objs",k,Timeline.stateFuncs.buttonGrps.spawn,Timeline.stateFuncs.buttonGrps.remove),this.applyCmmdsToMoments(d,f,e,h.cmmds,"cmmds",k))},applySpanToMoments:function(d,e,f,h,k,l,m,n){h=h?h:[];for(var p=0;p<h.length;p++){var q=d.takeNumber(),s=h[p],t=this.getTimestamp(s.cleanUpWith||l,"tail");this.pushSpan(f,s,m,n,q,e,l,t,!1,k)}},applyCmmdsToMoments:function(d,e,f,h,k,l){var m;h=h?h:[];for(var n=0;n<h.length;n++)m=
h[n],m="string"==typeof m||"function"==typeof m?new Timeline.Command("point",m,void 0,!0,!1):new Timeline.Command(m.type,m.spawn,m.remove,defaultTo(!0,m.oneWay),m.once),/span/i.test(m.type)?this.applyCmmdSpan(d,e,f,m,k,m.once,l):/point/i.test(m.type)?this.applyCmmdPoint(d,e,f,m,k,m.once,l):(console.log("Bad command"),console.log(m),console.log('Must be string or have type of "span" or "point"'))},applyCmmdSpan:function(d,e,f,h,k,l,m,n){n=void 0===n?d.takeNumber():n;d=Timeline.stateFuncs.cmmds.spawn;
k=Timeline.stateFuncs.cmmds.remove;var p=this.getTimestamp(h.cleanUpWith||m,"tail");this.pushSpan(f,h,d,k,n,e,m,p,l,"cmmds")},applyCmmdPoint:function(d,e,f,h,k,l,m,n){n=void 0===n?d.takeNumber():n;d=Timeline.stateFuncs.cmmds.spawn;var p=defaultTo(!0,h.oneWay);this.pushPoint(e,f,n,h,d,p,k,l,m)},pushSpan:function(d,e,f,h,k,l,m,n,p,q){m=this.getOrCreateMoment(l,m);l=this.getOrCreateMoment(l,n);n=new Timeline.Event.Span(this,d,e,f,h,k,"head",p,m);d=new Timeline.Event.Span(this,d,e,f,h,k,"tail",p,l);n.partner=
d;d.partner=n;m.events[q].push(n);l.events[q].push(d)},pushPoint:function(d,e,f,h,k,l,m,n,p){d=this.getOrCreateMoment(d,p);e=new Timeline.Event.Point(this,e,h,k,f,l,n,d);d.events[m].push(e)},getTimestamp:function(d,e){var f;/tailhtml/i.test(e)?f=0.8:/tail/i.test(e)?f=0.9:/setup/i.test(e)?f=0.1:/headhtml/i.test(e)?f=0.2:/head/i.test(e)?f=0:/branchPreClean/i.test(e)?f=0.85:/branchPostClean/i.test(e)&&(f=0.95);var h=this.parseIntegerTimeIdx(d);return-1==h&&"tail"==e?Infinity:h+f},getTimestampType:function(d){if(this.atDecimal(d,
0.8))return"tailhtml";if(this.atDecimal(d,0.9))return"tail";if(this.atDecimal(d,0.1))return"setup";if(this.atDecimal(d,0.2))return"headhtml";if(this.atDecimal(d,0))return"head";this.atDecimal(d,0.85)?"branchPreClean":this.atDecimal(d,0.95)&&"branchPostClean"},atDecimal:function(d,e){d=Math.abs(d);return 1E-5>Math.abs(d-Math.floor(d)-e)},parseIntegerTimeIdx:function(d){if("string"==typeof d){if(/section/i.test(d))return-1;var e=/[0-9]+/.exec(d);if(""!==e)return Number(e);console.log("Bad time code: "+
d)}else return Math.floor(d)},sortMoments:function(){this.moments=_.sortBy(this.moments,function(d){return d.timestamp})},getOrCreateMoment:function(d,e){for(var f=0;f<d.length;f++)if(d[f].timestamp==e)return d[f];d.push(new Timeline.Moment(e));return d[d.length-1]}};
Timeline.stateFuncs={walls:{spawn:function(d,e,f,h){e[f]=d.walls.addWall(h)},remove:function(d,e,f){var h=e[f];h&&d.walls.removeWall(h.handle);e[f]=void 0}},dots:{spawn:function(d,e,f,h){d.spcs[h.spcName].populate(h.pos,h.dims,h.count,h.temp,h.tag,f,h.returnTo);e[f]="dots"},remove:function(d,e,f){d.dotManager.removeByAttr("elemId",f);e[f]=void 0}},objs:{spawn:function(d,e,f,h){(d=window[h.type])||console.log("Bad object type "+h.type);e[f]=new d(h.attrs)},remove:function(d,e,f){(d=e[f])&&d.remove();
e[f]=void 0}},dataRecord:{spawn:function(d,e,f,h){if(/collisions/i.test(h.data))d.collide.recordCollisions();else d.walls[h.wallInfo]["record"+h.data.toCapitalCamelCase()](h.attrs);e[f]=h},remove:function(d,e,f){var h=e[f];if(/collisions/i.test(h.data))d.collide.recordCollisionsStop();else d.walls[h.wallInfo]["record"+h.data.toCapitalCamelCase()+"Stop"](h.attrs);e[f]=void 0}},dataReadouts:{spawn:function(d,e,f,h){d=d.dataDisplayer.addEntry(h);e[f]=d},remove:function(d,e,f){e[f].remove();e[f]=void 0}},
triggers:{spawn:function(d,e,f,h){e[f]=new window.Trigger(h)},remove:function(d,e,f){e[f].remove();e[f]=void 0}},graphs:{spawn:function(d,e,f,h){var k;/^load$/i.test(h.type)?((k=window.storedGraphs[h.handle])?(k.initDrawLayers(),k.restoreHTML()):console.log("Tried to load graph with bad handle "+h.handle),k.setDataValid()):k=new window.Graphs[h.type](h);k.drawAllData();if(h.sets)for(var l=0;l<h.sets.length;l++)k.addSet(h.sets[l]);d.level.graphs[h.handle]=k;e[f]=k},remove:function(d,e,f){var h=e[f],
k;for(k in h.data)h.data[k].recording=!1;delete d.level.graphs[h.handle];h.remove();e[f]=void 0}},rxnsEmergent:{spawn:function(d,e,f,h){d=d.collide.rxnHandlerEmergent.addReaction(h);e[f]=d},remove:function(d,e,f){e[f].remove();e[f]=void 0}},rxnsNonEmergent:{spawn:function(d,e,f,h){d=d.collide.rxnHandlerNonEmergent.addReaction(h);e[f]=d},remove:function(d,e,f){e[f].remove();e[f]=void 0}},buttonGrps:{spawn:function(d,e,f,h){d.buttonManager.addGroup(h.handle,h.label,h.prefIdx,h.isRadio,h.isToggle);if(h.buttons)for(var k=
0;k<h.buttons.length;k++){var l=h.buttons[k];d.buttonManager.addButton(h.handle,l.handle,l.label,l.exprs,l.prefIdx,l.isDown)}else console.log("Button group "+h.handle+" has no buttons.  Just thought you should know.  This object is logged below."),console.log(h);e[f]=h},remove:function(d,e,f){d.buttonManager.removeGroup(e[f].handle);e[f]=void 0}},cmmds:{spawn:function(d,e,f,h){var k=h.spawn;e[f]=h;if(k)with(DataGetFuncs)"function"==typeof k?k(d.timeline,d):"string"==typeof k?eval("("+k+")"):k instanceof
Array&&(d=k.join(";")+";",eval("("+d+")"))},remove:function(d,e,f){d=e[f];e[f]=void 0;if(e=d.remove)with(DataGetFuncs)"function"==typeof e?e():"string"==typeof e?eval("("+e+")"):e instanceof Array&&(e=e.join(";")+";",eval("("+e+")"))}}};Timeline.Moment=function(d){this.timestamp=d;this.events=new Timeline.EventClassHolder};
Timeline.Moment.prototype={fire:function(d,e){this.fireSpans(this.events.dots,d,e);this.fireSpans(this.events.walls,d,e);this.fireSpans(this.events.objs,d,e);this.fireCmmds(this.events.cmmds,d,e);this.fireCmmds([this.events.branchCmmd],d,e)},fireSpans:function(d,e,f){for(var h=0;h<d.length;h++)this.fireSpan(d[h],e,f)},fireSpan:function(d,e,f){if(d.active){var h=getAndEval(d.elemDatum);"head"==d.boundType?e<f&&e<this.timestamp&&f<d.partner.moment.timestamp?d.spawn(d.section,d.timelineElems,d.id,h):
f<e&&(f<this.timestamp&&e<=d.partner.moment.timestamp)&&(d.remove(d.section,d.timelineElems,d.id),d.once&&(d.active=!1,d.partner.active=!1)):"tail"==d.boundType&&(f>e&&e>=d.partner.moment.timestamp&&e<this.timestamp?(d.remove(d.section,d.timelineElems,d.id),d.once&&(d.active=!1)):f<e&&f>=d.partner.moment.timestamp&&d.spawn(d.section,d.timelineElems,d.id,h))}},fireCmmds:function(d,e,f){for(var h,k=0;k<d.length;k++){var l=d[k];if(l instanceof Timeline.Event.Span)this.fireSpans([l],e,f);else if(l instanceof
Timeline.Event.Point||l instanceof Timeline.Event.BranchCmmd)if((e<this.timestamp&&this.timestamp<=f||f<=this.timestamp&&this.timestamp<e)&&(l.elemDatum.oneWay?e<f:1)&&l.active)h=getAndEval(l.elemDatum),l.spawn(l.section,l.timelineElems,l.id,h),l.once&&(l.active=!1)}}};Timeline.Command=function(d,e,f,h,k,l){this.type=d;this.spawn=e;this.remove=f;this.oneWay=h;this.once=k;this.cleanUpWith=l};
Timeline.EventClassHolder=function(){this.walls=[];this.dots=[];this.objs=[];this.cmmds=[];this.branchCmmd=void 0};
Timeline.Event={Span:function(d,e,f,h,k,l,m,n,p){this.section=d;this.timelineElems=e;this.elemDatum=f;this.spawn=h;this.remove=k;this.id=l;this.boundType=m;this.moment=p;this.once=n;this.active=!0;this.parnter},Point:function(d,e,f,h,k,l,m,n){this.section=d;this.timelineElems=e;this.elemDatum=f;this.spawn=h;this.id=k;this.oneWay=l;this.moment=n;this.once=m;this.active=!0},BranchCmmd:function(d,e,f,h,k,l,m){this.section=this.section=d;this.timelineElems=e;this.elemDatum=f;this.spawn=h;this.id=k;this.oneWay=
!1;this.moment=l;this.once=!1;this.active=!0;this.isSectionsBranch=m;this.isPromptsBranch=!m}};Timeline.Branch=function(d,e){this.timeline=d;this.id=e};window.R=8.314;
$(function(){window.IMGPATHPREFIX="";window.simHost=window.simHost||"";"CW"==window.simHost&&(window.IMGPATHPREFIX="content/sims/levels/");$("#resetExp").append("<img src='"+IMGPATHPREFIX+"img/refresh.gif'></img>");MathJax.Hub.Config({tex2jax:{inlineMath:[["##","##"],["\\(","\\)"]],displayMath:[["$$","$$"]]}});_.extend(Array.prototype,toInherit.ArrayExtenders);_.extend(Math,toInherit.MathExtenders);_.extend(String.prototype,toInherit.StringExtenders);templater=new Templater;globalHTMLClass="sim";
dotManager=new DotManager;turn=0;window.Graphs={Scatter:GraphScatter,Hist:GraphHist,PhaseTwoComp:GraphPhaseTwoComp,PhaseOneComp:GraphPhaseOneComp};$("#mainHeader").html(LevelData.levelTitle);$("#canvasDiv").hide();$("#base").hide();$("#dashIntro").hide();$("#dashOutro").hide();$("#dashCutScene").hide();$("#display").hide();$("#intText").hide();canvas=document.getElementById("myCanvas");c=canvas.getContext("2d");N=1E3;R=8.314;KB=R/N;extraIntervals={};vConst=1E-4;pConst=16.3562;tConst=20;LtoM3=0.0010;
ATMtoPA=101325;PUNITTOPA=BARTOPA=1E5;MMHGTOBAR=0.0013332237;JtoKJ=0.0010;pxToE=Math.sqrt(tConst);ACTUALN=6.022E23;g=1.75;gInternal=0.01;updateInterval=30;dataInterval=1250;borderCol=Col(155,155,155);pxToMS=19.33821;auxHolderDivs=["aux1","aux2"];stored={};storedGraphs={};addJQueryElems($("button"),"button");draw=new DrawingTools;turnUpdater=setInterval("curLevel.update()",updateInterval);dataUpdater=setInterval("curLevel.updateData()",dataInterval);attractor=new Attractor;animText=new AnimText(c);
phaseEquilGenerator=new PhaseEquilGenerator;dotMigrator=new DotMigrator;quizRenderer=new QuizRenderer;sceneNavigator=new SceneNavigator;interpreter=new ExpressionInterpreter;$("#resetExp").click(function(){sceneNavigator.refresh()});$("#toSim").click(function(){sceneNavigator.nextPrompt()});$("#toLastStep").click(function(){sceneNavigator.prevPrompt()});$("#previous").click(function(){sceneNavigator.prevPrompt()});$("#next").click(function(){sceneNavigator.nextPrompt()});window.dashRunId=0;timeline=
new Timeline;canvasHeight=450;myCanvas.width=$("#main").width();myCanvas.height=canvasHeight;var d=0;LevelTools.addUF298(LevelData.spcDefs);LevelTools.addCp(LevelData.spcDefs);d=LevelTools.addImgsAndQuestionIds(LevelData.mainSequence,d);LevelTools.assumeDefaultRxnType(LevelData.mainSequence);LevelTools.setDefaultPromptVals(LevelData.mainSequence);LevelTools.addTriggerCleanUp(LevelData.mainSequence);LevelTools.addStoreAs(LevelData.mainSequence);LevelTools.transferObjCleanUp(LevelData.mainSequence);
LevelTools.showRunDivs();var e=0,f;for(f in LevelData.auxSections){var h=LevelData.auxSections[f],h=h instanceof Array?h:[h],d=LevelTools.addImgsAndQuestionIds(h,d);h.id=e;e++;LevelTools.assumeDefaultRxnType(h);LevelTools.setDefaultPromptVals(h);LevelTools.addTriggerCleanUp(h);LevelTools.addStoreAs(h);LevelTools.transferObjCleanUp(h)}for(var k in LevelData.auxPrompts)f=LevelData.auxPrompts[k],f=f instanceof Array?f:[f],h=[{prompts:f}],d=LevelTools.addImgsAndQuestionIds(h,d),f.id=e,e++,LevelTools.assumeDefaultRxnType(h),
LevelTools.setDefaultPromptVals(h),LevelTools.addTriggerCleanUp(h),LevelTools.addStoreAs(h),LevelTools.transferObjCleanUp(h);for(d=0;d<LevelData.mainSequence.length;d++)timeline.pushSection(LevelData.mainSequence[d]);timeline.show(0,0)});
